import{j as e}from"./ui-vendor-BO3EQrMK-mjd3dogn.js";import{u as t,i as r,r as a}from"./react-vendor-D1R0t5S0-mjd3dogn.js";import{u as s,s as i,B as o,t as l}from"./index-Ta7FH5xW-mjd3dogn.js";import{t as n}from"./tripsData-DKwZ96V_-mjd3dogn.js";import{L as c}from"./loader-circle-C0Dqayt8-mjd3dogn.js";import{E as d}from"./external-link-CqAT5ABV-mjd3dogn.js";import{S as m}from"./share-2-DwO-SOoB-mjd3dogn.js";import{M as u}from"./map-pin-BtCU-LeS-mjd3dogn.js";import{C as h}from"./calendar-C9K0fVga-mjd3dogn.js";import{U as p}from"./users-B07yK8Y7-mjd3dogn.js";import"./supabase-DyX-XggK-mjd3dogn.js";import"./utils-DD44zzh--mjd3dogn.js";const x=()=>{const{tripId:x}=t(),g=r(),{user:b}=s(),[v,j]=a.useState(!0),[w,f]=a.useState(null),[y,N]=a.useState(null);a.useEffect(()=>{const e=setTimeout(()=>{v&&(j(!1),w||y||N("Failed to load trip details. Please refresh."))},5e3);return()=>clearTimeout(e)},[v,w,y]),a.useEffect(()=>{const e=(null==w?void 0:w.name)||"an Amazing Trip",t=(null==w?void 0:w.destination)||"an exciting destination",r=(null==w?void 0:w.cover_image_url)||"https://images.unsplash.com/photo-1488646953014-85cb44e25828?w=1200&h=630&fit=crop";document.title=`${e} - Chravel`;const a=(e,t)=>{let r=document.querySelector(`meta[property="${e}"]`);r||(r=document.createElement("meta"),r.setAttribute("property",e),document.head.appendChild(r)),r.content=t},s=(e,t)=>{let r=document.querySelector(`meta[name="${e}"]`);r||(r=document.createElement("meta"),r.setAttribute("name",e),document.head.appendChild(r)),r.content=t};a("og:title",`Check out ${e} on Chravel!`),a("og:description",`A trip to ${t}. Plan your group travel adventures with Chravel!`),a("og:type","website"),a("og:image",r),a("og:url",window.location.href),s("twitter:card","summary_large_image"),s("twitter:title",`Check out ${e} on Chravel!`),s("twitter:description",`A trip to ${t}. Plan your group travel adventures with Chravel!`),s("twitter:image",r)},[w]),a.useEffect(()=>{x&&k()},[x]);const k=async()=>{if(!x)return;j(!0),N(null);const e=parseInt(x,10);if(!isNaN(e)&&e>0&&e<=12){const t=n.find(t=>t.id===e);if(t)return f({id:x,name:t.title,destination:t.location,start_date:null,end_date:null,dateRange:t.dateRange,cover_image_url:t.coverPhoto||null,trip_type:"consumer",member_count:t.participants.length,description:null}),void j(!1)}try{const{data:e,error:t}=await i.functions.invoke("get-trip-preview",{body:{tripId:x}});if(t||!(null==e?void 0:e.success)||!(null==e?void 0:e.trip))return void N((null==e?void 0:e.error)||(null==t?void 0:t.message)||"Trip not found");f(e.trip)}catch(t){N("Failed to load trip details")}finally{j(!1)}},C=async()=>{const e=window.location.href,t=`Check out ${(null==w?void 0:w.name)||"this trip"} on Chravel!`;if(navigator.share)try{await navigator.share({title:(null==w?void 0:w.name)||"Trip on Chravel",text:t,url:e})}catch(r){}else try{await navigator.clipboard.writeText(e),l.success("Link copied to clipboard!")}catch(r){l.error("Failed to copy link")}};return v?e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-black flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(c,{className:"h-12 w-12 animate-spin text-yellow-400 mx-auto mb-4"}),e.jsx("p",{className:"text-white/60",children:"Loading trip details..."})]})}):y||!w?e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-black flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-3xl p-8 max-w-md w-full text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(d,{className:"h-8 w-8 text-red-400"})}),e.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Trip Not Found"}),e.jsx("p",{className:"text-white/60 mb-6",children:y||"This trip may have been deleted or is no longer available."}),e.jsx(o,{onClick:()=>g("/"),className:"bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-black font-semibold",children:"Go to Home"})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-black",children:[e.jsxs("div",{className:"relative h-64 md:h-80",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:`url('${w.cover_image_url||"https://images.unsplash.com/photo-1488646953014-85cb44e25828?w=1200&h=630&fit=crop"}')`}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-gray-900/60 to-transparent"}),e.jsx("div",{className:"absolute top-4 left-4 z-10",children:e.jsx("div",{className:"bg-black/40 backdrop-blur-sm px-4 py-2 rounded-full",children:e.jsx("span",{className:"text-yellow-400 font-bold text-lg",children:"Chravel"})})}),e.jsx("button",{onClick:C,className:"absolute top-4 right-4 z-10 bg-black/40 backdrop-blur-sm p-3 rounded-full hover:bg-black/60 transition-colors",children:e.jsx(m,{className:"h-5 w-5 text-white"})})]}),e.jsx("div",{className:"relative -mt-20 px-4 pb-8",children:e.jsxs("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-3xl p-6 max-w-lg mx-auto",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-white mb-4",children:w.name}),e.jsxs("div",{className:"space-y-3 mb-6",children:[w.destination&&e.jsxs("div",{className:"flex items-center gap-3 text-white/80",children:[e.jsx(u,{className:"h-5 w-5 text-yellow-400 flex-shrink-0"}),e.jsx("span",{children:w.destination})]}),e.jsxs("div",{className:"flex items-center gap-3 text-white/80",children:[e.jsx(h,{className:"h-5 w-5 text-yellow-400 flex-shrink-0"}),e.jsx("span",{children:((e,t,r)=>{if(r)return r;if(!e)return"Dates TBD";const a=new Date(e),s={month:"short",day:"numeric"};if(!t)return a.toLocaleDateString("en-US",{...s,year:"numeric"});const i=new Date(t);return a.getFullYear()===i.getFullYear()?`${a.toLocaleDateString("en-US",s)} - ${i.toLocaleDateString("en-US",{...s,year:"numeric"})}`:`${a.toLocaleDateString("en-US",{...s,year:"numeric"})} - ${i.toLocaleDateString("en-US",{...s,year:"numeric"})}`})(w.start_date,w.end_date,w.dateRange)})]}),e.jsxs("div",{className:"flex items-center gap-3 text-white/80",children:[e.jsx(p,{className:"h-5 w-5 text-yellow-400 flex-shrink-0"}),e.jsxs("span",{children:[w.member_count," ",1===w.member_count?"Chraveler":"Chravelers"]})]})]}),w.description&&e.jsx("p",{className:"text-white/60 text-sm mb-6 line-clamp-3",children:w.description}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(o,{onClick:()=>{const e=x?parseInt(x,10):NaN;!isNaN(e)&&e>0&&e<=12?g(`/auth?mode=signup&returnTo=${encodeURIComponent("/")}`,{replace:!0}):b?g(`/trip/${x}`):g(`/auth?mode=signup&returnTo=${encodeURIComponent(`/trip/${x}`)}`,{replace:!0})},className:"w-full bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-black font-semibold py-3 text-base",children:(()=>{const e=x?parseInt(x,10):NaN;return!isNaN(e)&&e>0&&e<=12?"Sign Up to View":b?"View Full Trip":"Sign Up to View"})()}),e.jsxs(o,{onClick:C,variant:"outline",className:"w-full border-white/20 text-white hover:bg-white/10 py-3 text-base",children:[e.jsx(m,{className:"h-4 w-4 mr-2"}),"Share Trip"]})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-white/10 text-center",children:[e.jsx("p",{className:"text-white/40 text-sm mb-2",children:"Plan group trips together"}),e.jsx("p",{className:"text-yellow-400 font-medium",children:"chravel.app"})]})]})})]})};export{x as default};
