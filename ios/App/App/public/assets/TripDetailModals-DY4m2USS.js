const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CAsyng-G.js","assets/index-jbo_OdjT.css"])))=>i.map(i=>d[i]);
var Is=t=>{throw TypeError(t)};var Dt=(t,s,r)=>s.has(t)||Is("Cannot "+r);var j=(t,s,r)=>(Dt(t,s,"read from private field"),r?r.call(t):s.get(t)),B=(t,s,r)=>s.has(t)?Is("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(t):s.set(t,r),I=(t,s,r,n)=>(Dt(t,s,"write to private field"),n?n.call(t,r):s.set(t,r),r),z=(t,s,r)=>(Dt(t,s,"access private method"),r);import{c as Je,J as yr,K as Os,L as ae,M as ut,N as lt,O as Mn,Q as Vt,U as $s,V as An,Y as In,Z as On,$ as Fs,a0 as wt,a1 as Ls,a2 as $n,r as c,a3 as ds,k as Ve,s as V,j as e,X as Pe,t as Rt,R as Gt,o as us,S as ms,u as Fn,m as hs,h as W,A as Ln,i as zn,B as Un,D as Bn,F as Vn,n as Gn,P as _e,v as Mt,a4 as fs,a5 as jt,g as ge,a6 as ps,a7 as Wn,f as wr,a8 as jr,a9 as Nr,aa as Kn,ab as qn,ac as Hn,ad as Yn,ae as Qn,af as Xn,ag as Zn,ah as Cr,ai as Jn,aj as eo,_ as to,l as Sr,p as so,z as ro}from"./index-CAsyng-G.js";import{t as Er,i as kr,g as Pr,a as _r,S as ao,M as Tr,I as no,A as oo}from"./avatarUtils-ZvhZyhoo.js";import{u as io,U as lo,c as Wt,F as co,g as Dr,D as uo,T as Rr,d as Mr}from"./SeatManagementSection-BFc4Xk5u.js";import{C as Ar}from"./camera-CpfyDuxc.js";import{C as gs,U as Nt}from"./user-D5s9iwuG.js";import{r as mo,M as Ce,D as ho,o as Ir,s as fo,L as po,Z as go,T as zs,h as Us,S as xo}from"./SettingsMenu-BOjv86PG.js";import{C as Or,a as $r,b as Fr,c as Lr,d as zr,e as ne,f as vo,u as bo}from"./select-XMWUKs4c.js";import{D as Ur,a as Br,b as Vr,c as Gr,L as H,O as Wr,C as Kr,d as qr,T as Hr,e as Yr,P as yo,R as wo,h as Qr,f as jo,u as No,F as Co,g as So,_ as Eo,i as ko,j as Me,k as Po,z as _o,s as To,l as Do,m as Ro,n as Mo}from"./dialog-Cx8-WJ72.js";import{M as mt}from"./map-pin-BpJQ3jXK.js";import{C as Ue}from"./calendar-B2WMmvpa.js";import{U as ve}from"./users-DV9oPzUN.js";import{P as xs}from"./plus-CmGY8coD.js";import{C as Ct}from"./clock-z7hIZNmF.js";import{d as Ao}from"./demoModeService-C5DiNBaU.js";import{u as Ge}from"./useDemoMode-BjEsodyt.js";import{D as Io,a as Oo,b as $o,d as rt,C as Kt,c as Xr,R as Fo,I as Lo}from"./dropdown-menu-DesE2wBT.js";import{I as Oe}from"./input-CkF3ltBX.js";import{B as G}from"./button-_Pv0MPf0.js";import{C as qt,a as Ht,b as zo,c as Uo}from"./card-BWfXNMJp.js";import{S as Zr}from"./share-2-bKBjjyB8.js";import{t as te,c as Bo,e as Vo,d as Go,a as Wo,g as Bs,m as Vs,b as at,h as Ko,f as qe,C as Jr,i as qo}from"./calendar-BbT1q-ev.js";import{B as He}from"./badge-J4HoHOpX.js";import{A as ht,a as ft,b as pt}from"./avatar-BV3tYu8d.js";import{C as ea}from"./circle-check-big-DmirYwTN.js";import{F as Ho}from"./filter-CGCfNQCb.js";import{g as vs,a as ta,p as sa}from"./eventsMockData-BosocEr8.js";import{E as Yo}from"./ellipsis-vertical-CzHInxXT.js";import{C as Qo}from"./crown-DXGOoHaJ.js";import{S as Xo}from"./sparkles-C9bYoM-0.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=Je("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nu=Je("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zo=Je("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=Je("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jo=Je("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);var X,M,Xe,Q,we,$e,me,re,Ze,Fe,Le,je,Ne,he,ze,O,Ke,Yt,Qt,Xt,Zt,Jt,es,ts,ra,vr,ei=(vr=class extends yr{constructor(s,r){super();B(this,O);B(this,X);B(this,M);B(this,Xe);B(this,Q);B(this,we);B(this,$e);B(this,me);B(this,re);B(this,Ze);B(this,Fe);B(this,Le);B(this,je);B(this,Ne);B(this,he);B(this,ze,new Set);this.options=r,I(this,X,s),I(this,re,null),I(this,me,Os()),this.options.experimental_prefetchInRender||j(this,me).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(j(this,M).addObserver(this),Ws(j(this,M),this.options)?z(this,O,Ke).call(this):this.updateResult(),z(this,O,Zt).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ss(j(this,M),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ss(j(this,M),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,z(this,O,Jt).call(this),z(this,O,es).call(this),j(this,M).removeObserver(this)}setOptions(s,r){const n=this.options,a=j(this,M);if(this.options=j(this,X).defaultQueryOptions(s),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ae(this.options.enabled,j(this,M))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");z(this,O,ts).call(this),j(this,M).setOptions(this.options),n._defaulted&&!ut(this.options,n)&&j(this,X).getQueryCache().notify({type:"observerOptionsUpdated",query:j(this,M),observer:this});const o=this.hasListeners();o&&Ks(j(this,M),a,this.options,n)&&z(this,O,Ke).call(this),this.updateResult(r),o&&(j(this,M)!==a||ae(this.options.enabled,j(this,M))!==ae(n.enabled,j(this,M))||lt(this.options.staleTime,j(this,M))!==lt(n.staleTime,j(this,M)))&&z(this,O,Yt).call(this);const i=z(this,O,Qt).call(this);o&&(j(this,M)!==a||ae(this.options.enabled,j(this,M))!==ae(n.enabled,j(this,M))||i!==j(this,he))&&z(this,O,Xt).call(this,i)}getOptimisticResult(s){const r=j(this,X).getQueryCache().build(j(this,X),s),n=this.createResult(r,s);return si(this,n)&&(I(this,Q,n),I(this,$e,this.options),I(this,we,j(this,M).state)),n}getCurrentResult(){return j(this,Q)}trackResult(s,r){const n={};return Object.keys(s).forEach(a=>{Object.defineProperty(n,a,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(a),r==null||r(a),s[a])})}),n}trackProp(s){j(this,ze).add(s)}getCurrentQuery(){return j(this,M)}refetch({...s}={}){return this.fetch({...s})}fetchOptimistic(s){const r=j(this,X).defaultQueryOptions(s),n=j(this,X).getQueryCache().build(j(this,X),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(s){return z(this,O,Ke).call(this,{...s,cancelRefetch:s.cancelRefetch??!0}).then(()=>(this.updateResult(),j(this,Q)))}createResult(s,r){var P;const n=j(this,M),a=this.options,o=j(this,Q),i=j(this,we),l=j(this,$e),d=s!==n?s.state:j(this,Xe),{state:f}=s;let h={...f},m=!1,p;if(r._optimisticResults){const T=this.hasListeners(),$=!T&&Ws(s,r),F=T&&Ks(s,n,r,a);($||F)&&(h={...h,...On(f.data,s.options)}),r._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:b,errorUpdatedAt:x,status:v}=h;if(r.select&&h.data!==void 0)if(o&&h.data===(i==null?void 0:i.data)&&r.select===j(this,Ze))p=j(this,Fe);else try{I(this,Ze,r.select),p=r.select(h.data),p=Fs(o==null?void 0:o.data,p,r),I(this,Fe,p),I(this,re,null)}catch(T){I(this,re,T)}else p=h.data;if(r.placeholderData!==void 0&&p===void 0&&v==="pending"){let T;if(o!=null&&o.isPlaceholderData&&r.placeholderData===(l==null?void 0:l.placeholderData))T=o.data;else if(T=typeof r.placeholderData=="function"?r.placeholderData((P=j(this,Le))==null?void 0:P.state.data,j(this,Le)):r.placeholderData,r.select&&T!==void 0)try{T=r.select(T),I(this,re,null)}catch($){I(this,re,$)}T!==void 0&&(v="success",p=Fs(o==null?void 0:o.data,T,r),m=!0)}j(this,re)&&(b=j(this,re),p=j(this,Fe),x=Date.now(),v="error");const y=h.fetchStatus==="fetching",S=v==="pending",g=v==="error",w=S&&y,C=p!==void 0,k={status:v,fetchStatus:h.fetchStatus,isPending:S,isSuccess:v==="success",isError:g,isInitialLoading:w,isLoading:w,data:p,dataUpdatedAt:h.dataUpdatedAt,error:b,errorUpdatedAt:x,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>d.dataUpdateCount||h.errorUpdateCount>d.errorUpdateCount,isFetching:y,isRefetching:y&&!S,isLoadingError:g&&!C,isPaused:h.fetchStatus==="paused",isPlaceholderData:m,isRefetchError:g&&C,isStale:bs(s,r),refetch:this.refetch,promise:j(this,me)};if(this.options.experimental_prefetchInRender){const T=R=>{k.status==="error"?R.reject(k.error):k.data!==void 0&&R.resolve(k.data)},$=()=>{const R=I(this,me,k.promise=Os());T(R)},F=j(this,me);switch(F.status){case"pending":s.queryHash===n.queryHash&&T(F);break;case"fulfilled":(k.status==="error"||k.data!==F.value)&&$();break;case"rejected":(k.status!=="error"||k.error!==F.reason)&&$();break}}return k}updateResult(s){const r=j(this,Q),n=this.createResult(j(this,M),this.options);if(I(this,we,j(this,M).state),I(this,$e,this.options),j(this,we).data!==void 0&&I(this,Le,j(this,M)),ut(n,r))return;I(this,Q,n);const a={},o=()=>{if(!r)return!0;const{notifyOnChangeProps:i}=this.options,l=typeof i=="function"?i():i;if(l==="all"||!l&&!j(this,ze).size)return!0;const u=new Set(l??j(this,ze));return this.options.throwOnError&&u.add("error"),Object.keys(j(this,Q)).some(d=>{const f=d;return j(this,Q)[f]!==r[f]&&u.has(f)})};(s==null?void 0:s.listeners)!==!1&&o()&&(a.listeners=!0),z(this,O,ra).call(this,{...a,...s})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&z(this,O,Zt).call(this)}},X=new WeakMap,M=new WeakMap,Xe=new WeakMap,Q=new WeakMap,we=new WeakMap,$e=new WeakMap,me=new WeakMap,re=new WeakMap,Ze=new WeakMap,Fe=new WeakMap,Le=new WeakMap,je=new WeakMap,Ne=new WeakMap,he=new WeakMap,ze=new WeakMap,O=new WeakSet,Ke=function(s){z(this,O,ts).call(this);let r=j(this,M).fetch(this.options,s);return s!=null&&s.throwOnError||(r=r.catch(Mn)),r},Yt=function(){z(this,O,Jt).call(this);const s=lt(this.options.staleTime,j(this,M));if(Vt||j(this,Q).isStale||!$s(s))return;const n=An(j(this,Q).dataUpdatedAt,s)+1;I(this,je,setTimeout(()=>{j(this,Q).isStale||this.updateResult()},n))},Qt=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(j(this,M)):this.options.refetchInterval)??!1},Xt=function(s){z(this,O,es).call(this),I(this,he,s),!(Vt||ae(this.options.enabled,j(this,M))===!1||!$s(j(this,he))||j(this,he)===0)&&I(this,Ne,setInterval(()=>{(this.options.refetchIntervalInBackground||In.isFocused())&&z(this,O,Ke).call(this)},j(this,he)))},Zt=function(){z(this,O,Yt).call(this),z(this,O,Xt).call(this,z(this,O,Qt).call(this))},Jt=function(){j(this,je)&&(clearTimeout(j(this,je)),I(this,je,void 0))},es=function(){j(this,Ne)&&(clearInterval(j(this,Ne)),I(this,Ne,void 0))},ts=function(){const s=j(this,X).getQueryCache().build(j(this,X),this.options);if(s===j(this,M))return;const r=j(this,M);I(this,M,s),I(this,Xe,s.state),this.hasListeners()&&(r==null||r.removeObserver(this),s.addObserver(this))},ra=function(s){wt.batch(()=>{s.listeners&&this.listeners.forEach(r=>{r(j(this,Q))}),j(this,X).getQueryCache().notify({query:j(this,M),type:"observerResultsUpdated"})})},vr);function ti(t,s){return ae(s.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&s.retryOnMount===!1)}function Ws(t,s){return ti(t,s)||t.state.data!==void 0&&ss(t,s,s.refetchOnMount)}function ss(t,s,r){if(ae(s.enabled,t)!==!1){const n=typeof r=="function"?r(t):r;return n==="always"||n!==!1&&bs(t,s)}return!1}function Ks(t,s,r,n){return(t!==s||ae(n.enabled,t)===!1)&&(!r.suspense||t.state.status!=="error")&&bs(t,r)}function bs(t,s){return ae(s.enabled,t)!==!1&&t.isStaleByTime(lt(s.staleTime,t))}function si(t,s){return!ut(t.getCurrentResult(),s)}var fe,pe,Z,ie,ce,ct,rs,br,ri=(br=class extends yr{constructor(r,n){super();B(this,ce);B(this,fe);B(this,pe);B(this,Z);B(this,ie);I(this,fe,r),this.setOptions(n),this.bindMethods(),z(this,ce,ct).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var a;const n=this.options;this.options=j(this,fe).defaultMutationOptions(r),ut(this.options,n)||j(this,fe).getMutationCache().notify({type:"observerOptionsUpdated",mutation:j(this,Z),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&Ls(n.mutationKey)!==Ls(this.options.mutationKey)?this.reset():((a=j(this,Z))==null?void 0:a.state.status)==="pending"&&j(this,Z).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=j(this,Z))==null||r.removeObserver(this)}onMutationUpdate(r){z(this,ce,ct).call(this),z(this,ce,rs).call(this,r)}getCurrentResult(){return j(this,pe)}reset(){var r;(r=j(this,Z))==null||r.removeObserver(this),I(this,Z,void 0),z(this,ce,ct).call(this),z(this,ce,rs).call(this)}mutate(r,n){var a;return I(this,ie,n),(a=j(this,Z))==null||a.removeObserver(this),I(this,Z,j(this,fe).getMutationCache().build(j(this,fe),this.options)),j(this,Z).addObserver(this),j(this,Z).execute(r)}},fe=new WeakMap,pe=new WeakMap,Z=new WeakMap,ie=new WeakMap,ce=new WeakSet,ct=function(){var n;const r=((n=j(this,Z))==null?void 0:n.state)??$n();I(this,pe,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},rs=function(r){wt.batch(()=>{var n,a,o,i,l,u,d,f;if(j(this,ie)&&this.hasListeners()){const h=j(this,pe).variables,m=j(this,pe).context;(r==null?void 0:r.type)==="success"?((a=(n=j(this,ie)).onSuccess)==null||a.call(n,r.data,h,m),(i=(o=j(this,ie)).onSettled)==null||i.call(o,r.data,null,h,m)):(r==null?void 0:r.type)==="error"&&((u=(l=j(this,ie)).onError)==null||u.call(l,r.error,h,m),(f=(d=j(this,ie)).onSettled)==null||f.call(d,void 0,r.error,h,m))}this.listeners.forEach(h=>{h(j(this,pe))})})},br),aa=c.createContext(!1),ai=()=>c.useContext(aa);aa.Provider;function ni(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var oi=c.createContext(ni()),ii=()=>c.useContext(oi);function na(t,s){return typeof t=="function"?t(...s):!!t}function oa(){}var li=(t,s)=>{(t.suspense||t.throwOnError)&&(s.isReset()||(t.retryOnMount=!1))},ci=t=>{c.useEffect(()=>{t.clearReset()},[t])},di=({result:t,errorResetBoundary:s,throwOnError:r,query:n})=>t.isError&&!s.isReset()&&!t.isFetching&&n&&na(r,[t.error,n]),ui=t=>{t.suspense&&(t.staleTime===void 0&&(t.staleTime=1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},mi=(t,s)=>t.isLoading&&t.isFetching&&!s,hi=(t,s)=>(t==null?void 0:t.suspense)&&s.isPending,qs=(t,s,r)=>s.fetchOptimistic(t).catch(()=>{r.clearReset()});function fi(t,s,r){var f,h,m,p,b;const n=ds(),a=ai(),o=ii(),i=n.defaultQueryOptions(t);(h=(f=n.getDefaultOptions().queries)==null?void 0:f._experimental_beforeQuery)==null||h.call(f,i),i._optimisticResults=a?"isRestoring":"optimistic",ui(i),li(i,o),ci(o);const l=!n.getQueryCache().get(i.queryHash),[u]=c.useState(()=>new s(n,i)),d=u.getOptimisticResult(i);if(c.useSyncExternalStore(c.useCallback(x=>{const v=a?()=>{}:u.subscribe(wt.batchCalls(x));return u.updateResult(),v},[u,a]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),c.useEffect(()=>{u.setOptions(i,{listeners:!1})},[i,u]),hi(i,d))throw qs(i,u,o);if(di({result:d,errorResetBoundary:o,throwOnError:i.throwOnError,query:n.getQueryCache().get(i.queryHash)}))throw d.error;if((p=(m=n.getDefaultOptions().queries)==null?void 0:m._experimental_afterQuery)==null||p.call(m,i,d),i.experimental_prefetchInRender&&!Vt&&mi(d,a)){const x=l?qs(i,u,o):(b=n.getQueryCache().get(i.queryHash))==null?void 0:b.promise;x==null||x.catch(oa).finally(()=>{u.updateResult()})}return i.notifyOnChangeProps?d:u.trackResult(d)}function pi(t,s){return fi(t,ei)}function Hs(t,s){const r=ds(),[n]=c.useState(()=>new ri(r,t));c.useEffect(()=>{n.setOptions(t)},[n,t]);const a=c.useSyncExternalStore(c.useCallback(i=>n.subscribe(wt.batchCalls(i)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),o=c.useCallback((i,l)=>{n.mutate(i,l).catch(oa)},[n]);if(a.error&&na(n.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:o,mutateAsync:a.mutate}}const Ys=({tripId:t,currentPhoto:s,onPhotoUploaded:r,className:n=""})=>{const{user:a}=Ve(),[o,i]=c.useState(!1),[l,u]=c.useState(0),[d,f]=c.useState(!1),h=c.useCallback(async v=>{if(v.length===0)return;const y=v[0];i(!0),u(0);try{const S=URL.createObjectURL(y);if(setTimeout(()=>{r(S),f(!0),setTimeout(()=>f(!1),2e3),i(!1),u(0)},1500),a&&V)try{const g=new FormData;g.append("file",y),g.append("tripId",t),g.append("userId",a.id),g.append("caption",`Cover photo for trip ${t}`);const{data:w,error:C}=await V.functions.invoke("photo-upload",{body:g});if(C)throw C;w!=null&&w.success&&r(w.publicUrl)}catch(g){console.log("Supabase upload failed, using demo mode:",g)}}catch(S){console.error("Photo upload error:",S),i(!1),u(0)}},[a,t,r,V]),{getRootProps:m,getInputProps:p,isDragActive:b}=io({onDrop:h,accept:{"image/*":[".png",".jpg",".jpeg",".gif"]},maxSize:10*1024*1024,multiple:!1}),x=()=>{a||alert("Please sign in to upload photos. Demo mode: Photo will be shown temporarily.")};return s?e.jsxs("div",{className:`relative group ${n}`,children:[e.jsx("img",{src:s,alt:`Cover photo for trip ${t}`,className:"w-full h-64 object-cover rounded-2xl"}),e.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity rounded-2xl flex items-center justify-center",children:e.jsxs("div",{...m(),className:"cursor-pointer bg-white/20 backdrop-blur-sm border border-white/30 rounded-xl px-4 py-2 flex items-center gap-2 text-white hover:bg-white/30 transition-colors",onClick:x,children:[e.jsx("input",{...p()}),e.jsx(Ar,{size:16}),e.jsx("span",{className:"text-sm font-medium",children:"Change Photo"})]})}),o&&e.jsx("div",{className:"absolute inset-0 bg-black/60 rounded-2xl flex items-center justify-center",children:e.jsxs("div",{className:"text-white text-center",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-2"}),e.jsx("span",{className:"text-sm",children:"Uploading..."})]})}),d&&e.jsx("div",{className:"absolute inset-0 bg-green-500/60 rounded-2xl flex items-center justify-center",children:e.jsxs("div",{className:"text-white text-center",children:[e.jsx(gs,{size:32,className:"mx-auto mb-2"}),e.jsx("span",{className:"text-sm font-medium",children:"Photo Updated!"})]})})]}):e.jsxs("div",{...m(),className:`border-2 border-dashed border-white/30 rounded-2xl p-8 text-center cursor-pointer transition-all hover:border-white/50 hover:bg-white/5 ${b?"border-blue-400 bg-blue-400/10":""} ${n}`,onClick:x,children:[e.jsx("input",{...p()}),e.jsxs("div",{className:"text-white",children:[e.jsx(lo,{size:48,className:"mx-auto mb-4 text-white/70"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Upload Trip Cover Photo"}),e.jsx("p",{className:"text-gray-300 text-sm mb-4",children:b?"Drop your photo here...":"Drag & drop a photo here, or click to browse"}),e.jsx("p",{className:"text-gray-400 text-xs",children:"Supports PNG, JPG, GIF • Max 10MB"}),!a&&e.jsx("p",{className:"text-yellow-400 text-xs mt-2",children:"Demo mode: Photos will be shown temporarily. Sign in for full functionality."})]}),o&&e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-2"}),e.jsx("span",{className:"text-sm text-white",children:"Uploading..."})]})]})},gi=({tripId:t,description:s,onUpdate:r,className:n="text-gray-300 text-lg leading-relaxed"})=>{const[a,o]=c.useState(!1),[i,l]=c.useState(s),[u,d]=c.useState(!1),f=async()=>{if(i.trim()===s){o(!1);return}d(!0);try{await Er.updateTrip(t,{description:i.trim()})?(r(i.trim()),o(!1),Rt.success("Description updated successfully")):Rt.error("Failed to update description")}catch(p){console.error("Error updating description:",p),Rt.error("Failed to update description")}finally{d(!1)}},h=()=>{l(s),o(!1)},m=p=>{p.key==="Enter"&&(p.ctrlKey||p.metaKey)?f():p.key==="Escape"&&h()};return a?e.jsxs("div",{className:"space-y-3",children:[e.jsx("textarea",{value:i,onChange:p=>l(p.target.value),onKeyDown:m,className:"w-full p-3 bg-white/10 border border-white/20 rounded-xl text-gray-300 text-lg leading-relaxed resize-none min-h-[100px] focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Add a description for this trip...",autoFocus:!0,disabled:u}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:f,disabled:u,className:"flex items-center gap-1 px-3 py-1.5 bg-green-600 hover:bg-green-700 disabled:bg-green-600/50 text-white text-sm rounded-lg transition-colors",children:[e.jsx(gs,{size:14}),u?"Saving...":"Save"]}),e.jsxs("button",{onClick:h,disabled:u,className:"flex items-center gap-1 px-3 py-1.5 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-600/50 text-white text-sm rounded-lg transition-colors",children:[e.jsx(Pe,{size:14}),"Cancel"]}),e.jsx("span",{className:"text-xs text-gray-400",children:"Ctrl+Enter to save, Esc to cancel"})]})]}):e.jsxs("div",{className:"relative pb-12",children:[e.jsx("p",{className:n,children:s||"No description added yet. Click to add one."}),e.jsx("button",{onClick:()=>o(!0),className:"absolute bottom-2 left-0 p-2 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg transition-all duration-200 text-gray-400 hover:text-white",title:"Edit description",children:e.jsx(mo,{size:16})})]})},xi=t=>{const[s,r]=c.useState(t.coverPhoto);return{coverPhoto:s,updateCoverPhoto:o=>{r(o),console.log("Cover photo updated for trip:",t.id,o)},removeCoverPhoto:()=>{r(void 0),console.log("Cover photo removed for trip:",t.id)}}},ia={"Sports – Pro, Collegiate, Youth":{id:"Sports – Pro, Collegiate, Youth",name:"Sports – Pro, Collegiate, Youth",description:"Professional, collegiate, and youth sports teams, tournaments, and athletic events",roles:["Player","Coach","Crew","VIP","Security","Medical","Tech"],availableTabs:["chat","calendar","tasks","polls","places","team","finance","medical","compliance","ai-chat"],requiredTabs:["team","medical"],terminology:{teamLabel:"Team Roster",memberLabel:"Team Member",leaderLabel:"Team Captain"}},"Tour – Music, Comedy, etc.":{id:"Tour – Music, Comedy, etc.",name:"Tour – Music, Comedy, etc.",description:"Music tours, comedy shows, podcast tours, creator events, and entertainment productions",roles:["Artist Team","Tour Manager","Crew","VIP","Security"],availableTabs:["chat","calendar","tasks","polls","places","team","finance","sponsors","ai-chat"],requiredTabs:["team"],terminology:{teamLabel:"Tour Crew",memberLabel:"Crew Member",leaderLabel:"Tour Manager"}},"Business Travel":{id:"Business Travel",name:"Business Travel",description:"Corporate retreats, executive meetings, sales trips, recruiting events, and business travel",roles:[],availableTabs:["chat","calendar","tasks","polls","places","team","finance","compliance","ai-chat"],requiredTabs:["team"],terminology:{teamLabel:"Attendees",memberLabel:"Participant",leaderLabel:"Event Lead"}},"School Trip":{id:"School Trip",name:"School Trip",description:"Educational trips, academic competitions, and school-related events",roles:["Student","Chaperone","Teacher"],availableTabs:["chat","calendar","tasks","polls","places","team","compliance","medical","ai-chat"],requiredTabs:["team","compliance"],terminology:{teamLabel:"Group",memberLabel:"Participant",leaderLabel:"Lead Teacher"}},Content:{id:"Content",name:"Content",description:"Television shows, film productions, creator content, and media shoots",roles:["Talent","Crew","Security"],availableTabs:["chat","calendar","tasks","polls","places","team","sponsors","compliance","ai-chat"],requiredTabs:["team"],terminology:{teamLabel:"Cast & Crew",memberLabel:"Production Member",leaderLabel:"Producer"}},Other:{id:"Other",name:"Other",description:"All other types of professional trips and events not covered by the above categories",roles:[],availableTabs:["chat","calendar","tasks","polls","places","team","finance","ai-chat"],requiredTabs:["team"],terminology:{teamLabel:"Team",memberLabel:"Team Member",leaderLabel:"Team Lead"}}},la=t=>ia[t],vi=()=>Object.keys(ia),bi=({selectedCategory:t,onCategoryChange:s,className:r=""})=>{const[n,a]=Gt.useState(!1),o=vi();return e.jsxs("div",{className:`relative ${r}`,children:[e.jsxs("button",{onClick:()=>a(!n),className:"flex items-center gap-2 bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-xl transition-colors min-w-[200px] justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:t}),e.jsx(Or,{size:16,className:`transition-transform ${n?"rotate-180":""}`})]}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[59]",onClick:()=>a(!1)}),e.jsx("div",{className:"absolute top-full left-0 mt-2 w-full min-w-[280px] bg-gray-800 border border-gray-600 rounded-xl shadow-2xl z-[60] overflow-hidden max-h-72 overflow-y-auto mb-20 touch-pan-y",children:o.map(i=>{const l=la(i);return e.jsxs("button",{onClick:()=>{s(i),a(!1)},className:`w-full text-left px-4 py-3 text-sm transition-colors hover:bg-gray-700 border-b border-gray-700 last:border-b-0 ${t===i?"bg-gray-700 text-yellow-400":"text-gray-300"}`,children:[e.jsx("div",{className:"font-medium",children:l.name}),e.jsx("div",{className:"text-xs text-gray-400 mt-1 leading-relaxed",children:l.description})]},i)})})]})]})},yi=({category:t,tags:s,className:r=""})=>{const a=[la(t).name,...s];return e.jsx("div",{className:`flex flex-wrap gap-2 ${r}`,children:a.map((o,i)=>e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${i===0?"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30":"bg-gray-700/50 text-gray-300 border border-gray-600/30"}`,children:o},i))})},wi=({participants:t,countLabel:s,maxRows:r=2,minColWidth:n=220,onShowAll:a})=>{const o=Math.max(72,Math.min(240,r*84));return e.jsxs("section",{"aria-labelledby":"collab-title",className:"relative",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"grid gap-2",style:{gridTemplateColumns:`repeat(auto-fill, minmax(${n}px, 1fr))`,maxHeight:`${o}px`,overflow:"hidden"},role:"list","aria-label":"Collaborators",children:t.map(i=>e.jsxs("button",{className:"group flex items-center gap-3 rounded-lg border border-white/10 bg-white/5 px-3 py-2 hover:bg-white/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white/20 transition",role:"listitem",title:i.role?`${i.name} • ${i.role}`:i.name,children:[kr(i.avatar)?e.jsx("img",{src:i.avatar,alt:i.name,className:"h-8 w-8 rounded-full object-cover border border-white/20",loading:"lazy"}):e.jsx("div",{className:"h-8 w-8 rounded-full bg-white/10 text-white/80 grid place-items-center text-xs font-semibold border border-white/20",children:Pr(i.name)}),e.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[e.jsx("div",{className:"truncate text-sm font-medium text-white",children:i.name}),i.role&&e.jsx("div",{className:"truncate text-xs text-gray-400",children:i.role})]})]},i.id))}),e.jsx("div",{className:"pointer-events-none absolute inset-x-0 bottom-0 h-8 bg-gradient-to-t from-black/60 to-transparent rounded-b-lg"})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-gray-400",children:s}),e.jsx("button",{className:"text-xs font-medium underline text-gray-200 hover:text-white",onClick:a,"aria-label":"Show all collaborators",children:"Show all"})]})]})},ji=({open:t,onOpenChange:s,participants:r})=>e.jsx(Ur,{open:t,onOpenChange:s,children:e.jsxs(Br,{className:"max-w-2xl",children:[e.jsx(Vr,{children:e.jsxs(Gr,{children:["All Collaborators (",r.length,")"]})}),e.jsx("div",{role:"list","aria-label":"All collaborators",className:"mt-4 max-h-[70vh] overflow-auto pr-1",children:r.map(n=>e.jsxs("div",{role:"listitem",className:"flex items-center gap-3 rounded-lg border border-white/10 bg-white/5 px-3 py-2 mb-2",children:[kr(n.avatar)?e.jsx("img",{src:n.avatar,alt:n.name,className:"h-9 w-9 rounded-full object-cover border border-white/20",loading:"lazy"}):e.jsx("div",{className:"h-9 w-9 rounded-full bg-white/10 text-white/80 grid place-items-center text-xs font-semibold border border-white/20",children:Pr(n.name)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-medium text-white",children:n.name}),n.role&&e.jsx("div",{className:"truncate text-xs text-gray-400",children:n.role})]})]},n.id))})]})}),iu=({trip:t,onManageUsers:s,onDescriptionUpdate:r,category:n,tags:a=[],onCategoryChange:o})=>{const{user:i}=Ve(),[l,u]=c.useState(!1),[d,f]=c.useState(!1),{variant:h,accentColors:m}=us(),{coverPhoto:p,updateCoverPhoto:b}=xi(t),x=h==="pro";return e.jsxs(e.Fragment,{children:[p?e.jsx("div",{className:"relative mb-8 rounded-3xl overflow-hidden",children:e.jsxs("div",{className:"h-64 bg-cover bg-center",style:{backgroundImage:`url(${p})`},children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"}),e.jsxs("div",{className:"absolute bottom-6 left-8 right-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:t.title}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-white/90",children:[e.jsx(mt,{size:18}),e.jsx("span",{children:t.location})]}),e.jsxs("div",{className:"flex items-center gap-2 text-white/90",children:[e.jsx(Ue,{size:18}),e.jsx("span",{children:t.dateRange})]})]})]}),i&&e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx(Ys,{tripId:t.id.toString(),currentPhoto:p,onPhotoUploaded:b,className:"w-auto"})})]})}):e.jsx("div",{className:"mb-8",children:e.jsx(Ys,{tripId:t.id.toString(),currentPhoto:p,onPhotoUploaded:b,className:"h-32 mb-6"})}),e.jsx("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-8 mb-8",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-6",children:[e.jsxs("div",{className:"flex-1",children:[!p&&e.jsx("h1",{className:"text-4xl font-bold text-white mb-4",children:t.title}),x&&n&&e.jsx("div",{className:"mb-4",children:e.jsx(yi,{category:n,tags:a})}),!p&&e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[e.jsx(mt,{size:18,className:`text-${m.primary}`}),e.jsx("span",{children:t.location})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[e.jsx(Ue,{size:18,className:`text-${m.primary}`}),e.jsx("span",{children:t.dateRange})]})]}),e.jsx(gi,{tripId:t.id.toString(),description:t.description,onUpdate:r||(()=>{}),className:"text-gray-300 text-lg leading-relaxed"})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-6 min-w-[280px] lg:flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{size:20,className:`text-${m.primary}`}),e.jsx("h3",{className:"text-white font-semibold",children:"Trip Collaborators"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:t.participants.length}),s&&e.jsx("button",{onClick:s,className:`text-gray-400 hover:text-${m.primary} transition-colors p-1 rounded-lg hover:bg-white/10`,title:"Manage users",children:e.jsx(ms,{size:16})})]})]}),x&&n&&o&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-2",children:"Trip Category"}),e.jsx(bi,{selectedCategory:n,onCategoryChange:o})]}),e.jsx(wi,{participants:t.participants,countLabel:`${t.participants.length} collaborators`,onShowAll:()=>f(!0)}),e.jsxs("button",{onClick:()=>u(!0),className:`mt-4 w-full flex items-center justify-center gap-2 bg-gradient-to-r ${m.gradient} hover:from-${m.primary}/80 hover:to-${m.secondary}/80 text-white font-medium py-3 rounded-xl transition-all duration-200 hover:scale-105`,title:"Invite people to this trip",children:[e.jsx(xs,{size:16}),"Invite to Trip"]})]})]})}),e.jsx(_r,{isOpen:l,onClose:()=>u(!1),tripName:t.title,tripId:t.id.toString()}),e.jsx(ji,{open:d,onOpenChange:f,participants:t.participants})]})},lu=()=>{const t=Fn(),[s,r]=c.useState("all"),[n,a]=c.useState(""),o=[],i=()=>0,l=o.filter(m=>s==="unread"?!m.isRead:s==="mentions"?m.mentions&&m.mentions.length>0:!0),u=m=>{m.tripId?t(`/trip/${m.tripId}`):m.tourId&&t(`/tour/pro-${m.tourId}`)},d=m=>{const p=new Date(m),x=Math.floor((new Date().getTime()-p.getTime())/(1e3*60));return x<60?`${x}m ago`:x<1440?`${Math.floor(x/60)}h ago`:p.toLocaleDateString()},f=m=>m.tripName?m.tripName:m.tourName?m.tourName:m.tripId?"Trip":m.tourId?"Tour":null,h=m=>m.tripId&&m.tourId?"bg-purple-500/20 text-purple-400 border-purple-500/30":m.tripId?"bg-blue-500/20 text-blue-400 border-blue-500/30":m.tourId?"bg-glass-orange/20 text-glass-orange border-glass-orange/30":"bg-gray-500/20 text-gray-400 border-gray-500/30";return e.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ce,{size:24,className:"text-glass-orange"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Message Inbox"}),e.jsxs("p",{className:"text-slate-400 text-sm",children:[i()," unread messages"]})]})]})}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx(hs,{size:20,className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search messages, people, or trips...",value:n,onChange:m=>a(m.target.value),className:"w-full bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl pl-12 pr-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-glass-orange"})]}),e.jsx("div",{className:"flex gap-2 mb-6",children:["all","unread","mentions"].map(m=>e.jsx("button",{onClick:()=>r(m),className:`px-4 py-2 rounded-xl text-sm font-medium transition-colors ${s===m?"bg-glass-orange text-white":"bg-white/10 text-gray-300 hover:bg-white/20"}`,children:m.charAt(0).toUpperCase()+m.slice(1)},m))}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:l.map(m=>{const p=f(m),b=h(m);return e.jsx("div",{onClick:()=>u(m),className:`p-4 rounded-xl cursor-pointer transition-all hover:bg-white/10 ${m.isRead?"bg-white/2":"bg-white/5 border-l-4 border-glass-orange"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("img",{src:m.senderAvatar||"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face",alt:m.senderName,className:"w-10 h-10 rounded-full"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-medium",children:m.senderName}),p&&e.jsx("span",{className:`text-xs px-2 py-1 rounded-full border backdrop-blur-sm truncate max-w-32 ${b}`,children:p})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-xs",children:[e.jsx(Ct,{size:12}),d(m.timestamp)]})]}),e.jsx("p",{className:"text-gray-300 text-sm truncate",children:m.content}),m.mentions&&m.mentions.includes("everyone")&&e.jsx("div",{className:"mt-2",children:e.jsxs("span",{className:"text-xs bg-red-500/20 text-red-400 px-2 py-1 rounded flex items-center gap-1 w-fit",children:[e.jsx(Nt,{size:10}),"@everyone"]})})]}),!m.isRead&&e.jsx("div",{className:"w-2 h-2 bg-glass-orange rounded-full"})]})},m.id)})}),l.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ce,{size:48,className:"text-slate-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-400 mb-2",children:"No messages found"}),e.jsx("p",{className:"text-slate-500 text-sm",children:n?"Try a different search term":"Your messages will appear here"})]})]})},Ni=()=>({parseMessage:c.useCallback(async(s,r,n)=>{try{const{data:a,error:o}=await V.functions.invoke("message-parser",{body:{messageId:s,content:r,tripId:n}});return o?(console.error("Error parsing message:",o),!1):(a==null?void 0:a.success)||!1}catch(a){return console.error("Error invoking message parser:",a),!1}},[])}),Qs={Ray:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=40&h=40&fit=crop&crop=face",Maya:"https://images.unsplash.com/photo-1494790108755-2616b612b47c?w=40&h=40&fit=crop&crop=face",Sam:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face",Emma:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=40&h=40&fit=crop&crop=face",Jake:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=40&h=40&fit=crop&crop=face",Sarah:"https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=40&h=40&fit=crop&crop=face",Alex:"https://images.unsplash.com/photo-1507591064344-4c6ce005b128?w=40&h=40&fit=crop&crop=face",Lisa:"https://images.unsplash.com/photo-1489424731084-a5d8b219a5bb?w=40&h=40&fit=crop&crop=face",Mike:"https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?w=40&h=40&fit=crop&crop=face",Anna:"https://images.unsplash.com/photo-1491349174775-aaafddd81942?w=40&h=40&fit=crop&crop=face",David:"https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=40&h=40&fit=crop&crop=face",Sophie:"https://images.unsplash.com/photo-1517841905240-472988babdf9?w=40&h=40&fit=crop&crop=face",Chris:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=40&h=40&fit=crop&crop=face",Taylor:"https://images.unsplash.com/photo-1498551172505-8ee7ad69f235?w=40&h=40&fit=crop&crop=face",Jordan:"https://images.unsplash.com/photo-1507591064344-4c6ce005b128?w=40&h=40&fit=crop&crop=face",Casey:"https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=40&h=40&fit=crop&crop=face"},Xs=["https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face","https://images.unsplash.com/photo-1494790108755-2616b612b47c?w=40&h=40&fit=crop&crop=face","https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=40&h=40&fit=crop&crop=face","https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=40&h=40&fit=crop&crop=face","https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=40&h=40&fit=crop&crop=face","https://images.unsplash.com/photo-1507591064344-4c6ce005b128?w=40&h=40&fit=crop&crop=face"],xt=t=>{const s=t.trim();if(Qs[s])return Qs[s];const r=s.split("").reduce((n,a)=>(n=(n<<5)-n+a.charCodeAt(0),n&n),0);return Xs[Math.abs(r)%Xs.length]},Ci=({tripId:t,demoMode:s=!1,isEvent:r=!1}={})=>{const[n,a]=c.useState(""),[o,i]=c.useState(null),[l,u]=c.useState("all"),{parseMessage:d}=Ni(),f=c.useCallback((x,v={})=>{const y=`msg_${Date.now()}`,{isBroadcast:S=!1,isPayment:g=!1,paymentData:w}=v;if(g&&w){const C=(w.amount/w.splitCount).toFixed(2);return{id:y,text:`${w.description} - ${w.currency} ${w.amount.toFixed(2)} (split ${w.splitCount} ways) • Pay me $${C} via Venmo: @yourvenmo`,sender:{id:"user1",name:"You",avatar:xt("You")},createdAt:new Date().toISOString(),isBroadcast:!1,isPayment:!0,reactions:{},tags:["payment"],replyTo:o?{id:o.id,text:o.text,sender:o.senderName}:void 0}}return{id:y,text:x,sender:{id:"user1",name:"You",avatar:xt("You")},createdAt:new Date().toISOString(),isBroadcast:S,reactions:{},replyTo:o?{id:o.id,text:o.text,sender:o.senderName}:void 0}},[o]),h=c.useCallback(async(x={})=>{const{isPayment:v=!1,paymentData:y}=x;if(r&&v)return console.warn("Payment messages are not allowed for events"),null;if(!v&&n.trim()==="")return null;const S=f(n,x);return!s&&t&&!v&&await d(S.id,n,t),a(""),i(null),S},[n,f,s,t,d]),m=c.useCallback((x,v,y)=>{i({id:x,text:v,senderName:y})},[]),p=c.useCallback(()=>{i(null)},[]),b=c.useCallback(x=>l==="all"?x:l==="broadcast"?x.filter(v=>v.isBroadcast):l==="payments"?x.filter(v=>{var y;return v.text.includes("💳 Payment")||((y=v.tags)==null?void 0:y.includes("payment"))}):x,[l]);return{inputMessage:n,replyingTo:o,messageFilter:l,setInputMessage:a,setMessageFilter:u,sendMessage:h,setReply:m,clearReply:p,filterMessages:b}},At=["venmo","splitwise","cashapp","zelle"],Si=(t=[])=>{const[s,r]=c.useState(0),[n,a]=c.useState("USD"),[o,i]=c.useState(""),[l,u]=c.useState([]),[d,f]=c.useState([]),[h,m]=c.useState(0);c.useEffect(()=>{m(l.length)},[l]);const p=c.useCallback(C=>{u(E=>E.includes(C)?E.filter(k=>k!==C):[...E,C])},[]),b=c.useCallback(C=>{f(E=>E.includes(C)?E.filter(k=>k!==C):[...E,C])},[]),x=c.useCallback(()=>{const C=l.length===t.length;u(C?[]:t.map(E=>E.id))},[l.length,t]),v=c.useCallback(()=>{const C=d.length===At.length;f(C?[]:[...At])},[d.length]),y=c.useCallback(()=>h===0?0:s/h,[s,h]),S=c.useCallback(()=>s<=0?{isValid:!1,error:"Amount must be greater than 0"}:o.trim()?l.length===0?{isValid:!1,error:"At least one participant must be selected"}:d.length===0?{isValid:!1,error:"At least one payment method must be selected"}:{isValid:!0}:{isValid:!1,error:"Description is required"},[s,o,l,d]),g=c.useCallback(()=>S().isValid?{amount:s,currency:n,description:o.trim(),splitCount:h,splitParticipants:l,paymentMethods:d}:null,[s,n,o,h,l,d,S]),w=c.useCallback(()=>{r(0),a("USD"),i(""),u([]),f([]),m(0)},[]);return{amount:s,currency:n,description:o,selectedParticipants:l,selectedPaymentMethods:d,splitCount:h,perPersonAmount:y(),isValid:S().isValid,validationError:S().error,allParticipantsSelected:l.length===t.length,allPaymentMethodsSelected:d.length===At.length,setAmount:r,setCurrency:a,setDescription:i,toggleParticipant:p,togglePaymentMethod:b,selectAllParticipants:x,selectAllPaymentMethods:v,getPaymentData:g,validatePayment:S,resetForm:w}},Ei=({onSubmit:t,tripMembers:s,isVisible:r})=>{const{amount:n,currency:a,description:o,selectedParticipants:i,selectedPaymentMethods:l,perPersonAmount:u,allParticipantsSelected:d,allPaymentMethodsSelected:f,setAmount:h,setCurrency:m,setDescription:p,toggleParticipant:b,togglePaymentMethod:x,selectAllParticipants:v,selectAllPaymentMethods:y,getPaymentData:S,resetForm:g}=Si(s),w=[{id:"venmo",label:"Venmo"},{id:"splitwise",label:"Splitwise"},{id:"cashapp",label:"Cash App"},{id:"zelle",label:"Zelle"}],C=P=>{P.preventDefault();const T=S();T&&(t(T),g())},E=u,{isDemoMode:k}=Ge();return r?!k&&s.length===0?e.jsx(qt,{className:"bg-payment-background-light border-payment-border dark:bg-payment-background dark:border-payment-border",children:e.jsx(Ht,{className:"p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ve,{className:"w-12 h-12 text-gray-500 mx-auto mb-3"}),e.jsx("h4",{className:"text-lg font-medium text-gray-400 mb-2",children:"No trip collaborators yet"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Add collaborators to this trip before creating payment splits"})]})})}):e.jsx(qt,{className:"bg-payment-background-light border-payment-border dark:bg-payment-background dark:border-payment-border",children:e.jsxs(Ht,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ho,{size:18,className:"text-payment-primary"}),e.jsx("span",{className:"font-medium text-payment-primary-foreground dark:text-payment-primary-foreground",children:"Payment Details"})]}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(H,{htmlFor:"amount",children:"Amount"}),e.jsx(Oe,{id:"amount",type:"number",step:"0.01",value:n||"",onChange:P=>h(Number(P.target.value)),placeholder:"0.00",className:"bg-white dark:bg-white !text-black placeholder:!text-gray-500",required:!0})]}),e.jsxs("div",{children:[e.jsx(H,{htmlFor:"currency",children:"Currency"}),e.jsxs($r,{value:a,onValueChange:m,children:[e.jsx(Fr,{className:"bg-white dark:bg-white !text-black",children:e.jsx(Lr,{})}),e.jsxs(zr,{children:[e.jsx(ne,{value:"USD",children:"USD ($)"}),e.jsx(ne,{value:"EUR",children:"EUR (€)"}),e.jsx(ne,{value:"GBP",children:"GBP (£)"}),e.jsx(ne,{value:"CAD",children:"CAD ($)"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(H,{htmlFor:"description",children:"What's this for?"}),e.jsx(Oe,{id:"description",value:o,onChange:P=>p(P.target.value),placeholder:"Dinner, taxi, tickets, etc.",className:"bg-white dark:bg-white !text-black placeholder:!text-gray-500",required:!0})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs(H,{className:"flex items-center gap-2",children:[e.jsx(ve,{size:16}),"Split between ",i.length," people",E>0&&e.jsxs("span",{className:"text-payment-primary font-medium",children:["($",E.toFixed(2)," each)"]})]}),e.jsx(G,{type:"button",variant:"outline",size:"sm",onClick:v,className:"text-xs h-7",children:d?"Deselect All":"Select All"})]}),e.jsx("div",{className:"mt-2 max-h-32 overflow-y-auto space-y-2 p-2 bg-white dark:bg-white rounded border",children:s.map(P=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Wt,{id:`participant-${P.id}`,checked:i.includes(P.id),onCheckedChange:()=>b(P.id)}),e.jsxs("label",{htmlFor:`participant-${P.id}`,className:"text-sm flex items-center gap-2 cursor-pointer !text-black",children:[P.avatar&&e.jsx("img",{src:P.avatar,alt:P.name,className:"w-6 h-6 rounded-full"}),P.name]})]},P.id))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs(H,{className:"flex items-center gap-2",children:[e.jsx(ao,{size:16}),"Preferred payment methods"]}),e.jsx(G,{type:"button",variant:"outline",size:"sm",onClick:y,className:"text-xs h-7",children:f?"Deselect All":"Select All"})]}),e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2",children:w.map(P=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Wt,{id:`payment-${P.id}`,checked:l.includes(P.id),onCheckedChange:()=>x(P.id)}),e.jsx("label",{htmlFor:`payment-${P.id}`,className:"text-sm cursor-pointer flex items-center gap-1 !text-white",children:P.label})]},P.id))})]}),e.jsx(G,{type:"submit",className:"w-full bg-payment-primary hover:bg-payment-primary/90 text-payment-primary-foreground",disabled:!n||!o||i.length===0,children:"Add Payment Request"})]})]})}):null},ki=({inputMessage:t,onInputChange:s,onSendMessage:r,onKeyPress:n,onFileUpload:a,isTyping:o,tripMembers:i=[],hidePayments:l=!1})=>{const[u,d]=c.useState(!1),[f,h]=c.useState(!1),m=c.useRef(null),p=()=>{f||r(u,!1)},b=g=>{r(!1,!0,g),h(!1)},x=g=>{g.key==="Enter"&&!g.shiftKey?(g.preventDefault(),p()):n(g)},v=g=>{if(!a||!m.current)return;const w={image:"image/*",video:"video/*",document:".pdf,.doc,.docx,.txt,.xlsx,.pptx",audio:"audio/*"};m.current.accept=w[g],m.current.onchange=C=>{const E=C.target.files;E&&E.length>0&&a(E,g)},m.current.click()},y=g=>{g.preventDefault();const w=g.dataTransfer.files;if(w&&w.length>0&&a){const C=w[0],E=C.type.startsWith("image/"),k=C.type.startsWith("video/"),P=C.type.startsWith("audio/");a(w,E?"image":k?"video":P?"audio":"document")}},S=g=>{g.preventDefault()};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsxs("button",{onClick:()=>{d(!1),h(!1)},className:`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all ${!u&&!f?"bg-blue-600 text-white":"border border-gray-600 text-gray-400 hover:text-white hover:border-gray-500"}`,children:[e.jsx(Ce,{size:16}),"Group Chat"]}),e.jsxs("button",{onClick:()=>{d(!0),h(!1)},className:`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all ${u?"bg-gradient-to-r from-orange-600 to-red-600 text-white":"border border-orange-600 text-orange-400 hover:text-white hover:bg-orange-600/10"}`,children:[e.jsx(Tr,{size:16}),"Broadcast"]}),!l&&e.jsxs("button",{onClick:()=>{h(!0),d(!1)},className:`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all ${f?"bg-gradient-to-r from-green-600 to-emerald-600 text-white":"border border-green-600 text-green-400 hover:text-white hover:bg-green-600/10"}`,children:[e.jsx(Ir,{size:16}),"Payments"]}),e.jsxs(Io,{children:[e.jsx(Oo,{asChild:!0,children:e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium border border-gray-600 text-gray-400 hover:text-white hover:border-gray-500 transition-all","aria-label":"Share media, files, or links",children:[e.jsx(Zr,{size:16}),"Share"]})}),e.jsxs($o,{align:"end",className:"w-48 z-50 bg-gray-800 border-gray-700",children:[e.jsxs(rt,{onClick:()=>v("image"),children:[e.jsx(no,{className:"w-4 h-4 mr-2"}),"Photo/Image"]}),e.jsxs(rt,{onClick:()=>v("video"),children:[e.jsx(Jo,{className:"w-4 h-4 mr-2"}),"Video"]}),e.jsxs(rt,{onClick:()=>v("document"),children:[e.jsx(co,{className:"w-4 h-4 mr-2"}),"Document"]}),e.jsxs(rt,{onClick:()=>v("audio"),children:[e.jsx(fo,{className:"w-4 h-4 mr-2"}),"Audio/Voice"]})]})]})]}),f&&e.jsx(Ei,{onSubmit:b,tripMembers:i,isVisible:f}),!f&&e.jsxs("div",{className:"flex gap-3 items-end",onDrop:y,onDragOver:S,children:[e.jsx("textarea",{value:t,onChange:g=>s(g.target.value),onKeyPress:x,placeholder:u?"Send an announcement to all trip members...":f?"Payment mode active - use the form above to create a payment...":"Type a message or drag & drop files...",rows:2,className:`flex-1 border rounded-xl px-4 py-3 focus:outline-none resize-none transition-all ${u?"bg-gradient-to-r from-orange-900/20 to-red-900/20 border-orange-500/50 focus:border-orange-400 text-black placeholder-black":f?"bg-gradient-to-r from-green-900/20 to-emerald-900/20 border-green-500/50 focus:border-green-400 text-white placeholder-gray-500":"bg-gray-800 border-gray-700 focus:border-blue-500 text-white placeholder-gray-500"}`}),e.jsx("button",{onClick:p,disabled:!t.trim()||o,className:`text-white p-3 rounded-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed ${u?"bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700":f?"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700":"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700"}`,children:e.jsx(Dr,{size:16})}),e.jsx("input",{ref:m,type:"file",className:"hidden",multiple:!0})]})]})},Pi=[{id:"like",emoji:"👍",label:"Like"},{id:"love",emoji:"❤️",label:"Love"},{id:"dislike",emoji:"👎",label:"Dislike"},{id:"question",emoji:"❓",label:"Question"}],_i=({messageId:t,reactions:s={},onReaction:r,onReactMessage:n,className:a=""})=>e.jsx("div",{className:`flex items-center gap-1 mt-1 ${a}`,children:Pi.map(o=>{const i=s[o.id],l=(i==null?void 0:i.count)||0,u=(i==null?void 0:i.userReacted)||!1;return e.jsxs(G,{variant:"ghost",size:"sm",onClick:()=>{r&&t?r(t,o.id):n&&n(o.id)},className:`h-6 px-2 py-1 text-xs rounded-full bg-background/20 backdrop-blur-sm border border-border/30 hover:bg-background/40 transition-all duration-200 ${u?"bg-primary/20 border-primary/50 text-primary":"text-muted-foreground hover:text-foreground"}`,title:o.label,children:[e.jsx("span",{className:"text-sm mr-1",children:o.emoji}),l>0&&e.jsx("span",{className:"text-xs font-medium",children:l})]},o.id)})}),Ti=({id:t,text:s,senderName:r,senderAvatar:n,timestamp:a,isBroadcast:o,isPayment:i,reactions:l,onReaction:u})=>{const[d,f]=c.useState(!1),h=b=>new Date(b).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),m=()=>o?"text-orange-400":i?"text-green-400":"text-foreground",p=()=>o?"bg-orange-600/10 border-orange-500/30 shadow-[0_2px_12px_rgba(251,146,60,0.15)]":i?"bg-green-600/10 border-green-500/30 shadow-[0_2px_12px_rgba(34,197,94,0.15)]":"bg-card/50 border-border shadow-sm";return e.jsxs("div",{className:"group flex items-start gap-3",onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),children:[e.jsx("img",{src:n||xt(r),alt:r,className:"w-10 h-10 rounded-full object-cover border-2 border-border/50"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:W("rounded-xl px-4 py-3 backdrop-blur-sm border transition-all",p()),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-semibold text-sm text-foreground",children:r}),e.jsx("span",{className:"text-xs text-muted-foreground",children:h(a)}),o&&e.jsx("span",{className:"text-xs bg-orange-600/20 text-orange-400 px-2 py-0.5 rounded-full",children:"📢 Broadcast"}),i&&e.jsx("span",{className:"text-xs bg-green-600/20 text-green-400 px-2 py-0.5 rounded-full",children:"💳 Payment"})]}),e.jsx("p",{className:W("text-sm leading-relaxed",m()),children:s})]}),e.jsx("div",{className:W("mt-2 transition-opacity",d?"opacity-100":"opacity-0"),children:e.jsx(_i,{messageId:t,reactions:l,onReaction:u})})]})]})},Di=({message:t,reactions:s,onReaction:r})=>{var n;return e.jsx(Ti,{id:t.id,text:t.text,senderName:t.sender.name,senderAvatar:t.sender.avatar,timestamp:t.createdAt,isBroadcast:t.isBroadcast,isPayment:t.isPayment||((n=t.tags)==null?void 0:n.includes("payment")),reactions:s,onReaction:r})},Ri=({messages:t,reactions:s,onReaction:r,emptyStateTitle:n="Start the conversation",emptyStateDescription:a="Messages here are visible to everyone in the trip"})=>t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ce,{size:48,className:"text-slate-600 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-slate-400 mb-2",children:n}),e.jsx("p",{className:"text-slate-500 text-sm",children:a})]}):e.jsx("div",{className:"space-y-4",children:t.map(o=>e.jsx(Di,{message:o,reactions:s[o.id],onReaction:r},o.id))}),Mi=({activeFilter:t,onFilterChange:s,hidePayments:r=!1})=>e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsxs("button",{onClick:()=>s("all"),className:`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all ${t==="all"?"bg-blue-600 text-white":"border border-gray-600 text-gray-400 hover:text-white hover:border-gray-500"}`,children:[e.jsx(Ce,{size:16}),"All Messages"]}),e.jsxs("button",{onClick:()=>s("broadcast"),className:`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all ${t==="broadcast"?"bg-gradient-to-r from-orange-600 to-red-600 text-white":"border border-orange-600 text-orange-400 hover:text-white hover:bg-orange-600/10"}`,children:[e.jsx(Tr,{size:16}),"Broadcasts"]}),!r&&e.jsxs("button",{onClick:()=>s("payments"),className:`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all ${t==="payments"?"bg-gradient-to-r from-green-600 to-emerald-600 text-white":"border border-green-600 text-green-400 hover:text-white hover:bg-green-600/10"}`,children:[e.jsx(Ir,{size:16}),"Payments"]})]}),Ai=({replyTo:t,onRemoveReply:s,onCancel:r})=>t?e.jsx("div",{className:"bg-background/50 border-l-2 border-primary p-2 mb-2 rounded-r-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-xs text-muted-foreground mb-1",children:["Replying to ",t.senderName]}),e.jsx("p",{className:"text-sm text-foreground/80 truncate",children:t.text})]}),(s||r)&&e.jsx("button",{onClick:s||r,className:"text-muted-foreground hover:text-foreground ml-2 transition-colors",children:"×"})]})}):null,ca=t=>{const[s,r]=c.useState([]),[n,a]=c.useState(!1),{isDemoMode:o}=Ge(),i=d=>d.map(f=>{var h,m,p;return{id:f.user_id,name:((h=f.profiles)==null?void 0:h.display_name)||((m=f.profiles)==null?void 0:m.first_name)||"Unknown User",avatar:(p=f.profiles)==null?void 0:p.avatar_url}}),l=d=>{const f=parseInt(d),h=vs(f);return h&&h.participants?h.participants.map(m=>({id:m.id.toString(),name:m.name,avatar:m.avatar})):[{id:"user1",name:"You"},{id:"user2",name:"Trip Organizer"}]},u=async d=>{a(!0);try{const f=await Er.getTripMembers(d);if(f&&f.length>0){const h=i(f);r(h)}else if(o){const h=l(d);r(h)}else r([])}catch(f){if(console.error("Error fetching trip members:",f),o){const h=l(d);r(h)}else r([])}finally{a(!1)}};return c.useEffect(()=>{t&&u(t)},[t,o]),c.useEffect(()=>{if(!t)return;let d;return(async()=>{try{const{data:h}=await V.from("trip_members").select("id").limit(1);h!==null&&(d=V.channel(`trip-members-${t}`).on("postgres_changes",{event:"*",schema:"public",table:"trip_members",filter:`trip_id=eq.${t}`},()=>{u(t)}).subscribe())}catch{console.log("Database subscription not available, using local data only")}})(),()=>{d&&V.removeChannel(d)}},[t]),{tripMembers:s,loading:n,refreshMembers:()=>t&&u(t)}},cu=({enableGroupChat:t=!0,showBroadcasts:s=!0,isEvent:r=!1})=>{const[n,a]=c.useState([]),[o,i]=c.useState(!0),[l,u]=c.useState({}),{tripId:d}=Ln(),f=Ge(),{tripMembers:h}=ca(d),{inputMessage:m,setInputMessage:p,messageFilter:b,setMessageFilter:x,replyingTo:v,setReply:y,clearReply:S,sendMessage:g,filterMessages:w}=Ci({tripId:d,demoMode:f.isDemoMode,isEvent:r}),C=async(T=!1,$=!1,F)=>{const R=await g({isBroadcast:T,isPayment:$,paymentData:F});R&&a(q=>[...q,R])},E=T=>{T.key==="Enter"&&!T.shiftKey&&(T.preventDefault(),C())},k=(T,$)=>{const F={...l};F[T]||(F[T]={});const R=F[T][$]||{count:0,userReacted:!1};R.userReacted=!R.userReacted,R.count+=R.userReacted?1:-1,F[T][$]=R,u(F)};c.useEffect(()=>{(async()=>{const F=(await Ao.getMockMessages("friends-trip",r)).map(R=>{var q,oe,de;return{id:R.id,text:R.message_content||"",sender:{id:R.id,name:R.sender_name||"Unknown",avatar:xt(R.sender_name||"Unknown")},createdAt:new Date(Date.now()-(R.timestamp_offset_days||0)*864e5).toISOString(),isBroadcast:((q=R.tags)==null?void 0:q.includes("broadcast"))||((oe=R.tags)==null?void 0:oe.includes("logistics"))||((de=R.tags)==null?void 0:de.includes("urgent"))||!1,trip_type:R.trip_type,sender_name:R.sender_name,message_content:R.message_content,delay_seconds:R.delay_seconds,timestamp_offset_days:R.timestamp_offset_days,tags:R.tags}});a(F),i(!1)})()},[f.isDemoMode,r]);const P=w(n);return o?e.jsx("div",{children:"Loading messages..."}):e.jsxs("div",{className:"flex flex-col h-full",children:[n.length>0&&e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsx(Mi,{activeFilter:b,onFilterChange:x,hidePayments:r})}),e.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-800/30 rounded-lg mx-4 mb-4",children:e.jsx("div",{className:"p-4",children:e.jsx(Ri,{messages:P,reactions:l,onReaction:k})})}),v&&e.jsx(Ai,{replyTo:{id:v.id,text:v.text,senderName:v.senderName},onCancel:S}),e.jsx("div",{className:"p-4",children:e.jsx(ki,{inputMessage:m,onInputChange:p,onSendMessage:C,onKeyPress:E,apiKey:"",isTyping:!1,tripMembers:h,hidePayments:r})})]})};function dt(t,s){const r=te(t),n=te(s),a=r.getTime()-n.getTime();return a<0?-1:a>0?1:a}function Ii(t){return Bo(t,Date.now())}function Oi(t){return s=>{const n=(t?Math[t]:Math.trunc)(s);return n===0?0:n}}function $i(t,s){return+te(t)-+te(s)}function Fi(t){const s=te(t);return s.setHours(23,59,59,999),s}function Li(t){const s=te(t);return+Fi(s)==+Vo(s)}function zi(t,s){const r=te(t),n=te(s),a=dt(r,n),o=Math.abs(Go(r,n));let i;if(o<1)i=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-a*o);let l=dt(r,n)===-a;Li(te(t))&&o===1&&dt(t,n)===1&&(l=!1),i=a*(o-Number(l))}return i===0?0:i}function Ui(t,s,r){const n=$i(t,s)/1e3;return Oi(r==null?void 0:r.roundingMethod)(n)}function Bi(t,s,r){const n=Ko(),a=(r==null?void 0:r.locale)??n.locale??Wo,o=2520,i=dt(t,s);if(isNaN(i))throw new RangeError("Invalid time value");const l=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:i});let u,d;i>0?(u=te(s),d=te(t)):(u=te(t),d=te(s));const f=Ui(d,u),h=(Bs(d)-Bs(u))/1e3,m=Math.round((f-h)/60);let p;if(m<2)return r!=null&&r.includeSeconds?f<5?a.formatDistance("lessThanXSeconds",5,l):f<10?a.formatDistance("lessThanXSeconds",10,l):f<20?a.formatDistance("lessThanXSeconds",20,l):f<40?a.formatDistance("halfAMinute",0,l):f<60?a.formatDistance("lessThanXMinutes",1,l):a.formatDistance("xMinutes",1,l):m===0?a.formatDistance("lessThanXMinutes",1,l):a.formatDistance("xMinutes",m,l);if(m<45)return a.formatDistance("xMinutes",m,l);if(m<90)return a.formatDistance("aboutXHours",1,l);if(m<Vs){const b=Math.round(m/60);return a.formatDistance("aboutXHours",b,l)}else{if(m<o)return a.formatDistance("xDays",1,l);if(m<at){const b=Math.round(m/Vs);return a.formatDistance("xDays",b,l)}else if(m<at*2)return p=Math.round(m/at),a.formatDistance("aboutXMonths",p,l)}if(p=zi(d,u),p<12){const b=Math.round(m/at);return a.formatDistance("xMonths",b,l)}else{const b=p%12,x=Math.trunc(p/12);return b<3?a.formatDistance("aboutXYears",x,l):b<9?a.formatDistance("overXYears",x,l):a.formatDistance("almostXYears",x+1,l)}}function as(t,s){return Bi(t,Ii(t),s)}const Vi=({events:t,tripName:s="Trip Itinerary"})=>{const[r,n]=c.useState(!1),a=c.useMemo(()=>{const f=(r?t:t.filter(h=>h.include_in_itinerary)).reduce((h,m)=>{const p=qe(m.date,"yyyy-MM-dd");return h[p]||(h[p]=[]),h[p].push(m),h},{});return Object.entries(f).map(([h,m])=>({date:new Date(h),events:m.sort((p,b)=>p.time.localeCompare(b.time))})).sort((h,m)=>h.date.getTime()-m.date.getTime())},[t,r]),o=d=>({dining:"🍽️",lodging:"🏨",activity:"🎯",transportation:"🚗",entertainment:"🎭",other:"📅"})[d]||"📅",i=d=>({dining:"bg-red-500/20 text-red-300",lodging:"bg-blue-500/20 text-blue-300",activity:"bg-green-500/20 text-green-300",transportation:"bg-yellow-500/20 text-yellow-300",entertainment:"bg-purple-500/20 text-purple-300",other:"bg-slate-500/20 text-slate-300"})[d]||"bg-slate-500/20 text-slate-300",l=()=>{console.log("Exporting itinerary to PDF...")},u=()=>{navigator.share&&navigator.share({title:s,text:"Check out our trip itinerary!",url:window.location.href})};return a.length===0?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ue,{size:48,className:"mx-auto text-slate-400 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"No Itinerary Events"}),e.jsx("p",{className:"text-slate-400 mb-4",children:r?"No events have been added to the calendar yet.":"No events are marked for inclusion in the itinerary."}),e.jsx(G,{variant:"outline",onClick:()=>n(!r),children:r?"Show Only Itinerary Events":"Show All Events"})]})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:s}),e.jsxs("p",{className:"text-slate-400 text-sm",children:[a.length," ",a.length===1?"day":"days"," • "," ",a.reduce((d,f)=>d+f.events.length,0)," events"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(G,{variant:"outline",size:"sm",onClick:()=>n(!r),children:r?"Itinerary Only":"All Events"}),e.jsxs(G,{variant:"outline",size:"sm",onClick:u,children:[e.jsx(Zr,{size:16,className:"mr-1"}),"Share"]}),e.jsxs(G,{variant:"outline",size:"sm",onClick:l,children:[e.jsx(uo,{size:16,className:"mr-1"}),"Export PDF"]})]})]}),e.jsx("div",{className:"space-y-6",children:a.map((d,f)=>e.jsxs(qt,{className:"bg-slate-800/30 border-slate-700/50",children:[e.jsx(zo,{className:"pb-4",children:e.jsxs(Uo,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center text-primary-foreground text-sm font-bold",children:f+1}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-white",children:qe(d.date,"EEEE, MMMM d")}),e.jsxs("div",{className:"text-sm text-slate-400",children:[d.events.length," ",d.events.length===1?"event":"events"]})]})]})}),e.jsx(Ht,{className:"space-y-3",children:d.events.map((h,m)=>{var p;return e.jsxs("div",{className:"flex items-start gap-4 p-4 bg-slate-900/30 rounded-lg border border-slate-700/30",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-3 h-3 bg-primary rounded-full"}),m<d.events.length-1&&e.jsx("div",{className:"w-0.5 h-8 bg-slate-600 mt-2"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:o(h.event_category)}),e.jsx("h4",{className:"font-semibold text-white",children:h.title}),e.jsx(He,{className:W("text-xs",i(h.event_category)),children:h.event_category})]}),e.jsxs("div",{className:"text-sm text-slate-400 flex items-center gap-1",children:[e.jsx(Ct,{size:14}),h.time]})]}),h.location&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-slate-400 mb-2",children:[e.jsx(mt,{size:14}),h.location]}),h.description&&e.jsx("p",{className:"text-sm text-slate-300",children:h.description}),((p=h.source_data)==null?void 0:p.confirmation_number)&&e.jsx("div",{className:"mt-2",children:e.jsxs(He,{variant:"outline",className:"text-xs",children:["Confirmation: ",h.source_data.confirmation_number]})})]})]},h.id)})})]},d.date.toISOString()))})]})},Gi=()=>{const[t,s]=c.useState(new Date),[r,n]=c.useState([]),[a,o]=c.useState(!1),[i,l]=c.useState("calendar"),[u,d]=c.useState({title:"",date:new Date,time:"12:00",location:"",description:"",category:"other",include_in_itinerary:!0}),f=v=>r.filter(y=>y.date.toDateString()===v.toDateString()),h=()=>{if(!u.title||!t)return;const v={id:Date.now().toString(),title:u.title,date:t,time:u.time,location:u.location,description:u.description,createdBy:"current-user",include_in_itinerary:u.include_in_itinerary??!0,event_category:u.category,source_type:"manual",source_data:{}};n(y=>[...y,v].sort((S,g)=>S.date.getTime()-g.date.getTime())),b()},m=v=>{n(y=>y.filter(S=>S.id!==v))},p=(v,y)=>{d(S=>({...S,[v]:y}))},b=()=>{d({title:"",date:t||new Date,time:"12:00",location:"",description:"",category:"other",include_in_itinerary:!0}),o(!1)};return{selectedDate:t,setSelectedDate:s,events:r,setEvents:n,showAddEvent:a,setShowAddEvent:o,viewMode:i,setViewMode:l,toggleViewMode:()=>{l(v=>v==="calendar"?"itinerary":"calendar")},newEvent:u,updateEventField:p,getEventsForDate:f,handleAddEvent:h,deleteEvent:m,resetForm:b}},Zs=({viewMode:t,onToggleView:s,onAddEvent:r})=>e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Group Calendar"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(G,{variant:"outline",onClick:s,children:t==="calendar"?e.jsxs(e.Fragment,{children:[e.jsx(Zo,{className:"mr-2 h-4 w-4"}),"Itinerary View"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"mr-2 h-4 w-4"}),"Calendar View"]})}),e.jsxs(G,{onClick:r,children:[e.jsx(xs,{className:"mr-2 h-4 w-4"}),"Add Event"]})]})]}),Wi=({newEvent:t,onUpdateField:s,onSubmit:r,onCancel:n})=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(H,{htmlFor:"title",children:"Title"}),e.jsx(Oe,{id:"title",value:t.title,onChange:a=>s("title",a.target.value),placeholder:"Event title"})]}),e.jsxs("div",{children:[e.jsx(H,{htmlFor:"time",children:"Time"}),e.jsx(Oe,{id:"time",type:"time",value:t.time,onChange:a=>s("time",a.target.value)})]}),e.jsxs("div",{children:[e.jsx(H,{htmlFor:"location",children:"Location"}),e.jsx(Oe,{id:"location",value:t.location,onChange:a=>s("location",a.target.value),placeholder:"Event location"})]}),e.jsxs("div",{children:[e.jsx(H,{htmlFor:"category",children:"Category"}),e.jsxs($r,{value:t.category,onValueChange:a=>s("category",a),children:[e.jsx(Fr,{children:e.jsx(Lr,{})}),e.jsxs(zr,{children:[e.jsx(ne,{value:"dining",children:"Dining"}),e.jsx(ne,{value:"lodging",children:"Lodging"}),e.jsx(ne,{value:"activity",children:"Activity"}),e.jsx(ne,{value:"transportation",children:"Transportation"}),e.jsx(ne,{value:"entertainment",children:"Entertainment"}),e.jsx(ne,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx(H,{htmlFor:"description",children:"Description"}),e.jsx(Rr,{id:"description",value:t.description,onChange:a=>s("description",a.target.value),placeholder:"Event details (optional)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(G,{onClick:r,disabled:!t.title,children:"Add Event"}),e.jsx(G,{variant:"outline",onClick:n,children:"Cancel"})]})]}),Ki=({event:t,onDelete:s})=>{const r={dining:"🍽️",lodging:"🏨",activity:"🎯",transportation:"🚗",entertainment:"🎭",other:"📌"};return e.jsx("div",{className:"bg-card border border-border rounded-lg p-4 hover:bg-accent/50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-lg",children:r[t.event_category]||"📌"}),e.jsx("h4",{className:"font-medium text-foreground",children:t.title})]}),e.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx("span",{children:t.time})]}),t.location&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(mt,{className:"h-4 w-4"}),e.jsx("span",{children:t.location})]})]}),t.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:t.description})]}),e.jsx(G,{variant:"ghost",size:"icon",onClick:()=>s(t.id),className:"text-destructive hover:text-destructive hover:bg-destructive/10",children:e.jsx(Mr,{className:"h-4 w-4"})})]})})},qi=({events:t,onDelete:s,emptyMessage:r="No events for this date"})=>t.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground text-sm",children:r})}):e.jsx("div",{className:"space-y-3",children:t.map(n=>e.jsx(Ki,{event:n,onDelete:s},n.id))}),du=()=>{const{selectedDate:t,setSelectedDate:s,events:r,showAddEvent:n,setShowAddEvent:a,viewMode:o,toggleViewMode:i,newEvent:l,updateEventField:u,getEventsForDate:d,handleAddEvent:f,deleteEvent:h,resetForm:m}=Gi(),p=t?d(t):[],b=r.map(x=>x.date);return o==="itinerary"?e.jsxs("div",{className:"p-6",children:[e.jsx(Zs,{viewMode:o,onToggleView:i,onAddEvent:()=>a(!n)}),e.jsx(Vi,{events:r,tripName:"Trip Itinerary"})]}):e.jsxs("div",{className:"p-6",children:[e.jsx(Zs,{viewMode:o,onToggleView:i,onAddEvent:()=>a(!n)}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"bg-card/50 backdrop-blur-sm border border-border rounded-lg p-4",children:e.jsx(Jr,{mode:"single",selected:t,onSelect:s,className:"w-full",modifiers:{hasEvents:b},modifiersStyles:{hasEvents:{backgroundColor:"hsl(var(--primary) / 0.3)",color:"hsl(var(--primary-foreground))",fontWeight:"bold"}}})}),e.jsxs("div",{className:"space-y-4",children:[n&&e.jsxs("div",{className:"bg-card/50 backdrop-blur-sm border border-border rounded-lg p-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-foreground mb-4",children:["Add Event ",t&&`for ${qe(t,"MMM d")}`]}),e.jsx(Wi,{newEvent:l,onUpdateField:u,onSubmit:f,onCancel:m})]}),e.jsxs("div",{className:"bg-card/50 backdrop-blur-sm border border-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-foreground mb-4",children:t?`Events for ${qe(t,"EEEE, MMM d")}`:"Select a date to view events"}),e.jsx(qi,{events:p,onDelete:h,emptyMessage:t?"No events scheduled for this day":"Select a date to view events"})]})]})]})]})},Hi=wo,Yi=qr,Qi=yo,da=c.forwardRef(({className:t,...s},r)=>e.jsx(Wr,{className:W("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s,ref:r}));da.displayName=Wr.displayName;const Xi=zn("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),ua=c.forwardRef(({side:t="right",className:s,children:r,...n},a)=>e.jsxs(Qi,{children:[e.jsx(da,{}),e.jsxs(Kr,{ref:a,className:W(Xi({side:t}),s),...n,children:[r,e.jsxs(qr,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ua.displayName=Kr.displayName;const ma=({className:t,...s})=>e.jsx("div",{className:W("flex flex-col space-y-2 text-center sm:text-left",t),...s});ma.displayName="SheetHeader";const ha=c.forwardRef(({className:t,...s},r)=>e.jsx(Hr,{ref:r,className:W("text-lg font-semibold text-foreground",t),...s}));ha.displayName=Hr.displayName;const Zi=c.forwardRef(({className:t,...s},r)=>e.jsx(Yr,{ref:r,className:W("text-sm text-muted-foreground",t),...s}));Zi.displayName=Yr.displayName;const Ji=({task:t,onClose:s})=>{var a,o,i,l;const r=((a=t.task_status)==null?void 0:a.filter(u=>u.completed))||[],n=((o=t.task_status)==null?void 0:o.filter(u=>!u.completed))||[];return e.jsx(Hi,{open:!0,onOpenChange:s,children:e.jsxs(ua,{className:"bg-gray-900 border-gray-700 text-white",children:[e.jsx(ma,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ha,{className:"text-white",children:t.title}),e.jsx(Yi,{asChild:!0,children:e.jsx("button",{className:"text-gray-400 hover:text-white",children:e.jsx(Pe,{size:20})})})]})}),e.jsxs("div",{className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"bg-white/5 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-gray-300",children:"Progress"}),e.jsxs(He,{className:"bg-gradient-to-r from-blue-400 to-purple-400",children:[r.length,"/",((i=t.task_status)==null?void 0:i.length)||0]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-400 to-purple-400 h-2 rounded-full transition-all duration-300",style:{width:`${r.length/(((l=t.task_status)==null?void 0:l.length)||1)*100}%`}})})]}),r.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-lg font-medium text-white flex items-center gap-2",children:[e.jsx(gt,{size:20,className:"text-green-400"}),"Completed (",r.length,")"]}),e.jsx("div",{className:"space-y-2",children:r.map(u=>{var d,f,h,m;return e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-400/10 rounded-lg border border-green-400/20",children:[e.jsxs(ht,{className:"w-8 h-8",children:[e.jsx(ft,{src:(d=u.user)==null?void 0:d.avatar}),e.jsx(pt,{className:"text-xs bg-green-400 text-white",children:((h=(f=u.user)==null?void 0:f.name)==null?void 0:h.charAt(0))||"U"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-white font-medium",children:((m=u.user)==null?void 0:m.name)||"Unknown User"}),u.completed_at&&e.jsxs("div",{className:"text-gray-400 text-xs",children:["Completed ",as(new Date(u.completed_at),{addSuffix:!0})]})]}),e.jsx(gt,{size:20,className:"text-green-400"})]},u.user_id)})})]}),n.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-lg font-medium text-white flex items-center gap-2",children:[e.jsx(Kt,{size:20,className:"text-yellow-400"}),"Pending (",n.length,")"]}),e.jsx("div",{className:"space-y-2",children:n.map(u=>{var d,f,h,m;return e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-yellow-400/10 rounded-lg border border-yellow-400/20",children:[e.jsxs(ht,{className:"w-8 h-8",children:[e.jsx(ft,{src:(d=u.user)==null?void 0:d.avatar}),e.jsx(pt,{className:"text-xs bg-yellow-400 text-white",children:((h=(f=u.user)==null?void 0:f.name)==null?void 0:h.charAt(0))||"U"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-white font-medium",children:((m=u.user)==null?void 0:m.name)||"Unknown User"}),e.jsx("div",{className:"text-gray-400 text-xs",children:"Not completed yet"})]}),e.jsx(Kt,{size:20,className:"text-yellow-400"})]},u.user_id)})})]}),t.description&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Description"}),e.jsx("p",{className:"text-gray-300 bg-white/5 rounded-lg p-3",children:t.description})]}),t.due_at&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Due Date"}),e.jsx("div",{className:"text-gray-300 bg-white/5 rounded-lg p-3",children:as(new Date(t.due_at),{addSuffix:!0})})]})]})]})})};class el{getStorageKey(s){return`tasks_${s}`}async getTasks(s){try{return await Un(this.getStorageKey(s),[])}catch(r){return console.error("Error loading tasks from storage:",r),[]}}async saveTasks(s,r){try{await Bn(this.getStorageKey(s),r)}catch(n){console.error("Error saving tasks to storage:",n)}}async createTask(s,r){const n=await this.getTasks(s),a={id:`demo-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,trip_id:s,creator_id:"demo-user",title:r.title,description:r.description,due_at:r.due_at,is_poll:r.is_poll,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),creator:{id:"demo-user",name:"You"},task_status:this.createInitialTaskStatus(r,"demo-user")};return n.unshift(a),await this.saveTasks(s,n),a}createInitialTaskStatus(s,r){return s.is_poll?s.assignedTo.map(n=>({task_id:"",user_id:n,completed:!1})):(s.assignedTo.length>0?s.assignedTo:[r]).map(a=>({task_id:"",user_id:a,completed:!1}))}async toggleTask(s,r,n,a){var d;const o=await this.getTasks(s),i=o.findIndex(f=>f.id===r);if(i===-1)return null;const l=o[i],u=((d=l.task_status)==null?void 0:d.findIndex(f=>f.user_id===n))??-1;return u===-1?(l.task_status=l.task_status||[],l.task_status.push({task_id:r,user_id:n,completed:a,completed_at:a?new Date().toISOString():void 0})):l.task_status[u]={...l.task_status[u],completed:a,completed_at:a?new Date().toISOString():void 0},l.updated_at=new Date().toISOString(),await this.saveTasks(s,o),l}async deleteTask(s,r){const n=await this.getTasks(s),a=n.filter(o=>o.id!==r);return a.length!==n.length?(await this.saveTasks(s,a),!0):!1}async clearTasks(s){await Vn(this.getStorageKey(s))}async clearAllDemoTasks(){console.warn("Clear all demo tasks not fully supported with platformStorage")}}const vt=new el,It=t=>["1","2","3","4","5","6","7","8","9","10","11","12"].includes(t)?{1:[{id:"seed-1-1",trip_id:t,creator_id:"seed-user",title:"Pack reef-safe sunscreen",description:"Make sure to bring sunscreen that won't damage the coral reefs",due_at:new Date(Date.now()+7*24*60*60*1e3).toISOString(),is_poll:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),creator:{id:"seed-user",name:"Trip Organizer"},task_status:[{task_id:"seed-1-1",user_id:"current-user",completed:!1}]},{id:"seed-1-2",trip_id:t,creator_id:"seed-user",title:"Download offline maps for Cancun",description:"Download Google Maps offline for the hotel and downtown areas",due_at:new Date(Date.now()+5*24*60*60*1e3).toISOString(),is_poll:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),creator:{id:"seed-user",name:"Trip Organizer"},task_status:[{task_id:"seed-1-2",user_id:"current-user",completed:!1}]}],4:[{id:"seed-4-1",trip_id:t,creator_id:"seed-user",title:"Coordinate ride to Broadway bars",description:"Book Uber/Lyft for the group to hit the honky-tonk scene",due_at:new Date(Date.now()+3*24*60*60*1e3).toISOString(),is_poll:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),creator:{id:"seed-user",name:"Ashley"},task_status:[{task_id:"seed-4-1",user_id:"current-user",completed:!1}]}],6:[{id:"seed-6-1",trip_id:t,creator_id:"seed-user",title:"Pack hiking boots for everyone",description:"Make sure everyone has proper footwear for the mountain trails",due_at:new Date(Date.now()+4*24*60*60*1e3).toISOString(),is_poll:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),creator:{id:"seed-user",name:"Dad (Mike)"},task_status:[{task_id:"seed-6-1",user_id:"current-user",completed:!1}]}],7:[{id:"seed-7-1",trip_id:t,creator_id:"seed-user",title:"Bring poker chips for evening games",description:"Someone needs to pack the poker set for our nightly tournaments",due_at:new Date(Date.now()+6*24*60*60*1e3).toISOString(),is_poll:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),creator:{id:"seed-user",name:"Commissioner Mike"},task_status:[{task_id:"seed-7-1",user_id:"current-user",completed:!1}]}]}[t]||[]:[],tl=t=>{const{isDemoMode:s}=Ge(),{user:r}=Ve();return pi({queryKey:["tripTasks",t,s],queryFn:async()=>{if(s||!r){const n=await vt.getTasks(t);return n.length===0?It(t):n}try{const{data:n,error:a}=await V.from("trip_tasks").select(`
            *,
            task_status(*)
          `).eq("trip_id",t).order("created_at",{ascending:!1});if(a)throw a;return!n||n.length===0?It(t):n.map(o=>({id:o.id,trip_id:o.trip_id,creator_id:o.creator_id,title:o.title,description:o.description,due_at:o.due_at,is_poll:o.is_poll,created_at:o.created_at,updated_at:o.updated_at,creator:{id:o.creator_id,name:"User"},task_status:o.task_status||[]}))}catch(n){console.error("Error fetching tasks:",n);const a=await vt.getTasks(t);return a.length>0?a:It(t)}},enabled:!!t})},fa=t=>{const s=ds(),{toast:r}=Gn(),{isDemoMode:n}=Ge(),{user:a}=Ve(),o=Hs({mutationFn:async l=>{if(n||!a){const m=l.assignedTo||["demo-user"];return await vt.createTask(t,{...l,assignedTo:m})}const{data:{user:u}}=await V.auth.getUser();if(!u)throw new Error("Please sign in to create tasks");const{error:d}=await V.rpc("ensure_trip_membership",{p_trip_id:t,p_user_id:u.id});if(d)throw console.error("Membership error:",d),new Error("Unable to join trip. Please try again.");const{data:f,error:h}=await V.from("trip_tasks").insert({trip_id:t,creator_id:u.id,title:l.title,description:l.description,due_at:l.due_at,is_poll:l.is_poll}).select().single();if(h)throw console.error("Task creation error:",h),h.code==="PGRST116"?new Error("Access denied. You must be a trip member to create tasks."):h;return await V.from("task_status").insert({task_id:f.id,user_id:u.id,completed:!1}),{id:f.id,trip_id:f.trip_id,creator_id:f.creator_id,title:f.title,description:f.description,due_at:f.due_at,is_poll:f.is_poll,created_at:f.created_at,updated_at:f.updated_at,creator:{id:u.id,name:"Current User"},task_status:[{task_id:f.id,user_id:u.id,completed:!1}]}},onSuccess:()=>{s.invalidateQueries({queryKey:["tripTasks",t]}),r({title:"Task created",description:"Your task has been added to the list."})},onError:l=>{console.error("Create task mutation error:",l);const u=l.message||"Failed to create task. Please try again.";r({title:"Error Creating Task",description:u,variant:"destructive"})}}),i=Hs({mutationFn:async({taskId:l,completed:u})=>{if(n||!a){const p=(a==null?void 0:a.id)||"demo-user";return await vt.toggleTask(t,l,p,u)}const{data:{user:d}}=await V.auth.getUser();if(!d)throw new Error("User not authenticated");const{data:f,error:h}=await V.from("trip_tasks").select("version").eq("id",l).single();if(h)throw h;const{error:m}=await V.rpc("toggle_task_status",{p_task_id:l,p_user_id:d.id,p_completed:u,p_current_version:f.version});if(m)throw m;return{taskId:l,completed:u}},onMutate:async({taskId:l,completed:u})=>{await s.cancelQueries({queryKey:["tripTasks",t]});const d=s.getQueryData(["tripTasks",t]);return s.setQueryData(["tripTasks",t],f=>f&&f.map(h=>{var m;if(h.id===l){const p=(a==null?void 0:a.id)||"demo-user",b=(m=h.task_status)==null?void 0:m.map(x=>x.user_id===p?{...x,completed:u,completed_at:u?new Date().toISOString():void 0}:x);return{...h,task_status:b}}return h})),{previousTasks:d}},onError:(l,u,d)=>{d!=null&&d.previousTasks&&s.setQueryData(["tripTasks",t],d.previousTasks),r({title:"Error",description:"Failed to update task. Please try again.",variant:"destructive"})},onSettled:()=>{s.invalidateQueries({queryKey:["tripTasks",t,n]})}});return{createTaskMutation:o,toggleTaskMutation:i}};function sl(t,s=[]){let r=[];function n(o,i){const l=c.createContext(i),u=r.length;r=[...r,i];function d(h){const{scope:m,children:p,...b}=h,x=(m==null?void 0:m[t][u])||l,v=c.useMemo(()=>b,Object.values(b));return e.jsx(x.Provider,{value:v,children:p})}function f(h,m){const p=(m==null?void 0:m[t][u])||l,b=c.useContext(p);if(b)return b;if(i!==void 0)return i;throw new Error(`\`${h}\` must be used within \`${o}\``)}return d.displayName=o+"Provider",[d,f]}const a=()=>{const o=r.map(i=>c.createContext(i));return function(l){const u=(l==null?void 0:l[t])||o;return c.useMemo(()=>({[`__scope${t}`]:{...l,[t]:u}}),[l,u])}};return a.scopeName=t,[n,rl(a,...s)]}function rl(...t){const s=t[0];if(t.length===1)return s;const r=()=>{const n=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(o){const i=n.reduce((l,{useScope:u,scopeName:d})=>{const h=u(o)[`__scope${d}`];return{...l,...h}},{});return c.useMemo(()=>({[`__scope${s.scopeName}`]:i}),[i])}};return r.scopeName=s.scopeName,r}var ys="Progress",ws=100,[al,uu]=sl(ys),[nl,ol]=al(ys),pa=c.forwardRef((t,s)=>{const{__scopeProgress:r,value:n=null,max:a,getValueLabel:o=il,...i}=t;(a||a===0)&&!Js(a)&&console.error(ll(`${a}`,"Progress"));const l=Js(a)?a:ws;n!==null&&!er(n,l)&&console.error(cl(`${n}`,"Progress"));const u=er(n,l)?n:null,d=bt(u)?o(u,l):void 0;return e.jsx(nl,{scope:r,value:u,max:l,children:e.jsx(_e.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":bt(u)?u:void 0,"aria-valuetext":d,role:"progressbar","data-state":va(u,l),"data-value":u??void 0,"data-max":l,...i,ref:s})})});pa.displayName=ys;var ga="ProgressIndicator",xa=c.forwardRef((t,s)=>{const{__scopeProgress:r,...n}=t,a=ol(ga,r);return e.jsx(_e.div,{"data-state":va(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...n,ref:s})});xa.displayName=ga;function il(t,s){return`${Math.round(t/s*100)}%`}function va(t,s){return t==null?"indeterminate":t===s?"complete":"loading"}function bt(t){return typeof t=="number"}function Js(t){return bt(t)&&!isNaN(t)&&t>0}function er(t,s){return bt(t)&&!isNaN(t)&&t<=s&&t>=0}function ll(t,s){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${s}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${ws}\`.`}function cl(t,s){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${s}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${ws} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var ba=pa,dl=xa;const ya=c.forwardRef(({className:t,value:s,...r},n)=>e.jsx(ba,{ref:n,className:W("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...r,children:e.jsx(dl,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(s||0)}%)`}})}));ya.displayName=ba.displayName;const ul=({task:t,tripId:s})=>{var g,w,C,E,k,P,T,$,F,R;const[r,n]=c.useState(!1),[a,o]=c.useState(!1),{toggleTaskMutation:i}=fa(s),l=t.is_poll?(((g=t.task_status)==null?void 0:g.filter(q=>q.completed).length)||0)>=(((w=t.task_status)==null?void 0:w.length)||1):((E=(C=t.task_status)==null?void 0:C[0])==null?void 0:E.completed)||!1,u=t.due_at&&qo(new Date,new Date(t.due_at))&&!l,{user:d}=Ve(),{isDemoMode:f}=Ge(),m=f||!d?"demo-user":d.id,p=(k=t.task_status)==null?void 0:k.find(q=>q.user_id===m),b=(p==null?void 0:p.completed)||!1,x=((P=t.task_status)==null?void 0:P.filter(q=>q.completed).length)||0,v=((T=t.task_status)==null?void 0:T.length)||1,y=x/v*100,S=()=>{const q=!b;q?(Mt.success(),o(!0),setTimeout(()=>o(!1),1e3)):Mt.light(),i.mutate({taskId:t.id,completed:q})};return c.useEffect(()=>{t.is_poll&&y===100&&!a&&Mt.celebration()},[y,t.is_poll,a]),e.jsxs("div",{className:`bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-4 transition-all hover:bg-white/10 ${l?"opacity-75":""}`,children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:"relative mt-1",children:[e.jsx(Wt,{checked:b,onCheckedChange:S}),a&&e.jsx("div",{className:"absolute -inset-2 pointer-events-none",children:e.jsx(ea,{className:"w-6 h-6 text-green-400 animate-scale-in",fill:"currentColor"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`font-medium text-white ${l?"line-through":""}`,children:t.title}),t.description&&e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:t.description}),t.due_at&&e.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[e.jsx(Ue,{size:14}),e.jsxs(He,{variant:u?"destructive":"secondary",className:"text-xs",children:[u?"Overdue":"Due"," ",as(new Date(t.due_at),{addSuffix:!0})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:t.is_poll?e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsxs(G,{variant:"ghost",size:"sm",onClick:()=>n(!0),className:"flex items-center gap-2 text-gray-300 hover:text-white",children:[e.jsx(ve,{size:16}),e.jsxs("span",{className:"text-sm",children:[x,"/",v]})]}),e.jsxs("div",{className:"w-20",children:[e.jsx(ya,{value:y,className:`h-1 ${y===100?"animate-pulse":""}`}),e.jsxs("span",{className:"text-xs text-gray-400 mt-1",children:[Math.round(y),"%"]})]}),y===100&&e.jsx("div",{className:"text-xs text-yellow-400 font-medium animate-bounce",children:"🎉 All done!"})]}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Nt,{size:16,className:"text-gray-400"}),e.jsxs(ht,{className:"w-6 h-6",children:[e.jsx(ft,{src:($=t.creator)==null?void 0:$.avatar}),e.jsx(pt,{className:"text-xs",children:((R=(F=t.creator)==null?void 0:F.name)==null?void 0:R.charAt(0))||"U"})]})]})})]}),r&&e.jsx(Ji,{task:t,onClose:()=>n(!1)})]})},tr=({tasks:t,tripId:s,title:r,emptyMessage:n,showCompleted:a,onToggleCompleted:o})=>{const i=r.toLowerCase().includes("completed");return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:i?e.jsxs("button",{onClick:o,className:"flex items-center gap-2 text-gray-300 hover:text-white font-medium transition-colors",children:[e.jsx(gt,{size:18}),e.jsxs("span",{children:[r," (",t.length,")"]}),e.jsx("span",{className:"text-xs",children:a?"▼":"▶"})]}):e.jsxs("div",{className:"flex items-center gap-2 text-white font-medium",children:[e.jsx(Ct,{size:18}),e.jsxs("span",{children:[r," (",t.length,")"]})]})}),t.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(gt,{size:48,className:"mx-auto mb-3 opacity-50"}),e.jsx("p",{children:n||"No tasks found"})]}):(!i||a)&&e.jsx("div",{className:"space-y-2",children:t.map(l=>e.jsx(ul,{task:l,tripId:s},l.id))})]})},ml=({status:t,sortBy:s,onStatusChange:r,onSortChange:n,hasActiveFilters:a,onClearFilters:o})=>{const i=["all","open","completed"],l=[{value:"dueDate",label:"Due Date"},{value:"created",label:"Created"},{value:"priority",label:"Priority"}];return e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-sm",children:[e.jsx(Ho,{size:16}),e.jsx("span",{children:"Filter:"})]}),e.jsx("div",{className:"flex gap-2",children:i.map(u=>e.jsx("button",{onClick:()=>r(u),className:`px-3 py-1 rounded-full text-xs font-medium transition-colors capitalize ${t===u?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:u},u))}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx("span",{className:"text-slate-400 text-sm",children:"Sort by:"}),e.jsx("select",{value:s,onChange:u=>n(u.target.value),className:"bg-slate-700 text-white text-xs rounded px-2 py-1 border border-slate-600",children:l.map(u=>e.jsx("option",{value:u.value,children:u.label},u.value))})]}),a&&e.jsxs(G,{variant:"ghost",size:"sm",onClick:o,className:"text-slate-400 hover:text-white",children:[e.jsx(Pe,{size:14,className:"mr-1"}),"Clear"]})]})};var js="Radio",[hl,wa]=fs(js),[fl,pl]=hl(js),ja=c.forwardRef((t,s)=>{const{__scopeRadio:r,name:n,checked:a=!1,required:o,disabled:i,value:l="on",onCheck:u,form:d,...f}=t,[h,m]=c.useState(null),p=jt(s,v=>m(v)),b=c.useRef(!1),x=h?d||!!h.closest("form"):!0;return e.jsxs(fl,{scope:r,checked:a,disabled:i,children:[e.jsx(_e.button,{type:"button",role:"radio","aria-checked":a,"data-state":Sa(a),"data-disabled":i?"":void 0,disabled:i,value:l,...f,ref:p,onClick:ge(t.onClick,v=>{a||u==null||u(),x&&(b.current=v.isPropagationStopped(),b.current||v.stopPropagation())})}),x&&e.jsx(gl,{control:h,bubbles:!b.current,name:n,value:l,checked:a,required:o,disabled:i,form:d,style:{transform:"translateX(-100%)"}})]})});ja.displayName=js;var Na="RadioIndicator",Ca=c.forwardRef((t,s)=>{const{__scopeRadio:r,forceMount:n,...a}=t,o=pl(Na,r);return e.jsx(ps,{present:n||o.checked,children:e.jsx(_e.span,{"data-state":Sa(o.checked),"data-disabled":o.disabled?"":void 0,...a,ref:s})})});Ca.displayName=Na;var gl=t=>{const{control:s,checked:r,bubbles:n=!0,...a}=t,o=c.useRef(null),i=vo(r),l=Wn(s);return c.useEffect(()=>{const u=o.current,d=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(d,"checked").set;if(i!==r&&h){const m=new Event("click",{bubbles:n});h.call(u,r),u.dispatchEvent(m)}},[i,r,n]),e.jsx("input",{type:"radio","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:o,style:{...t.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Sa(t){return t?"checked":"unchecked"}var xl=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Ns="RadioGroup",[vl,mu]=fs(Ns,[Xr,wa]),Ea=Xr(),ka=wa(),[bl,yl]=vl(Ns),Pa=c.forwardRef((t,s)=>{const{__scopeRadioGroup:r,name:n,defaultValue:a,value:o,required:i=!1,disabled:l=!1,orientation:u,dir:d,loop:f=!0,onValueChange:h,...m}=t,p=Ea(r),b=bo(d),[x,v]=wr({prop:o,defaultProp:a,onChange:h});return e.jsx(bl,{scope:r,name:n,required:i,disabled:l,value:x,onValueChange:v,children:e.jsx(Fo,{asChild:!0,...p,orientation:u,dir:b,loop:f,children:e.jsx(_e.div,{role:"radiogroup","aria-required":i,"aria-orientation":u,"data-disabled":l?"":void 0,dir:b,...m,ref:s})})})});Pa.displayName=Ns;var _a="RadioGroupItem",Ta=c.forwardRef((t,s)=>{const{__scopeRadioGroup:r,disabled:n,...a}=t,o=yl(_a,r),i=o.disabled||n,l=Ea(r),u=ka(r),d=c.useRef(null),f=jt(s,d),h=o.value===a.value,m=c.useRef(!1);return c.useEffect(()=>{const p=x=>{xl.includes(x.key)&&(m.current=!0)},b=()=>m.current=!1;return document.addEventListener("keydown",p),document.addEventListener("keyup",b),()=>{document.removeEventListener("keydown",p),document.removeEventListener("keyup",b)}},[]),e.jsx(Lo,{asChild:!0,...l,focusable:!i,active:h,children:e.jsx(ja,{disabled:i,required:o.required,checked:h,...u,...a,name:o.name,ref:f,onCheck:()=>o.onValueChange(a.value),onKeyDown:ge(p=>{p.key==="Enter"&&p.preventDefault()}),onFocus:ge(a.onFocus,()=>{var p;m.current&&((p=d.current)==null||p.click())})})})});Ta.displayName=_a;var wl="RadioGroupIndicator",Da=c.forwardRef((t,s)=>{const{__scopeRadioGroup:r,...n}=t,a=ka(r);return e.jsx(Ca,{...a,...n,ref:s})});Da.displayName=wl;var Ra=Pa,Ma=Ta,jl=Da;const Aa=c.forwardRef(({className:t,...s},r)=>e.jsx(Ra,{className:W("grid gap-2",t),...s,ref:r}));Aa.displayName=Ra.displayName;const ns=c.forwardRef(({className:t,...s},r)=>e.jsx(Ma,{ref:r,className:W("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:e.jsx(jl,{className:"flex items-center justify-center",children:e.jsx(Kt,{className:"h-2.5 w-2.5 fill-current text-current"})})}));ns.displayName=Ma.displayName;var Cs="Popover",[Ia,hu]=fs(Cs,[jr]),et=jr(),[Nl,ye]=Ia(Cs),Oa=t=>{const{__scopePopover:s,children:r,open:n,defaultOpen:a,onOpenChange:o,modal:i=!1}=t,l=et(s),u=c.useRef(null),[d,f]=c.useState(!1),[h=!1,m]=wr({prop:n,defaultProp:a,onChange:o});return e.jsx(Xn,{...l,children:e.jsx(Nl,{scope:s,contentId:Zn(),triggerRef:u,open:h,onOpenChange:m,onOpenToggle:c.useCallback(()=>m(p=>!p),[m]),hasCustomAnchor:d,onCustomAnchorAdd:c.useCallback(()=>f(!0),[]),onCustomAnchorRemove:c.useCallback(()=>f(!1),[]),modal:i,children:r})})};Oa.displayName=Cs;var $a="PopoverAnchor",Cl=c.forwardRef((t,s)=>{const{__scopePopover:r,...n}=t,a=ye($a,r),o=et(r),{onCustomAnchorAdd:i,onCustomAnchorRemove:l}=a;return c.useEffect(()=>(i(),()=>l()),[i,l]),e.jsx(Nr,{...o,...n,ref:s})});Cl.displayName=$a;var Fa="PopoverTrigger",La=c.forwardRef((t,s)=>{const{__scopePopover:r,...n}=t,a=ye(Fa,r),o=et(r),i=jt(s,a.triggerRef),l=e.jsx(_e.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Ga(a.open),...n,ref:i,onClick:ge(t.onClick,a.onOpenToggle)});return a.hasCustomAnchor?l:e.jsx(Nr,{asChild:!0,...o,children:l})});La.displayName=Fa;var Ss="PopoverPortal",[Sl,El]=Ia(Ss,{forceMount:void 0}),za=t=>{const{__scopePopover:s,forceMount:r,children:n,container:a}=t,o=ye(Ss,s);return e.jsx(Sl,{scope:s,forceMount:r,children:e.jsx(ps,{present:r||o.open,children:e.jsx(Qn,{asChild:!0,container:a,children:n})})})};za.displayName=Ss;var Be="PopoverContent",Ua=c.forwardRef((t,s)=>{const r=El(Be,t.__scopePopover),{forceMount:n=r.forceMount,...a}=t,o=ye(Be,t.__scopePopover);return e.jsx(ps,{present:n||o.open,children:o.modal?e.jsx(kl,{...a,ref:s}):e.jsx(Pl,{...a,ref:s})})});Ua.displayName=Be;var kl=c.forwardRef((t,s)=>{const r=ye(Be,t.__scopePopover),n=c.useRef(null),a=jt(s,n),o=c.useRef(!1);return c.useEffect(()=>{const i=n.current;if(i)return Qr(i)},[]),e.jsx(jo,{as:Kn,allowPinchZoom:!0,children:e.jsx(Ba,{...t,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ge(t.onCloseAutoFocus,i=>{var l;i.preventDefault(),o.current||(l=r.triggerRef.current)==null||l.focus()}),onPointerDownOutside:ge(t.onPointerDownOutside,i=>{const l=i.detail.originalEvent,u=l.button===0&&l.ctrlKey===!0,d=l.button===2||u;o.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:ge(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),Pl=c.forwardRef((t,s)=>{const r=ye(Be,t.__scopePopover),n=c.useRef(!1),a=c.useRef(!1);return e.jsx(Ba,{...t,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var i,l;(i=t.onCloseAutoFocus)==null||i.call(t,o),o.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),o.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:o=>{var u,d;(u=t.onInteractOutside)==null||u.call(t,o),o.defaultPrevented||(n.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=o.target;((d=r.triggerRef.current)==null?void 0:d.contains(i))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),Ba=c.forwardRef((t,s)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:i,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:f,...h}=t,m=ye(Be,r),p=et(r);return No(),e.jsx(Co,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:o,children:e.jsx(qn,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:f,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onDismiss:()=>m.onOpenChange(!1),children:e.jsx(Hn,{"data-state":Ga(m.open),role:"dialog",id:m.contentId,...p,...h,ref:s,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Va="PopoverClose",_l=c.forwardRef((t,s)=>{const{__scopePopover:r,...n}=t,a=ye(Va,r);return e.jsx(_e.button,{type:"button",...n,ref:s,onClick:ge(t.onClick,()=>a.onOpenChange(!1))})});_l.displayName=Va;var Tl="PopoverArrow",Dl=c.forwardRef((t,s)=>{const{__scopePopover:r,...n}=t,a=et(r);return e.jsx(Yn,{...a,...n,ref:s})});Dl.displayName=Tl;function Ga(t){return t?"open":"closed"}var Rl=Oa,Ml=La,Al=za,Wa=Ua;const Ka=Rl,qa=Ml,Es=c.forwardRef(({className:t,align:s="center",sideOffset:r=4,...n},a)=>e.jsx(Al,{children:e.jsx(Wa,{ref:a,align:s,sideOffset:r,className:W("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}));Es.displayName=Wa.displayName;var sr=1,Il=.9,Ol=.8,$l=.17,Ot=.1,$t=.999,Fl=.9999,Ll=.99,zl=/[\\\/_+.#"@\[\(\{&]/,Ul=/[\\\/_+.#"@\[\(\{&]/g,Bl=/[\s-]/,Ha=/[\s-]/g;function os(t,s,r,n,a,o,i){if(o===s.length)return a===t.length?sr:Ll;var l=`${a},${o}`;if(i[l]!==void 0)return i[l];for(var u=n.charAt(o),d=r.indexOf(u,a),f=0,h,m,p,b;d>=0;)h=os(t,s,r,n,d+1,o+1,i),h>f&&(d===a?h*=sr:zl.test(t.charAt(d-1))?(h*=Ol,p=t.slice(a,d-1).match(Ul),p&&a>0&&(h*=Math.pow($t,p.length))):Bl.test(t.charAt(d-1))?(h*=Il,b=t.slice(a,d-1).match(Ha),b&&a>0&&(h*=Math.pow($t,b.length))):(h*=$l,a>0&&(h*=Math.pow($t,d-a))),t.charAt(d)!==s.charAt(o)&&(h*=Fl)),(h<Ot&&r.charAt(d-1)===n.charAt(o+1)||n.charAt(o+1)===n.charAt(o)&&r.charAt(d-1)!==n.charAt(o))&&(m=os(t,s,r,n,d+1,o+2,i),m*Ot>h&&(h=m*Ot)),h>f&&(f=h),d=r.indexOf(u,d+1);return i[l]=f,f}function rr(t){return t.toLowerCase().replace(Ha," ")}function Vl(t,s,r){return t=r&&r.length>0?`${t+" "+r.join(" ")}`:t,os(t,s,rr(t),rr(s),0,0,{})}function xe(t,s,{checkForDefaultPrevented:r=!0}={}){return function(a){if(t==null||t(a),r===!1||!a.defaultPrevented)return s==null?void 0:s(a)}}function ar(t,s){if(typeof t=="function")return t(s);t!=null&&(t.current=s)}function Se(...t){return s=>{let r=!1;const n=t.map(a=>{const o=ar(a,s);return!r&&typeof o=="function"&&(r=!0),o});if(r)return()=>{for(let a=0;a<n.length;a++){const o=n[a];typeof o=="function"?o():ar(t[a],null)}}}}function Te(...t){return c.useCallback(Se(...t),t)}function Gl(t,s){const r=c.createContext(s),n=o=>{const{children:i,...l}=o,u=c.useMemo(()=>l,Object.values(l));return e.jsx(r.Provider,{value:u,children:i})};n.displayName=t+"Provider";function a(o){const i=c.useContext(r);if(i)return i;if(s!==void 0)return s;throw new Error(`\`${o}\` must be used within \`${t}\``)}return[n,a]}function Wl(t,s=[]){let r=[];function n(o,i){const l=c.createContext(i),u=r.length;r=[...r,i];const d=h=>{var y;const{scope:m,children:p,...b}=h,x=((y=m==null?void 0:m[t])==null?void 0:y[u])||l,v=c.useMemo(()=>b,Object.values(b));return e.jsx(x.Provider,{value:v,children:p})};d.displayName=o+"Provider";function f(h,m){var x;const p=((x=m==null?void 0:m[t])==null?void 0:x[u])||l,b=c.useContext(p);if(b)return b;if(i!==void 0)return i;throw new Error(`\`${h}\` must be used within \`${o}\``)}return[d,f]}const a=()=>{const o=r.map(i=>c.createContext(i));return function(l){const u=(l==null?void 0:l[t])||o;return c.useMemo(()=>({[`__scope${t}`]:{...l,[t]:u}}),[l,u])}};return a.scopeName=t,[n,Kl(a,...s)]}function Kl(...t){const s=t[0];if(t.length===1)return s;const r=()=>{const n=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(o){const i=n.reduce((l,{useScope:u,scopeName:d})=>{const h=u(o)[`__scope${d}`];return{...l,...h}},{});return c.useMemo(()=>({[`__scope${s.scopeName}`]:i}),[i])}};return r.scopeName=s.scopeName,r}var Ye=globalThis!=null&&globalThis.document?c.useLayoutEffect:()=>{},ql=Cr[" useId ".trim().toString()]||(()=>{}),Hl=0;function le(t){const[s,r]=c.useState(ql());return Ye(()=>{r(n=>n??String(Hl++))},[t]),s?`radix-${s}`:""}var Yl=Cr[" useInsertionEffect ".trim().toString()]||Ye;function Ql({prop:t,defaultProp:s,onChange:r=()=>{},caller:n}){const[a,o,i]=Xl({defaultProp:s,onChange:r}),l=t!==void 0,u=l?t:a;{const f=c.useRef(t!==void 0);c.useEffect(()=>{const h=f.current;h!==l&&console.warn(`${n} is changing from ${h?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=l},[l,n])}const d=c.useCallback(f=>{var h;if(l){const m=Zl(f)?f(t):f;m!==t&&((h=i.current)==null||h.call(i,m))}else o(f)},[l,t,o,i]);return[u,d]}function Xl({defaultProp:t,onChange:s}){const[r,n]=c.useState(t),a=c.useRef(r),o=c.useRef(s);return Yl(()=>{o.current=s},[s]),c.useEffect(()=>{var i;a.current!==r&&((i=o.current)==null||i.call(o,r),a.current=r)},[r,a]),[r,n,o]}function Zl(t){return typeof t=="function"}function Ya(t){const s=Jl(t),r=c.forwardRef((n,a)=>{const{children:o,...i}=n,l=c.Children.toArray(o),u=l.find(tc);if(u){const d=u.props.children,f=l.map(h=>h===u?c.Children.count(d)>1?c.Children.only(null):c.isValidElement(d)?d.props.children:null:h);return e.jsx(s,{...i,ref:a,children:c.isValidElement(d)?c.cloneElement(d,void 0,f):null})}return e.jsx(s,{...i,ref:a,children:o})});return r.displayName=`${t}.Slot`,r}function Jl(t){const s=c.forwardRef((r,n)=>{const{children:a,...o}=r;if(c.isValidElement(a)){const i=rc(a),l=sc(o,a.props);return a.type!==c.Fragment&&(l.ref=n?Se(n,i):i),c.cloneElement(a,l)}return c.Children.count(a)>1?c.Children.only(null):null});return s.displayName=`${t}.SlotClone`,s}var ec=Symbol("radix.slottable");function tc(t){return c.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===ec}function sc(t,s){const r={...s};for(const n in s){const a=t[n],o=s[n];/^on[A-Z]/.test(n)?a&&o?r[n]=(...l)=>{const u=o(...l);return a(...l),u}:a&&(r[n]=a):n==="style"?r[n]={...a,...o}:n==="className"&&(r[n]=[a,o].filter(Boolean).join(" "))}return{...t,...r}}function rc(t){var n,a;let s=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=s&&"isReactWarning"in s&&s.isReactWarning;return r?t.ref:(s=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var ac=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],K=ac.reduce((t,s)=>{const r=Ya(`Primitive.${s}`),n=c.forwardRef((a,o)=>{const{asChild:i,...l}=a,u=i?r:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(u,{...l,ref:o})});return n.displayName=`Primitive.${s}`,{...t,[s]:n}},{});function nc(t,s){t&&Jn.flushSync(()=>t.dispatchEvent(s))}function Qe(t){const s=c.useRef(t);return c.useEffect(()=>{s.current=t}),c.useMemo(()=>(...r)=>{var n;return(n=s.current)==null?void 0:n.call(s,...r)},[])}function oc(t,s=globalThis==null?void 0:globalThis.document){const r=Qe(t);c.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return s.addEventListener("keydown",n,{capture:!0}),()=>s.removeEventListener("keydown",n,{capture:!0})},[r,s])}var ic="DismissableLayer",is="dismissableLayer.update",lc="dismissableLayer.pointerDownOutside",cc="dismissableLayer.focusOutside",nr,Qa=c.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Xa=c.forwardRef((t,s)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:o,onInteractOutside:i,onDismiss:l,...u}=t,d=c.useContext(Qa),[f,h]=c.useState(null),m=(f==null?void 0:f.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=c.useState({}),b=Te(s,k=>h(k)),x=Array.from(d.layers),[v]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),y=x.indexOf(v),S=f?x.indexOf(f):-1,g=d.layersWithOutsidePointerEventsDisabled.size>0,w=S>=y,C=mc(k=>{const P=k.target,T=[...d.branches].some($=>$.contains(P));!w||T||(a==null||a(k),i==null||i(k),k.defaultPrevented||l==null||l())},m),E=hc(k=>{const P=k.target;[...d.branches].some($=>$.contains(P))||(o==null||o(k),i==null||i(k),k.defaultPrevented||l==null||l())},m);return oc(k=>{S===d.layers.size-1&&(n==null||n(k),!k.defaultPrevented&&l&&(k.preventDefault(),l()))},m),c.useEffect(()=>{if(f)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(nr=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(f)),d.layers.add(f),or(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=nr)}},[f,m,r,d]),c.useEffect(()=>()=>{f&&(d.layers.delete(f),d.layersWithOutsidePointerEventsDisabled.delete(f),or())},[f,d]),c.useEffect(()=>{const k=()=>p({});return document.addEventListener(is,k),()=>document.removeEventListener(is,k)},[]),e.jsx(K.div,{...u,ref:b,style:{pointerEvents:g?w?"auto":"none":void 0,...t.style},onFocusCapture:xe(t.onFocusCapture,E.onFocusCapture),onBlurCapture:xe(t.onBlurCapture,E.onBlurCapture),onPointerDownCapture:xe(t.onPointerDownCapture,C.onPointerDownCapture)})});Xa.displayName=ic;var dc="DismissableLayerBranch",uc=c.forwardRef((t,s)=>{const r=c.useContext(Qa),n=c.useRef(null),a=Te(s,n);return c.useEffect(()=>{const o=n.current;if(o)return r.branches.add(o),()=>{r.branches.delete(o)}},[r.branches]),e.jsx(K.div,{...t,ref:a})});uc.displayName=dc;function mc(t,s=globalThis==null?void 0:globalThis.document){const r=Qe(t),n=c.useRef(!1),a=c.useRef(()=>{});return c.useEffect(()=>{const o=l=>{if(l.target&&!n.current){let u=function(){Za(lc,r,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(s.removeEventListener("click",a.current),a.current=u,s.addEventListener("click",a.current,{once:!0})):u()}else s.removeEventListener("click",a.current);n.current=!1},i=window.setTimeout(()=>{s.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(i),s.removeEventListener("pointerdown",o),s.removeEventListener("click",a.current)}},[s,r]),{onPointerDownCapture:()=>n.current=!0}}function hc(t,s=globalThis==null?void 0:globalThis.document){const r=Qe(t),n=c.useRef(!1);return c.useEffect(()=>{const a=o=>{o.target&&!n.current&&Za(cc,r,{originalEvent:o},{discrete:!1})};return s.addEventListener("focusin",a),()=>s.removeEventListener("focusin",a)},[s,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function or(){const t=new CustomEvent(is);document.dispatchEvent(t)}function Za(t,s,r,{discrete:n}){const a=r.originalEvent.target,o=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});s&&a.addEventListener(t,s,{once:!0}),n?nc(a,o):a.dispatchEvent(o)}var Ft="focusScope.autoFocusOnMount",Lt="focusScope.autoFocusOnUnmount",ir={bubbles:!1,cancelable:!0},fc="FocusScope",Ja=c.forwardRef((t,s)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...i}=t,[l,u]=c.useState(null),d=Qe(a),f=Qe(o),h=c.useRef(null),m=Te(s,x=>u(x)),p=c.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;c.useEffect(()=>{if(n){let x=function(g){if(p.paused||!l)return;const w=g.target;l.contains(w)?h.current=w:ue(h.current,{select:!0})},v=function(g){if(p.paused||!l)return;const w=g.relatedTarget;w!==null&&(l.contains(w)||ue(h.current,{select:!0}))},y=function(g){if(document.activeElement===document.body)for(const C of g)C.removedNodes.length>0&&ue(l)};document.addEventListener("focusin",x),document.addEventListener("focusout",v);const S=new MutationObserver(y);return l&&S.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",v),S.disconnect()}}},[n,l,p.paused]),c.useEffect(()=>{if(l){cr.add(p);const x=document.activeElement;if(!l.contains(x)){const y=new CustomEvent(Ft,ir);l.addEventListener(Ft,d),l.dispatchEvent(y),y.defaultPrevented||(pc(yc(en(l)),{select:!0}),document.activeElement===x&&ue(l))}return()=>{l.removeEventListener(Ft,d),setTimeout(()=>{const y=new CustomEvent(Lt,ir);l.addEventListener(Lt,f),l.dispatchEvent(y),y.defaultPrevented||ue(x??document.body,{select:!0}),l.removeEventListener(Lt,f),cr.remove(p)},0)}}},[l,d,f,p]);const b=c.useCallback(x=>{if(!r&&!n||p.paused)return;const v=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,y=document.activeElement;if(v&&y){const S=x.currentTarget,[g,w]=gc(S);g&&w?!x.shiftKey&&y===w?(x.preventDefault(),r&&ue(g,{select:!0})):x.shiftKey&&y===g&&(x.preventDefault(),r&&ue(w,{select:!0})):y===S&&x.preventDefault()}},[r,n,p.paused]);return e.jsx(K.div,{tabIndex:-1,...i,ref:m,onKeyDown:b})});Ja.displayName=fc;function pc(t,{select:s=!1}={}){const r=document.activeElement;for(const n of t)if(ue(n,{select:s}),document.activeElement!==r)return}function gc(t){const s=en(t),r=lr(s,t),n=lr(s.reverse(),t);return[r,n]}function en(t){const s=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)s.push(r.currentNode);return s}function lr(t,s){for(const r of t)if(!xc(r,{upTo:s}))return r}function xc(t,{upTo:s}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(s!==void 0&&t===s)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function vc(t){return t instanceof HTMLInputElement&&"select"in t}function ue(t,{select:s=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&vc(t)&&s&&t.select()}}var cr=bc();function bc(){let t=[];return{add(s){const r=t[0];s!==r&&(r==null||r.pause()),t=dr(t,s),t.unshift(s)},remove(s){var r;t=dr(t,s),(r=t[0])==null||r.resume()}}}function dr(t,s){const r=[...t],n=r.indexOf(s);return n!==-1&&r.splice(n,1),r}function yc(t){return t.filter(s=>s.tagName!=="A")}var wc="Portal",tn=c.forwardRef((t,s)=>{var l;const{container:r,...n}=t,[a,o]=c.useState(!1);Ye(()=>o(!0),[]);const i=r||a&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return i?eo.createPortal(e.jsx(K.div,{...n,ref:s}),i):null});tn.displayName=wc;function jc(t,s){return c.useReducer((r,n)=>s[r][n]??r,t)}var St=t=>{const{present:s,children:r}=t,n=Nc(s),a=typeof r=="function"?r({present:n.isPresent}):c.Children.only(r),o=Te(n.ref,Cc(a));return typeof r=="function"||n.isPresent?c.cloneElement(a,{ref:o}):null};St.displayName="Presence";function Nc(t){const[s,r]=c.useState(),n=c.useRef(null),a=c.useRef(t),o=c.useRef("none"),i=t?"mounted":"unmounted",[l,u]=jc(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return c.useEffect(()=>{const d=nt(n.current);o.current=l==="mounted"?d:"none"},[l]),Ye(()=>{const d=n.current,f=a.current;if(f!==t){const m=o.current,p=nt(d);t?u("MOUNT"):p==="none"||(d==null?void 0:d.display)==="none"?u("UNMOUNT"):u(f&&m!==p?"ANIMATION_OUT":"UNMOUNT"),a.current=t}},[t,u]),Ye(()=>{if(s){let d;const f=s.ownerDocument.defaultView??window,h=p=>{const x=nt(n.current).includes(CSS.escape(p.animationName));if(p.target===s&&x&&(u("ANIMATION_END"),!a.current)){const v=s.style.animationFillMode;s.style.animationFillMode="forwards",d=f.setTimeout(()=>{s.style.animationFillMode==="forwards"&&(s.style.animationFillMode=v)})}},m=p=>{p.target===s&&(o.current=nt(n.current))};return s.addEventListener("animationstart",m),s.addEventListener("animationcancel",h),s.addEventListener("animationend",h),()=>{f.clearTimeout(d),s.removeEventListener("animationstart",m),s.removeEventListener("animationcancel",h),s.removeEventListener("animationend",h)}}else u("ANIMATION_END")},[s,u]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:c.useCallback(d=>{n.current=d?getComputedStyle(d):null,r(d)},[])}}function nt(t){return(t==null?void 0:t.animationName)||"none"}function Cc(t){var n,a;let s=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=s&&"isReactWarning"in s&&s.isReactWarning;return r?t.ref:(s=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var zt=0;function Sc(){c.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??ur()),document.body.insertAdjacentElement("beforeend",t[1]??ur()),zt++,()=>{zt===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(s=>s.remove()),zt--}},[])}function ur(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var sn=So(),Ut=function(){},Et=c.forwardRef(function(t,s){var r=c.useRef(null),n=c.useState({onScrollCapture:Ut,onWheelCapture:Ut,onTouchMoveCapture:Ut}),a=n[0],o=n[1],i=t.forwardProps,l=t.children,u=t.className,d=t.removeScrollBar,f=t.enabled,h=t.shards,m=t.sideCar,p=t.noRelative,b=t.noIsolation,x=t.inert,v=t.allowPinchZoom,y=t.as,S=y===void 0?"div":y,g=t.gapMode,w=Eo(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),C=m,E=ko([r,s]),k=Me(Me({},w),a);return c.createElement(c.Fragment,null,f&&c.createElement(C,{sideCar:sn,removeScrollBar:d,shards:h,noRelative:p,noIsolation:b,inert:x,setCallbacks:o,allowPinchZoom:!!v,lockRef:r,gapMode:g}),i?c.cloneElement(c.Children.only(l),Me(Me({},k),{ref:E})):c.createElement(S,Me({},k,{className:u,ref:E}),l))});Et.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Et.classNames={fullWidth:Po,zeroRight:_o};var ls=!1;if(typeof window<"u")try{var ot=Object.defineProperty({},"passive",{get:function(){return ls=!0,!0}});window.addEventListener("test",ot,ot),window.removeEventListener("test",ot,ot)}catch{ls=!1}var De=ls?{passive:!1}:!1,Ec=function(t){return t.tagName==="TEXTAREA"},rn=function(t,s){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[s]!=="hidden"&&!(r.overflowY===r.overflowX&&!Ec(t)&&r[s]==="visible")},kc=function(t){return rn(t,"overflowY")},Pc=function(t){return rn(t,"overflowX")},mr=function(t,s){var r=s.ownerDocument,n=s;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=an(t,n);if(a){var o=nn(t,n),i=o[1],l=o[2];if(i>l)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},_c=function(t){var s=t.scrollTop,r=t.scrollHeight,n=t.clientHeight;return[s,r,n]},Tc=function(t){var s=t.scrollLeft,r=t.scrollWidth,n=t.clientWidth;return[s,r,n]},an=function(t,s){return t==="v"?kc(s):Pc(s)},nn=function(t,s){return t==="v"?_c(s):Tc(s)},Dc=function(t,s){return t==="h"&&s==="rtl"?-1:1},Rc=function(t,s,r,n,a){var o=Dc(t,window.getComputedStyle(s).direction),i=o*n,l=r.target,u=s.contains(l),d=!1,f=i>0,h=0,m=0;do{if(!l)break;var p=nn(t,l),b=p[0],x=p[1],v=p[2],y=x-v-o*b;(b||y)&&an(t,l)&&(h+=y,m+=b);var S=l.parentNode;l=S&&S.nodeType===Node.DOCUMENT_FRAGMENT_NODE?S.host:S}while(!u&&l!==document.body||u&&(s.contains(l)||s===l));return(f&&(Math.abs(h)<1||!a)||!f&&(Math.abs(m)<1||!a))&&(d=!0),d},it=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},hr=function(t){return[t.deltaX,t.deltaY]},fr=function(t){return t&&"current"in t?t.current:t},Mc=function(t,s){return t[0]===s[0]&&t[1]===s[1]},Ac=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},Ic=0,Re=[];function Oc(t){var s=c.useRef([]),r=c.useRef([0,0]),n=c.useRef(),a=c.useState(Ic++)[0],o=c.useState(To)[0],i=c.useRef(t);c.useEffect(function(){i.current=t},[t]),c.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(a));var x=Do([t.lockRef.current],(t.shards||[]).map(fr),!0).filter(Boolean);return x.forEach(function(v){return v.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),x.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(a))})}}},[t.inert,t.lockRef.current,t.shards]);var l=c.useCallback(function(x,v){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!i.current.allowPinchZoom;var y=it(x),S=r.current,g="deltaX"in x?x.deltaX:S[0]-y[0],w="deltaY"in x?x.deltaY:S[1]-y[1],C,E=x.target,k=Math.abs(g)>Math.abs(w)?"h":"v";if("touches"in x&&k==="h"&&E.type==="range")return!1;var P=mr(k,E);if(!P)return!0;if(P?C=k:(C=k==="v"?"h":"v",P=mr(k,E)),!P)return!1;if(!n.current&&"changedTouches"in x&&(g||w)&&(n.current=C),!C)return!0;var T=n.current||C;return Rc(T,v,x,T==="h"?g:w,!0)},[]),u=c.useCallback(function(x){var v=x;if(!(!Re.length||Re[Re.length-1]!==o)){var y="deltaY"in v?hr(v):it(v),S=s.current.filter(function(C){return C.name===v.type&&(C.target===v.target||v.target===C.shadowParent)&&Mc(C.delta,y)})[0];if(S&&S.should){v.cancelable&&v.preventDefault();return}if(!S){var g=(i.current.shards||[]).map(fr).filter(Boolean).filter(function(C){return C.contains(v.target)}),w=g.length>0?l(v,g[0]):!i.current.noIsolation;w&&v.cancelable&&v.preventDefault()}}},[]),d=c.useCallback(function(x,v,y,S){var g={name:x,delta:v,target:y,should:S,shadowParent:$c(y)};s.current.push(g),setTimeout(function(){s.current=s.current.filter(function(w){return w!==g})},1)},[]),f=c.useCallback(function(x){r.current=it(x),n.current=void 0},[]),h=c.useCallback(function(x){d(x.type,hr(x),x.target,l(x,t.lockRef.current))},[]),m=c.useCallback(function(x){d(x.type,it(x),x.target,l(x,t.lockRef.current))},[]);c.useEffect(function(){return Re.push(o),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:m}),document.addEventListener("wheel",u,De),document.addEventListener("touchmove",u,De),document.addEventListener("touchstart",f,De),function(){Re=Re.filter(function(x){return x!==o}),document.removeEventListener("wheel",u,De),document.removeEventListener("touchmove",u,De),document.removeEventListener("touchstart",f,De)}},[]);var p=t.removeScrollBar,b=t.inert;return c.createElement(c.Fragment,null,b?c.createElement(o,{styles:Ac(a)}):null,p?c.createElement(Ro,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function $c(t){for(var s=null;t!==null;)t instanceof ShadowRoot&&(s=t.host,t=t.host),t=t.parentNode;return s}const Fc=Mo(sn,Oc);var on=c.forwardRef(function(t,s){return c.createElement(Et,Me({},t,{ref:s,sideCar:Fc}))});on.classNames=Et.classNames;var kt="Dialog",[ln,fu]=Wl(kt),[Lc,se]=ln(kt),cn=t=>{const{__scopeDialog:s,children:r,open:n,defaultOpen:a,onOpenChange:o,modal:i=!0}=t,l=c.useRef(null),u=c.useRef(null),[d,f]=Ql({prop:n,defaultProp:a??!1,onChange:o,caller:kt});return e.jsx(Lc,{scope:s,triggerRef:l,contentRef:u,contentId:le(),titleId:le(),descriptionId:le(),open:d,onOpenChange:f,onOpenToggle:c.useCallback(()=>f(h=>!h),[f]),modal:i,children:r})};cn.displayName=kt;var dn="DialogTrigger",zc=c.forwardRef((t,s)=>{const{__scopeDialog:r,...n}=t,a=se(dn,r),o=Te(s,a.triggerRef);return e.jsx(K.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":_s(a.open),...n,ref:o,onClick:xe(t.onClick,a.onOpenToggle)})});zc.displayName=dn;var ks="DialogPortal",[Uc,un]=ln(ks,{forceMount:void 0}),mn=t=>{const{__scopeDialog:s,forceMount:r,children:n,container:a}=t,o=se(ks,s);return e.jsx(Uc,{scope:s,forceMount:r,children:c.Children.map(n,i=>e.jsx(St,{present:r||o.open,children:e.jsx(tn,{asChild:!0,container:a,children:i})}))})};mn.displayName=ks;var yt="DialogOverlay",hn=c.forwardRef((t,s)=>{const r=un(yt,t.__scopeDialog),{forceMount:n=r.forceMount,...a}=t,o=se(yt,t.__scopeDialog);return o.modal?e.jsx(St,{present:n||o.open,children:e.jsx(Vc,{...a,ref:s})}):null});hn.displayName=yt;var Bc=Ya("DialogOverlay.RemoveScroll"),Vc=c.forwardRef((t,s)=>{const{__scopeDialog:r,...n}=t,a=se(yt,r);return e.jsx(on,{as:Bc,allowPinchZoom:!0,shards:[a.contentRef],children:e.jsx(K.div,{"data-state":_s(a.open),...n,ref:s,style:{pointerEvents:"auto",...n.style}})})}),Ee="DialogContent",fn=c.forwardRef((t,s)=>{const r=un(Ee,t.__scopeDialog),{forceMount:n=r.forceMount,...a}=t,o=se(Ee,t.__scopeDialog);return e.jsx(St,{present:n||o.open,children:o.modal?e.jsx(Gc,{...a,ref:s}):e.jsx(Wc,{...a,ref:s})})});fn.displayName=Ee;var Gc=c.forwardRef((t,s)=>{const r=se(Ee,t.__scopeDialog),n=c.useRef(null),a=Te(s,r.contentRef,n);return c.useEffect(()=>{const o=n.current;if(o)return Qr(o)},[]),e.jsx(pn,{...t,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:xe(t.onCloseAutoFocus,o=>{var i;o.preventDefault(),(i=r.triggerRef.current)==null||i.focus()}),onPointerDownOutside:xe(t.onPointerDownOutside,o=>{const i=o.detail.originalEvent,l=i.button===0&&i.ctrlKey===!0;(i.button===2||l)&&o.preventDefault()}),onFocusOutside:xe(t.onFocusOutside,o=>o.preventDefault())})}),Wc=c.forwardRef((t,s)=>{const r=se(Ee,t.__scopeDialog),n=c.useRef(!1),a=c.useRef(!1);return e.jsx(pn,{...t,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var i,l;(i=t.onCloseAutoFocus)==null||i.call(t,o),o.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),o.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:o=>{var u,d;(u=t.onInteractOutside)==null||u.call(t,o),o.defaultPrevented||(n.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=o.target;((d=r.triggerRef.current)==null?void 0:d.contains(i))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),pn=c.forwardRef((t,s)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:o,...i}=t,l=se(Ee,r),u=c.useRef(null),d=Te(s,u);return Sc(),e.jsxs(e.Fragment,{children:[e.jsx(Ja,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:o,children:e.jsx(Xa,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":_s(l.open),...i,ref:d,onDismiss:()=>l.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(Yc,{titleId:l.titleId}),e.jsx(Xc,{contentRef:u,descriptionId:l.descriptionId})]})]})}),Ps="DialogTitle",Kc=c.forwardRef((t,s)=>{const{__scopeDialog:r,...n}=t,a=se(Ps,r);return e.jsx(K.h2,{id:a.titleId,...n,ref:s})});Kc.displayName=Ps;var gn="DialogDescription",qc=c.forwardRef((t,s)=>{const{__scopeDialog:r,...n}=t,a=se(gn,r);return e.jsx(K.p,{id:a.descriptionId,...n,ref:s})});qc.displayName=gn;var xn="DialogClose",Hc=c.forwardRef((t,s)=>{const{__scopeDialog:r,...n}=t,a=se(xn,r);return e.jsx(K.button,{type:"button",...n,ref:s,onClick:xe(t.onClick,()=>a.onOpenChange(!1))})});Hc.displayName=xn;function _s(t){return t?"open":"closed"}var vn="DialogTitleWarning",[pu,bn]=Gl(vn,{contentName:Ee,titleName:Ps,docsSlug:"dialog"}),Yc=({titleId:t})=>{const s=bn(vn),r=`\`${s.contentName}\` requires a \`${s.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${s.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${s.docsSlug}`;return c.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},Qc="DialogDescriptionWarning",Xc=({contentRef:t,descriptionId:s})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${bn(Qc).contentName}}.`;return c.useEffect(()=>{var o;const a=(o=t.current)==null?void 0:o.getAttribute("aria-describedby");s&&a&&(document.getElementById(s)||console.warn(n))},[n,t,s]),null},Zc=cn,Jc=mn,ed=hn,td=fn,We='[cmdk-group=""]',Bt='[cmdk-group-items=""]',sd='[cmdk-group-heading=""]',yn='[cmdk-item=""]',pr=`${yn}:not([aria-disabled="true"])`,cs="cmdk-item-select",Ae="data-value",rd=(t,s,r)=>Vl(t,s,r),wn=c.createContext(void 0),tt=()=>c.useContext(wn),jn=c.createContext(void 0),Ts=()=>c.useContext(jn),Nn=c.createContext(void 0),Cn=c.forwardRef((t,s)=>{let r=Ie(()=>{var N,D;return{search:"",value:(D=(N=t.value)!=null?N:t.defaultValue)!=null?D:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),n=Ie(()=>new Set),a=Ie(()=>new Map),o=Ie(()=>new Map),i=Ie(()=>new Set),l=Sn(t),{label:u,children:d,value:f,onValueChange:h,filter:m,shouldFilter:p,loop:b,disablePointerSelection:x=!1,vimBindings:v=!0,...y}=t,S=le(),g=le(),w=le(),C=c.useRef(null),E=fd();ke(()=>{if(f!==void 0){let N=f.trim();r.current.value=N,k.emit()}},[f]),ke(()=>{E(6,q)},[]);let k=c.useMemo(()=>({subscribe:N=>(i.current.add(N),()=>i.current.delete(N)),snapshot:()=>r.current,setState:(N,D,A)=>{var _,L,U,ee;if(!Object.is(r.current[N],D)){if(r.current[N]=D,N==="search")R(),$(),E(1,F);else if(N==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let Y=document.getElementById(w);Y?Y.focus():(_=document.getElementById(S))==null||_.focus()}if(E(7,()=>{var Y;r.current.selectedItemId=(Y=oe())==null?void 0:Y.id,k.emit()}),A||E(5,q),((L=l.current)==null?void 0:L.value)!==void 0){let Y=D??"";(ee=(U=l.current).onValueChange)==null||ee.call(U,Y);return}}k.emit()}},emit:()=>{i.current.forEach(N=>N())}}),[]),P=c.useMemo(()=>({value:(N,D,A)=>{var _;D!==((_=o.current.get(N))==null?void 0:_.value)&&(o.current.set(N,{value:D,keywords:A}),r.current.filtered.items.set(N,T(D,A)),E(2,()=>{$(),k.emit()}))},item:(N,D)=>(n.current.add(N),D&&(a.current.has(D)?a.current.get(D).add(N):a.current.set(D,new Set([N]))),E(3,()=>{R(),$(),r.current.value||F(),k.emit()}),()=>{o.current.delete(N),n.current.delete(N),r.current.filtered.items.delete(N);let A=oe();E(4,()=>{R(),(A==null?void 0:A.getAttribute("id"))===N&&F(),k.emit()})}),group:N=>(a.current.has(N)||a.current.set(N,new Set),()=>{o.current.delete(N),a.current.delete(N)}),filter:()=>l.current.shouldFilter,label:u||t["aria-label"],getDisablePointerSelection:()=>l.current.disablePointerSelection,listId:S,inputId:w,labelId:g,listInnerRef:C}),[]);function T(N,D){var A,_;let L=(_=(A=l.current)==null?void 0:A.filter)!=null?_:rd;return N?L(N,r.current.search,D):0}function $(){if(!r.current.search||l.current.shouldFilter===!1)return;let N=r.current.filtered.items,D=[];r.current.filtered.groups.forEach(_=>{let L=a.current.get(_),U=0;L.forEach(ee=>{let Y=N.get(ee);U=Math.max(Y,U)}),D.push([_,U])});let A=C.current;de().sort((_,L)=>{var U,ee;let Y=_.getAttribute("id"),st=L.getAttribute("id");return((U=N.get(st))!=null?U:0)-((ee=N.get(Y))!=null?ee:0)}).forEach(_=>{let L=_.closest(Bt);L?L.appendChild(_.parentElement===L?_:_.closest(`${Bt} > *`)):A.appendChild(_.parentElement===A?_:_.closest(`${Bt} > *`))}),D.sort((_,L)=>L[1]-_[1]).forEach(_=>{var L;let U=(L=C.current)==null?void 0:L.querySelector(`${We}[${Ae}="${encodeURIComponent(_[0])}"]`);U==null||U.parentElement.appendChild(U)})}function F(){let N=de().find(A=>A.getAttribute("aria-disabled")!=="true"),D=N==null?void 0:N.getAttribute(Ae);k.setState("value",D||void 0)}function R(){var N,D,A,_;if(!r.current.search||l.current.shouldFilter===!1){r.current.filtered.count=n.current.size;return}r.current.filtered.groups=new Set;let L=0;for(let U of n.current){let ee=(D=(N=o.current.get(U))==null?void 0:N.value)!=null?D:"",Y=(_=(A=o.current.get(U))==null?void 0:A.keywords)!=null?_:[],st=T(ee,Y);r.current.filtered.items.set(U,st),st>0&&L++}for(let[U,ee]of a.current)for(let Y of ee)if(r.current.filtered.items.get(Y)>0){r.current.filtered.groups.add(U);break}r.current.filtered.count=L}function q(){var N,D,A;let _=oe();_&&(((N=_.parentElement)==null?void 0:N.firstChild)===_&&((A=(D=_.closest(We))==null?void 0:D.querySelector(sd))==null||A.scrollIntoView({block:"nearest"})),_.scrollIntoView({block:"nearest"}))}function oe(){var N;return(N=C.current)==null?void 0:N.querySelector(`${yn}[aria-selected="true"]`)}function de(){var N;return Array.from(((N=C.current)==null?void 0:N.querySelectorAll(pr))||[])}function _t(N){let D=de()[N];D&&k.setState("value",D.getAttribute(Ae))}function Tt(N){var D;let A=oe(),_=de(),L=_.findIndex(ee=>ee===A),U=_[L+N];(D=l.current)!=null&&D.loop&&(U=L+N<0?_[_.length-1]:L+N===_.length?_[0]:_[L+N]),U&&k.setState("value",U.getAttribute(Ae))}function Ds(N){let D=oe(),A=D==null?void 0:D.closest(We),_;for(;A&&!_;)A=N>0?md(A,We):hd(A,We),_=A==null?void 0:A.querySelector(pr);_?k.setState("value",_.getAttribute(Ae)):Tt(N)}let Rs=()=>_t(de().length-1),Ms=N=>{N.preventDefault(),N.metaKey?Rs():N.altKey?Ds(1):Tt(1)},As=N=>{N.preventDefault(),N.metaKey?_t(0):N.altKey?Ds(-1):Tt(-1)};return c.createElement(K.div,{ref:s,tabIndex:-1,...y,"cmdk-root":"",onKeyDown:N=>{var D;(D=y.onKeyDown)==null||D.call(y,N);let A=N.nativeEvent.isComposing||N.keyCode===229;if(!(N.defaultPrevented||A))switch(N.key){case"n":case"j":{v&&N.ctrlKey&&Ms(N);break}case"ArrowDown":{Ms(N);break}case"p":case"k":{v&&N.ctrlKey&&As(N);break}case"ArrowUp":{As(N);break}case"Home":{N.preventDefault(),_t(0);break}case"End":{N.preventDefault(),Rs();break}case"Enter":{N.preventDefault();let _=oe();if(_){let L=new Event(cs);_.dispatchEvent(L)}}}}},c.createElement("label",{"cmdk-label":"",htmlFor:P.inputId,id:P.labelId,style:gd},u),Pt(t,N=>c.createElement(jn.Provider,{value:k},c.createElement(wn.Provider,{value:P},N))))}),ad=c.forwardRef((t,s)=>{var r,n;let a=le(),o=c.useRef(null),i=c.useContext(Nn),l=tt(),u=Sn(t),d=(n=(r=u.current)==null?void 0:r.forceMount)!=null?n:i==null?void 0:i.forceMount;ke(()=>{if(!d)return l.item(a,i==null?void 0:i.id)},[d]);let f=En(a,o,[t.value,t.children,o],t.keywords),h=Ts(),m=be(E=>E.value&&E.value===f.current),p=be(E=>d||l.filter()===!1?!0:E.search?E.filtered.items.get(a)>0:!0);c.useEffect(()=>{let E=o.current;if(!(!E||t.disabled))return E.addEventListener(cs,b),()=>E.removeEventListener(cs,b)},[p,t.onSelect,t.disabled]);function b(){var E,k;x(),(k=(E=u.current).onSelect)==null||k.call(E,f.current)}function x(){h.setState("value",f.current,!0)}if(!p)return null;let{disabled:v,value:y,onSelect:S,forceMount:g,keywords:w,...C}=t;return c.createElement(K.div,{ref:Se(o,s),...C,id:a,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!m,"data-disabled":!!v,"data-selected":!!m,onPointerMove:v||l.getDisablePointerSelection()?void 0:x,onClick:v?void 0:b},t.children)}),nd=c.forwardRef((t,s)=>{let{heading:r,children:n,forceMount:a,...o}=t,i=le(),l=c.useRef(null),u=c.useRef(null),d=le(),f=tt(),h=be(p=>a||f.filter()===!1?!0:p.search?p.filtered.groups.has(i):!0);ke(()=>f.group(i),[]),En(i,l,[t.value,t.heading,u]);let m=c.useMemo(()=>({id:i,forceMount:a}),[a]);return c.createElement(K.div,{ref:Se(l,s),...o,"cmdk-group":"",role:"presentation",hidden:h?void 0:!0},r&&c.createElement("div",{ref:u,"cmdk-group-heading":"","aria-hidden":!0,id:d},r),Pt(t,p=>c.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?d:void 0},c.createElement(Nn.Provider,{value:m},p))))}),od=c.forwardRef((t,s)=>{let{alwaysRender:r,...n}=t,a=c.useRef(null),o=be(i=>!i.search);return!r&&!o?null:c.createElement(K.div,{ref:Se(a,s),...n,"cmdk-separator":"",role:"separator"})}),id=c.forwardRef((t,s)=>{let{onValueChange:r,...n}=t,a=t.value!=null,o=Ts(),i=be(d=>d.search),l=be(d=>d.selectedItemId),u=tt();return c.useEffect(()=>{t.value!=null&&o.setState("search",t.value)},[t.value]),c.createElement(K.input,{ref:s,...n,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":u.listId,"aria-labelledby":u.labelId,"aria-activedescendant":l,id:u.inputId,type:"text",value:a?t.value:i,onChange:d=>{a||o.setState("search",d.target.value),r==null||r(d.target.value)}})}),ld=c.forwardRef((t,s)=>{let{children:r,label:n="Suggestions",...a}=t,o=c.useRef(null),i=c.useRef(null),l=be(d=>d.selectedItemId),u=tt();return c.useEffect(()=>{if(i.current&&o.current){let d=i.current,f=o.current,h,m=new ResizeObserver(()=>{h=requestAnimationFrame(()=>{let p=d.offsetHeight;f.style.setProperty("--cmdk-list-height",p.toFixed(1)+"px")})});return m.observe(d),()=>{cancelAnimationFrame(h),m.unobserve(d)}}},[]),c.createElement(K.div,{ref:Se(o,s),...a,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":l,"aria-label":n,id:u.listId},Pt(t,d=>c.createElement("div",{ref:Se(i,u.listInnerRef),"cmdk-list-sizer":""},d)))}),cd=c.forwardRef((t,s)=>{let{open:r,onOpenChange:n,overlayClassName:a,contentClassName:o,container:i,...l}=t;return c.createElement(Zc,{open:r,onOpenChange:n},c.createElement(Jc,{container:i},c.createElement(ed,{"cmdk-overlay":"",className:a}),c.createElement(td,{"aria-label":t.label,"cmdk-dialog":"",className:o},c.createElement(Cn,{ref:s,...l}))))}),dd=c.forwardRef((t,s)=>be(r=>r.filtered.count===0)?c.createElement(K.div,{ref:s,...t,"cmdk-empty":"",role:"presentation"}):null),ud=c.forwardRef((t,s)=>{let{progress:r,children:n,label:a="Loading...",...o}=t;return c.createElement(K.div,{ref:s,...o,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},Pt(t,i=>c.createElement("div",{"aria-hidden":!0},i)))}),J=Object.assign(Cn,{List:ld,Item:ad,Input:id,Group:nd,Separator:od,Dialog:cd,Empty:dd,Loading:ud});function md(t,s){let r=t.nextElementSibling;for(;r;){if(r.matches(s))return r;r=r.nextElementSibling}}function hd(t,s){let r=t.previousElementSibling;for(;r;){if(r.matches(s))return r;r=r.previousElementSibling}}function Sn(t){let s=c.useRef(t);return ke(()=>{s.current=t}),s}var ke=typeof window>"u"?c.useEffect:c.useLayoutEffect;function Ie(t){let s=c.useRef();return s.current===void 0&&(s.current=t()),s}function be(t){let s=Ts(),r=()=>t(s.snapshot());return c.useSyncExternalStore(s.subscribe,r,r)}function En(t,s,r,n=[]){let a=c.useRef(),o=tt();return ke(()=>{var i;let l=(()=>{var d;for(let f of r){if(typeof f=="string")return f.trim();if(typeof f=="object"&&"current"in f)return f.current?(d=f.current.textContent)==null?void 0:d.trim():a.current}})(),u=n.map(d=>d.trim());o.value(t,l,u),(i=s.current)==null||i.setAttribute(Ae,l),a.current=l}),a}var fd=()=>{let[t,s]=c.useState(),r=Ie(()=>new Map);return ke(()=>{r.current.forEach(n=>n()),r.current=new Map},[t]),(n,a)=>{r.current.set(n,a),s({})}};function pd(t){let s=t.type;return typeof s=="function"?s(t.props):"render"in s?s.render(t.props):t}function Pt({asChild:t,children:s},r){return t&&c.isValidElement(s)?c.cloneElement(pd(s),{ref:s.ref},r(s.props.children)):r(s)}var gd={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const kn=c.forwardRef(({className:t,...s},r)=>e.jsx(J,{ref:r,className:W("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...s}));kn.displayName=J.displayName;const Pn=c.forwardRef(({className:t,...s},r)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(hs,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(J.Input,{ref:r,className:W("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...s})]}));Pn.displayName=J.Input.displayName;const _n=c.forwardRef(({className:t,...s},r)=>e.jsx(J.List,{ref:r,className:W("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...s}));_n.displayName=J.List.displayName;const Tn=c.forwardRef(({className:t,...s},r)=>e.jsx(J.Empty,{ref:r,className:W("py-6 text-center text-sm",t),...s}));Tn.displayName=J.Empty.displayName;const Dn=c.forwardRef(({className:t,...s},r)=>e.jsx(J.Group,{ref:r,className:W("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...s}));Dn.displayName=J.Group.displayName;const xd=c.forwardRef(({className:t,...s},r)=>e.jsx(J.Separator,{ref:r,className:W("-mx-1 h-px bg-border",t),...s}));xd.displayName=J.Separator.displayName;const Rn=c.forwardRef(({className:t,...s},r)=>e.jsx(J.Item,{ref:r,className:W("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50",t),...s}));Rn.displayName=J.Item.displayName;const vd=({tripId:t,selectedMembers:s,onMembersChange:r,isSingleTask:n})=>{const{tripMembers:a,loading:o}=ca(t),i=Array.isArray(a)?a:[],[l,u]=Gt.useState(!1);Gt.useEffect(()=>{!n&&i.length>0&&s.length===0&&r(i.map(m=>m.id))},[n,i,s.length,r]);const d=m=>{n?s.includes(m)?r(s.filter(p=>p!==m)):r([...s,m]):s.includes(m)?r(s.filter(p=>p!==m)):r([...s,m])},f=i.filter(m=>s.includes(m.id)).map(m=>m.name).join(", "),h=s.length===0?n?"Assign to someone":"Assign to group":s.length===i.length&&!n?"Everyone":f;return o?e.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[e.jsx(ve,{size:16}),e.jsx("span",{children:"Loading members..."})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-300",children:n?"Assign to:":"Group members:"}),!n&&e.jsx(G,{type:"button",variant:"ghost",size:"sm",onClick:()=>{const m=s.length===i.length;r(m?[]:i.map(p=>p.id))},className:"text-xs text-gray-400 hover:text-white",children:s.length===i.length?"Deselect All":"Select All"})]}),e.jsxs(Ka,{open:l,onOpenChange:u,children:[e.jsx(qa,{asChild:!0,children:e.jsxs(G,{variant:"outline",role:"combobox","aria-expanded":l,className:"w-full justify-between bg-gray-800 border-gray-600 text-white hover:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[n?e.jsx(Nt,{size:16,className:"text-gray-400 shrink-0"}):e.jsx(ve,{size:16,className:"text-gray-400 shrink-0"}),e.jsx("span",{className:"truncate",children:h})]}),e.jsx(Or,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Es,{className:"w-full p-0 bg-gray-800 border-gray-600 z-50",children:e.jsxs(kn,{className:"bg-gray-800",children:[e.jsx(Pn,{placeholder:"Search members...",className:"bg-gray-800 border-gray-600 text-white"}),e.jsxs(_n,{children:[e.jsx(Tn,{children:"No members found."}),e.jsx(Dn,{children:i.map(m=>e.jsxs(Rn,{onSelect:()=>d(m.id),className:"flex items-center gap-3 cursor-pointer hover:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsxs(ht,{className:"w-6 h-6",children:[e.jsx(ft,{src:m.avatar}),e.jsx(pt,{className:"text-xs",children:m.name.charAt(0).toUpperCase()})]}),e.jsx("span",{className:"text-white",children:m.name})]}),e.jsx(gs,{className:`h-4 w-4 ${s.includes(m.id)?"opacity-100":"opacity-0"}`})]},m.id))})]})]})})]}),s.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:i.filter(m=>s.includes(m.id)).map(m=>e.jsx(He,{variant:"secondary",className:"text-xs bg-gray-700 text-gray-200",children:m.name},m.id))})]})},bd=({tripId:t,onClose:s})=>{const[r,n]=c.useState(""),[a,o]=c.useState(""),[i,l]=c.useState(),[u,d]=c.useState("solo"),[f,h]=c.useState(!1),[m,p]=c.useState([]),{createTaskMutation:b}=fa(t),{accentColors:x}=us(),v=y=>{y.preventDefault(),r.trim()&&b.mutate({title:r.trim(),description:a.trim()||void 0,due_at:i==null?void 0:i.toISOString(),is_poll:u==="poll",assignedTo:m},{onSuccess:()=>{n(""),o(""),l(void 0),d("solo"),p([]),s()},onError:S=>{console.error("Task creation failed:",S)}})};return e.jsx(Ur,{open:!0,onOpenChange:s,children:e.jsxs(Br,{className:"sm:max-w-md bg-gray-900 border-gray-700",children:[e.jsx(Vr,{children:e.jsx(Gr,{className:"text-white",children:"Create New Task"})}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"title",className:"text-gray-300",children:"Task Title"}),e.jsx(Oe,{id:"title",value:r,onChange:y=>n(y.target.value),placeholder:"What needs to be done?",maxLength:140,className:"bg-gray-800 border-gray-600 text-white",autoFocus:!0}),e.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[r.length,"/140"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"description",className:"text-gray-300",children:"Description (Optional)"}),e.jsx(Rr,{id:"description",value:a,onChange:y=>o(y.target.value),placeholder:"Add more details...",className:"bg-gray-800 border-gray-600 text-white min-h-[80px]"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{className:"text-gray-300",children:"Due Date (Optional)"}),e.jsxs(Ka,{open:f,onOpenChange:h,children:[e.jsx(qa,{asChild:!0,children:e.jsxs(G,{variant:"outline",className:"w-full justify-start text-left bg-gray-800 border-gray-600 text-white hover:bg-gray-700",children:[e.jsx(Ue,{size:16,className:"mr-2"}),i?qe(i,"PPP"):"Set due date"]})}),e.jsx(Es,{className:"w-auto p-0 bg-gray-800 border-gray-600",children:e.jsx(Jr,{mode:"single",selected:i,onSelect:y=>{l(y),h(!1)},disabled:y=>y<new Date,className:"text-white"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(H,{className:"text-gray-300",children:"Task Type"}),e.jsxs(Aa,{value:u,onValueChange:y=>d(y),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ns,{value:"solo",id:"solo"}),e.jsxs(H,{htmlFor:"solo",className:"flex items-center gap-2 text-gray-300",children:[e.jsx(Nt,{size:16}),"Single Task - Assign to specific people"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ns,{value:"poll",id:"poll"}),e.jsxs(H,{htmlFor:"poll",className:"flex items-center gap-2 text-gray-300",children:[e.jsx(ve,{size:16}),"Group Task - Everyone needs to complete this"]})]})]})]}),e.jsx(vd,{tripId:t,selectedMembers:m,onMembersChange:p,isSingleTask:u==="solo"}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(G,{type:"button",variant:"outline",onClick:s,className:"flex-1 border-gray-600 text-gray-300 hover:bg-gray-700",children:"Cancel"}),e.jsx(G,{type:"submit",disabled:!r.trim()||b.isPending,className:`flex-1 bg-gradient-to-r ${x.gradient} hover:opacity-90`,children:b.isPending?"Creating...":"Create Task"})]})]})]})})},yd=()=>{const[t,s]=c.useState("all"),[r,n]=c.useState(),[a,o]=c.useState({}),[i,l]=c.useState("dueDate"),u=c.useCallback(h=>{let m=h.filter(p=>{var x,v,y,S,g;const b=p.is_poll?(((x=p.task_status)==null?void 0:x.filter(w=>w.completed).length)||0)>=(((v=p.task_status)==null?void 0:v.length)||1):((S=(y=p.task_status)==null?void 0:y[0])==null?void 0:S.completed)||!1;if(t==="open"&&b||t==="completed"&&!b||r&&!((g=p.task_status)==null?void 0:g.some(C=>C.user_id===r)))return!1;if(p.due_at){const w=new Date(p.due_at);if(a.start&&w<a.start||a.end&&w>a.end)return!1}return!0});return m.sort((p,b)=>{switch(i){case"dueDate":return p.due_at?b.due_at?new Date(p.due_at).getTime()-new Date(b.due_at).getTime():-1:1;case"created":return new Date(b.created_at).getTime()-new Date(p.created_at).getTime();case"priority":const x=p.due_at?1:0;return(b.due_at?1:0)-x;default:return 0}}),m},[t,r,a,i]),d=c.useCallback(()=>{s("all"),n(void 0),o({}),l("dueDate")},[]),f=c.useMemo(()=>t!=="all"||r!==void 0||a.start!==void 0||a.end!==void 0,[t,r,a]);return{status:t,assignee:r,dateRange:a,sortBy:i,hasActiveFilters:f,setStatus:s,setAssignee:n,setDateRange:o,setSortBy:l,applyFilters:u,clearFilters:d}},gu=({tripId:t})=>{const[s,r]=c.useState(!1),[n,a]=c.useState(!1),{accentColors:o}=us(),{data:i,isLoading:l}=tl(t),{status:u,sortBy:d,setStatus:f,setSortBy:h,applyFilters:m,hasActiveFilters:p,clearFilters:b}=yd(),x=[{id:"task-1",trip_id:t,title:"Make sure your visa and passport documents are handled at least one month prior",description:"Verify all travel documents are valid and up to date",due_at:new Date(Date.now()+30*24*60*60*1e3).toISOString(),is_poll:!1,task_status:[{task_id:"task-1",completed:!1,user_id:"user1"}],creator_id:"trip-organizer",created_by:"Trip Organizer",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"task-2",trip_id:t,title:"Jimmy to purchase alcohol for the house while Sam gets food",description:"Coordinate house supplies for the trip",due_at:new Date(Date.now()+7*24*60*60*1e3).toISOString(),is_poll:!1,task_status:[{task_id:"task-2",completed:!0,user_id:"jimmy"}],creator_id:"marcus",created_by:"Marcus",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"task-3",trip_id:t,title:"Making sure all clothes are packed before next destination",description:"Pack weather-appropriate clothing for all activities",due_at:new Date(Date.now()+3*24*60*60*1e3).toISOString(),is_poll:!1,task_status:[{task_id:"task-3",completed:!1,user_id:"user1"}],creator_id:"sarah",created_by:"Sarah",created_at:new Date().toISOString(),updated_at:new Date().toISOString()}],v=i&&i.length>0?i:x,y=m(v),S=(y==null?void 0:y.filter(w=>{var C,E,k,P;if(w.is_poll){const T=((C=w.task_status)==null?void 0:C.filter(F=>F.completed).length)||0,$=((E=w.task_status)==null?void 0:E.length)||1;return T<$}return!((P=(k=w.task_status)==null?void 0:k[0])!=null&&P.completed)}))||[],g=(y==null?void 0:y.filter(w=>{var C,E,k,P;if(w.is_poll){const T=((C=w.task_status)==null?void 0:C.filter(F=>F.completed).length)||0,$=((E=w.task_status)==null?void 0:E.length)||1;return T>=$}return(P=(k=w.task_status)==null?void 0:k[0])==null?void 0:P.completed}))||[];return l?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Tasks"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Keep track of everything that needs to get done"})]}),e.jsxs(G,{onClick:()=>r(!0),className:`bg-gradient-to-r ${o.gradient} hover:opacity-90`,children:[e.jsx(xs,{size:16,className:"mr-2"}),"Add Task"]})]}),e.jsx(ml,{status:u,sortBy:d,onStatusChange:f,onSortChange:h,hasActiveFilters:p,onClearFilters:b}),e.jsx(tr,{tasks:S,tripId:t,title:"To Do",emptyMessage:"All caught up! No pending tasks."}),g.length>0&&e.jsx(tr,{tasks:g,tripId:t,title:"Completed",showCompleted:n,onToggleCompleted:()=>a(!n)}),s&&e.jsx(bd,{tripId:t,onClose:()=>r(!1)})]})};class wd{static async getTripContext(s,r=!1){try{return r?this.getProTripContext(s):this.getConsumerTripContext(s)}catch(n){throw console.error("Error fetching trip context:",n),new Error("Failed to fetch trip context")}}static getConsumerTripContext(s){const r=vs(parseInt(s));if(!r)throw new Error("Trip not found");const n=ta(r),a=new Date().toISOString().split("T")[0];return{tripId:s,title:r.title,location:r.location,dateRange:r.dateRange,participants:r.participants.map(o=>({id:o.id.toString(),name:o.name,role:"participant"})),itinerary:n.itinerary.map((o,i)=>({id:i.toString(),title:`Day ${i+1}`,date:o.date,events:o.events})),accommodation:n.basecamp.name,currentDate:a,upcomingEvents:this.getUpcomingEvents(n.itinerary,a),recentUpdates:n.broadcasts.map((o,i)=>({id:i.toString(),type:"broadcast",message:o.content,timestamp:o.timestamp})),confirmationNumbers:{hotel:"HTL-"+Math.random().toString(36).substr(2,9),rental_car:"CAR-"+Math.random().toString(36).substr(2,9),flight:"FLT-"+Math.random().toString(36).substr(2,9)}}}static getProTripContext(s){const r=sa[s];if(!r)throw new Error("Pro trip not found");const n=new Date().toISOString().split("T")[0];return{tripId:s,title:r.title,location:r.location,dateRange:r.dateRange,participants:r.participants.map(a=>({id:a.id.toString(),name:a.name,role:a.role})),itinerary:(r.itinerary||[]).map((a,o)=>({id:o.toString(),title:`Day ${o+1}`,date:a.date,events:a.events})),accommodation:`${r.location} Accommodation`,currentDate:n,upcomingEvents:this.getUpcomingEvents(r.itinerary||[],n),recentUpdates:[{id:"1",type:"description",message:r.description,timestamp:n}],confirmationNumbers:{venue:"VEN-"+Math.random().toString(36).substr(2,9),transportation:"TRN-"+Math.random().toString(36).substr(2,9)}}}static getUpcomingEvents(s,r){return s.filter(n=>n.date>=r).flatMap(n=>{var a;return((a=n.events)==null?void 0:a.map(o=>({...o,date:n.date})))||[]}).slice(0,5)}static formatContextForAI(s){const r=s.participants.map(o=>o.name).join(", "),n=s.upcomingEvents.map(o=>`- ${o.title} at ${o.time} (${o.location})`).join(`
`),a=Object.entries(s.confirmationNumbers).map(([o,i])=>`- ${o.replace("_"," ")}: ${i}`).join(`
`);return`
TRIP INFORMATION:
- Trip: ${s.title}
- Location: ${s.location}
- Dates: ${s.dateRange}
- Participants: ${r}
- Accommodation: ${s.accommodation||"Not specified"}

TODAY'S DATE: ${s.currentDate}

UPCOMING EVENTS:
${n||"No upcoming events scheduled"}

CONFIRMATION NUMBERS:
${a}

RECENT UPDATES:
${s.recentUpdates.map(o=>`- ${o.message}`).join(`
`)}
    `.trim()}}class jd{static async getEnhancedTripContext(s,r=!1){try{let n;return r?n=await this.getProTripContext(s):n=await this.getConsumerTripContext(s),await this.enhanceWithContextualData(n)}catch(n){throw console.error("Error fetching enhanced trip context:",n),new Error("Failed to fetch enhanced trip context")}}static async getConsumerTripContext(s){const r=vs(parseInt(s));if(!r)throw new Error("Trip not found");const n=ta(r),a=new Date().toISOString().split("T")[0];return{tripId:s,title:r.title,location:r.location,dateRange:r.dateRange,participants:r.participants.map(o=>({id:o.id.toString(),name:o.name,role:"participant"})),itinerary:n.itinerary.map((o,i)=>({id:i.toString(),title:`Day ${i+1}`,date:o.date,events:o.events})),accommodation:typeof n.basecamp=="object"?{name:n.basecamp.name,address:n.basecamp.address,checkIn:"",checkOut:""}:n.basecamp,currentDate:a,upcomingEvents:this.getUpcomingEvents(n.itinerary,a),recentUpdates:n.broadcasts.map((o,i)=>({id:i.toString(),type:"broadcast",message:o.content,timestamp:o.timestamp})),confirmationNumbers:{hotel:"HTL-"+Math.random().toString(36).substr(2,9),rental_car:"CAR-"+Math.random().toString(36).substr(2,9),flight:"FLT-"+Math.random().toString(36).substr(2,9)},basecamp:n.basecamp}}static async getProTripContext(s){const r=sa[s];if(!r)throw new Error("Pro trip not found");const n=new Date().toISOString().split("T")[0];return{tripId:s,title:r.title,location:r.location,dateRange:r.dateRange,participants:r.participants.map(a=>({id:a.id.toString(),name:a.name,role:a.role})),itinerary:(r.itinerary||[]).map((a,o)=>({id:o.toString(),title:`Day ${o+1}`,date:a.date,events:a.events})),accommodation:`${r.location} Accommodation`,currentDate:n,upcomingEvents:this.getUpcomingEvents(r.itinerary||[],n),recentUpdates:[{id:"1",type:"description",message:r.description,timestamp:n}],confirmationNumbers:{venue:"VEN-"+Math.random().toString(36).substr(2,9),transportation:"TRN-"+Math.random().toString(36).substr(2,9)},isPro:!0,proData:{category:r.category||"professional"}}}static async enhanceWithContextualData(s){const r=await this.getTripFiles(s.tripId),n=await this.getTripPhotos(s.tripId),a=await this.getTripLinks(s.tripId),o=await this.getTripPolls(s.tripId),i=await this.getChatHistory(s.tripId),l=await this.getTripReceipts(s.tripId),u=await this.getTripPreferences(s.tripId),d=this.analyzeSpendingPatterns(l),f=this.analyzeGroupDynamics(i,o),h=this.extractVisitedPlaces(s.itinerary,n),m=await this.getWeatherContext(s.location);return{...s,files:r,photos:n,links:a,polls:o,chatHistory:i.slice(-20),receipts:l,preferences:u,spendingPatterns:d,groupDynamics:f,visitedPlaces:h,weatherContext:m}}static async getTripFiles(s){try{const{data:r,error:n}=await V.from("trip_files").select(`
          id,
          name,
          file_type,
          content_text,
          ai_summary,
          extracted_events,
          uploaded_by,
          created_at
        `).eq("trip_id",s).order("created_at",{ascending:!1});return n?(console.warn("Failed to fetch trip files:",n),[]):(r||[]).map(a=>({id:a.id,name:a.name,type:a.file_type,content:a.content_text,extractedEvents:a.extracted_events||0,aiSummary:a.ai_summary,uploadedBy:"Unknown",uploadedAt:a.created_at}))}catch(r){return console.warn("Error fetching trip files:",r),[]}}static async getTripPhotos(s){return[{id:"photo-1",url:"/src/assets/vacation-beach-group.jpg",caption:"Beach day with the crew! 🏖️",location:"Santa Monica Beach",timestamp:new Date(Date.now()-2*24*60*60*1e3).toISOString(),uploadedBy:"Marcus",aiTags:["beach","group","outdoor","sunny","recreational"]},{id:"photo-2",url:"/src/assets/vacation-landmark-selfie.jpg",caption:"Epic group selfie at the landmark!",location:"Hollywood Sign Viewpoint",timestamp:new Date(Date.now()-1*24*60*60*1e3).toISOString(),uploadedBy:"Sarah",aiTags:["landmark","selfie","group","tourist","scenic"]}]}static async getTripLinks(s){try{const{data:r,error:n}=await V.from("trip_links").select(`
          id,
          url,
          title,
          description,
          category,
          votes,
          added_by,
          created_at
        `).eq("trip_id",s).order("votes",{ascending:!1});return n?(console.warn("Failed to fetch trip links:",n),[]):(r||[]).map(a=>({id:a.id,url:a.url,title:a.title,description:a.description,category:a.category,votes:a.votes||0,addedBy:"Unknown",addedAt:a.created_at}))}catch(r){return console.warn("Error fetching trip links:",r),[]}}static async getTripPolls(s){try{const{data:r,error:n}=await V.from("trip_polls").select(`
          id,
          question,
          options,
          total_votes,
          status,
          created_by,
          created_at
        `).eq("trip_id",s).order("created_at",{ascending:!1});return n?(console.warn("Failed to fetch trip polls:",n),[]):(r||[]).map(a=>({id:a.id,question:a.question,options:Array.isArray(a.options)?a.options:[],totalVotes:a.total_votes||0,createdBy:"Unknown",createdAt:a.created_at,status:a.status||"active"}))}catch(r){return console.warn("Error fetching trip polls:",r),[]}}static async getChatHistory(s){try{const{data:r,error:n}=await V.from("trip_chat_messages").select(`
          id,
          content,
          author_name,
          sentiment,
          created_at
        `).eq("trip_id",s).order("created_at",{ascending:!1}).limit(50);return n?(console.warn("Failed to fetch chat history:",n),[]):(r||[]).map(a=>({id:a.id,content:a.content,author:a.author_name,timestamp:a.created_at,sentiment:a.sentiment}))}catch(r){return console.warn("Error fetching chat history:",r),[]}}static async getTripReceipts(s){return[{id:"receipt-1",amount:156.8,currency:"USD",description:"Dinner at Le Comptoir",category:"food",splitBetween:4,uploadedBy:"Emma",uploadedAt:"2025-01-15T19:30:00Z"},{id:"receipt-2",amount:89.5,currency:"USD",description:"Uber to airport",category:"transport",splitBetween:3,uploadedBy:"Alex",uploadedAt:"2025-01-15T08:15:00Z"}]}static async getTripPreferences(s){try{const{data:r,error:n}=await V.from("trip_preferences").select("*").eq("trip_id",s).maybeSingle();return n||!r?(console.warn("Failed to fetch trip preferences:",n),{dietary:[],vibe:[],accessibility:[],business:[],entertainment:[],lifestyle:[],budgetMin:0,budgetMax:1e3,timePreference:"flexible"}):{dietary:r.dietary||[],vibe:r.vibe||[],accessibility:r.accessibility||[],business:r.business||[],entertainment:r.entertainment||[],lifestyle:r.lifestyle||[],budgetMin:r.budget_min||0,budgetMax:r.budget_max||1e3,timePreference:r.time_preference||"flexible"}}catch(r){return console.warn("Error fetching trip preferences:",r),{dietary:[],vibe:[],accessibility:[],business:[],entertainment:[],lifestyle:[],budgetMin:0,budgetMax:1e3,timePreference:"flexible"}}}static analyzeSpendingPatterns(s){const r=s.reduce((o,i)=>o+i.amount,0),n=s.reduce((o,i)=>(o[i.category]=(o[i.category]||0)+i.amount,o),{}),a=s.reduce((o,i)=>o+i.amount/i.splitBetween,0);return{totalSpent:r,categories:n,avgPerPerson:a}}static analyzeGroupDynamics(s,r){const n=s.reduce((d,f)=>(d[f.author]=(d[f.author]||0)+1,d),{}),a=Object.entries(n).sort(([,d],[,f])=>f-d).slice(0,3).map(([d])=>d),o=r.filter(d=>d.status==="closed").map(d=>{const f=d.options.reduce((h,m)=>m.votes>h.votes?m:h);return`${d.question}: ${f.text}`}),i=s.filter(d=>d.sentiment==="positive").length,l=s.length?i/s.length:0,u=l>.7?"high":l>.4?"medium":"low";return{mostActiveParticipants:a,recentDecisions:o,consensusLevel:u}}static extractVisitedPlaces(s,r){const n=new Set;return s.forEach(a=>{var o;(o=a.events)==null||o.forEach(i=>{i.location&&n.add(i.location)})}),r.forEach(a=>{a.location&&n.add(a.location)}),Array.from(n)}static async getWeatherContext(s){return{current:"Sunny, 72°F",forecast:["Sunny, 75°F","Partly cloudy, 70°F","Sunny, 78°F"]}}static getUpcomingEvents(s,r){return s.filter(n=>n.date>=r).flatMap(n=>{var a;return((a=n.events)==null?void 0:a.map(o=>({...o,date:n.date})))||[]}).slice(0,5)}}class gr{static async healthCheck(){const s=Date.now();try{const{data:r,error:n}=await V.functions.invoke("perplexity-chat",{body:{message:"Hello, this is a health check.",config:{model:"sonar",temperature:.1,maxTokens:50}}}),a=Date.now()-s;return n?(console.error("Perplexity health check error:",n),{healthy:!1,error:n.message,latency:a}):r!=null&&r.success?{healthy:!0,model:r.model||"sonar",latency:a}:{healthy:!1,error:(r==null?void 0:r.error)||"Unknown error",latency:a}}catch(r){const n=Date.now()-s;return console.error("Perplexity health check failed:",r),{healthy:!1,error:r instanceof Error?r.message:"Network error",latency:n}}}static async sendMessage(s,r={}){try{const{data:n,error:a}=await V.functions.invoke("perplexity-chat",{body:{message:s,tripContext:r.tripContext,chatHistory:r.chatHistory||[],config:{model:"sonar",temperature:.7,maxTokens:2048,...r.config},imageBase64:r.imageBase64,analysisType:r.analysisType||"chat"}});return a?(console.error("Perplexity API error:",a),{success:!1,error:a.message||"Failed to connect to Perplexity AI"}):n!=null&&n.success?{success:!0,response:n.response,usage:n.usage,citations:n.citations||n.sources||[],sources:n.sources||n.citations||[],model:n.model}:{success:!1,error:(n==null?void 0:n.error)||"Unknown error from Perplexity AI"}}catch(n){return console.error("Perplexity service error:",n),{success:!1,error:n instanceof Error?n.message:"Network error"}}}}class xr{static async healthCheck(){return gr.healthCheck()}static buildSystemPrompt(s,r,n){var o,i,l,u,d,f,h,m,p,b,x,v,y,S;let a=`You are Concierge, an intelligent travel assistant with access to real-time web information. You help travelers plan and manage their trips with personalized recommendations and current information.

Key capabilities:
- Real-time web search for current information about restaurants, attractions, events
- Location-based recommendations and directions  
- Weather updates and travel conditions
- Local insights and hidden gems
- Practical travel advice and tips
- Context-aware suggestions based on your trip data

Always provide helpful, specific, and current information. When providing recommendations, include current details like hours, prices, and availability when possible. Cite your sources for factual information.`;if(s){if(a+=`

=== TRIP CONTEXT ===`,a+=`
Destination: ${s.location}`,typeof s.dateRange=="object"?a+=`
Travel Dates: ${s.dateRange.start} to ${s.dateRange.end}`:s.dateRange&&(a+=`
Travel Dates: ${s.dateRange}`),a+=`
Group Size: ${((o=s.participants)==null?void 0:o.length)||0} travelers`,a+=`
Participants: ${((i=s.participants)==null?void 0:i.map(g=>g.name).join(", "))||"Not specified"}`,s.accommodation){const g=typeof s.accommodation=="object"?`${s.accommodation.name} at ${s.accommodation.address}`:s.accommodation;a+=`
Accommodation: ${g}`}if(r&&(a+=`
Current Basecamp: ${r.name} at ${r.address}`,(l=s.basecamp)!=null&&l.coordinates&&(a+=` (${s.basecamp.coordinates.lat}, ${s.basecamp.coordinates.lng})`)),s.preferences){a+=`

=== GROUP PREFERENCES ===`;const g=s.preferences;(u=g.dietary)!=null&&u.length&&(a+=`
Dietary: ${g.dietary.join(", ")}`),(d=g.vibe)!=null&&d.length&&(a+=`
Vibes: ${g.vibe.join(", ")}`),(f=g.entertainment)!=null&&f.length&&(a+=`
Entertainment: ${g.entertainment.join(", ")}`),(h=g.lifestyle)!=null&&h.length&&(a+=`
Lifestyle: ${g.lifestyle.join(", ")}`),g.budgetMin&&g.budgetMax&&(a+=`
Budget Range: $${g.budgetMin} - $${g.budgetMax} per person`),a+=`
Time Preference: ${g.timePreference||"flexible"}`}if((m=s.visitedPlaces)!=null&&m.length&&(a+=`

=== ALREADY VISITED ===`,a+=`
Places: ${s.visitedPlaces.join(", ")}`,a+=`
Note: Avoid recommending these places unless specifically asked.`),s.spendingPatterns){a+=`

=== SPENDING PATTERNS ===`,a+=`
Total Spent: $${s.spendingPatterns.totalSpent.toFixed(2)}`,a+=`
Average per Person: $${s.spendingPatterns.avgPerPerson.toFixed(2)}`;const g=Object.entries(s.spendingPatterns.categories).map(([w,C])=>`${w}: $${C}`).join(", ");g&&(a+=`
By Category: ${g}`)}if(s.groupDynamics&&(a+=`

=== GROUP DYNAMICS ===`,a+=`
Most Active: ${s.groupDynamics.mostActiveParticipants.join(", ")}`,a+=`
Consensus Level: ${s.groupDynamics.consensusLevel}`,s.groupDynamics.recentDecisions.length&&(a+=`
Recent Decisions: ${s.groupDynamics.recentDecisions.join("; ")}`)),(p=s.links)!=null&&p.length&&(a+=`

=== SHARED LINKS & IDEAS ===`,s.links.forEach(g=>{a+=`
- ${g.title} (${g.category}, ${g.votes} votes): ${g.description}`})),(b=s.polls)!=null&&b.length&&(a+=`

=== ACTIVE POLLS & DECISIONS ===`,s.polls.forEach(g=>{if(g.status==="active"){const w=g.options.reduce((C,E)=>E.votes>C.votes?E:C);a+=`
- ${g.question}: Leading option is "${w.text}" (${w.votes}/${g.totalVotes} votes)`}})),(x=s.files)!=null&&x.length&&(a+=`

=== UPLOADED FILES & CONTENT ===`,s.files.forEach(g=>{g.aiSummary&&(a+=`
- ${g.name}: ${g.aiSummary}`),g.extractedEvents&&(a+=` (${g.extractedEvents} events extracted)`)})),(v=s.chatHistory)!=null&&v.length){a+=`

=== RECENT GROUP CHAT SENTIMENT ===`;const g=s.chatHistory.slice(-5),w=g.filter(E=>E.sentiment==="positive").length,C=w>=3?"Very positive":w>=2?"Positive":"Mixed";a+=`
Group Mood: ${C}`,a+=`
Recent Topics: ${g.map(E=>`"${E.content}"`).join("; ")}`}((y=s.upcomingEvents)==null?void 0:y.length)>0&&(a+=`

=== UPCOMING SCHEDULE ===`,s.upcomingEvents.forEach(g=>{a+=`
- ${g.title} on ${g.date}`,g.time&&(a+=` at ${g.time}`),g.location&&(a+=` (${g.location})`)})),s.confirmationNumbers&&(a+=`

=== CONFIRMATIONS ===`,Object.entries(s.confirmationNumbers).forEach(([g,w])=>{a+=`
${g.replace("_"," ")}: ${w}`})),s.weatherContext&&(a+=`

=== WEATHER CONTEXT ===`,a+=`
Current: ${s.weatherContext.current}`,(S=s.weatherContext.forecast)!=null&&S.length&&(a+=`
Forecast: ${s.weatherContext.forecast.join(", ")}`))}return a+=`

=== INSTRUCTIONS ===`,a+=`
Provide personalized recommendations based on ALL the context above. Use web search to get the most current information about restaurants, attractions, events, and conditions.`,a+=`
Key guidelines:`,a+=`
- Consider group preferences, budget, and past decisions`,a+=`
- Avoid suggesting places they've already visited unless asked`,a+=`
- Factor in current location/basecamp for proximity`,a+=`
- Reference their shared content when relevant`,a+=`
- Match recommendations to group mood and consensus level`,a+=`
- Always provide specific, actionable suggestions with current details`,a+=`
- Cite your sources for factual information`,a}static async sendMessage(s,r,n,a,o=[],i=!1){const l=this.buildSystemPrompt(r,n,a);try{return i?await this.sendToLovableAI(s,r,l,o):await gr.sendMessage(s,{tripContext:r,chatHistory:o,config:{systemPrompt:l,model:"sonar",temperature:.7,maxTokens:2048}})}catch(u){return console.error("Concierge error:",u),{success:!1,error:u instanceof Error?u.message:"Failed to get response from travel concierge"}}}static async sendToLovableAI(s,r,n,a){const{supabase:o}=await to(async()=>{const{supabase:i}=await import("./index-CAsyng-G.js").then(l=>l.aB);return{supabase:i}},__vite__mapDeps([0,1]));try{const{data:i,error:l}=await o.functions.invoke("lovable-concierge",{body:{message:s,tripContext:r,chatHistory:a,config:{systemPrompt:n,model:"google/gemini-2.5-flash",temperature:.7,maxTokens:2048}}});if(l)throw l;return{success:i.success,response:i.response,usage:i.usage,sources:i.sources||[],error:i.error}}catch(i){return console.error("Lovable AI error:",i),{success:!1,error:i instanceof Error?i.message:"Failed to connect to AI service"}}}}const Nd=({messages:t,isTyping:s})=>t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ce,{size:48,className:"text-gray-600 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-400 mb-2",children:"Start the conversation"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Send a message to get the chat started!"})]}):e.jsxs(e.Fragment,{children:[t.map(r=>e.jsx("div",{className:`flex ${r.type==="user"?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`max-w-xs lg:max-w-md px-4 py-3 rounded-2xl ${r.type==="user"?"bg-gray-800 text-white":"bg-gradient-to-r from-blue-600/20 to-purple-600/20 text-gray-300 border border-blue-500/20"}`,children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:r.content})})},r.id)),s&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-600/20 to-purple-600/20 rounded-2xl p-4 border border-blue-500/20",children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce"}),e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})})]}),Cd=({inputMessage:t,onInputChange:s,onSendMessage:r,onKeyPress:n,isTyping:a,disabled:o=!1})=>{const i=l=>{l.key==="Enter"&&!l.shiftKey?(l.preventDefault(),r()):n(l)};return e.jsxs("div",{className:"flex gap-3 items-end",children:[e.jsx("textarea",{value:t,onChange:l=>s(l.target.value),onKeyPress:i,placeholder:"Ask about your trip...",rows:2,disabled:o,className:"flex-1 bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-blue-500 resize-none disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("button",{onClick:r,disabled:!t.trim()||a||o,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white p-3 rounded-full transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Dr,{size:16})})]})},xu=({tripId:t,basecamp:s,preferences:r,isDemoMode:n=!1})=>{Sr();const{basecamp:a}=so(),[o,i]=c.useState([]),[l,u]=c.useState(""),[d,f]=c.useState(!1),[h,m]=c.useState("checking"),[p,b]=c.useState(null);c.useEffect(()=>{const y=async()=>{try{const g=await xr.healthCheck();b(g),m(g.healthy?"connected":"limited")}catch(g){console.error("❌ Health check failed:",g),m("error")}};y();const S=setInterval(()=>{h!=="connected"&&y()},3e4);return()=>clearInterval(S)},[h]);const x=async()=>{if(!l.trim()||d)return;const y={id:Date.now().toString(),type:"user",content:l,timestamp:new Date().toISOString()};i(g=>[...g,y]);const S=l;u(""),f(!0),m("thinking");try{let g;try{g=await jd.getEnhancedTripContext(t,!1)}catch(P){console.warn("Enhanced context failed, falling back to basic context:",P);try{g=await wd.getTripContext(t,!1)}catch(T){console.warn("Basic context also failed, using minimal context:",T),g={tripId:t,title:"Current Trip",location:(a==null?void 0:a.address)||(s==null?void 0:s.address)||"Unknown location",dateRange:new Date().toISOString().split("T")[0],participants:[],itinerary:[],accommodation:(a==null?void 0:a.name)||(s==null?void 0:s.name),currentDate:new Date().toISOString().split("T")[0],upcomingEvents:[],recentUpdates:[],confirmationNumbers:{}}}}const w=o.slice(-6).map(P=>({role:P.type==="user"?"user":"assistant",content:P.content})),C=a?{name:a.name||"Basecamp",address:a.address}:s?{name:s.name||"Basecamp",address:s.address}:void 0,E=await xr.sendMessage(S,g,C,r,w,n);E.success?m("connected"):m("limited");const k={id:(Date.now()+1).toString(),type:"assistant",content:E.response||`Sorry, I encountered an error: ${E.error}`,timestamp:new Date().toISOString(),isFromPerplexity:E.success,usage:E.usage,sources:E.sources||E.citations};i(P=>[...P,k])}catch(g){console.error("❌ Perplexity Chat error:",g),m("error");const w={id:(Date.now()+1).toString(),type:"assistant",content:"I'm having trouble connecting to my AI services right now. Please try again in a moment.",timestamp:new Date().toISOString(),isFromPerplexity:!1};i(C=>[...C,w])}finally{f(!1)}},v=y=>{y.key==="Enter"&&!y.shiftKey&&(y.preventDefault(),x())};return e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:e.jsx(hs,{size:20,className:"text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"AI Concierge"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ea,{size:16,className:"text-green-400"}),e.jsx("span",{className:"text-xs text-green-400",children:"Ready with Web Search"})]})})]})]}),o.length===0&&e.jsxs("div",{className:"text-center py-8 mb-6",children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Your AI Travel Concierge"}),e.jsxs("div",{className:"text-sm text-gray-300 space-y-2 max-w-md mx-auto",children:[e.jsx("p",{children:"Ask me anything about your trip:"}),e.jsxs("div",{className:"text-xs text-gray-400 space-y-1",children:[e.jsx("p",{children:'• "What are the best restaurants for our group?"'}),e.jsx("p",{children:'• "Suggest activities based on our preferences"'}),e.jsx("p",{children:'• "Help me plan our itinerary"'}),e.jsx("p",{children:'• "What hidden gems should we check out?"'})]}),e.jsx("div",{className:"mt-3 text-xs text-green-400 bg-green-500/10 rounded px-3 py-2 inline-block",children:"✨ Powered by AI - ask me anything!"})]})]}),e.jsx("div",{className:"space-y-4 mb-6 max-h-80 overflow-y-auto",children:e.jsx(Nd,{messages:o,isTyping:d})}),e.jsx(Cd,{inputMessage:l,onInputChange:u,onSendMessage:x,onKeyPress:v,isTyping:d,disabled:h==="error"})]})},Sd=({tripId:t,tripName:s,users:r,currentUserId:n,onUserRemoved:a,onLeaveTrip:o})=>{Ve();const[i,l]=c.useState(!1),[u,d]=c.useState(null),[f,h]=c.useState(null),m=r.find(g=>g.id===n),p=(m==null?void 0:m.role)==="owner",b=(m==null?void 0:m.role)==="admin"||p,x=()=>{o(),l(!1)},v=g=>{a(g.id),d(null),h(null)},y=g=>g.id===n||g.role==="owner"?!1:!!(p||b&&g.role!=="admin"),S=g=>{switch(g){case"owner":return"bg-yellow-500/20 text-yellow-300 border-yellow-500/30";case"admin":return"bg-blue-500/20 text-blue-300 border-blue-500/30";default:return"bg-gray-500/20 text-gray-300 border-gray-500/30"}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Trip Members"}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[r.length," people in this trip"]})]}),e.jsxs("button",{onClick:()=>l(!0),className:"flex items-center gap-2 bg-red-600/20 hover:bg-red-600/30 border border-red-500/30 text-red-300 px-4 py-2 rounded-xl transition-colors",children:[e.jsx(po,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Leave Trip"})]})]}),e.jsx("div",{className:"space-y-3",children:r.map(g=>e.jsxs("div",{className:"flex items-center justify-between bg-white/5 border border-white/10 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:g.avatar,alt:g.name,className:"w-10 h-10 rounded-full border-2 border-white/20"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-medium",children:g.name}),g.id===n&&e.jsx("span",{className:"text-xs bg-glass-orange/20 text-glass-orange px-2 py-1 rounded",children:"You"})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[g.role&&e.jsx("span",{className:`text-xs px-2 py-1 rounded border ${S(g.role)}`,children:g.role}),e.jsxs("span",{className:"text-xs text-gray-400",children:["Joined ",new Date(g.joinedAt).toLocaleDateString()]})]})]})]}),y(g)&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>h(f===g.id?null:g.id),className:"text-gray-400 hover:text-white p-2 rounded-lg hover:bg-white/10 transition-colors",children:e.jsx(Yo,{size:16})}),f===g.id&&e.jsx("div",{className:"absolute right-0 top-full mt-2 bg-gray-900/95 backdrop-blur-md border border-gray-700 rounded-xl shadow-xl z-10 min-w-[180px]",children:e.jsxs("button",{onClick:()=>d(g),className:"w-full flex items-center gap-3 px-4 py-3 text-red-300 hover:bg-red-500/10 rounded-xl transition-colors",children:[e.jsx(Gs,{size:16}),"Remove from trip"]})})]})]},g.id))})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-8 max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center gap-3 text-red-400 mb-4",children:[e.jsx(ro,{size:24}),e.jsx("h3",{className:"text-xl font-bold text-white",children:"Leave Trip?"})]}),e.jsxs("p",{className:"text-gray-300 mb-6",children:['Are you sure you want to leave "',s,`"? You'll lose access to all trip information and won't receive updates.`]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>l(!1),className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-3 rounded-xl transition-colors",children:"Cancel"}),e.jsx("button",{onClick:x,className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-3 rounded-xl transition-colors",children:"Leave Trip"})]})]})}),u&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-8 max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 text-red-400",children:[e.jsx(Gs,{size:24}),e.jsx("h3",{className:"text-xl font-bold text-white",children:"Remove User?"})]}),e.jsx("button",{onClick:()=>d(null),className:"text-gray-400 hover:text-white",children:e.jsx(Pe,{size:20})})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-white/5 border border-white/10 rounded-xl p-4 mb-6",children:[e.jsx("img",{src:u.avatar,alt:u.name,className:"w-10 h-10 rounded-full border-2 border-white/20"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white font-medium",children:u.name}),u.role&&e.jsx("div",{className:`text-xs px-2 py-1 rounded border mt-1 inline-block ${S(u.role)}`,children:u.role})]})]}),e.jsxs("p",{className:"text-gray-300 mb-6",children:["Are you sure you want to remove ",u.name,' from "',s,`"? They'll lose access to all trip information.`]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>d(null),className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-3 rounded-xl transition-colors",children:"Cancel"}),e.jsx("button",{onClick:()=>v(u),className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-3 rounded-xl transition-colors",children:"Remove User"})]})]})}),f&&e.jsx("div",{className:"fixed inset-0 z-5",onClick:()=>h(null)})]})},Ed=["Sports – Pro, Collegiate, Youth","Tour – Music, Comedy, etc.","Business Travel","School Trip","Content","Other"],kd=({isOpen:t,onClose:s,tripId:r,tripName:n,currentUserId:a})=>{const[o,i]=c.useState("users"),[l,u]=c.useState("Business Travel"),[d,f]=c.useState(""),[h,m]=c.useState(!1),[p,b]=c.useState([{id:"1",name:"Emma Wilson",avatar:"https://images.unsplash.com/photo-1494790108755-2616b612b47c?w=40&h=40&fit=crop&crop=face",role:"owner",joinedAt:"2024-01-15"},{id:"2",name:"Jake Thompson",avatar:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=40&h=40&fit=crop&crop=face",role:"admin",joinedAt:"2024-01-16"},{id:"3",name:"Sarah Chen",avatar:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=40&h=40&fit=crop&crop=face",role:"member",joinedAt:"2024-01-18"},{id:"4",name:"You",avatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face",role:"member",joinedAt:"2024-01-20"}]);if(!t)return null;const x=w=>{b(p.filter(C=>C.id!==w)),console.log(`User ${w} removed from trip ${r}`)},v=()=>{console.log(`Current user left trip ${r}`),s()},y=w=>{w==="Other"?(m(!0),u("")):(m(!1),u(w),f(""))},S=()=>{console.log(`Trip category updated to: ${h?d:l}`)},g=[{id:"users",label:"Members",icon:ve},{id:"general",label:"General",icon:ms},{id:"danger",label:"Danger Zone",icon:Mr}];return e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50",children:e.jsxs("div",{className:"flex h-full",children:[e.jsxs("div",{className:"w-80 bg-white/5 backdrop-blur-md border-r border-white/10 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Trip Settings"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white p-2 rounded-lg hover:bg-white/10 transition-colors",children:e.jsx(Pe,{size:20})})]}),e.jsx("div",{className:"space-y-2",children:g.map(w=>{const C=w.icon;return e.jsxs("button",{onClick:()=>i(w.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-colors ${o===w.id?"bg-glass-orange/20 text-glass-orange border border-glass-orange/30":"text-gray-300 hover:text-white hover:bg-white/10"}`,children:[e.jsx(C,{size:20}),w.label]},w.id)})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"p-8",children:[o==="users"&&e.jsx(Sd,{tripId:r,tripName:n,users:p,currentUserId:a,onUserRemoved:x,onLeaveTrip:v}),o==="general"&&e.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-6",children:"General Settings"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Trip Category"}),e.jsx("select",{value:h?"Other":l,onChange:w=>y(w.target.value),className:"w-full bg-gray-800/50 border border-gray-600 text-white rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-glass-orange/50 focus:border-glass-orange/50",children:Ed.map(w=>e.jsx("option",{value:w,children:w},w))}),h&&e.jsx("div",{className:"mt-3",children:e.jsx("input",{type:"text",value:d,onChange:w=>f(w.target.value),placeholder:"Enter custom category...",className:"w-full bg-gray-800/50 border border-gray-600 text-white rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-glass-orange/50 focus:border-glass-orange/50"})}),e.jsx("button",{onClick:S,className:"mt-3 bg-glass-orange hover:bg-glass-orange/80 text-white px-6 py-2 rounded-xl transition-colors font-medium",children:"Save Category"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Trip Name"}),e.jsx("input",{type:"text",defaultValue:n,className:"w-full bg-gray-800/50 border border-gray-600 text-white rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-glass-orange/50 focus:border-glass-orange/50"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Description"}),e.jsx("textarea",{rows:4,placeholder:"Describe your trip...",className:"w-full bg-gray-800/50 border border-gray-600 text-white rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-glass-orange/50 focus:border-glass-orange/50 resize-none"})]})]}),o==="danger"&&e.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-red-500/20 rounded-2xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-red-300 mb-4",children:"Danger Zone"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"These actions are irreversible."}),e.jsx("button",{className:"bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-xl transition-colors",children:"Delete Trip"})]})]})})]})})},Pd=({isOpen:t,onClose:s})=>{const{upgradeToPlus:r,isLoading:n}=Sr(),[a,o]=c.useState("monthly");if(!t)return null;const i=async()=>{await r(),s()},l=()=>a==="monthly"?zs:Us,u=()=>{const d=zs*12;return Math.round((d-Us)/d*100)};return e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-glass-orange to-glass-yellow rounded-2xl flex items-center justify-center",children:e.jsx(Qo,{size:24,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Upgrade to Plus"}),e.jsx("p",{className:"text-gray-400",children:"AI-powered travel planning for smarter trips"})]})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(Pe,{size:24})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-500/10 to-purple-500/10 border border-blue-500/20 rounded-2xl p-6",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl flex items-center justify-center mb-4",children:e.jsx(Xo,{size:24,className:"text-white"})}),e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Concierge"}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Chat with AI for personalized recommendations based on your location and preferences."})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-500/10 to-teal-500/10 border border-green-500/20 rounded-2xl p-6",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-green-500 to-teal-500 rounded-xl flex items-center justify-center mb-4",children:e.jsx(ms,{size:24,className:"text-white"})}),e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Smart Preferences"}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Set dietary, vibe, budget, and time preferences to get tailored suggestions for your entire group."})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-500/10 to-red-500/10 border border-orange-500/20 rounded-2xl p-6",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-orange-500 to-red-500 rounded-xl flex items-center justify-center mb-4",children:e.jsx(go,{size:24,className:"text-white"})}),e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Basecamp Intelligence"}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Get location-aware recommendations within walking distance or perfect travel time from your basecamp."})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-500/10 to-pink-500/10 border border-purple-500/20 rounded-2xl p-6",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl flex items-center justify-center mb-4",children:e.jsx(Ce,{size:24,className:"text-white"})}),e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Contextual Chat"}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Real-time assistance for planning activities, finding restaurants, and making the most of your trip."})]}),e.jsxs("div",{className:"bg-gradient-to-br from-cyan-500/10 to-blue-500/10 border border-cyan-500/20 rounded-2xl p-6",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-xl flex items-center justify-center mb-4",children:e.jsx(Ar,{size:24,className:"text-white"})}),e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Photo Sharing"}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Share and organize trip photos with your group in beautiful albums and memories."})]})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-6 mb-8",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Free vs. Plus"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Free Plan"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-400",children:[e.jsx("li",{children:"• Up to 5 trips (delete to add new)"}),e.jsx("li",{children:"• Basic group chat"}),e.jsx("li",{children:"• Group to-do list"}),e.jsx("li",{children:"• Shared trip calendar"}),e.jsx("li",{children:"• Up to 10 participants"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Plus"}),e.jsxs("ul",{className:"space-y-2 text-sm text-green-300",children:[e.jsx("li",{children:"• Unlimited trips & participants"}),e.jsx("li",{children:"• Photo sharing"}),e.jsx("li",{children:"• AI-powered recommendations"}),e.jsx("li",{children:"• Smart preference matching"}),e.jsx("li",{children:"• Basecamp-aware suggestions"}),e.jsx("li",{children:"• Concierge AI chat"}),e.jsx("li",{children:"• Personalized itinerary building"}),e.jsx("li",{children:"• Group preference management"})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[e.jsx("span",{className:`text-sm ${a==="monthly"?"text-white font-medium":"text-gray-400"}`,children:"Monthly"}),e.jsx("button",{onClick:()=>o(a==="monthly"?"annual":"monthly"),className:"relative w-12 h-6 bg-gray-700 rounded-full transition-colors",children:e.jsx("div",{className:`absolute top-1 w-4 h-4 bg-glass-orange rounded-full transition-transform ${a==="annual"?"translate-x-7":"translate-x-1"}`})}),e.jsx("span",{className:`text-sm ${a==="annual"?"text-white font-medium":"text-gray-400"}`,children:"Annual"}),a==="annual"&&e.jsxs("div",{className:"bg-green-500/20 text-green-400 px-2 py-1 rounded-lg text-xs font-medium",children:["Save ",u(),"%"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"bg-gradient-to-r from-glass-orange/20 to-glass-yellow/20 backdrop-blur-sm border border-glass-orange/30 rounded-2xl p-6 mb-6",children:[e.jsxs("div",{className:"text-4xl font-bold text-white mb-2",children:["$",l(),a==="monthly"?"/month":"/year"]}),a==="annual"&&e.jsxs("div",{className:"text-green-400 text-sm mb-2",children:["Save ",u(),"% with annual billing"]}),e.jsx("p",{className:"text-gray-300 mb-4",children:"7-day free trial • Cancel anytime"}),e.jsx("div",{className:"text-sm text-glass-yellow",children:"No credit card required for trial"})]}),e.jsxs("div",{className:"flex gap-4 justify-center",children:[e.jsx("button",{onClick:s,className:"px-8 py-3 bg-white/10 backdrop-blur-md border border-white/20 hover:bg-white/20 text-white rounded-2xl transition-all duration-200 font-medium",children:"Maybe Later"}),e.jsx("button",{onClick:i,disabled:n,className:"px-8 py-3 bg-gradient-to-r from-glass-orange to-glass-yellow hover:from-glass-orange/80 hover:to-glass-yellow/80 text-white font-medium rounded-2xl transition-all duration-200 hover:scale-105 shadow-lg disabled:opacity-50",children:n?"Processing...":"Start Free Trial"})]})]})]})})},vu=({showSettings:t,onCloseSettings:s,showInvite:r,onCloseInvite:n,showAuth:a,onCloseAuth:o,showTripSettings:i,onCloseTripSettings:l,showTripsPlusModal:u,onCloseTripsPlusModal:d,tripName:f,tripId:h,userId:m})=>e.jsxs(e.Fragment,{children:[e.jsx(xo,{isOpen:t,onClose:s}),e.jsx(_r,{isOpen:r,onClose:n,tripName:f,tripId:h}),e.jsx(oo,{isOpen:a,onClose:o}),e.jsx(kd,{isOpen:i,onClose:l,tripId:h,tripName:f,currentUserId:m||"4"}),e.jsx(Pd,{isOpen:u,onClose:d})]});export{ki as C,du as G,Ai as I,Ri as M,xu as P,iu as T,Jo as V,nu as a,lu as b,vu as c,gu as d,cu as e,Ka as f,la as g,qa as h,Es as i,Ci as u};
