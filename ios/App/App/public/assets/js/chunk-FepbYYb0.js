const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/web.js-CQUai8A_.js","assets/index-C69Cv9fm.js","assets/js/chunk-DE8J_P3a.js","assets/js/chunk-CHPtWMTz.js","assets/js/chunk-DN5ISW2H.js","assets/js/chunk-CbEMFF6w.js","assets/index-BTBA-ZGg.css","assets/js/chunk-hQfd_hHm.js","assets/js/chunk-BpSVmO2m.js","assets/js/chunk-DgElOEdu.js","assets/js/chunk-DcTAIqBw.js","assets/js/chunk-D_Hxdxtf.js","assets/js/chunk--pMnkzaH.js","assets/js/chunk-C0eak1NN.js","assets/js/chunk-BxvRdxTs.js","assets/js/chunk-DyZQNKrs.js","assets/js/chunk-D_Qk7JHd.js","assets/js/chunk-CKgI9q5n.js","assets/js/chunk-D3Z6_DOi.js","assets/js/chunk-YjRoWQ3-.js","assets/js/chunk-LoZVIojA.js","assets/js/chunk-CD10_Lnj.js","assets/js/chunk-Bc1XvzR8.js","assets/js/chunk-D5WpN7K-.js","assets/js/chunk-DJZXZyJn.js","assets/js/chunk-A2g_dVj8.js","assets/js/chunk-30ZbY-F3.js","assets/js/chunk-BIY1ublO.js","assets/js/chunk-DeuaeHUI.js","assets/js/chunk-D53qnCh4.js","assets/js/chunk-B6KUG25W.js","assets/js/chunk-DILfnUIk.js","assets/js/chunk-Bx2M---t.js","assets/js/chunk-88HG7dU1.js","assets/js/chunk-DoIo-fWL.js","assets/js/chunk-CkE6zG_x.js","assets/js/chunk-Ck98qql-.js","assets/js/chunk-y0HRaaXz.js","assets/js/chunk-DV9vF-NS.js","assets/js/chunk-ByyMTJWo.js","assets/js/chunk-DkxHCs8B.js","assets/js/chunk-BOGV63ZI.js","assets/js/chunk-wPum6LLk.js","assets/js/chunk-Ccyq873b.js","assets/js/chunk-DGLf2uCM.js","assets/js/tripService.ts-CUb9l8sj.js","assets/js/chunk-Bbmjf7eQ.js","assets/js/chunk-DV21tWlK.js","assets/js/chunk-DuSQr7KO.js","assets/js/chunk-BzRjpoc5.js","assets/js/chunk-C-NDN0ZE.js","assets/js/chunk-DtLDND_v.js","assets/js/chunk-bP8xJp5e.js","assets/js/chunk-4koW6KZp.js","assets/js/chunk-ObNbiZMt.js","assets/js/chunk--XGoeuWx.js","assets/js/chunk-D393L8yP.js","assets/js/chunk-DomSceYV.js","assets/js/chunk-0Vn9svHl.js","assets/js/chunk-CVnd1dNx.js","assets/js/chunk-I0kJWO9F.js","assets/js/chunk-vfQQTDq4.js","assets/js/chunk-CeA63noh.js","assets/js/chunk-C5qHPTeJ.js","assets/js/chunk-vJ6XLRYv.js","assets/js/chunk-BBFu0Y12.js","assets/js/chunk-CeVrn2l1.js","assets/js/web.js-CAiVcvaM.js","assets/js/web.js-D1l5e9pa.js","assets/js/web.js-CsOClVje.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=(t,a,n)=>((t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n)(t,"symbol"!=typeof a?a+"":a,n);import{j as a,O as n,s as r,T as s,t as i,v as o,w as l,x as c,y as d}from"./chunk-DE8J_P3a.js";import{r as u,c as m,j as p,u as h}from"./chunk-CHPtWMTz.js";import{u as f,a as g,b as x,S as w,c as b,d as v,e as y,V as j,M as N,I as k,C,A as S,f as E,T as P,g as T,h as D,i as R}from"./chunk-hQfd_hHm.js";import{T as I}from"./chunk-DomSceYV.js";import{T as _,C as M,P as O,a as A,g as L}from"./chunk-CVnd1dNx.js";import{u as $}from"./chunk-Ccyq873b.js";import{c as U,R as B,X as F,t as z,m as q,W,n as H,r as V,o as Y,s as X,j as G,k as K,p as J,f as Z,e as Q,M as ee,u as te}from"../index-C69Cv9fm.js";import{g as ae,a as ne}from"./chunk-wPum6LLk.js";import{B as re}from"./chunk-CKgI9q5n.js";import{c as se}from"./chunk-4koW6KZp.js";import{C as ie}from"./chunk-D53qnCh4.js";import{f as oe}from"./chunk-DN5ISW2H.js";import{P as le}from"./chunk-DoIo-fWL.js";import{C as ce}from"./chunk-DJZXZyJn.js";import{M as de}from"./chunk-ByyMTJWo.js";import{U as ue}from"./chunk-D5WpN7K-.js";import{S as me}from"./chunk-BpSVmO2m.js";import{a as pe,U as he,C as fe}from"./chunk-BxvRdxTs.js";import{C as ge}from"./chunk-CD10_Lnj.js";import{_ as xe}from"./chunk-CbEMFF6w.js";import{O as we}from"./chunk-CeVrn2l1.js";import{C as be}from"./chunk-C0eak1NN.js";import{I as ve,C as ye}from"./chunk-C-NDN0ZE.js";import{d as je}from"./chunk-DGLf2uCM.js";import{D as Ne}from"./chunk-DcTAIqBw.js";import{C as ke}from"./chunk-DeuaeHUI.js";import{M as Ce,S as Se,m as Ee}from"./chunk-B6KUG25W.js";import{A as Pe}from"./chunk-0Vn9svHl.js";import{E as Te}from"./chunk-D393L8yP.js";import{I as De}from"./chunk-C5qHPTeJ.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=U("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]),Ie=({activeTab:e,onTabChange:t,onShowTripsPlusModal:n,tripId:r,tripName:s,basecamp:i})=>{const{isDemoMode:o}=$();return a.jsx(_,{activeTab:e,onTabChange:t,tripId:r,tripName:s,basecamp:i,showPlaces:!0,showConcierge:!0,isDemoMode:o})},_e=({isRefreshing:e,pullDistance:t,threshold:n})=>{const r=Math.min(t/n*100,100),s=Math.min(t/n,1);return a.jsx("div",{className:"absolute top-0 left-0 right-0 flex justify-center items-center transition-opacity",style:{transform:`translateY(${t}px)`,opacity:s,pointerEvents:"none"},children:a.jsx("div",{className:"bg-black/80 backdrop-blur-sm rounded-full p-3 shadow-lg border border-white/10",children:a.jsx(B,{size:20,className:"text-white "+(e?"animate-spin":""),style:{transform:`rotate(${3.6*r}deg)`}})})})},Me=()=>a.jsx("div",{className:"space-y-4 animate-pulse",children:[1,2,3].map(e=>a.jsxs("div",{className:"flex gap-3 "+(e%2==0?"flex-row-reverse":""),children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-white/10"}),a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx("div",{className:"h-4 bg-white/10 rounded w-3/4"}),a.jsx("div",{className:"h-4 bg-white/10 rounded w-1/2"})]})]},e))}),Oe=()=>a.jsx("div",{className:"space-y-3 animate-pulse",children:[1,2,3].map(e=>a.jsx("div",{className:"bg-white/10 rounded-xl p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-6 h-6 rounded-full bg-white/20"}),a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx("div",{className:"h-4 bg-white/20 rounded w-3/4"}),a.jsx("div",{className:"h-3 bg-white/10 rounded w-1/2"})]})]})},e))}),Ae=()=>a.jsx("div",{className:"space-y-4 animate-pulse",children:a.jsxs("div",{className:"bg-white/10 rounded-xl p-6",children:[a.jsx("div",{className:"h-6 bg-white/20 rounded w-1/3 mb-4"}),a.jsx("div",{className:"grid grid-cols-7 gap-2",children:Array(35).fill(0).map((e,t)=>a.jsx("div",{className:"aspect-square bg-white/10 rounded"},t))})]})}),Le=({isOpen:e,onClose:t,selectedDate:n,tripId:r,onEventCreated:s})=>{const[i,o]=u.useState(""),[l,c]=u.useState("12:00"),[d,m]=u.useState(""),[p,h]=u.useState("activity"),[f,g]=u.useState(""),[x,w]=u.useState(!1);if(!e)return null;return a.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:t}),a.jsxs("div",{className:"relative w-full max-w-md bg-glass-slate-card border border-glass-slate-border rounded-t-3xl sm:rounded-3xl shadow-enterprise-2xl p-6 animate-slide-up max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-500/20 flex items-center justify-center",children:a.jsx(ie,{className:"w-5 h-5 text-blue-400"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-white",children:"Add Event"}),a.jsx("p",{className:"text-sm text-gray-400",children:oe(n,"MMM d, yyyy")})]})]}),a.jsx("button",{onClick:t,className:"w-8 h-8 rounded-lg bg-white/10 hover:bg-white/20 flex items-center justify-center transition-colors",children:a.jsx(F,{className:"w-5 h-5 text-white"})})]}),a.jsxs("form",{onSubmit:async e=>{e.preventDefault(),w(!0);try{const[e,a]=l.split(":"),u=new Date(n);u.setHours(parseInt(e),parseInt(a),0,0);const x=await se.createEvent({trip_id:r,title:i,description:f||void 0,start_time:u.toISOString(),location:d||void 0,event_category:p,include_in_itinerary:!0,source_type:"manual",source_data:{created_from:"mobile"}});if(!x)throw new Error("Failed to create event");z.success("Event created",{description:`${i} has been added to your calendar`}),null==s||s(x),o(""),c("12:00"),m(""),h("activity"),g(""),t()}catch(a){z.error("Failed to create event",{description:"Please try again or contact support if the issue persists"})}finally{w(!1)}},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Event Title"}),a.jsx("input",{type:"text",value:i,onChange:e=>o(e.target.value),placeholder:"e.g., Dinner at Italian Restaurant",className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Time"}),a.jsx("input",{type:"time",value:l,onChange:e=>c(e.target.value),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Location"}),a.jsx("input",{type:"text",value:d,onChange:e=>m(e.target.value),placeholder:"e.g., Central Park",className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Category"}),a.jsxs("select",{value:p,onChange:e=>h(e.target.value),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50",children:[a.jsx("option",{value:"dining",children:"Dining"}),a.jsx("option",{value:"lodging",children:"Lodging"}),a.jsx("option",{value:"activity",children:"Activity"}),a.jsx("option",{value:"transportation",children:"Transportation"}),a.jsx("option",{value:"entertainment",children:"Entertainment"}),a.jsx("option",{value:"other",children:"Other"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Description (Optional)"}),a.jsx("textarea",{value:f,onChange:e=>g(e.target.value),placeholder:"Add any additional details...",rows:3,className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50 resize-none"})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx(re,{type:"button",variant:"outline",onClick:t,className:"flex-1 bg-white/5 border-white/10 text-white hover:bg-white/10",children:"Cancel"}),a.jsx(re,{type:"submit",disabled:x,className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white",children:x?"Creating...":"Create Event"})]})]})]})]})},$e=({tripId:e})=>{const[t,n]=u.useState(new Date),[r,s]=u.useState(!0),[i,o]=u.useState(!1),[l,c]=u.useState([{id:"1",title:"Airport Pickup",date:new Date,time:"10:00 AM",location:"JFK Airport",participants:4,color:"from-blue-500 to-blue-600"},{id:"2",title:"Hotel Check-in",date:new Date,time:"2:00 PM",location:"Grand Hotel NYC",participants:4,color:"from-purple-500 to-purple-600"}]),{isPulling:d,isRefreshing:m,pullDistance:p}=f({onRefresh:async()=>{s(!0),await new Promise(e=>setTimeout(e,1e3)),s(!1)}});u.useEffect(()=>{setTimeout(()=>s(!1),700)},[]);return a.jsxs("div",{className:"flex flex-col h-full bg-black relative",children:[a.jsx(_e,{isRefreshing:m,pullDistance:p,threshold:80}),r?a.jsx("div",{className:"px-4 py-4",children:a.jsx(Ae,{})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"px-4 py-4 border-b border-white/10",children:a.jsx("div",{className:"flex overflow-x-auto scrollbar-hide gap-3",children:Array.from({length:7},(e,r)=>{const s=new Date;s.setDate(s.getDate()+r);const i=oe(s,"yyyy-MM-dd")===oe(t,"yyyy-MM-dd");return a.jsxs("button",{onClick:async()=>{await q.light(),n(s)},className:`\n                  flex flex-col items-center justify-center\n                  min-w-[60px] h-[70px] rounded-xl\n                  transition-all duration-200\n                  active:scale-95\n                  ${i?"bg-gradient-to-b from-blue-500 to-blue-600 text-white shadow-lg":"bg-white/10 text-gray-300"}\n                `,children:[a.jsx("span",{className:"text-xs font-medium uppercase",children:oe(s,"EEE")}),a.jsx("span",{className:"text-2xl font-bold mt-1",children:oe(s,"d")})]},r)})})}),a.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-white",children:oe(t,"MMMM d, yyyy")}),a.jsx("button",{onClick:async()=>{await q.medium(),o(!0)},className:"p-2 bg-blue-600 rounded-lg active:scale-95 transition-transform",children:a.jsx(le,{size:20,className:"text-white"})})]}),a.jsx("div",{className:"space-y-3",children:0===l.length?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(ce,{size:48,className:"text-gray-600 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-400",children:"No events scheduled"})]}):l.map(e=>a.jsxs("button",{onClick:async()=>{await q.light()},className:"w-full bg-white/10 rounded-xl p-4 active:scale-98 transition-transform",children:[a.jsx("div",{className:`w-1 h-full absolute left-0 top-0 rounded-l-xl bg-gradient-to-b ${e.color}`}),a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h4",{className:"text-white font-semibold text-left",children:e.title}),a.jsx("span",{className:"text-sm text-gray-400",children:e.time})]}),e.location&&a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-300 mb-2",children:[a.jsx(de,{size:14}),a.jsx("span",{children:e.location})]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[a.jsx(ue,{size:14}),a.jsxs("span",{children:[e.participants," attending"]})]})]},e.id))})]})]}),a.jsx(Le,{isOpen:i,onClose:()=>o(!1),selectedDate:t,tripId:e,onEventCreated:e=>{c(t=>[...t,e])}})]})},Ue=({isOpen:e,onClose:t,tripId:n,onTaskCreated:r})=>{const[s,i]=u.useState(""),[o,l]=u.useState(""),[c,d]=u.useState(!1);if(!e)return null;return a.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:t}),a.jsxs("div",{className:"relative w-full max-w-md bg-glass-slate-card border border-glass-slate-border rounded-t-3xl sm:rounded-3xl shadow-enterprise-2xl p-6 animate-slide-up",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-500/20 flex items-center justify-center",children:a.jsx(me,{className:"w-5 h-5 text-blue-400"})}),a.jsx("h2",{className:"text-xl font-semibold text-white",children:"Add Task"})]}),a.jsx("button",{onClick:t,className:"w-8 h-8 rounded-lg bg-white/10 hover:bg-white/20 flex items-center justify-center transition-colors",children:a.jsx(F,{className:"w-5 h-5 text-white"})})]}),a.jsxs("form",{onSubmit:async e=>{e.preventDefault(),d(!0);try{const e={id:`task-${Date.now()}`,title:s,description:o,completed:!1,assignee:"You",dueDate:null,createdAt:(new Date).toISOString()};null==r||r(e),i(""),l(""),t()}catch(a){}finally{d(!1)}},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Task Title"}),a.jsx("input",{type:"text",value:s,onChange:e=>i(e.target.value),placeholder:"e.g., Book flight tickets",className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Description (Optional)"}),a.jsx("textarea",{value:o,onChange:e=>l(e.target.value),placeholder:"Add any additional details...",rows:3,className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50 resize-none"})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx(re,{type:"button",variant:"outline",onClick:t,className:"flex-1 bg-white/5 border-white/10 text-white hover:bg-white/10",children:"Cancel"}),a.jsx(re,{type:"submit",disabled:c,className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white",children:c?"Creating...":"Create Task"})]})]})]})]})},Be=({tripId:e})=>{const[t,n]=u.useState(!1),[r,s]=u.useState([{id:"1",title:"Book flights",completed:!0,assignee:"Sarah"},{id:"2",title:"Reserve hotel rooms",completed:!1,assignee:"Mike",dueDate:"Tomorrow"},{id:"3",title:"Plan day 1 itinerary",completed:!1,assignee:"Alex"}]),[i,o]=u.useState(!0),[l,c]=u.useState(!0),[d,m]=u.useState(null),{isPulling:p,isRefreshing:h,pullDistance:g}=f({onRefresh:async()=>{c(!0),await new Promise(e=>setTimeout(e,1e3)),c(!1)}});u.useEffect(()=>{setTimeout(()=>c(!1),600)},[]);const x=async e=>{await q.success(),s(r.map(t=>t.id===e?{...t,completed:!t.completed}:t))},w=r.filter(e=>!e.completed),b=r.filter(e=>e.completed);return a.jsxs("div",{className:"flex flex-col h-full bg-black px-4 py-4 relative",children:[a.jsx(_e,{isRefreshing:h,pullDistance:g,threshold:80}),a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-white",children:"Trip Tasks"}),a.jsxs("p",{className:"text-sm text-gray-400",children:[w.length," pending · ",b.length," completed"]})]}),a.jsx("button",{onClick:async()=>{await q.medium(),n(!0)},className:"p-3 bg-blue-600 rounded-lg active:scale-95 transition-transform",children:a.jsx(le,{size:20,className:"text-white"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[l?a.jsx(Oe,{}):a.jsx("div",{className:"space-y-3 mb-6",children:w.map(e=>{const t=d===e.id;return a.jsxs("div",{className:"relative overflow-hidden rounded-xl",onTouchStart:t=>{const a=t.touches[0].clientX,n=t=>{const n=t.touches[0].clientX;a-n>80&&(m(e.id),q.light())},r=()=>{document.removeEventListener("touchmove",n),document.removeEventListener("touchend",r)};document.addEventListener("touchmove",n),document.addEventListener("touchend",r)},onClick:()=>{t&&m(null)},children:[a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-4 bg-red-500/20",children:a.jsx("button",{onClick:t=>{t.stopPropagation(),(async e=>{await q.heavy(),m(null),setTimeout(()=>{s(r.filter(t=>t.id!==e))},150)})(e.id)},className:"p-3 bg-red-500 rounded-lg",children:a.jsx(pe,{size:18,className:"text-white"})})}),a.jsx("div",{className:"bg-white/10 rounded-xl p-4 transition-transform "+(t?"-translate-x-24":"translate-x-0"),children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("button",{onClick:()=>x(e.id),className:"mt-0.5 flex-shrink-0 w-6 h-6 rounded-full border-2 border-gray-400 flex items-center justify-center active:scale-95 transition-transform",children:e.completed&&a.jsx(ge,{size:14,className:"text-white"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"text-white font-medium",children:e.title}),a.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.assignee&&a.jsxs("span",{className:"text-xs text-gray-400",children:["@",e.assignee]}),e.dueDate&&a.jsx("span",{className:"text-xs text-orange-400",children:e.dueDate})]})]})]})})]},e.id)})}),b.length>0&&a.jsxs("div",{children:[a.jsxs("button",{onClick:async()=>{await q.light(),o(!i)},className:"flex items-center justify-between w-full mb-3 py-2",children:[a.jsxs("h3",{className:"text-sm font-semibold text-gray-400",children:["Completed (",b.length,")"]}),a.jsx("span",{className:"text-gray-400",children:i?"−":"+"})]}),i&&a.jsx("div",{className:"space-y-3",children:b.map(e=>a.jsx("div",{className:"bg-white/5 rounded-xl p-4 opacity-60",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("button",{onClick:()=>x(e.id),className:"mt-0.5 flex-shrink-0 w-6 h-6 rounded-full bg-green-500 flex items-center justify-center active:scale-95 transition-transform",children:a.jsx(ge,{size:14,className:"text-white"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"text-gray-300 line-through",children:e.title}),e.assignee&&a.jsxs("span",{className:"text-xs text-gray-500",children:["@",e.assignee]})]})]})},e.id))})]})]}),a.jsx(Ue,{isOpen:t,onClose:()=>n(!1),tripId:e,onTaskCreated:e=>{s(t=>[e,...t])}})]})};var Fe,ze,qe,We,He,Ve;(ze=Fe||(Fe={})).Prompt="PROMPT",ze.Camera="CAMERA",ze.Photos="PHOTOS",(We=qe||(qe={})).Rear="REAR",We.Front="FRONT",(Ve=He||(He={})).Uri="uri",Ve.Base64="base64",Ve.DataUrl="dataUrl";class Ye extends W{async getPhoto(e){return new Promise(async(t,a)=>{if(e.webUseInput||e.source===Fe.Photos)this.fileInputExperience(e,t,a);else if(e.source===Fe.Prompt){let n=document.querySelector("pwa-action-sheet");n||(n=document.createElement("pwa-action-sheet"),document.body.appendChild(n)),n.header=e.promptLabelHeader||"Photo",n.cancelable=!1,n.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}],n.addEventListener("onSelection",async n=>{0===n.detail?this.fileInputExperience(e,t,a):this.cameraExperience(e,t,a)})}else this.cameraExperience(e,t,a)})}async pickImages(e){return new Promise(async(e,t)=>{this.multipleFileInputExperience(e,t)})}async cameraExperience(e,t,a){if(customElements.get("pwa-camera-modal")){const r=document.createElement("pwa-camera-modal");r.facingMode=e.direction===qe.Front?"user":"environment",document.body.appendChild(r);try{await r.componentOnReady(),r.addEventListener("onPhoto",async n=>{const s=n.detail;null===s?a(new H("User cancelled photos app")):s instanceof Error?a(s):t(await this._getCameraPhoto(s,e)),r.dismiss(),document.body.removeChild(r)}),r.present()}catch(n){this.fileInputExperience(e,t,a)}}else this.fileInputExperience(e,t,a)}fileInputExperience(e,t,a){let n=document.querySelector("#_capacitor-camera-input");const r=()=>{var e;null===(e=n.parentNode)||void 0===e||e.removeChild(n)};n||(n=document.createElement("input"),n.id="_capacitor-camera-input",n.type="file",n.hidden=!0,document.body.appendChild(n),n.addEventListener("change",a=>{const s=n.files[0];let i="jpeg";if("image/png"===s.type?i="png":"image/gif"===s.type&&(i="gif"),"dataUrl"===e.resultType||"base64"===e.resultType){const a=new FileReader;a.addEventListener("load",()=>{if("dataUrl"===e.resultType)t({dataUrl:a.result,format:i});else if("base64"===e.resultType){const e=a.result.split(",")[1];t({base64String:e,format:i})}r()}),a.readAsDataURL(s)}else t({webPath:URL.createObjectURL(s),format:i}),r()}),n.addEventListener("cancel",e=>{a(new H("User cancelled photos app")),r()})),n.accept="image/*",n.capture=!0,e.source===Fe.Photos||e.source===Fe.Prompt?n.removeAttribute("capture"):e.direction===qe.Front?n.capture="user":e.direction===qe.Rear&&(n.capture="environment"),n.click()}multipleFileInputExperience(e,t){let a=document.querySelector("#_capacitor-camera-input-multiple");const n=()=>{var e;null===(e=a.parentNode)||void 0===e||e.removeChild(a)};a||(a=document.createElement("input"),a.id="_capacitor-camera-input-multiple",a.type="file",a.hidden=!0,a.multiple=!0,document.body.appendChild(a),a.addEventListener("change",t=>{const r=[];for(let e=0;e<a.files.length;e++){const t=a.files[e];let n="jpeg";"image/png"===t.type?n="png":"image/gif"===t.type&&(n="gif"),r.push({webPath:URL.createObjectURL(t),format:n})}e({photos:r}),n()}),a.addEventListener("cancel",e=>{t(new H("User cancelled photos app")),n()})),a.accept="image/*",a.click()}_getCameraPhoto(e,t){return new Promise((a,n)=>{const r=new FileReader,s=e.type.split("/")[1];"uri"===t.resultType?a({webPath:URL.createObjectURL(e),format:s,saved:!1}):(r.readAsDataURL(e),r.onloadend=()=>{const e=r.result;"dataUrl"===t.resultType?a({dataUrl:e,format:s,saved:!1}):a({base64String:e.split(",")[1],format:s,saved:!1})},r.onerror=e=>{n(e)})})}async checkPermissions(){if("undefined"==typeof navigator||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(await window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch(e){throw this.unavailable("Camera permissions are not available in this browser")}}async requestPermissions(){throw this.unimplemented("Not implemented on web.")}async pickLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}async getLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}}const Xe=V("Camera",{web:()=>new Ye});function Ge(e=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},void 0===window.Capacitor||e?void 0!==window.cordova&&function(e){e.CapacitorUtils.Synapse=new Proxy({},{get:(t,a)=>e.cordova.plugins[a]})}(window):function(e){e.CapacitorUtils.Synapse=new Proxy({},{get:(t,a)=>new Proxy({},{get:(t,n)=>(t,r,s)=>{const i=e.Capacitor.Plugins[a];void 0!==i?"function"==typeof i[n]?(async()=>{try{const e=await i[n](t);r(e)}catch(e){s(e)}})():s(new Error(`Method ${n} not found in Capacitor plugin ${a}`)):s(new Error(`Capacitor plugin ${a} not found`))}})})}(window))}var Ke,Je,Ze,Qe;(Je=Ke||(Ke={})).Documents="DOCUMENTS",Je.Data="DATA",Je.Library="LIBRARY",Je.Cache="CACHE",Je.External="EXTERNAL",Je.ExternalStorage="EXTERNAL_STORAGE",Je.ExternalCache="EXTERNAL_CACHE",Je.LibraryNoCloud="LIBRARY_NO_CLOUD",Je.Temporary="TEMPORARY",(Qe=Ze||(Ze={})).UTF8="utf8",Qe.ASCII="ascii",Qe.UTF16="utf16";const et=V("Filesystem",{web:()=>xe(()=>import("./web.js-CQUai8A_.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66])).then(e=>new e.FilesystemWeb)});Ge();const tt=V("Geolocation",{web:()=>xe(()=>import("./web.js-CAiVcvaM.js"),__vite__mapDeps([67,1,2,3,4,5,6])).then(e=>new e.GeolocationWeb)});Ge();const at=V("PushNotifications",{}),nt=V("Share",{web:()=>xe(()=>import("./web.js-D1l5e9pa.js"),__vite__mapDeps([68,1,2,3,4,5,6])).then(e=>new e.ShareWeb)});var rt,st,it,ot;(st=rt||(rt={})).Dark="DARK",st.Light="LIGHT",st.Default="DEFAULT",(ot=it||(it={})).None="NONE",ot.Slide="SLIDE",ot.Fade="FADE";const lt=V("StatusBar");var ct,dt;(dt=ct||(ct={}))[dt.Sunday=1]="Sunday",dt[dt.Monday=2]="Monday",dt[dt.Tuesday=3]="Tuesday",dt[dt.Wednesday=4]="Wednesday",dt[dt.Thursday=5]="Thursday",dt[dt.Friday=6]="Friday",dt[dt.Saturday=7]="Saturday";const ut=V("LocalNotifications",{web:()=>xe(()=>import("./web.js-CsOClVje.js"),__vite__mapDeps([69,1,2,3,4,5,6])).then(e=>new e.LocalNotificationsWeb)}),mt=class e{constructor(){}static getInstance(){return e.instance||(e.instance=new e),e.instance}async initializeApp(){Y.isNativePlatform()&&(await this.initializeStatusBar(),await this.initializePushNotifications(),await this.initializeLocalNotifications())}async initializeStatusBar(){try{await lt.setStyle({style:rt.Dark}),await lt.setBackgroundColor({color:"#000000"})}catch(e){}}async initializePushNotifications(){try{await at.requestPermissions(),await at.register(),at.addListener("registration",e=>{}),at.addListener("registrationError",e=>{}),at.addListener("pushNotificationReceived",e=>{}),at.addListener("pushNotificationActionPerformed",e=>{})}catch(e){}}async initializeLocalNotifications(){try{await ut.requestPermissions()}catch(e){}}async takePicture(){try{return(await Xe.getPhoto({quality:90,allowEditing:!0,resultType:He.Uri,source:Fe.Camera})).webPath||null}catch(e){return null}}async selectImage(){try{return(await Xe.getPhoto({quality:90,allowEditing:!0,resultType:He.Uri,source:Fe.Photos})).webPath||null}catch(e){return null}}async getCurrentPosition(){try{return await tt.getCurrentPosition({enableHighAccuracy:!0,timeout:1e4})}catch(e){return null}}async shareContent(e,t,a){try{return await nt.share({title:e,text:t,url:a,dialogTitle:"Share Trip"}),!0}catch(n){return!1}}async saveFile(e,t){try{return(await et.writeFile({path:t,data:e,directory:Ke.Documents})).uri}catch(a){return null}}async scheduleLocalNotification(e,t,a){try{await ut.schedule({notifications:[{title:e,body:t,id:Date.now(),schedule:{at:a},sound:void 0,attachments:void 0,actionTypeId:"",extra:null}]})}catch(n){}}isNativePlatform(){return Y.isNativePlatform()}getPlatform(){return Y.getPlatform()}};t(mt,"instance");const pt=mt.getInstance(),ht=({item:e,onPress:t,onLongPress:n})=>{const r=g({onLongPress:async()=>{await q.medium(),n()}});return a.jsxs("button",{...r,onClick:async()=>{await q.light(),t()},className:"media-grid-item rounded-md bg-white/5",style:{WebkitTapHighlightColor:"transparent",WebkitTouchCallout:"none"},children:[a.jsx(we,{src:e.url,alt:"Trip media",className:"w-full h-full object-cover",width:300,loading:"lazy"}),"video"===e.type&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/40 backdrop-blur-[1px]",children:a.jsx("div",{className:"bg-white/20 backdrop-blur-sm rounded-full p-2",children:a.jsx(Re,{size:20,className:"text-white drop-shadow-lg"})})})]})},ft=({tripId:e})=>{$();const{mediaItems:t,loading:n,refetch:r}=x(e),[s,i]=u.useState("all"),{isPulling:o,isRefreshing:l,pullDistance:c}=f({onRefresh:async()=>{await r()}}),d=t.filter(e=>"image"===e.media_type||"video"===e.media_type).map(e=>({id:e.id,type:"video"===e.media_type?"video":"image",url:e.media_url,uploadedBy:"User",uploadedAt:new Date(e.created_at)})).filter(e=>"all"===s||("photos"===s?"image"===e.type:"videos"===s?"video"===e.type:"files"===s?"file"===e.type:"links"!==s||"link"===e.type));return a.jsxs("div",{className:"flex flex-col h-full bg-black relative",children:[a.jsx(_e,{isRefreshing:l,pullDistance:c,threshold:80}),a.jsx("div",{className:"px-4 py-4 border-b border-white/10 safe-container",children:a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("button",{onClick:async()=>{await q.medium();try{await pt.takePicture()}catch(e){}},className:"native-button flex items-center justify-center gap-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white px-4 py-3 rounded-xl font-medium shadow-lg",children:[a.jsx(be,{size:20}),a.jsx("span",{children:"Take Photo"})]}),a.jsxs("button",{onClick:async()=>{await q.medium();try{await pt.selectImage()}catch(e){}},className:"native-button flex items-center justify-center gap-2 bg-white/10 text-white px-4 py-3 rounded-xl font-medium backdrop-blur-sm",children:[a.jsx(he,{size:20}),a.jsx("span",{children:"Upload"})]})]})}),a.jsx("div",{className:"px-4 py-3 border-b border-white/10 safe-container",children:a.jsx(w,{tripId:e,showDetails:!0})}),a.jsx("div",{className:"flex gap-2 px-4 py-3 border-b border-white/10 safe-container overflow-x-auto native-scroll scrollbar-hide",children:["all","photos","videos","files","links"].map(e=>a.jsx("button",{onClick:async()=>{await q.light(),i(e)},className:`\n              native-tab px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap flex-shrink-0\n              ${s===e?"bg-blue-600 text-white shadow-md":"bg-white/10 text-gray-300"}\n            `,children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),a.jsx("div",{className:"flex-1 overflow-y-auto px-2 py-2 native-scroll safe-container-bottom",style:{WebkitOverflowScrolling:"touch",overscrollBehavior:"contain"},children:n?a.jsx("div",{className:"media-grid",children:[...Array(9)].map((e,t)=>a.jsx("div",{className:"aspect-square rounded-md bg-white/5 skeleton-shimmer"},t))}):0===d.length?a.jsx("div",{className:"text-center py-12 animate-fade-in",children:a.jsxs("div",{className:"ios-bounce",children:[a.jsx(ve,{size:48,className:"text-gray-600 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-400 mb-2 font-medium",children:"No media yet"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Tap the camera button to add photos"})]})}):a.jsx("div",{className:"media-grid animate-fade-in",children:d.filter(e=>"image"===e.type||"video"===e.type).map((e,t)=>a.jsx("div",{style:{animationDelay:30*t+"ms",animation:"fade-in 0.3s ease-out both"},children:a.jsx(ht,{item:e,onPress:()=>{},onLongPress:()=>{}})},e.id))})})]})};const gt=new class{constructor(){t(this,"channels",new Map),t(this,"messageCallbacks",new Map)}async subscribeToTrip(e,t){if(this.messageCallbacks.has(e)||this.messageCallbacks.set(e,new Set),this.messageCallbacks.get(e).add(t),!this.channels.has(e)){const t=X.channel(`trip-messages:${e}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"trip_chat_messages",filter:`trip_id=eq.${e}`},t=>{var a;const n=this.transformMessage(t.new);null==(a=this.messageCallbacks.get(e))||a.forEach(e=>e(n))}).subscribe();this.channels.set(e,t)}return()=>{const a=this.messageCallbacks.get(e);if(a&&(a.delete(t),0===a.size)){const t=this.channels.get(e);t&&(X.removeChannel(t),this.channels.delete(e)),this.messageCallbacks.delete(e)}}}async sendMessage(e){const{data:t,error:a}=await X.from("trip_chat_messages").insert({trip_id:e.tripId,content:e.content,author_name:e.userName,user_id:e.userId,reply_to_id:e.replyToId,thread_id:e.threadId,attachments:e.attachments||[]}).select().single();if(a)throw a;return this.transformMessage(t)}async getMessages(e,t=50,a){let n=X.from("trip_chat_messages").select("*").eq("trip_id",e).eq("is_deleted",!1).order("created_at",{ascending:!1}).limit(t);a&&(n=n.lt("created_at",a.toISOString()));const{data:r,error:s}=await n;if(s)throw s;return(r||[]).map(this.transformMessage).reverse()}async editMessage(e,t){const{error:a}=await X.from("trip_chat_messages").update({content:t,is_edited:!0,edited_at:(new Date).toISOString()}).eq("id",e);if(a)throw a}async deleteMessage(e){const{error:t}=await X.from("trip_chat_messages").update({is_deleted:!0,deleted_at:(new Date).toISOString()}).eq("id",e);if(t)throw t}async getUnreadCount(e,t,a){const{count:n,error:r}=await X.from("trip_chat_messages").select("*",{count:"exact",head:!0}).eq("trip_id",e).neq("user_id",t).gt("created_at",a.toISOString());if(r)throw r;return n||0}async scheduleMessage(e){var t;try{const{data:a,error:n}=await X.functions.invoke("schedule-message",{body:{content:e.content,send_at:e.sendAt.toISOString(),trip_id:e.tripId,tour_id:e.tourId,user_id:e.userId,priority:e.priority||"fyi",is_recurring:e.isRecurring||!1,recurrence_type:e.recurrenceType,recurrence_end:null==(t=e.recurrenceEnd)?void 0:t.toISOString(),template_id:e.templateId}});if(n)throw n;return{success:!0,id:a.id}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Unknown error"}}}async getMessageTemplates(e,t){try{const{data:a,error:n}=await X.functions.invoke("get-message-templates",{body:{tripType:e,category:t}});if(n)throw n;return a.templates||[]}catch(a){return[]}}fillTemplate(e,t){let a=e;return Object.entries(t).forEach(([e,t])=>{const n=new RegExp(`\\{\\{${e}\\}\\}`,"g");a=a.replace(n,t||`[${e}]`)}),a}cleanup(){this.channels.forEach(e=>{X.removeChannel(e)}),this.channels.clear(),this.messageCallbacks.clear()}transformMessage(e){return{id:e.id,trip_id:e.trip_id,content:e.content,author_name:e.author_name,user_id:e.user_id,created_at:e.created_at,updated_at:e.updated_at,reply_to_id:e.reply_to_id,thread_id:e.thread_id,is_edited:e.is_edited,edited_at:e.edited_at,is_deleted:e.is_deleted,deleted_at:e.deleted_at,attachments:e.attachments||[],media_type:e.media_type,media_url:e.media_url,link_preview:e.link_preview,privacy_mode:e.privacy_mode,privacy_encrypted:e.privacy_encrypted}}async getScheduledMessages(e,t,a){try{const{data:n,error:r}=await X.from("scheduled_messages").select("*").eq("user_id",e).eq(t?"trip_id":"tour_id",t||a).order("send_at",{ascending:!0});if(r)throw r;return n||[]}catch(n){return[]}}async updateScheduledMessage(e,t){try{const{error:a}=await X.from("scheduled_messages").update(t).eq("id",e);if(a)throw a;return{success:!0}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Unknown error"}}}async cancelScheduledMessage(e){try{const{error:t}=await X.from("scheduled_messages").delete().eq("id",e);if(t)throw t;return{success:!0}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Unknown error"}}}},xt=(e,t)=>t.some(t=>e instanceof t);let wt,bt;const vt=new WeakMap,yt=new WeakMap,jt=new WeakMap;let Nt={get(e,t,a){if(e instanceof IDBTransaction){if("done"===t)return vt.get(e);if("store"===t)return a.objectStoreNames[1]?void 0:a.objectStore(a.objectStoreNames[0])}return Et(e[t])},set:(e,t,a)=>(e[t]=a,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function kt(e){Nt=e(Nt)}function Ct(e){return(bt||(bt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(Pt(this),t),Et(this.request)}:function(...t){return Et(e.apply(Pt(this),t))}}function St(e){return"function"==typeof e?Ct(e):(e instanceof IDBTransaction&&function(e){if(vt.has(e))return;const t=new Promise((t,a)=>{const n=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",s),e.removeEventListener("abort",s)},r=()=>{t(),n()},s=()=>{a(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",r),e.addEventListener("error",s),e.addEventListener("abort",s)});vt.set(e,t)}(e),xt(e,wt||(wt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Nt):e)}function Et(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,a)=>{const n=()=>{e.removeEventListener("success",r),e.removeEventListener("error",s)},r=()=>{t(Et(e.result)),n()},s=()=>{a(e.error),n()};e.addEventListener("success",r),e.addEventListener("error",s)});return jt.set(t,e),t}(e);if(yt.has(e))return yt.get(e);const t=St(e);return t!==e&&(yt.set(e,t),jt.set(t,e)),t}const Pt=e=>jt.get(e);const Tt=["get","getKey","getAll","getAllKeys","count"],Dt=["put","add","delete","clear"],Rt=new Map;function It(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Rt.get(t))return Rt.get(t);const a=t.replace(/FromIndex$/,""),n=t!==a,r=Dt.includes(a);if(!(a in(n?IDBIndex:IDBObjectStore).prototype)||!r&&!Tt.includes(a))return;const s=async function(e,...t){const s=this.transaction(e,r?"readwrite":"readonly");let i=s.store;return n&&(i=i.index(t.shift())),(await Promise.all([i[a](...t),r&&s.done]))[0]};return Rt.set(t,s),s}kt(e=>({...e,get:(t,a,n)=>It(t,a)||e.get(t,a,n),has:(t,a)=>!!It(t,a)||e.has(t,a)}));const _t=["continue","continuePrimaryKey","advance"],Mt={},Ot=new WeakMap,At=new WeakMap,Lt={get(e,t){if(!_t.includes(t))return e[t];let a=Mt[t];return a||(a=Mt[t]=function(...e){Ot.set(this,At.get(this)[t](...e))}),a}};async function*$t(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;const a=new Proxy(t,Lt);for(At.set(a,t),jt.set(a,Pt(t));t;)yield a,t=await(Ot.get(a)||t.continue()),Ot.delete(a)}function Ut(e,t){return t===Symbol.asyncIterator&&xt(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&xt(e,[IDBIndex,IDBObjectStore])}kt(e=>({...e,get:(t,a,n)=>Ut(t,a)?$t:e.get(t,a,n),has:(t,a)=>Ut(t,a)||e.has(t,a)}));let Bt=null;async function Ft(){return Bt||(Bt=await function(e,t,{blocked:a,upgrade:n,blocking:r,terminated:s}={}){const i=indexedDB.open(e,t),o=Et(i);return n&&i.addEventListener("upgradeneeded",e=>{n(Et(i.result),e.oldVersion,e.newVersion,Et(i.transaction),e)}),a&&i.addEventListener("blocked",e=>a(e.oldVersion,e.newVersion,e)),o.then(e=>{s&&e.addEventListener("close",()=>s()),r&&e.addEventListener("versionchange",e=>r(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}("chravel-chat-db",1,{upgrade(e){if(!e.objectStoreNames.contains("messages")){const t=e.createObjectStore("messages",{keyPath:"id"});t.createIndex("by-trip","trip_id"),t.createIndex("by-date","created_at")}}}),Bt)}async function zt(e,t){try{const a=(await Ft()).transaction("messages","readwrite");await Promise.all(t.map(t=>a.store.put({...t,trip_id:e}))),await a.done}catch(a){}}function qt({tripId:e,enabled:t=!0}){const{toast:a}=G(),[n,r]=u.useState([]),[s,i]=u.useState(!0),[o,l]=u.useState(!1),[c,d]=u.useState(!0),[m,p]=u.useState(!1),[h,f]=u.useState(null),g=u.useRef(null);u.useEffect(()=>{X.auth.getUser().then(({data:e})=>{f(e.user)})},[]),u.useEffect(()=>{if(!t||!h||!e)return;return(async()=>{try{const t=await async function(e){try{const t=await Ft();return(await t.getAllFromIndex("messages","by-trip",e)).sort((e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime())}catch(t){return[]}}(e);t.length>0&&(r(t),i(!1));const a=await gt.getMessages(e,10);r(a),d(10===a.length),await zt(e,a);const n=await gt.subscribeToTrip(e,e=>{r(t=>t.some(t=>t.id===e.id)?t:[...t,e])});g.current=n,i(!1)}catch(t){a({title:"Connection Error",description:"Failed to connect to messaging service",variant:"destructive"}),i(!1)}})(),()=>{g.current&&g.current()}},[t,h,e,a]);const x=u.useCallback(async t=>{var n;if(h){l(!0);try{const a=(null==(n=h.email)?void 0:n.split("@")[0])||"Unknown User",r=await gt.sendMessage({content:t,tripId:e,userName:a,userId:h.id});await zt(e,[r])}catch(r){throw a({title:"Send Failed",description:"Failed to send message",variant:"destructive"}),r}finally{l(!1)}}else a({title:"Not Authenticated",description:"Please sign in to send messages",variant:"destructive"})},[h,e,a]),w=u.useCallback(async()=>{if(0!==n.length&&c&&!m){p(!0);try{const t=n[0],a=await gt.getMessages(e,20,new Date(t.created_at));a.length>0?(r(e=>[...a,...e]),d(20===a.length)):d(!1)}catch(t){}finally{p(!1)}}},[e,n,c,m]),b=u.useCallback(async e=>{try{await gt.deleteMessage(e),r(t=>t.filter(t=>t.id!==e))}catch(t){a({title:"Delete Failed",description:"Failed to delete message",variant:"destructive"})}},[a]);return{messages:n,isLoading:s,isSending:o,sendMessage:x,loadMore:w,deleteMessage:b,isConnected:!0,hasMore:c,isLoadingMore:m}}const Wt=({tripId:e,isEvent:t=!1})=>{b();const n=u.useRef(null);u.useRef(null);const[r,s]=u.useState({}),{messages:i,isLoading:o,sendMessage:l,loadMore:c,hasMore:d,isLoadingMore:m}=qt({tripId:e,enabled:!0}),p=i.map(e=>({id:e.id,text:e.content,sender:{id:e.user_id||"unknown",name:e.author_name,avatar:`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.author_name}`},createdAt:new Date(e.created_at).toISOString(),isBroadcast:!1})),{inputMessage:h,setInputMessage:f,replyingTo:g,clearReply:x,sendMessage:w}=v({tripId:e});y({preventZoom:!0,adjustViewport:!0,onShow:()=>{setTimeout(()=>{var e;null==(e=n.current)||e.scrollIntoView({behavior:"smooth"})},300)}});const S=async(e=!1,t=!1,a)=>{await q.light(),h.trim()&&(await l(h),f(""))},E=async(e,t)=>{await q.light();const a={...r};a[e]||(a[e]={});const n=a[e][t]||{count:0,userReacted:!1};n.userReacted=!n.userReacted,n.count+=n.userReacted?1:-1,a[e][t]=n,s(a)};return a.jsx("div",{className:"flex flex-col h-full bg-black relative p-4",children:a.jsxs("div",{className:"rounded-2xl border border-white/10 bg-black/40 shadow-[inset_0_1px_0_rgba(255,255,255,0.06)] overflow-hidden flex flex-col mobile-portrait-chat-container",style:{height:"480px",maxHeight:"480px",minHeight:"360px"},children:[o?a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsx(Me,{})}):a.jsx(j,{messages:p,renderMessage:e=>a.jsx(N,{message:e,reactions:r[e.id],onReaction:E}),onLoadMore:c,hasMore:d,isLoading:m,initialVisibleCount:10,className:"chat-scroll-container native-scroll"}),g&&a.jsx("div",{className:"border-t border-white/10 bg-black/30 px-4 py-2",children:a.jsx(k,{replyTo:g,onCancel:x})}),a.jsx("div",{className:"border-t border-white/10 bg-black/30 p-3",children:a.jsx(C,{inputMessage:h,onInputChange:f,onSendMessage:S,onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),S())},apiKey:"",isTyping:!1,tripMembers:[],hidePayments:!0,tripId:e})})]})})},Ht=({isOpen:e,onClose:t,tripId:n,onPaymentCreated:r})=>{const[s,i]=u.useState(""),[o,l]=u.useState(""),[c,d]=u.useState("USD"),[m,p]=u.useState(2),[h,f]=u.useState([]),[g,x]=u.useState(!1);if(!e)return null;return a.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:t}),a.jsxs("div",{className:"relative w-full max-w-md bg-glass-slate-card border border-glass-slate-border rounded-t-3xl sm:rounded-3xl shadow-enterprise-2xl p-6 animate-slide-up",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-green-500/20 flex items-center justify-center",children:a.jsx(Ne,{className:"w-5 h-5 text-green-400"})}),a.jsx("h2",{className:"text-xl font-semibold text-white",children:"Add Payment"})]}),a.jsx("button",{onClick:t,className:"w-8 h-8 rounded-lg bg-white/10 hover:bg-white/20 flex items-center justify-center transition-colors",children:a.jsx(F,{className:"w-5 h-5 text-white"})})]}),a.jsxs("form",{onSubmit:async e=>{e.preventDefault(),x(!0);try{je.addSessionPayment(n,{amount:parseFloat(o),currency:c,description:s,splitCount:m,splitParticipants:Array.from({length:m},(e,t)=>`user${t+1}`),paymentMethods:h.length>0?h:["Venmo"]}),i(""),l(""),d("USD"),p(2),f([]),null==r||r(),t()}catch(a){}finally{x(!1)}},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Description"}),a.jsx("input",{type:"text",value:s,onChange:e=>i(e.target.value),placeholder:"e.g., Dinner at restaurant",className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-green-500/50",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Amount"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",children:"$"}),a.jsx("input",{type:"number",step:"0.01",value:o,onChange:e=>l(e.target.value),placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-green-500/50",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Currency"}),a.jsxs("select",{value:c,onChange:e=>d(e.target.value),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-green-500/50",children:[a.jsx("option",{value:"USD",children:"USD ($)"}),a.jsx("option",{value:"EUR",children:"EUR (€)"}),a.jsx("option",{value:"GBP",children:"GBP (£)"}),a.jsx("option",{value:"JPY",children:"JPY (¥)"}),a.jsx("option",{value:"CAD",children:"CAD ($)"}),a.jsx("option",{value:"AUD",children:"AUD ($)"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Split Between People"}),a.jsx("input",{type:"number",min:"1",max:"20",value:m,onChange:e=>p(parseInt(e.target.value)||1),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-green-500/50",required:!0}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:o&&m>0?`$${(parseFloat(o)/m).toFixed(2)} per person`:""})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Preferred Payment Methods"}),a.jsx("div",{className:"space-y-2",children:["Venmo","Cash App","Zelle","PayPal","Apple Cash"].map(e=>a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:h.includes(e),onChange:t=>{t.target.checked?f([...h,e]):f(h.filter(t=>t!==e))},className:"w-5 h-5 rounded border-white/10 bg-white/5 text-green-600 focus:ring-2 focus:ring-green-500/50"}),a.jsx("span",{className:"text-white",children:e})]},e))})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx(re,{type:"button",variant:"outline",onClick:t,className:"flex-1 bg-white/5 border-white/10 text-white hover:bg-white/10",children:"Cancel"}),a.jsx(re,{type:"submit",disabled:g,className:"flex-1 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white",children:g?"Creating...":"Create Payment"})]})]})]})]})},Vt=({tripId:e})=>{const[t,n]=u.useState(!1),[r,s]=u.useState([{id:"1",payer:"Sarah Chen",payerAvatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Sarah",amount:450,currency:"USD",description:"Hotel - Night 1 & 2",status:"settled",splitWith:["Alex","Jordan","Taylor"],date:"2024-03-15"},{id:"2",payer:"Alex Rivera",payerAvatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Alex",amount:120.5,currency:"USD",description:"Group Dinner - Italian Restaurant",status:"pending",splitWith:["Sarah","Jordan","Taylor"],date:"2024-03-16"},{id:"3",payer:"Jordan Kim",payerAvatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Jordan",amount:85,currency:"USD",description:"Uber to Airport",status:"pending",splitWith:["Sarah","Alex","Taylor"],date:"2024-03-17"}]);u.useEffect(()=>{const t=je.getSessionPayments(e);if(t.length>0){const e=t.map(e=>({id:e.id,payer:e.createdByName,payerAvatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Demo",amount:e.amount,currency:e.currency,description:e.description,status:e.is_settled?"settled":"pending",splitWith:e.split_participants,date:e.created_at}));s(t=>[...e,...t])}},[e]);const i=e=>{switch(e){case"settled":return a.jsx(ke,{size:20,className:"text-green-500"});case"pending":return a.jsx(ce,{size:20,className:"text-yellow-500"});case"overdue":return a.jsx(fe,{size:20,className:"text-red-500"})}},o=e=>{switch(e){case"settled":return"Settled";case"pending":return"Pending";case"overdue":return"Overdue"}},l=r.filter(e=>"settled"!==e.status).reduce((e,t)=>e+t.amount/(t.splitWith.length+1),0);return a.jsxs("div",{className:"flex flex-col h-full bg-black",children:[a.jsx("div",{className:"px-4 pt-4 pb-2",children:a.jsxs("div",{className:"bg-gradient-to-br from-green-600/20 to-green-700/20 border border-green-500/30 rounded-2xl p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-sm text-gray-400",children:"Your Share Pending"}),a.jsx(Ne,{size:20,className:"text-green-500"})]}),a.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:["$",l.toFixed(2)]}),a.jsxs("p",{className:"text-xs text-gray-400",children:[r.filter(e=>"settled"!==e.status).length," unsettled payments"]})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-4 space-y-3 native-scroll",children:0===r.length?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Ne,{size:48,className:"text-slate-600 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-slate-400 mb-2",children:"No payments yet"}),a.jsx("p",{className:"text-slate-500 text-sm",children:"Split expenses and track who owes what"})]}):r.map(e=>a.jsx("button",{onClick:()=>(async()=>{await q.light()})(e.id),className:"w-full bg-white/10 hover:bg-white/15 border border-white/10 rounded-xl p-4 transition-all active:scale-[0.98] text-left",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("img",{src:e.payerAvatar,alt:e.payer,className:"w-10 h-10 rounded-full flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-white truncate",children:e.description}),a.jsxs("p",{className:"text-xs text-gray-400",children:["Paid by ",e.payer]})]}),a.jsxs("div",{className:"text-right flex-shrink-0",children:[a.jsxs("p",{className:"text-sm font-semibold text-white",children:["$",e.amount.toFixed(2)]}),a.jsxs("p",{className:"text-xs text-gray-400",children:["$",(e.amount/(e.splitWith.length+1)).toFixed(2)," each"]})]})]}),a.jsxs("div",{className:"flex items-center justify-between mt-2",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[i(e.status),a.jsx("span",{className:"text-xs text-gray-400",children:o(e.status)})]}),a.jsxs("span",{className:"text-xs text-gray-500",children:["Split ",e.splitWith.length+1," ways"]})]})]})]})},e.id))}),a.jsx("div",{className:"sticky bottom-0 p-4 bg-gradient-to-t from-black via-black to-transparent border-t border-white/10 safe-bottom",children:a.jsxs("button",{onClick:async()=>{await q.medium(),n(!0)},className:"w-full bg-gradient-to-r from-green-600 to-green-500 hover:from-green-700 hover:to-green-600 text-white font-medium py-4 rounded-xl transition-all active:scale-[0.98] shadow-lg flex items-center justify-center gap-2 min-h-[44px]",children:[a.jsx(le,{size:20}),"Add Payment Split"]})}),a.jsx(Ht,{isOpen:t,onClose:()=>n(!1),tripId:e,onPaymentCreated:()=>{const t=je.getSessionPayments(e).map(e=>({id:e.id,payer:e.createdByName,payerAvatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Demo",amount:e.amount,currency:e.currency,description:e.description,status:e.is_settled?"settled":"pending",splitWith:e.split_participants,date:e.created_at}));s(t)}})]})},Yt=({activeTab:e,onTabChange:t,tripId:n,basecamp:r})=>{const{accentColors:s}=K(),{isDemoMode:i}=$(),o=u.useRef(null),l=u.useRef(null),c=[{id:"chat",label:"Chat",icon:Ce},{id:"calendar",label:"Calendar",icon:ie},{id:"concierge",label:"Concierge",icon:Se},{id:"media",label:"Media",icon:be},{id:"payments",label:"Payments",icon:Ee},{id:"places",label:"Places",icon:de},{id:"polls",label:"Polls",icon:ye},{id:"tasks",label:"Tasks",icon:M}];u.useEffect(()=>{if(l.current){const t=l.current.querySelector(`[data-tab="${e}"]`);t&&t.scrollIntoView({behavior:"smooth",inline:"start",block:"nearest"})}const t=()=>{const e=l.current,t=null==e?void 0:e.parentElement,a=((null==t?void 0:t.offsetHeight)??(null==e?void 0:e.offsetHeight))||52;document.documentElement.style.setProperty("--mobile-tabs-h",`${a}px`)};let a;const n=()=>{clearTimeout(a),a=setTimeout(t,100)};return t(),window.addEventListener("resize",n),window.addEventListener("orientationchange",n),()=>{window.removeEventListener("resize",n),window.removeEventListener("orientationchange",n)}},[e]);return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"sticky top-[var(--mobile-header-h,73px)] z-40 bg-black/95 backdrop-blur-md border-b border-white/10",children:a.jsx("div",{ref:l,className:"flex overflow-x-auto scrollbar-hide gap-2 px-4 py-2",style:{scrollbarWidth:"none",msOverflowStyle:"none",scrollSnapType:"x mandatory",WebkitOverflowScrolling:"touch"},children:c.map(n=>{const r=n.icon,i=e===n.id;return a.jsxs("button",{"data-tab":n.id,onClick:()=>(async e=>{await q.light(),t(e)})(n.id),className:`\n                  flex items-center justify-center gap-2 \n                  px-4 py-2 min-w-max h-[44px]\n                  rounded-lg font-medium text-sm\n                  transition-all duration-200\n                  flex-shrink-0\n                  active:scale-95\n                  scroll-snap-align-start\n                  ${i?`bg-gradient-to-r ${s.gradient} text-white shadow-lg`:"bg-white/10 text-gray-300"}\n                `,children:[a.jsx(r,{size:16,className:"flex-shrink-0"}),a.jsx("span",{className:"whitespace-nowrap text-sm",children:n.label})]},n.id)})})}),a.jsx("div",{ref:o,className:"bg-background flex flex-col min-h-0 flex-1 mb-[calc(80px+env(safe-area-inset-bottom))]",style:{height:"calc(100dvh - var(--mobile-header-h, 73px) - var(--mobile-tabs-h, 52px) - 80px - env(safe-area-inset-bottom))",minHeight:"400px",maxHeight:"calc(100dvh - var(--mobile-header-h, 73px) - var(--mobile-tabs-h, 52px) - 80px - env(safe-area-inset-bottom))",WebkitOverflowScrolling:"touch"},children:(()=>{switch(e){case"chat":return a.jsx(P,{tripId:n});case"calendar":return a.jsx($e,{tripId:n});case"tasks":return a.jsx(Be,{tripId:n});case"polls":return a.jsx(E,{tripId:n});case"media":return a.jsx(ft,{tripId:n});case"places":return a.jsx(O,{tripId:n});case"payments":return a.jsx(Vt,{tripId:n});case"concierge":return a.jsx(S,{tripId:n,basecamp:r,isDemoMode:i});default:return a.jsx(Wt,{tripId:n})}})()})]})};class Xt extends u.Component{constructor(e){super(e),t(this,"handleReset",async()=>{await q.light(),this.setState({hasError:!1,error:void 0})}),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){q.heavy()}render(){var e;return this.state.hasError?this.props.fallback?this.props.fallback:a.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-black p-6",children:a.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-6 max-w-md",children:[a.jsx(J,{className:"text-red-400 mx-auto mb-4",size:48}),a.jsx("h2",{className:"text-xl font-bold text-white text-center mb-2",children:"Something went wrong"}),a.jsx("p",{className:"text-gray-400 text-center mb-6 text-sm",children:(null==(e=this.state.error)?void 0:e.message)||"An unexpected error occurred"}),a.jsxs("button",{onClick:this.handleReset,className:"w-full bg-blue-600 text-white py-3 rounded-xl flex items-center justify-center gap-2 active:scale-95 transition-transform",children:[a.jsx(B,{size:20}),a.jsx("span",{children:"Try Again"})]})]})}):this.props.children}}const Gt=m.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),Kt=()=>{const e=m.useContext(Gt);if(!e)throw new Error("useDrawerContext must be used within a Drawer.Root");return e};!function(e){if("undefined"==typeof document)return;let t=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",t.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}("[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,100%,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,-100%,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(-100%,0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(100%,0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(\n[data-state=closed]\n){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,100%,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,100%,0)}}@keyframes slideFromTop{from{transform:translate3d(0,-100%,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,-100%,0)}}@keyframes slideFromLeft{from{transform:translate3d(-100%,0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(-100%,0,0)}}@keyframes slideFromRight{from{transform:translate3d(100%,0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(100%,0,0)}}");const Jt="undefined"!=typeof window?u.useLayoutEffect:u.useEffect;function Zt(...e){return(...t)=>{for(let a of e)"function"==typeof a&&a(...t)}}function Qt(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function ea(){return aa(/^iPad/)||aa(/^Mac/)&&navigator.maxTouchPoints>1}function ta(){return aa(/^iPhone/)||ea()}function aa(e){return"undefined"!=typeof window&&null!=window.navigator?e.test(window.navigator.platform):void 0}const na="undefined"!=typeof document&&window.visualViewport;function ra(e){let t=window.getComputedStyle(e);return/(auto|scroll)/.test(t.overflow+t.overflowX+t.overflowY)}function sa(e){for(ra(e)&&(e=e.parentElement);e&&!ra(e);)e=e.parentElement;return e||document.scrollingElement||document.documentElement}const ia=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let oa,la=0;function ca(e={}){let{isDisabled:t}=e;Jt(()=>{if(!t)return la++,1===la&&ta()&&(oa=function(){let e,t=0,a=a=>{e=sa(a.target),e===document.documentElement&&e===document.body||(t=a.changedTouches[0].pageY)},n=a=>{if(!e||e===document.documentElement||e===document.body)return void a.preventDefault();let n=a.changedTouches[0].pageY,r=e.scrollTop,s=e.scrollHeight-e.clientHeight;0!==s&&((r<=0&&n>t||r>=s&&n<t)&&a.preventDefault(),t=n)},r=e=>{let t=e.target;ma(t)&&t!==document.activeElement&&(e.preventDefault(),t.style.transform="translateY(-2000px)",t.focus(),requestAnimationFrame(()=>{t.style.transform=""}))},s=e=>{let t=e.target;ma(t)&&(t.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{t.style.transform="",na&&(na.height<window.innerHeight?requestAnimationFrame(()=>{ua(t)}):na.addEventListener("resize",()=>ua(t),{once:!0}))}))},i=()=>{window.scrollTo(0,0)},o=window.pageXOffset,l=window.pageYOffset,c=Zt(function(e,t,a){let n=e.style[t];return e.style[t]=a,()=>{e.style[t]=n}}(document.documentElement,"paddingRight",window.innerWidth-document.documentElement.clientWidth+"px"));window.scrollTo(0,0);let d=Zt(da(document,"touchstart",a,{passive:!1,capture:!0}),da(document,"touchmove",n,{passive:!1,capture:!0}),da(document,"touchend",r,{passive:!1,capture:!0}),da(document,"focus",s,!0),da(window,"scroll",i));return()=>{c(),d(),window.scrollTo(o,l)}}()),()=>{la--,0===la&&(null==oa||oa())}},[t])}function da(e,t,a,n){return e.addEventListener(t,a,n),()=>{e.removeEventListener(t,a,n)}}function ua(e){let t=document.scrollingElement||document.documentElement;for(;e&&e!==t;){let t=sa(e);if(t!==document.documentElement&&t!==document.body&&t!==e){let a=t.getBoundingClientRect().top,n=e.getBoundingClientRect().top;e.getBoundingClientRect().bottom>t.getBoundingClientRect().bottom+24&&(t.scrollTop+=n-a)}e=t.parentElement}}function ma(e){return e instanceof HTMLInputElement&&!ia.has(e.type)||e instanceof HTMLTextAreaElement||e instanceof HTMLElement&&e.isContentEditable}function pa(...e){return u.useCallback(function(...e){return t=>e.forEach(e=>function(e,t){"function"==typeof e?e(t):null!=e&&(e.current=t)}(e,t))}(...e),e)}const ha=new WeakMap;function fa(e,t,a=!1){if(!(e&&e instanceof HTMLElement))return;let n={};Object.entries(t).forEach(([t,a])=>{t.startsWith("--")?e.style.setProperty(t,a):(n[t]=e.style[t],e.style[t]=a)}),a||ha.set(e,n)}const ga=e=>{switch(e){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return e}};function xa(e,t){if(!e)return null;const a=window.getComputedStyle(e),n=a.transform||a.webkitTransform||a.mozTransform;let r=n.match(/^matrix3d\((.+)\)$/);return r?parseFloat(r[1].split(", ")[ga(t)?13:12]):(r=n.match(/^matrix\((.+)\)$/),r?parseFloat(r[1].split(", ")[ga(t)?5:4]):null)}function wa(e,t){if(!e)return()=>{};const a=e.style.cssText;return Object.assign(e.style,t),()=>{e.style.cssText=a}}const ba={DURATION:.5,EASE:[.32,.72,0,1]},va=16,ya="vaul-dragging";function ja(e){const t=m.useRef(e);return m.useEffect(()=>{t.current=e}),m.useMemo(()=>(...e)=>null==t.current?void 0:t.current.call(t,...e),[])}function Na({prop:e,defaultProp:t,onChange:a=()=>{}}){const[n,r]=function({defaultProp:e,onChange:t}){const a=m.useState(e),[n]=a,r=m.useRef(n),s=ja(t);return m.useEffect(()=>{r.current!==n&&(s(n),r.current=n)},[n,r,s]),a}({defaultProp:t,onChange:a}),s=void 0!==e,i=s?e:n,o=ja(a);return[i,m.useCallback(t=>{if(s){const a="function"==typeof t?t(e):t;a!==e&&o(a)}else r(t)},[s,e,r,o])]}let ka=null;function Ca({open:e,onOpenChange:t,children:a,onDrag:n,onRelease:r,snapPoints:s,shouldScaleBackground:i=!1,setBackgroundColorOnScale:o=!0,closeThreshold:l=.25,scrollLockTimeout:d=100,dismissible:u=!0,handleOnly:p=!1,fadeFromIndex:h=s&&s.length-1,activeSnapPoint:f,setActiveSnapPoint:g,fixed:x,modal:w=!0,onClose:b,nested:v,noBodyStyles:y,direction:j="bottom",defaultOpen:N=!1,disablePreventScroll:k=!0,snapToSequentialPoint:C=!1,preventScrollRestoration:S=!1,repositionInputs:E=!0,onAnimationEnd:P,container:T,autoFocus:D=!1}){var R,I;const[_=!1,M]=Na({defaultProp:N,prop:e,onChange:e=>{null==t||t(e),e||v||de(),setTimeout(()=>{null==P||P(e)},1e3*ba.DURATION),e&&!w&&"undefined"!=typeof window&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),e||(document.body.style.pointerEvents="auto")}}),[O,A]=m.useState(!1),[L,$]=m.useState(!1),[U,B]=m.useState(!1),F=m.useRef(null),z=m.useRef(null),q=m.useRef(null),W=m.useRef(null),H=m.useRef(null),V=m.useRef(!1),Y=m.useRef(null),X=m.useRef(0),G=m.useRef(!1),K=m.useRef(0),J=m.useRef(null),Z=m.useRef((null==(R=J.current)?void 0:R.getBoundingClientRect().height)||0),Q=m.useRef((null==(I=J.current)?void 0:I.getBoundingClientRect().width)||0),ee=m.useRef(0),te=m.useCallback(e=>{s&&e===ie.length-1&&(z.current=new Date)},[]),{activeSnapPoint:ae,activeSnapPointIndex:ne,setActiveSnapPoint:re,onRelease:se,snapPointsOffset:ie,onDrag:oe,shouldFade:le,getPercentageDragged:ce}=function({activeSnapPointProp:e,setActiveSnapPointProp:t,snapPoints:a,drawerRef:n,overlayRef:r,fadeFromIndex:s,onSnapPointChange:i,direction:o="bottom",container:l,snapToSequentialPoint:c}){const[d,u]=Na({prop:e,defaultProp:null==a?void 0:a[0],onChange:t}),[p,h]=m.useState("undefined"!=typeof window?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);m.useEffect(()=>{function e(){h({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const f=m.useMemo(()=>d===(null==a?void 0:a[a.length-1])||null,[a,d]),g=m.useMemo(()=>null==a?void 0:a.findIndex(e=>e===d),[a,d]),x=a&&a.length>0&&(s||0===s)&&!Number.isNaN(s)&&a[s]===d||!a,w=m.useMemo(()=>{const e=l?{width:l.getBoundingClientRect().width,height:l.getBoundingClientRect().height}:"undefined"!=typeof window?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var t;return null!=(t=null==a?void 0:a.map(t=>{const a="string"==typeof t;let n=0;if(a&&(n=parseInt(t,10)),ga(o)){const r=a?n:p?t*e.height:0;return p?"bottom"===o?e.height-r:-e.height+r:r}const r=a?n:p?t*e.width:0;return p?"right"===o?e.width-r:-e.width+r:r}))?t:[]},[a,p,l]),b=m.useMemo(()=>null!==g?null==w?void 0:w[g]:null,[w,g]),v=m.useCallback(e=>{var t;const l=null!=(t=null==w?void 0:w.findIndex(t=>t===e))?t:null;i(l),fa(n.current,{transition:`transform ${ba.DURATION}s cubic-bezier(${ba.EASE.join(",")})`,transform:ga(o)?`translate3d(0, ${e}px, 0)`:`translate3d(${e}px, 0, 0)`}),w&&l!==w.length-1&&l!==s&&l<s?fa(r.current,{transition:`opacity ${ba.DURATION}s cubic-bezier(${ba.EASE.join(",")})`,opacity:"0"}):fa(r.current,{transition:`opacity ${ba.DURATION}s cubic-bezier(${ba.EASE.join(",")})`,opacity:"1"}),u(null==a?void 0:a[Math.max(l,0)])},[n.current,a,w,s,r,u]);return m.useEffect(()=>{if(d||e){var t;const n=null!=(t=null==a?void 0:a.findIndex(t=>t===e||t===d))?t:-1;w&&-1!==n&&"number"==typeof w[n]&&v(w[n])}},[d,e,a,w,v]),{isLastSnapPoint:f,activeSnapPoint:d,shouldFade:x,getPercentageDragged:function(e,t){if(!a||"number"!=typeof g||!w||void 0===s)return null;const n=g===s-1;if(g>=s&&t)return 0;if(n&&!t)return 1;if(!x&&!n)return null;const r=n?g+1:g-1,i=n?w[r]-w[r-1]:w[r+1]-w[r],o=e/Math.abs(i);return n?1-o:o},setActiveSnapPoint:u,activeSnapPointIndex:g,onRelease:function({draggedDistance:e,closeDrawer:t,velocity:n,dismissible:i}){if(void 0===s)return;const l="bottom"===o||"right"===o?(null!=b?b:0)-e:(null!=b?b:0)+e,d=0===g,u=e>0;if(g===s-1&&fa(r.current,{transition:`opacity ${ba.DURATION}s cubic-bezier(${ba.EASE.join(",")})`}),!c&&n>2&&!u)return void(i?t():v(w[0]));if(!c&&n>2&&u&&w&&a)return void v(w[a.length-1]);const m=null==w?void 0:w.reduce((e,t)=>"number"!=typeof e||"number"!=typeof t?e:Math.abs(t-l)<Math.abs(e-l)?t:e),p=ga(o)?window.innerHeight:window.innerWidth;if(n>.4&&Math.abs(e)<.4*p){const e=u?1:-1;if(e>0&&f)return void v(w[a.length-1]);if(d&&e<0&&i&&t(),null===g)return;return void v(w[g+e])}v(m)},onDrag:function({draggedDistance:e}){if(null===b)return;const t="bottom"===o||"right"===o?b-e:b+e;("bottom"===o||"right"===o)&&t<w[w.length-1]||("top"===o||"left"===o)&&t>w[w.length-1]||fa(n.current,{transform:ga(o)?`translate3d(0, ${t}px, 0)`:`translate3d(${t}px, 0, 0)`})},snapPointsOffset:w}}({snapPoints:s,activeSnapPointProp:f,setActiveSnapPointProp:g,drawerRef:J,fadeFromIndex:h,overlayRef:F,onSnapPointChange:te,direction:j,container:T,snapToSequentialPoint:C});ca({isDisabled:!_||L||!w||U||!O||!E||!k});const{restorePositionSetting:de}=function({isOpen:e,modal:t,nested:a,hasBeenOpened:n,preventScrollRestoration:r,noBodyStyles:s}){const[i,o]=m.useState(()=>"undefined"!=typeof window?window.location.href:""),l=m.useRef(0),c=m.useCallback(()=>{if(Qt()&&null===ka&&e&&!s){ka={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:e,innerHeight:t}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:-l.current+"px",left:-e+"px",right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const e=t-window.innerHeight;e&&l.current>=t&&(document.body.style.top=-(l.current+e)+"px")}),300)}},[e]),d=m.useCallback(()=>{if(Qt()&&null!==ka&&!s){const e=-parseInt(document.body.style.top,10),t=-parseInt(document.body.style.left,10);Object.assign(document.body.style,ka),window.requestAnimationFrame(()=>{r&&i!==window.location.href?o(window.location.href):window.scrollTo(t,e)}),ka=null}},[i]);return m.useEffect(()=>{function e(){l.current=window.scrollY}return e(),window.addEventListener("scroll",e),()=>{window.removeEventListener("scroll",e)}},[]),m.useEffect(()=>{!a&&n&&(e?(!window.matchMedia("(display-mode: standalone)").matches&&c(),t||window.setTimeout(()=>{d()},500)):d())},[e,n,i,t,a,c,d]),{restorePositionSetting:d}}({isOpen:_,modal:w,nested:v,hasBeenOpened:O,preventScrollRestoration:S,noBodyStyles:y});function ue(){return(window.innerWidth-26)/window.innerWidth}function me(e,t){var a,n;let r=e;const s=null==(a=window.getSelection())?void 0:a.toString(),i=J.current?xa(J.current,j):null,o=new Date;if(r.hasAttribute("data-vaul-no-drag")||r.closest("[data-vaul-no-drag]"))return!1;if("right"===j||"left"===j)return!0;if(z.current&&o.getTime()-z.current.getTime()<500)return!1;if(null!==i&&("bottom"===j?i>0:i<0))return!0;if(s&&s.length>0)return!1;if(o.getTime()-(null==(n=H.current)?void 0:n.getTime())<d&&0===i)return H.current=o,!1;if(t)return H.current=o,!1;for(;r;){if(r.scrollHeight>r.clientHeight){if(0!==r.scrollTop)return H.current=new Date,!1;if("dialog"===r.getAttribute("role"))return!0}r=r.parentNode}return!0}function pe(e){!function(){if(!L||!J.current)return;J.current.classList.remove(ya),V.current=!1,$(!1),W.current=new Date}(),null==b||b(),e||M(!1),setTimeout(()=>{s&&re(s[0])},1e3*ba.DURATION)}function he(){if(!J.current)return;const e=document.querySelector("[data-vaul-drawer-wrapper]"),t=xa(J.current,j);fa(J.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${ba.DURATION}s cubic-bezier(${ba.EASE.join(",")})`}),fa(F.current,{transition:`opacity ${ba.DURATION}s cubic-bezier(${ba.EASE.join(",")})`,opacity:"1"}),i&&t&&t>0&&_&&fa(e,{borderRadius:"8px",overflow:"hidden",...ga(j)?{transform:`scale(${ue()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${ue()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${ba.DURATION}s`,transitionTimingFunction:`cubic-bezier(${ba.EASE.join(",")})`},!0)}return m.useEffect(()=>{var e;function t(){if(!J.current||!E)return;if(ma(document.activeElement)||G.current){var e;const t=(null==(e=window.visualViewport)?void 0:e.height)||0,a=window.innerHeight;let n=a-t;const r=J.current.getBoundingClientRect().height||0,i=r>.8*a;ee.current||(ee.current=r);const o=J.current.getBoundingClientRect().top;if(Math.abs(K.current-n)>60&&(G.current=!G.current),s&&s.length>0&&ie&&ne){n+=ie[ne]||0}if(K.current=n,r>t||G.current){const e=J.current.getBoundingClientRect().height;let a=e;e>t&&(a=t-(i?o:26)),J.current.style.height=x?e-Math.max(n,0)+"px":`${Math.max(a,t-o)}px`}else J.current.style.height=`${ee.current}px`;s&&s.length>0&&!G.current?J.current.style.bottom="0px":J.current.style.bottom=`${Math.max(n,0)}px`}}return null==(e=window.visualViewport)||e.addEventListener("resize",t),()=>{var e;return null==(e=window.visualViewport)?void 0:e.removeEventListener("resize",t)}},[ne,s,ie]),m.useEffect(()=>(_&&(fa(document.documentElement,{scrollBehavior:"auto"}),z.current=new Date),()=>{!function(e,t){if(!(e&&e instanceof HTMLElement))return;let a=ha.get(e);a&&(e.style[t]=a[t])}(document.documentElement,"scrollBehavior")}),[_]),m.createElement(c,{defaultOpen:N,onOpenChange:e=>{(u||e)&&(e?A(!0):pe(!0),M(e))},open:_},m.createElement(Gt.Provider,{value:{activeSnapPoint:ae,snapPoints:s,setActiveSnapPoint:re,drawerRef:J,overlayRef:F,onOpenChange:t,onPress:function(e){var t,a;(u||s)&&(J.current&&!J.current.contains(e.target)||(Z.current=(null==(t=J.current)?void 0:t.getBoundingClientRect().height)||0,Q.current=(null==(a=J.current)?void 0:a.getBoundingClientRect().width)||0,$(!0),q.current=new Date,ta()&&window.addEventListener("touchend",()=>V.current=!1,{once:!0}),e.target.setPointerCapture(e.pointerId),X.current=ga(j)?e.pageY:e.pageX))},onRelease:function(e){if(!L||!J.current)return;J.current.classList.remove(ya),V.current=!1,$(!1),W.current=new Date;const t=xa(J.current,j);if(!me(e.target,!1)||!t||Number.isNaN(t))return;if(null===q.current)return;const a=W.current.getTime()-q.current.getTime(),n=X.current-(ga(j)?e.pageY:e.pageX),i=Math.abs(n)/a;if(i>.05&&(B(!0),setTimeout(()=>{B(!1)},200)),s){return se({draggedDistance:n*("bottom"===j||"right"===j?1:-1),closeDrawer:pe,velocity:i,dismissible:u}),void(null==r||r(e,!0))}if("bottom"===j||"right"===j?n>0:n<0)return he(),void(null==r||r(e,!0));if(i>.4)return pe(),void(null==r||r(e,!1));var o;const c=Math.min(null!=(o=J.current.getBoundingClientRect().height)?o:0,window.innerHeight);var d;const m=Math.min(null!=(d=J.current.getBoundingClientRect().width)?d:0,window.innerWidth),p="left"===j||"right"===j;if(Math.abs(t)>=(p?m:c)*l)return pe(),void(null==r||r(e,!1));null==r||r(e,!0),he()},onDrag:function(e){var t;if(J.current&&L){const a="bottom"===j||"right"===j?1:-1,r=(X.current-(ga(j)?e.pageY:e.pageX))*a,o=r>0,l=s&&!u&&!o;if(l&&0===ne)return;const c=Math.abs(r),d=document.querySelector("[data-vaul-drawer-wrapper]");let m=c/("bottom"===j||"top"===j?Z.current:Q.current);const p=ce(c,o);if(null!==p&&(m=p),l&&m>=1)return;if(!V.current&&!me(e.target,o))return;if(J.current.classList.add(ya),V.current=!0,fa(J.current,{transition:"none"}),fa(F.current,{transition:"none"}),s&&oe({draggedDistance:r}),o&&!s){const e=(t=r,8*(Math.log(t+1)-2)),n=Math.min(-1*e,0)*a;return void fa(J.current,{transform:ga(j)?`translate3d(0, ${n}px, 0)`:`translate3d(${n}px, 0, 0)`})}const f=1-m;if((le||h&&ne===h-1)&&(null==n||n(e,m),fa(F.current,{opacity:`${f}`,transition:"none"},!0)),d&&F.current&&i){const e=Math.min(ue()+m*(1-ue()),1),t=8-8*m,a=Math.max(0,14-14*m);fa(d,{borderRadius:`${t}px`,transform:ga(j)?`scale(${e}) translate3d(0, ${a}px, 0)`:`scale(${e}) translate3d(${a}px, 0, 0)`,transition:"none"},!0)}if(!s){const e=c*a;fa(J.current,{transform:ga(j)?`translate3d(0, ${e}px, 0)`:`translate3d(${e}px, 0, 0)`})}}},dismissible:u,handleOnly:p,isOpen:_,isDragging:L,shouldFade:le,closeDrawer:pe,onNestedDrag:function(e,t){if(t<0)return;const a=(window.innerWidth-va)/window.innerWidth,n=a+t*(1-a),r=t*va-16;fa(J.current,{transform:ga(j)?`scale(${n}) translate3d(0, ${r}px, 0)`:`scale(${n}) translate3d(${r}px, 0, 0)`,transition:"none"})},onNestedOpenChange:function(e){const t=e?(window.innerWidth-va)/window.innerWidth:1,a=e?-16:0;Y.current&&window.clearTimeout(Y.current),fa(J.current,{transition:`transform ${ba.DURATION}s cubic-bezier(${ba.EASE.join(",")})`,transform:`scale(${t}) translate3d(0, ${a}px, 0)`}),!e&&J.current&&(Y.current=setTimeout(()=>{const e=xa(J.current,j);fa(J.current,{transition:"none",transform:ga(j)?`translate3d(0, ${e}px, 0)`:`translate3d(${e}px, 0, 0)`})},500))},onNestedRelease:function(e,t){const a=ga(j)?window.innerHeight:window.innerWidth,n=t?(a-va)/a:1,r=t?-16:0;t&&fa(J.current,{transition:`transform ${ba.DURATION}s cubic-bezier(${ba.EASE.join(",")})`,transform:ga(j)?`scale(${n}) translate3d(0, ${r}px, 0)`:`scale(${n}) translate3d(${r}px, 0, 0)`})},keyboardIsOpen:G,modal:w,snapPointsOffset:ie,direction:j,shouldScaleBackground:i,setBackgroundColorOnScale:o,noBodyStyles:y,container:T,autoFocus:D}},a))}const Sa=m.forwardRef(function({...e},t){const{overlayRef:a,snapPoints:r,onRelease:s,shouldFade:i,isOpen:o,modal:l}=Kt(),c=pa(t,a),d=r&&r.length>0;return l?m.createElement(n,{onMouseUp:s,ref:c,"data-vaul-overlay":"","data-vaul-snap-points":o&&d?"true":"false","data-vaul-snap-points-overlay":o&&i?"true":"false",...e}):("undefined"!=typeof window&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),null)});Sa.displayName="Drawer.Overlay";const Ea=m.forwardRef(function({onPointerDownOutside:e,style:t,onOpenAutoFocus:a,...n},s){const{drawerRef:i,onPress:o,onRelease:l,onDrag:c,keyboardIsOpen:d,snapPointsOffset:p,modal:h,isOpen:f,direction:g,snapPoints:x,container:w,handleOnly:b,autoFocus:v}=Kt(),[y,j]=m.useState(!1),N=pa(s,i),k=m.useRef(null),C=m.useRef(null),S=m.useRef(!1),E=x&&x.length>0;!function(){const{direction:e,isOpen:t,shouldScaleBackground:a,setBackgroundColorOnScale:n,noBodyStyles:r}=Kt(),s=m.useRef(null),i=u.useMemo(()=>document.body.style.backgroundColor,[]);function o(){return(window.innerWidth-26)/window.innerWidth}m.useEffect(()=>{if(t&&a){s.current&&clearTimeout(s.current);const t=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!t)return;n&&!r&&wa(document.body,{background:"black"}),wa(t,{transformOrigin:ga(e)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${ba.DURATION}s`,transitionTimingFunction:`cubic-bezier(${ba.EASE.join(",")})`});const a=wa(t,{borderRadius:"8px",overflow:"hidden",...ga(e)?{transform:`scale(${o()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${o()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{a(),s.current=window.setTimeout(()=>{i?document.body.style.background=i:document.body.style.removeProperty("background")},1e3*ba.DURATION)}}},[t,a,i])}();function P(e){k.current=null,S.current=!1,l(e)}return m.useEffect(()=>{E&&window.requestAnimationFrame(()=>{j(!0)})},[]),m.createElement(r,{"data-vaul-drawer-direction":g,"data-vaul-drawer":"","data-vaul-delayed-snap-points":y?"true":"false","data-vaul-snap-points":f&&E?"true":"false","data-vaul-custom-container":w?"true":"false",...n,ref:N,style:p&&p.length>0?{"--snap-point-height":`${p[0]}px`,...t}:t,onPointerDown:e=>{b||(null==n.onPointerDown||n.onPointerDown.call(n,e),k.current={x:e.pageX,y:e.pageY},o(e))},onOpenAutoFocus:e=>{null==a||a(e),v||e.preventDefault()},onPointerDownOutside:t=>{null==e||e(t),h&&!t.defaultPrevented?d.current&&(d.current=!1):t.preventDefault()},onFocusOutside:e=>{h||e.preventDefault()},onPointerMove:e=>{if(C.current=e,b)return;if(null==n.onPointerMove||n.onPointerMove.call(n,e),!k.current)return;const t=e.pageY-k.current.y,a=e.pageX-k.current.x,r="touch"===e.pointerType?10:2,s=((e,t,a=0)=>{if(S.current)return!0;const n=Math.abs(e.y),r=Math.abs(e.x),s=r>n,i=["bottom","right"].includes(t)?1:-1;if("left"===t||"right"===t){if(!(e.x*i<0)&&r>=0&&r<=a)return s}else if(!(e.y*i<0)&&n>=0&&n<=a)return!s;return S.current=!0,!0})({x:a,y:t},g,r);s?c(e):(Math.abs(a)>r||Math.abs(t)>r)&&(k.current=null)},onPointerUp:e=>{null==n.onPointerUp||n.onPointerUp.call(n,e),k.current=null,S.current=!1,l(e)},onPointerOut:e=>{null==n.onPointerOut||n.onPointerOut.call(n,e),P(C.current)},onContextMenu:e=>{null==n.onContextMenu||n.onContextMenu.call(n,e),P(C.current)}})});Ea.displayName="Drawer.Content";const Pa=m.forwardRef(function({preventCycle:e=!1,children:t,...a},n){const{closeDrawer:r,isDragging:s,snapPoints:i,activeSnapPoint:o,setActiveSnapPoint:l,dismissible:c,handleOnly:d,isOpen:u,onPress:p,onDrag:h}=Kt(),f=m.useRef(null),g=m.useRef(!1);function x(){window.clearTimeout(f.current),g.current=!1}return m.createElement("div",{onClick:function(){g.current?x():window.setTimeout(()=>{!function(){if(s||e||g.current)return void x();if(x(),(!i||0===i.length)&&c)return void r();if(o===i[i.length-1]&&c)return void r();const t=i.findIndex(e=>e===o);if(-1===t)return;const a=i[t+1];l(a)}()},120)},onPointerCancel:x,onPointerDown:e=>{d&&p(e),f.current=window.setTimeout(()=>{g.current=!0},250)},onPointerMove:e=>{d&&h(e)},ref:n,"data-vaul-drawer-visible":u?"true":"false","data-vaul-handle":"","aria-hidden":"true",...a},m.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},t))});Pa.displayName="Drawer.Handle";const Ta={Root:Ca,NestedRoot:function({onDrag:e,onOpenChange:t,...a}){const{onNestedDrag:n,onNestedOpenChange:r,onNestedRelease:s}=Kt();if(!n)throw new Error("Drawer.NestedRoot must be placed in another drawer");return m.createElement(Ca,{nested:!0,onClose:()=>{r(!1)},onDrag:(t,a)=>{n(t,a),null==e||e(t,a)},onOpenChange:e=>{e&&r(e)},onRelease:s,...a})},Content:Ea,Overlay:Sa,Trigger:s,Portal:function(e){const t=Kt(),{container:a=t.container,...n}=e;return m.createElement(d,{container:a,...n})},Handle:Pa,Close:i,Title:o,Description:l},Da=({shouldScaleBackground:e=!0,...t})=>a.jsx(Ta.Root,{shouldScaleBackground:e,...t});Da.displayName="Drawer";const Ra=Ta.Portal,Ia=Ta.Close,_a=u.forwardRef(({className:e,...t},n)=>a.jsx(Ta.Overlay,{ref:n,className:Z("fixed inset-0 z-50 bg-black/80",e),...t}));_a.displayName=Ta.Overlay.displayName;const Ma=u.forwardRef(({className:e,children:t,...n},r)=>a.jsxs(Ra,{children:[a.jsx(_a,{}),a.jsxs(Ta.Content,{ref:r,className:Z("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",e),...n,children:[a.jsx("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),t]})]}));Ma.displayName="DrawerContent";const Oa=({className:e,...t})=>a.jsx("div",{className:Z("grid gap-1.5 p-4 text-center sm:text-left",e),...t});Oa.displayName="DrawerHeader";const Aa=u.forwardRef(({className:e,...t},n)=>a.jsx(Ta.Title,{ref:n,className:Z("text-lg font-semibold leading-none tracking-tight",e),...t}));Aa.displayName=Ta.Title.displayName;u.forwardRef(({className:e,...t},n)=>a.jsx(Ta.Description,{ref:n,className:Z("text-sm text-muted-foreground",e),...t})).displayName=Ta.Description.displayName;const La=({trip:e,isOpen:t,onClose:n,onDescriptionUpdate:r})=>a.jsx(Da,{open:t,onOpenChange:e=>!e&&n(),children:a.jsxs(Ma,{className:"bg-black border-t border-white/10",children:[a.jsx(Oa,{className:"border-b border-white/10",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Aa,{className:"text-white text-lg font-semibold",children:"Trip Details"}),a.jsx(Ia,{asChild:!0,children:a.jsx("button",{onClick:()=>{q.light(),n()},className:"p-2 rounded-lg hover:bg-white/10 active:scale-95 transition-all",children:a.jsx(F,{size:20,className:"text-white"})})})]})}),a.jsx("div",{className:"px-4 py-4 max-h-[70vh] overflow-y-auto",children:a.jsx(T,{trip:e,onDescriptionUpdate:r})})]})}),$a=()=>{const{tripId:e}=p(),t=h();Q();const[n,r]=u.useState("chat"),[s,i]=u.useState(""),[o,l]=u.useState(!1),c=m.useRef(null);y({preventZoom:!0,adjustViewport:!0});const d=e?parseInt(e,10):null,f=d?ae(d):null;m.useEffect(()=>{f&&!s&&i(f.description)},[f,s]),m.useEffect(()=>{const e=()=>{var e;const t=(null==(e=c.current)?void 0:e.offsetHeight)||73;document.documentElement.style.setProperty("--mobile-header-h",`${t}px`)},t=((e,t=100)=>{let a;return()=>{clearTimeout(a),a=setTimeout(e,t)}})(e,100);return e(),window.addEventListener("resize",t),window.addEventListener("orientationchange",t),()=>{window.removeEventListener("resize",t),window.removeEventListener("orientationchange",t)}},[]);const g=f?{...f,description:s||f.description}:null;if(!g)return a.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center p-4",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-2xl font-bold text-white mb-4",children:"Trip Not Found"}),a.jsx("p",{className:"text-gray-400 mb-6",children:"The trip you're looking for doesn't exist."}),a.jsx("button",{onClick:()=>{q.light(),t("/")},className:"bg-blue-600 text-white px-6 py-3 rounded-xl transition-colors active:scale-95",children:"Back to My Trips"})]})});const x=ne(f).basecamp;return a.jsx(Xt,{children:a.jsxs("div",{className:"flex flex-col min-h-screen bg-black",children:[a.jsx("div",{ref:c,className:"sticky top-0 z-50 bg-black/95 backdrop-blur-md border-b border-white/10",children:a.jsxs("div",{className:"px-4 py-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("button",{onClick:()=>{q.light(),t("/")},className:"p-2 -ml-2 active:scale-95 transition-transform",children:a.jsx(Pe,{size:24,className:"text-white"})}),a.jsx("button",{onClick:()=>q.light(),className:"p-2 -mr-2 active:scale-95 transition-transform",children:a.jsx(Te,{size:24,className:"text-white"})})]}),a.jsxs("div",{className:"text-center px-2",children:[a.jsx("h1",{className:"text-lg font-semibold text-white leading-tight mb-1.5 break-words",children:f.title}),a.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs text-gray-400",children:[a.jsxs("span",{children:[f.location," • ",f.participants.length," travelers"]}),a.jsxs("button",{onClick:()=>{q.light(),l(!0)},className:"flex items-center gap-1 active:scale-95 transition-transform text-blue-400 hover:text-blue-300","aria-label":"View trip details",children:[a.jsx(De,{size:16}),a.jsx("span",{className:"font-medium",children:"More Details"})]})]})]})]})}),a.jsx(Yt,{activeTab:n,onTabChange:e=>{q.light(),r(e)},tripId:e||"1",basecamp:x}),a.jsx(La,{trip:g,isOpen:o,onClose:()=>{q.light(),l(!1)},onDescriptionUpdate:i}),a.jsx(ee,{})]})})},Ua=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const e=te(),{tripId:t}=p(),n=h(),{user:r}=Q(),[s,i]=u.useState("chat"),[o,l]=u.useState(!1),[c,d]=u.useState(!1),[f,g]=u.useState(!1),[x,w]=u.useState(!1),[b,v]=u.useState(!1),[y,j]=u.useState(!1),[N,k]=u.useState(!1),[C,S]=u.useState(""),[E,P]=u.useState({}),_=t?parseInt(t,10):null,M=_?ae(_):null;m.useEffect(()=>{M&&!C&&S(M.description)},[M,C]);const O=M?{...M,title:E.title||M.title,location:E.location||M.location,dateRange:E.dateRange||M.dateRange,description:C||M.description}:null;if(!O)return a.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-4xl font-bold text-white mb-4",children:"Trip Not Found"}),a.jsx("p",{className:"text-gray-400 mb-6",children:"The trip you're looking for doesn't exist."}),a.jsx("button",{onClick:()=>n("/"),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl transition-colors",children:"Back to My Trips"})]})});const $=ne(M),U=$.basecamp,B=$.broadcasts,F=$.links,q=$.itinerary,W={id:t||"1",title:M.title,location:M.location,dateRange:M.dateRange,basecamp:U,calendar:q,broadcasts:B,links:F,messages:[],collaborators:M.participants,itinerary:q,isPro:!1};return e?a.jsx($a,{}):a.jsxs("div",{className:"min-h-screen bg-black",children:[a.jsxs("div",{className:"container mx-auto px-6 py-8 max-w-7xl",children:[a.jsx(I,{tripContext:W,showInbox:o,onToggleInbox:()=>l(!o),onShowInvite:()=>g(!0),onShowTripSettings:()=>v(!0),onShowAuth:()=>w(!0)}),o&&r&&a.jsx("div",{className:"mb-8",children:a.jsx(D,{})}),a.jsx(T,{trip:O,onDescriptionUpdate:S,onTripUpdate:e=>{P(t=>({...t,...e})),e.name&&P(t=>({...t,title:e.name})),e.description&&S(e.description)},onShowExport:()=>k(!0)}),a.jsx(Ie,{activeTab:s,onTabChange:i,onShowTripsPlusModal:()=>j(!0),tripId:t||"1",tripName:O.title,basecamp:U})]}),a.jsx(R,{showSettings:c,onCloseSettings:()=>d(!1),showInvite:f,onCloseInvite:()=>g(!1),showAuth:x,onCloseAuth:()=>w(!1),showTripSettings:b,onCloseTripSettings:()=>v(!1),showTripsPlusModal:y,onCloseTripsPlusModal:()=>j(!1),tripName:O.title,tripId:t||"1",userId:null==r?void 0:r.id}),a.jsx(A,{isOpen:N,onClose:()=>k(!1),onExport:async(e,a,n,r)=>{const s=t&&/^\d+$/.test(t);try{let i;if(s){z.info("Generating demo PDF with mock data...");const n=await je.getMockPayments(t||"1"),s=await je.getMockPolls(t||"1"),o=await je.getMockMembers(t||"1");i=await L({tripId:t||"1",tripTitle:O.title,destination:O.location,dateRange:O.dateRange,description:O.description,mockData:{payments:n,polls:s,roster:o}},e,a,r)}else{const s=await fetch("https://jmjiyekmxwsxkfnqwyaa.supabase.co/functions/v1/export-trip",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tripId:t,sections:e,layout:a,privacyRedaction:n,paper:r})});if(s.ok)i=await s.blob();else{z.info("Using demo export mode...");const n=await je.getMockPayments(t||"1"),s=await je.getMockPolls(t||"1"),o=await je.getMockMembers(t||"1");i=await L({tripId:t||"1",tripTitle:O.title,destination:O.location,dateRange:O.dateRange,description:O.description,mockData:{payments:n,polls:s,roster:o}},e,a,r)}}const o=window.URL.createObjectURL(i),l=document.createElement("a");l.href=o,l.download=`Trip_${O.title.replace(/[^a-z0-9]/gi,"_")}_${a}_${Date.now()}.pdf`,document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(o),document.body.removeChild(l),z.success("PDF exported successfully!")}catch(i){throw z.error("Failed to export PDF"),i}},tripName:O.title,tripId:t||"1"})]})}},Symbol.toStringTag,{value:"Module"}));export{Ze as E,Ua as T};
