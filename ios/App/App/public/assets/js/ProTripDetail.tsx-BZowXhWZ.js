import{j as e}from"./chunk-DE8J_P3a.js";import{u as s,r as t,j as a}from"./chunk-CHPtWMTz.js";import{j as r,k as i,A as n,U as l,f as c,G as o,T as d,h as m,g as x,i as h}from"./chunk-hQfd_hHm.js";import{c as u,e as p,k as g,S as b,H as y,X as j,s as f,j as N,i as v,p as w,v as C,t as k}from"../index-C69Cv9fm.js";import{A as _}from"./chunk-0Vn9svHl.js";import{C as S}from"./chunk-D_Qk7JHd.js";import{U as R,S as A,P as M}from"./chunk-D_Hxdxtf.js";import{M as z,S as I,k as P}from"./chunk-B6KUG25W.js";import{U as T}from"./chunk-D5WpN7K-.js";import{C as q}from"./chunk-D53qnCh4.js";import{C as B}from"./chunk-C0eak1NN.js";import{D as U}from"./chunk-DcTAIqBw.js";import{M as D}from"./chunk-ByyMTJWo.js";import{C as E,P as O}from"./chunk-C-NDN0ZE.js";import{C as $,L,T as F,P as V,b as H,c as G,a as Y,g as W}from"./chunk-CVnd1dNx.js";import{S as J}from"./chunk-DILfnUIk.js";import{B as K}from"./chunk-CKgI9q5n.js";import{I as Q}from"./chunk-D3Z6_DOi.js";import{D as Z,a as X,b as ee,d as se,e as te,c as ae}from"./chunk-DtLDND_v.js";import{C as re,S as ie,a as ne,b as le,c as ce,d as oe}from"./chunk-LoZVIojA.js";import{R as de}from"./chunk-ldxIEj_z.js";import{f as me}from"./chunk-DN5ISW2H.js";import{I as xe}from"./chunk-C5qHPTeJ.js";import{D as he,a as ue,b as pe,c as ge,L as be}from"./chunk-YjRoWQ3-.js";import{B as ye}from"./chunk-Bc1XvzR8.js";import{U as je}from"./chunk-CkE6zG_x.js";import{S as fe}from"./chunk-C-heRrtZ.js";import{C as Ne}from"./chunk-DeuaeHUI.js";import{C as ve}from"./chunk-CD10_Lnj.js";import{C as we}from"./chunk-DuSQr7KO.js";import{F as Ce}from"./chunk-CeA63noh.js";import{C as ke,T as _e}from"./chunk-BxvRdxTs.js";import{M as Se}from"./chunk-DgElOEdu.js";import{S as Re}from"./chunk-88HG7dU1.js";import{B as Ae}from"./chunk--pMnkzaH.js";import{H as Me}from"./chunk-BpSVmO2m.js";import{u as ze}from"./chunk-Ccyq873b.js";import{p as Ie}from"./chunk--XGoeuWx.js";import{P as Pe}from"./chunk-av49YmwH.js";import"./tripService.ts-CUb9l8sj.js";import"./chunk-DGLf2uCM.js";import"./chunk-wPum6LLk.js";import"./chunk-Bbmjf7eQ.js";import"./chunk-DV21tWlK.js";import"./chunk-BzRjpoc5.js";import"./chunk-A2g_dVj8.js";import"./chunk-BIY1ublO.js";import"./chunk-DoIo-fWL.js";import"./chunk-DJZXZyJn.js";import"./chunk-30ZbY-F3.js";import"./chunk-bP8xJp5e.js";import"./chunk-y0HRaaXz.js";import"./chunk-DV9vF-NS.js";import"./chunk-4koW6KZp.js";import"./chunk-ObNbiZMt.js";import"./chunk-D393L8yP.js";import"./chunk-CbEMFF6w.js";import"./chunk-DyZQNKrs.js";import"./chunk-Bx2M---t.js";import"./chunk-Ck98qql-.js";import"./chunk-DkxHCs8B.js";import"./chunk-BOGV63ZI.js";import"./chunk-I0kJWO9F.js";import"./chunk-vfQQTDq4.js";import"./chunk-vJ6XLRYv.js";import"./chunk-BBFu0Y12.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=u("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),qe=u("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]),Be=u("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]),Ue=u("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),De=u("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),Ee=u("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]),Oe=u("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),$e=({tripContext:t,showInbox:a,onToggleInbox:r,onShowInvite:i,onShowTripSettings:n,onShowAuth:l})=>{const c=s(),{user:o}=p(),{accentColors:d}=g();return e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("button",{onClick:()=>c("/"),className:"flex items-center gap-3 text-gray-300 hover:text-white transition-colors group",children:[e.jsx("div",{className:"bg-gray-800 p-2 rounded-lg shadow-lg group-hover:shadow-yellow-500/20 transition-all border border-gray-700 hover:border-yellow-500/50",children:e.jsx(_,{size:20})}),e.jsx("span",{className:"font-medium",children:"Back to Trips"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:`bg-gradient-to-r ${d.gradient} backdrop-blur-sm border border-yellow-500/30 rounded-xl px-4 py-2 flex items-center gap-2`,children:[e.jsx(S,{size:16,className:"text-white"}),e.jsx("span",{className:"text-white font-medium",children:"PRO"})]}),o&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:i,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-xl transition-colors flex items-center gap-2",children:[e.jsx(R,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Invite"})]}),e.jsxs("button",{onClick:r,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-xl transition-colors flex items-center gap-2",children:[e.jsx(z,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:a?"Hide Inbox":"Messages"})]}),e.jsx("button",{onClick:n,className:"bg-gray-700 hover:bg-gray-600 text-white p-2 rounded-xl transition-colors",children:e.jsx(b,{size:20})})]})]})]})},Le=({isOpen:s,onClose:a,roomAssignments:r,roster:i,onUpdateAssignments:n})=>{const[l,c]=t.useState(r);if(!s)return null;const o=e=>{const s=i.find(s=>s.id===e);return(null==s?void 0:s.name)||"Unknown"},d=e=>{switch(e){case"suite":return"bg-purple-500/20 text-purple-400 border-purple-500/30";case"single":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"double":return"bg-green-500/20 text-green-400 border-green-500/30";case"connecting":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-2xl max-w-4xl w-full max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{className:"text-red-400",size:24}),e.jsx("h2",{className:"text-xl font-bold text-white",children:"Room Assignments"})]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(j,{size:24})})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(80vh-120px)]",children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:l.map(s=>e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-gray-700 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-medium",children:s.room}),e.jsx("p",{className:"text-gray-400 text-sm",children:s.hotel})]}),e.jsx("div",{className:`px-2 py-1 rounded-lg border text-xs font-medium ${d(s.roomType)}`,children:s.roomType})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(T,{size:16,className:"text-gray-400"}),e.jsxs("span",{className:"text-gray-400 text-sm",children:["Occupants (",s.occupants.length,")"]})]}),e.jsx("div",{className:"space-y-1",children:s.occupants.map(s=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-red-400 rounded-full"}),e.jsx("span",{className:"text-white",children:o(s)})]},s))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(q,{size:14,className:"text-gray-400"}),e.jsx("span",{className:"text-gray-400 text-xs",children:"Check-in"})]}),e.jsx("p",{className:"text-white text-sm",children:new Date(s.checkIn).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(q,{size:14,className:"text-gray-400"}),e.jsx("span",{className:"text-gray-400 text-xs",children:"Check-out"})]}),e.jsx("p",{className:"text-white text-sm",children:new Date(s.checkOut).toLocaleDateString()})]})]}),s.specialRequests&&s.specialRequests.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-xs mb-1",children:"Special Requests:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.specialRequests.map((s,t)=>e.jsx("span",{className:"bg-yellow-500/20 text-yellow-400 px-2 py-1 rounded text-xs",children:s},t))})]})]})]},s.id))})}),e.jsxs("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-gray-700",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",children:"Cancel"}),e.jsx("button",{onClick:()=>{n(l),a()},className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors",children:"Save Changes"})]})]})})},Fe=[{id:"chat",label:"Chat",icon:null},{id:"calendar",label:"Calendar",icon:q},{id:"ai-chat",label:"Concierge",icon:I},{id:"media",label:"Media",icon:B},{id:"payments",label:"Payments",icon:U},{id:"places",label:"Places",icon:D},{id:"polls",label:"Polls",icon:E},{id:"tasks",label:"Tasks",icon:$},{id:"team",label:"Team",icon:T,proOnly:!0,requiredPermissions:["read"]},{id:"finance",label:"Finance",icon:U,proOnly:!0,restrictedRoles:["talent","cast","student"],requiredPermissions:["finance"]},{id:"medical",label:"Medical",icon:J,proOnly:!0,requiredPermissions:["medical","admin"]},{id:"compliance",label:"Compliance",icon:qe,proOnly:!0,restrictedRoles:["talent","cast","student"],requiredPermissions:["compliance","admin"]},{id:"sponsors",label:"Sponsors",icon:Te,proOnly:!0,requiredPermissions:["admin"]}],Ve=(e,s,t)=>!("finance"!==e&&"compliance"!==e||!["talent","cast","student","artist"].includes(s.toLowerCase()))||!t.includes("write")&&!t.includes("admin"),He=({tabs:s,activeTab:t,onTabChange:a,category:r})=>{const{accentColors:i}=g(),{user:n}=p(),l=(null==n?void 0:n.proRole)||"staff",c=(null==n?void 0:n.permissions)||["read"];return e.jsx("div",{className:"flex justify-center overflow-x-auto whitespace-nowrap scroll-smooth gap-2 mb-8 pb-2 -mx-2 px-2 bg-white/5 backdrop-blur-sm rounded-xl border border-white/10",children:s.map(s=>{const n=s.icon,o=Ve(s.id,l,c),d="team"===s.id&&"Content"===r?"Cast & Crew":s.label;return e.jsxs("button",{onClick:()=>a(s.id),className:`flex-shrink-0 min-w-max px-4 py-3 rounded-lg font-medium transition-all duration-200 text-sm flex items-center gap-2 ${t===s.id?`bg-gradient-to-r ${i.gradient} text-white shadow-md`:"bg-white/10 text-gray-300 hover:bg-white/20 hover:text-white"} ${o?"opacity-75":""}`,children:[n&&e.jsx(n,{size:16}),d,s.proOnly&&e.jsx(S,{size:14,className:`text-${i.primary}`}),o&&e.jsx(L,{size:12,className:"text-gray-400"})]},s.id)})})};
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=new class{async isAdmin(e,s){var t;try{const a=s||(null==(t=(await f.auth.getUser()).data.user)?void 0:t.id);if(!a)return!1;const{data:r}=await f.from("trip_admins").select("id").eq("trip_id",e).eq("user_id",a).single();return!!r}catch{return!1}}async hasAdminPermission(e,s,t){var a;try{const r=t||(null==(a=(await f.auth.getUser()).data.user)?void 0:a.id);if(!r)return!1;const{data:i}=await f.from("trip_admins").select("permissions").eq("trip_id",e).eq("user_id",r).single();if(!i)return!1;const n=i.permissions;return!0===(null==n?void 0:n[s])}catch{return!1}}async getUserPrimaryRole(e,s){var t;try{const a=s||(null==(t=(await f.auth.getUser()).data.user)?void 0:t.id);if(!a)return null;const{data:r}=await f.from("user_trip_roles").select("role_id, trip_roles(*)").eq("trip_id",e).eq("user_id",a).eq("is_primary",!0).single();if(!(null==r?void 0:r.trip_roles))return null;const i=r.trip_roles;return{id:i.id,tripId:i.trip_id,roleName:i.role_name,description:i.description,createdBy:i.created_by,createdAt:i.created_at,updatedAt:i.updated_at}}catch{return null}}async createRole(e){try{const{data:{user:s}}=await f.auth.getUser();if(!s)return null;const{data:t,error:a}=await f.from("trip_roles").insert({trip_id:e.tripId,role_name:e.roleName,description:e.description,created_by:s.id}).select().single();if(a)throw a;return{id:t.id,tripId:t.trip_id,roleName:t.role_name,description:t.description,createdBy:t.created_by,createdAt:t.created_at,updatedAt:t.updated_at}}catch{return null}}async getRoles(e){try{const{data:s}=await f.from("trip_roles").select("*").eq("trip_id",e).order("created_at");return(s||[]).map(e=>({id:e.id,tripId:e.trip_id,roleName:e.role_name,description:e.description,createdBy:e.created_by,createdAt:e.created_at,updatedAt:e.updated_at}))}catch{return[]}}async deleteRole(e){try{const{error:s}=await f.from("trip_roles").delete().eq("id",e);return!s}catch{return!1}}async assignUserToRole(e){try{const{data:{user:s}}=await f.auth.getUser();if(!s)return!1;if(!1!==e.isPrimary){const{data:s}=await f.from("user_trip_roles").select("id").eq("trip_id",e.tripId).eq("user_id",e.userId).eq("is_primary",!0).single();if(s)throw new Error("User already has a primary role for this trip")}const{error:t}=await f.from("user_trip_roles").insert({trip_id:e.tripId,user_id:e.userId,role_id:e.roleId,assigned_by:s.id,is_primary:!1!==e.isPrimary});return!t}catch{return!1}}async revokeUserFromRole(e,s,t){try{const{error:a}=await f.from("user_trip_roles").delete().eq("trip_id",e).eq("user_id",s).eq("role_id",t);return!a}catch{return!1}}async getUserRoles(e,s){try{const{data:t}=await f.from("user_trip_roles").select("role_id, trip_roles(*)").eq("trip_id",e).eq("user_id",s);return(t||[]).filter(e=>e.trip_roles).map(e=>{const s=e.trip_roles;return{id:s.id,tripId:s.trip_id,roleName:s.role_name,description:s.description,createdBy:s.created_by,createdAt:s.created_at,updatedAt:s.updated_at}})}catch{return[]}}async getRoleAssignments(e){try{const{data:s}=await f.from("user_trip_roles").select("*, trip_roles(role_name)").eq("trip_id",e);return(s||[]).map(e=>{var s;return{id:e.id,tripId:e.trip_id,userId:e.user_id,roleId:e.role_id,roleName:null==(s=e.trip_roles)?void 0:s.role_name,assignedBy:e.assigned_by,assignedAt:e.assigned_at}})}catch{return[]}}async createChannel(e){try{const{data:{user:s}}=await f.auth.getUser();if(!s)return null;const{data:t}=await f.from("trip_channels").insert({trip_id:e.tripId,channel_name:e.channelName,channel_slug:e.channelSlug,description:e.description,required_role_id:e.requiredRoleId,is_private:e.isPrivate??!0,created_by:s.id}).select().single();return{id:t.id,tripId:t.trip_id,channelName:t.channel_name,channelSlug:t.channel_slug,description:t.description,requiredRoleId:t.required_role_id,isPrivate:t.is_private,isArchived:t.is_archived,createdBy:t.created_by,createdAt:t.created_at,updatedAt:t.updated_at}}catch{return null}}async createChannelWithRoles(e,s,t,a,r){try{const{data:{user:i}}=await f.auth.getUser();if(!i)return null;const{data:n,error:l}=await f.from("trip_channels").insert({trip_id:e,channel_name:s,channel_slug:t,description:r,required_role_id:a.length>0?a[0]:null,is_private:!0,created_by:i.id}).select().single();if(l||!n)throw l;if(a.length>0){const e=a.map(e=>({channel_id:n.id,role_id:e})),{error:s}=await f.from("channel_role_access").insert(e)}return{id:n.id,tripId:n.trip_id,channelName:n.channel_name,channelSlug:n.channel_slug,description:n.description,requiredRoleId:n.required_role_id,isPrivate:n.is_private,isArchived:n.is_archived,createdBy:n.created_by,createdAt:n.created_at,updatedAt:n.updated_at}}catch(i){return null}}async getAccessibleChannels(e){try{const{data:{user:s}}=await f.auth.getUser();if(!s)return[];const t=await this.getUserPrimaryRole(e,s.id);if(!t)return[];const{data:a}=await f.from("trip_channels").select("\n          *,\n          trip_roles!inner(role_name),\n          channel_role_access!inner(role_id)\n        ").eq("trip_id",e).eq("is_archived",!1).eq("channel_role_access.role_id",t.id);return(a||[]).map(e=>{var s;return{id:e.id,tripId:e.trip_id,channelName:e.channel_name,channelSlug:e.channel_slug,description:e.description,requiredRoleId:e.required_role_id,requiredRoleName:null==(s=e.trip_roles)?void 0:s.role_name,isPrivate:e.is_private,isArchived:e.is_archived,createdBy:e.created_by,createdAt:e.created_at,updatedAt:e.updated_at}})}catch{return[]}}async sendMessage(e){try{const{data:{user:s}}=await f.auth.getUser();if(!s)return null;const t={channel_id:e.channelId,sender_id:s.id,content:e.content,message_type:"broadcast"===e.messageType?"broadcast":e.messageType||"text",metadata:e.metadata||{}};"broadcast"===e.messageType&&e.broadcastCategory&&(t.broadcast_category=e.broadcastCategory,t.metadata={...t.metadata,category:e.broadcastCategory});const{data:a}=await f.from("channel_messages").insert(t).select().single();return{id:a.id,channelId:a.channel_id,senderId:a.sender_id,content:a.content,messageType:a.message_type,metadata:a.metadata||{},createdAt:a.created_at}}catch{return null}}async getMessages(e,s=50){try{const{data:t}=await f.from("channel_messages").select("*").eq("channel_id",e).is("deleted_at",null).order("created_at").limit(s);return(t||[]).map(e=>({id:e.id,channelId:e.channel_id,senderId:e.sender_id,content:e.content,messageType:e.message_type,metadata:e.metadata||{},createdAt:e.created_at}))}catch{return[]}}subscribeToChannel(e,s){const t=f.channel(`chan_${e}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"channel_messages",filter:`channel_id=eq.${e}`},e=>{s({id:e.new.id,channelId:e.new.channel_id,senderId:e.new.sender_id,content:e.new.content,messageType:e.new.message_type,metadata:e.new.metadata,createdAt:e.new.created_at})}).subscribe();return()=>t.unsubscribe()}async designateAdmin(e,s,t){try{const{data:{user:a}}=await f.auth.getUser();if(!a)return!1;if(!(await this.hasAdminPermission(e,"can_designate_admins",a.id)))throw new Error("Insufficient permissions to designate admins");const r={...{can_manage_roles:!0,can_manage_channels:!0,can_designate_admins:!1},...t},{error:i}=await f.from("trip_admins").insert({trip_id:e,user_id:s,granted_by:a.id,permissions:r});return!i}catch(a){return!1}}async revokeAdmin(e,s){try{const{data:{user:t}}=await f.auth.getUser();if(!t)return!1;if(!(await this.hasAdminPermission(e,"can_designate_admins",t.id)))throw new Error("Insufficient permissions to revoke admin access");const{error:a}=await f.from("trip_admins").delete().eq("trip_id",e).eq("user_id",s);return!a}catch(t){return!1}}async updateAdminPermissions(e,s,t){try{const{data:{user:a}}=await f.auth.getUser();if(!a)return!1;if(!(await this.hasAdminPermission(e,"can_designate_admins",a.id)))throw new Error("Insufficient permissions to update admin permissions");const{data:r}=await f.from("trip_admins").select("permissions").eq("trip_id",e).eq("user_id",s).single();if(!r)throw new Error("Admin not found");const i={...r.permissions,...t},{error:n}=await f.from("trip_admins").update({permissions:i}).eq("trip_id",e).eq("user_id",s);return!n}catch(a){return!1}}async getAdmins(e){try{const{data:s}=await f.from("trip_admins").select("*").eq("trip_id",e);return(s||[]).map(e=>({userId:e.user_id,permissions:e.permissions,grantedBy:e.granted_by,grantedAt:e.granted_at}))}catch{return[]}}},Ye=[{channel:{channelName:"Players",channelSlug:"players",description:"Team player discussions",requiredRoleId:"demo-role-players",requiredRoleName:"Players",isPrivate:!0,isArchived:!1,memberCount:15,createdBy:"demo-user"},messages:[{senderName:"LeBron James",content:"Who's got the playlist for the bus? ðŸŽµ",timestamp:"2:30 PM"},{senderName:"Anthony Davis",content:"I got you. Sending now.",timestamp:"2:32 PM"},{senderName:"Head Coach",content:"ðŸš¨ URGENT: Bus departure moved to 5:45 AM sharp. NO exceptions.",timestamp:"4:30 PM",isBroadcast:!0,category:"urgent"},{senderName:"Austin Reaves",content:"Practice tomorrow 2pm at the arena ðŸ€",timestamp:"4:45 PM"}]},{channel:{channelName:"Coaches",channelSlug:"coaches",description:"Coaching staff coordination",requiredRoleId:"demo-role-coaches",requiredRoleName:"Coaches",isPrivate:!0,isArchived:!1,memberCount:5,createdBy:"demo-user"},messages:[{senderName:"Head Coach",content:"Reviewing game film at 7pm in conference room B",timestamp:"11:15 AM"},{senderName:"Assistant Coach",content:"Defense needs work on pick and roll coverage",timestamp:"11:20 AM"},{senderName:"Head Coach",content:"Strategy session after practice. All coaches required.",timestamp:"12:00 PM",isBroadcast:!0,category:"logistics"}]}],We=[{channel:{channelName:"Production",channelSlug:"production",description:"Production team coordination",requiredRoleId:"demo-role-production",requiredRoleName:"Production",isPrivate:!0,isArchived:!1,memberCount:25,createdBy:"demo-user"},messages:[{senderName:"Production Lead",content:"Stage setup complete. Sound check at 3pm",timestamp:"1:45 PM"},{senderName:"Lighting Director",content:"New lighting cues programmed for Act 2",timestamp:"2:10 PM"},{senderName:"Tour Manager",content:"Showtime in 90 minutes. All crew report to positions NOW.",timestamp:"2:20 PM",isBroadcast:!0,category:"urgent"},{senderName:"Stage Manager",content:"All pyro tested and ready for tonight",timestamp:"2:30 PM"}]},{channel:{channelName:"Security",channelSlug:"security",description:"Security team coordination",requiredRoleId:"demo-role-security",requiredRoleName:"Security",isPrivate:!0,isArchived:!1,memberCount:20,createdBy:"demo-user"},messages:[{senderName:"Security Chief",content:"VIP entrance secured. Meet & greet at 6pm",timestamp:"10:00 AM"},{senderName:"Security Chief",content:"Reminder: Backstage credentials must be visible at all times",timestamp:"10:15 AM",isBroadcast:!0,category:"logistics"},{senderName:"Head of Security",content:"Barricades in place. Crowd control ready",timestamp:"10:30 AM"}]}],Je=[{channel:{channelName:"Executives",channelSlug:"executives",description:"Executive team discussions",requiredRoleId:"demo-role-executives",requiredRoleName:"Executives",isPrivate:!0,isArchived:!1,memberCount:8,createdBy:"demo-user"},messages:[{senderName:"David Ricks",content:"Strategic planning session moved to 3pm today",timestamp:"9:00 AM"},{senderName:"Executive Assistant",content:"Board meeting materials now available in shared drive",timestamp:"9:10 AM",isBroadcast:!0,category:"chill"},{senderName:"Anat Ashkenazi",content:"Q1 financials deck ready for review",timestamp:"9:15 AM"},{senderName:"Dan Skovronsky",content:"R&D pipeline update at tomorrow's session",timestamp:"10:30 AM"}]},{channel:{channelName:"Event Planning",channelSlug:"event-planning",description:"Event coordination team",requiredRoleId:"demo-role-event",requiredRoleName:"Event Planning",isPrivate:!0,isArchived:!1,memberCount:4,createdBy:"demo-user"},messages:[{senderName:"Event Coordinator",content:"Dinner reservations confirmed for 7:30pm",timestamp:"11:00 AM"},{senderName:"Meeting Planner",content:"AV equipment tested in all conference rooms",timestamp:"11:20 AM"},{senderName:"Event Coordinator",content:"Transportation departing hotel lobby at 7:00pm sharp",timestamp:"11:45 AM",isBroadcast:!0,category:"logistics"}]}],Ke=[{channel:{channelName:"Production Crew",channelSlug:"production-crew",description:"Production team coordination",requiredRoleId:"demo-role-production",requiredRoleName:"Production",isPrivate:!0,isArchived:!1,memberCount:12,createdBy:"demo-user"},messages:[{senderName:"Production Lead",content:"Stage setup complete. Sound check at 3pm",timestamp:"1:45 PM"},{senderName:"AV Tech",content:"Lighting programmed and ready to test",timestamp:"2:10 PM"},{senderName:"Stage Manager",content:"Truck arrives at 4pm. Everyone ready to sync.",timestamp:"2:30 PM"}]},{channel:{channelName:"Security",channelSlug:"security",description:"Security team coordination",requiredRoleId:"demo-role-security",requiredRoleName:"Security",isPrivate:!0,isArchived:!1,memberCount:8,createdBy:"demo-user"},messages:[{senderName:"Security Chief",content:"Perimeter secured. All checkpoints active.",timestamp:"10:00 AM"},{senderName:"Security Lead",content:"VIP entrance ready. Badge system live.",timestamp:"10:30 AM"}]}],Qe=e=>{const s=(new Date).toISOString();let t=[];const a=String(e);"13"===a||"lakers-road-trip"===a?t=Ye:"14"===a||"tesla-cybertruck-roadshow-2025"===a?t=Ke:"15"===a||"beyonce-cowboy-carter-tour"===a?t=We:"16"!==a&&"eli-lilly-c-suite-retreat-2026"!==a||(t=Je);const r=t.map((t,a)=>({id:`demo-channel-${e}-${a}`,tripId:e,...t.channel,createdAt:s,updatedAt:s})),i=new Map;return t.forEach((t,a)=>{const r=`demo-channel-${e}-${a}`,n=t.messages.map((e,t)=>({id:`demo-msg-${r}-${t}`,channelId:r,senderId:`demo-sender-${t}`,senderName:e.senderName,content:e.content,messageType:e.isBroadcast?"system":"text",metadata:e.isBroadcast?{isBroadcast:!0,category:e.category}:void 0,createdAt:s,editedAt:void 0,deletedAt:void 0}));i.set(r,n)}),{channels:r,messagesByChannel:i}},Ze=({currentChannel:s,availableChannels:t,onChannelChange:a})=>e.jsxs(Z,{children:[e.jsx(X,{asChild:!0,children:e.jsxs(K,{variant:"ghost",className:"flex items-center gap-2 px-2 py-1 h-auto hover:bg-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.isPrivate?e.jsx(L,{size:16,className:"text-purple-400"}):e.jsx(Ue,{size:16,className:"text-gray-400"}),e.jsx("span",{className:"font-semibold text-white",children:s.channelSlug})]}),e.jsx(re,{size:16,className:"text-gray-400"})]})}),e.jsxs(ee,{align:"start",className:"w-64 bg-gray-800 border-gray-700",children:[e.jsx(se,{className:"text-gray-400 text-xs",children:"Switch Channel"}),e.jsx(te,{className:"bg-gray-700"}),t.map(t=>e.jsxs(ae,{onClick:()=>a(t),className:"flex items-center gap-2 py-2 px-3 cursor-pointer "+(t.id===s.id?"bg-purple-600/20 text-white":"text-gray-300 hover:bg-white/10"),children:[t.isPrivate?e.jsx(L,{size:14,className:"text-purple-400"}):e.jsx(Ue,{size:14,className:"text-gray-400"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"font-medium truncate",children:["#",t.channelSlug]}),e.jsx("div",{className:"text-xs text-gray-500 truncate",children:t.requiredRoleName})]}),t.unreadCount&&t.unreadCount>0&&e.jsx("span",{className:"bg-red-600 text-white text-xs px-1.5 py-0.5 rounded-full min-w-[20px] text-center",children:t.unreadCount})]},t.id)),e.jsx(te,{className:"bg-gray-700"}),e.jsxs(ae,{onClick:()=>a(null),className:"text-gray-300 hover:bg-white/10 cursor-pointer",children:[e.jsx(Ue,{size:14,className:"mr-2 text-gray-400"}),"Main Trip Chat"]})]})]}),Xe=({channel:s,availableChannels:a=[],onBack:r,onChannelChange:i})=>{const[n,l]=t.useState([]),[c,o]=t.useState(""),[d,m]=t.useState(!1),[x,h]=t.useState(!0),[u,p]=t.useState("regular"),g=t.useRef(null),{toast:b}=N();t.useEffect(()=>{y();if(!["lakers-road-trip","beyonce-cowboy-carter-tour","eli-lilly-c-suite-retreat-2026"].includes(s.tripId)){return Ge.subscribeToChannel(s.id,e=>{l(s=>[...s,e])})}},[s.id,s.tripId]),t.useEffect(()=>{var e;null==(e=g.current)||e.scrollIntoView({behavior:"smooth"})},[n]);const y=async()=>{h(!0);if(["lakers-road-trip","beyonce-cowboy-carter-tour","eli-lilly-c-suite-retreat-2026"].includes(s.tripId)){const{messagesByChannel:e}=Qe(s.tripId),t=e.get(s.id)||[];return l(t),void h(!1)}const e=await Ge.getMessages(s.id);l(e),h(!1)},j=async()=>{if(!c.trim()||d)return;m(!0);if(["lakers-road-trip","beyonce-cowboy-carter-tour","eli-lilly-c-suite-retreat-2026"].includes(s.tripId)){const e={id:`demo-msg-${Date.now()}`,channelId:s.id,senderId:"current-user",senderName:"You",content:c.trim(),messageType:"broadcast"===u?"system":"text",metadata:"broadcast"===u?{isBroadcast:!0}:void 0,createdAt:(new Date).toISOString()};return l(s=>[...s,e]),o(""),p("regular"),void m(!1)}await Ge.sendMessage({channelId:s.id,content:c.trim(),messageType:u})?(o(""),p("regular")):b({title:"Failed to send message",variant:"destructive"}),m(!1)};return e.jsxs("div",{className:"flex flex-col h-full bg-gray-900",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-3 px-3 md:px-4 py-2 md:py-3 border-b border-gray-700 bg-gray-800",children:[r&&e.jsx(K,{onClick:r,variant:"ghost",size:"sm",className:"p-1 md:p-2 h-auto",children:e.jsx(_,{size:18})}),e.jsx("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:a.length>0&&i?e.jsx(Ze,{currentChannel:s,availableChannels:a,onChannelChange:i}):e.jsxs(e.Fragment,{children:[s.isPrivate&&e.jsx(L,{size:16,className:"text-purple-400 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("h3",{className:"font-semibold text-white text-sm md:text-base truncate",children:["#",s.channelSlug]}),e.jsxs("p",{className:"text-xs text-gray-400 truncate",children:[s.requiredRoleName," â€¢ ",s.memberCount||0," members"]})]})]})}),e.jsx(T,{size:18,className:"text-gray-400 flex-shrink-0"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-3 md:p-4 space-y-3 md:space-y-4",children:[x?e.jsx("div",{className:"text-center text-gray-400 py-8",children:"Loading messages..."}):0===n.length?e.jsxs("div",{className:"text-center text-gray-400 py-8",children:[e.jsx(L,{size:48,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No messages yet. Start the conversation!"})]}):n.map(s=>{var t,a;const r=(null==(t=s.metadata)?void 0:t.isBroadcast)||"system"===s.messageType;return e.jsx("div",{className:"flex gap-3 "+("system"!==s.messageType||r?"":"justify-center"),children:"system"!==s.messageType||r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-semibold "+(r?"bg-gradient-to-br from-orange-500 to-orange-700":"bg-gradient-to-br from-red-500 to-red-700"),children:r?e.jsx(de,{size:16}):(null==(a=s.senderName)?void 0:a[0])||"U"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-baseline gap-2 mb-1 flex-wrap",children:[e.jsx("span",{className:"font-medium text-white text-sm",children:s.senderName||"User"}),e.jsx("span",{className:"text-xs text-gray-500",children:me(new Date(s.createdAt),"h:mm a")})]}),e.jsx("p",{className:"text-sm break-words "+(r?"bg-orange-900/20 border-l-4 border-orange-500 pl-3 py-2 text-gray-200":"text-gray-300"),children:s.content})]})]}):e.jsx("div",{className:"text-xs text-gray-500 bg-gray-800/50 px-3 py-1 rounded-full",children:s.content})},s.id)}),e.jsx("div",{ref:g})]}),e.jsxs("div",{className:"p-2 md:p-4 border-t border-gray-700 bg-gray-800 safe-bottom space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>p("regular"),className:"flex items-center gap-2 px-3 py-1.5 rounded text-sm transition-colors "+("regular"===u?"bg-gray-700 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"),children:"ðŸ’¬ Regular"}),e.jsx("button",{onClick:()=>p("broadcast"),className:"flex items-center gap-2 px-3 py-1.5 rounded text-sm transition-colors "+("broadcast"===u?"bg-orange-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"),children:"ðŸ“¢ Broadcast"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Q,{value:c,onChange:e=>o(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),j())},placeholder:"broadcast"===u?`ðŸ“¢ Broadcast to #${s.channelSlug}...`:`Message #${s.channelSlug}...`,className:"flex-1 bg-gray-900 border-gray-600 text-white text-sm md:text-base min-h-[44px]",disabled:d,maxLength:"broadcast"===u?140:void 0}),e.jsx(K,{onClick:j,disabled:!c.trim()||d,className:"min-w-[44px] min-h-[44px] p-2 "+("broadcast"===u?"bg-orange-600 hover:bg-orange-700":"bg-red-600 hover:bg-red-700"),children:e.jsx(A,{size:18})})]}),"broadcast"===u&&e.jsxs("p",{className:"text-xs text-gray-500",children:[c.length,"/140 characters"]})]})]})},es=["lakers-road-trip","beyonce-cowboy-carter-tour","eli-lilly-c-suite-retreat-2026","13","14","15","16"],ss=({tripId:s,userRole:a})=>{const[r,i]=t.useState([]),[n,l]=t.useState(null),[c,o]=t.useState(!0),d=es.includes(s);t.useEffect(()=>{m()},[s]);const m=async()=>{if(o(!0),d){const{channels:e}=Qe(s);i(e)}else{const e=await Ge.getAccessibleChannels(s);i(e)}o(!1)};return c?e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(P,{size:24,className:"mx-auto mb-2 animate-pulse"}),e.jsx("p",{className:"text-sm",children:"Loading channels..."})]}):0===r.length?e.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-lg p-6 text-center",children:[e.jsx(P,{size:32,className:"mx-auto mb-2 text-gray-500"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"No channels available for your role"})]}):n?e.jsx("div",{className:"bg-gray-900 border border-gray-700 rounded-lg overflow-hidden",children:e.jsx("div",{className:"h-[600px]",children:e.jsx(Xe,{channel:n,availableChannels:r,onBack:()=>l(null),onChannelChange:e=>l(e)})})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:r.map(s=>e.jsx("button",{onClick:()=>l(s),className:"bg-gray-800/50 hover:bg-gray-800 border border-gray-700 hover:border-gray-600 rounded-lg p-4 text-left transition-all group",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-600/20 flex items-center justify-center flex-shrink-0",children:s.isPrivate?e.jsx(L,{size:18,className:"text-purple-400"}):e.jsx(Ue,{size:18,className:"text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("h4",{className:"font-semibold text-white group-hover:text-purple-400 transition-colors truncate",children:["#",s.channelSlug]}),s.unreadCount&&s.unreadCount>0&&e.jsx("span",{className:"bg-red-600 text-white text-xs px-2 py-0.5 rounded-full",children:s.unreadCount})]}),e.jsx("p",{className:"text-sm text-gray-400 truncate mb-2",children:s.requiredRoleName}),s.description&&e.jsx("p",{className:"text-xs text-gray-500 truncate",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(T,{size:12}),e.jsxs("span",{children:[s.memberCount||0," members"]})]}),s.lastMessage&&e.jsxs("span",{className:"truncate",children:["Last: ",s.lastMessage.content.substring(0,30),"..."]})]})]})]})},s.id))})},ts=({tripId:s,userRole:t})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-white/5 via-white/3 to-transparent backdrop-blur-sm border border-gray-700/50 rounded-2xl p-6 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(P,{className:"text-purple-400",size:24}),e.jsx("h2",{className:"text-xl font-bold text-white",children:"Role-Based Channels"})]}),e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(xe,{size:16,className:"text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-300 space-y-1",children:[e.jsx("p",{className:"font-medium",children:"How channels work:"}),e.jsxs("ul",{className:"text-xs text-blue-200 space-y-1 ml-4",children:[e.jsx("li",{children:"â€¢ Each channel is private to members with that role"}),e.jsx("li",{children:"â€¢ Click any channel to view messages and participate"}),e.jsx("li",{children:"â€¢ Main trip chat remains available to everyone"}),e.jsx("li",{children:"â€¢ Perfect for focused discussions (e.g., security, medical, production)"})]})]})]})})]}),e.jsx("div",{className:"space-y-4",children:e.jsx(ss,{tripId:s,userRole:t})}),e.jsx("div",{className:"bg-white/5 border border-gray-700 rounded-lg p-4",children:e.jsx("p",{className:"text-xs text-gray-400",children:"Don't see a channel you need? Contact an admin to create new role-based channels or assign you additional roles."})})]}),as=(e,s)=>r(s).roles.includes(e)?"bg-red-600/20 text-red-400":"bg-blue-600/20 text-blue-400",rs=({isOpen:s,onClose:a,member:i,category:n,existingRoles:l,onUpdateRole:c})=>{const[o,d]=t.useState(""),[m,x]=t.useState(!1),[h,u]=t.useState(!1),[p,g]=t.useState(""),b=r(n);((e,s)=>{const t=r(e),a=[];t.roles.forEach(e=>{a.push({value:e,label:e,isCustom:!1})}),s.filter(e=>!t.roles.includes(e)).forEach(e=>{a.push({value:e,label:e,isCustom:!0})})})(n,l),t.useEffect(()=>{i&&s&&(d(i.role),x(!b.roles.includes(i.role)),g(""))},[i,s,b.roles]);return i?e.jsx(he,{open:s,onOpenChange:a,children:e.jsxs(ue,{className:"bg-gray-900 border-gray-700 text-white max-w-md",children:[e.jsx(pe,{children:e.jsxs(ge,{className:"flex items-center gap-2",children:[e.jsx(je,{size:20}),"Edit Team Member Role"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white/5 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:i.avatar||"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face",alt:i.name,className:"w-10 h-10 rounded-full"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:i.name}),e.jsx("p",{className:"text-sm text-gray-400",children:i.email}),e.jsxs(ye,{className:"mt-1 bg-red-600/20 text-red-400",children:["Current: ",i.role]})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(be,{htmlFor:"role-type",className:"text-sm font-medium",children:"Role Type"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{type:"button",variant:m?"outline":"default",size:"sm",onClick:()=>{x(!1),d(b.roles[0]||"")},disabled:0===b.roles.length,className:"flex-1",children:"Predefined"}),e.jsx(K,{type:"button",variant:m?"default":"outline",size:"sm",onClick:()=>{x(!0),d("")},className:"flex-1",children:"Custom"})]}),!m&&b.roles.length>0?e.jsxs(ie,{value:o,onValueChange:d,children:[e.jsx(ne,{className:"bg-gray-800 border-gray-600",children:e.jsx(le,{placeholder:"Select a role"})}),e.jsxs(ce,{className:"bg-gray-800 border-gray-600",children:[b.roles.map(s=>e.jsx(oe,{value:s,className:"text-white hover:bg-gray-700",children:s},s)),l.filter(e=>!b.roles.includes(e)).map(s=>e.jsxs(oe,{value:s,className:"text-white hover:bg-gray-700",children:[s," ",e.jsx("span",{className:"text-xs text-gray-400",children:"(Custom)"})]},s))]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{value:o,onChange:e=>d(e.target.value),placeholder:"Enter custom role (e.g., Production Manager, Lead Vocalist)",className:"bg-gray-800 border-gray-600 text-white"}),l.length>0&&e.jsxs("div",{className:"text-xs text-gray-400",children:[e.jsx("p",{className:"mb-1",children:"Existing roles:"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[l.slice(0,5).map(s=>e.jsx("button",{type:"button",onClick:()=>d(s),className:"bg-gray-700 hover:bg-gray-600 px-2 py-1 rounded text-xs transition-colors",children:s},s)),l.length>5&&e.jsxs("span",{className:"text-gray-500",children:["+",l.length-5," more"]})]})]})]})]}),p&&e.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3",children:e.jsx("p",{className:"text-red-400 text-sm",children:p})}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsxs(K,{onClick:()=>{d((null==i?void 0:i.role)||""),x(!1),g(""),a()},variant:"outline",className:"flex-1",disabled:h,children:[e.jsx(j,{size:16,className:"mr-1"}),"Cancel"]}),e.jsx(K,{onClick:async()=>{if(i&&o.trim()){u(!0),g("");try{await c(i.id,o.trim()),a()}catch(e){g("Failed to update role. Please try again.")}finally{u(!1)}}else g("Role is required")},disabled:h||!o.trim()||o===i.role,className:"flex-1 bg-red-600 hover:bg-red-700",children:h?e.jsx(e.Fragment,{children:"Saving..."}):e.jsxs(e.Fragment,{children:[e.jsx(fe,{size:16,className:"mr-1"}),"Save Role"]})})]})]})]})}):null},is=({hasUnassignedRoles:s,onAssignRoles:a,onDismiss:r})=>{const[i,n]=t.useState(!1),[l,c]=t.useState(!1);t.useEffect(()=>{!localStorage.getItem("team-onboarding-dismissed")&&s&&n(!0)},[s]);return i?e.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-r from-red-500/10 via-orange-500/10 to-red-500/10 backdrop-blur-sm border border-red-500/20 rounded-xl p-6 mb-6 animate-in fade-in slide-in-from-top duration-500",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-white/[0.02] pointer-events-none"}),e.jsx("button",{onClick:()=>{l&&localStorage.setItem("team-onboarding-dismissed","true"),n(!1),r()},className:"absolute top-4 right-4 text-gray-400 hover:text-white transition-colors","aria-label":"Dismiss",children:e.jsx(j,{size:20})}),e.jsxs("div",{className:"relative flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"bg-red-500/20 rounded-full p-3",children:e.jsx(T,{className:"text-red-400",size:24})})}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[e.jsx(I,{size:18,className:"text-yellow-400"}),"Assign Roles to Your Team"]}),e.jsx("p",{className:"text-gray-300 text-sm mt-1",children:"Help everyone know who's who by assigning roles to your team members. This makes it easier to coordinate and communicate effectively."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"bg-red-500/20 rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold text-red-400",children:"1"}),e.jsx("span",{className:"text-sm font-medium text-white",children:"Click Member"})]}),e.jsxs("p",{className:"text-xs text-gray-400 ml-8",children:["Click the ",e.jsx(b,{size:12,className:"inline"})," icon next to any team member"]})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"bg-red-500/20 rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold text-red-400",children:"2"}),e.jsx("span",{className:"text-sm font-medium text-white",children:"Choose Role"})]}),e.jsx("p",{className:"text-xs text-gray-400 ml-8",children:"Select from predefined roles or create custom ones"})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"bg-red-500/20 rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold text-red-400",children:"3"}),e.jsx("span",{className:"text-sm font-medium text-white",children:"Save & Organize"})]}),e.jsx("p",{className:"text-xs text-gray-400 ml-8",children:"Filter and organize by role for better coordination"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[e.jsxs(K,{onClick:a,className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(Ne,{size:16,className:"mr-2"}),"Start Assigning Roles"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l,onChange:e=>c(e.target.checked),className:"rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-500"}),"Don't show again"]})]})]})]})]}):null},ns=({isOpen:s,onClose:a,roster:n,category:l,existingRoles:c,onUpdateMemberRole:o})=>{const[d,m]=t.useState("select"),[x,h]=t.useState(""),[u,p]=t.useState("all"),[g,b]=t.useState(""),[y,f]=t.useState(!1),[N,w]=t.useState(null),{selectedMembers:C,toggleMember:k,selectAll:_,clearSelection:S,selectByRole:R,assignRoleToMultiple:A,isAssigning:M}=(()=>{const[e,s]=t.useState([]),[a,r]=t.useState(!1),i=t.useCallback(e=>{s(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},[]),n=t.useCallback(e=>{s(e)},[]),l=t.useCallback(()=>{s([])},[]),c=t.useCallback((e,t)=>{const a=e.filter(e=>e.role===t).map(e=>e.id);s(a)},[]),o=t.useCallback(async(e,s,t)=>{r(!0);const a=[];let i=0;try{for(const r of e)try{await t(r,s),i++}catch(n){a.push(`Failed to assign role to member ${r}`)}return{success:0===a.length,assignedCount:i,errors:a.length>0?a:void 0}}finally{r(!1),l()}},[l]);return{selectedMembers:e,toggleMember:i,selectAll:n,clearSelection:l,selectByRole:c,assignRoleToMultiple:o,isAssigning:a}})(),z=r(l),I=t.useMemo(()=>{let e=n;return x&&(e=e.filter(e=>e.name.toLowerCase().includes(x.toLowerCase())||e.email.toLowerCase().includes(x.toLowerCase()))),"all"!==u&&(e=e.filter(e=>e.role===u)),e},[n,x,u]),P=t.useMemo(()=>n.filter(e=>C.includes(e.id)),[n,C]),q=()=>{m("select"),h(""),p("all"),b(""),f(!1),w(null),S(),a()};return e.jsx(he,{open:s,onOpenChange:q,children:e.jsxs(ue,{className:"bg-gray-900 border-gray-700 text-white max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(pe,{children:e.jsxs(ge,{className:"flex items-center gap-2",children:[e.jsx(T,{size:20}),"Bulk Role Assignment"]})}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 "+("select"===d?"text-red-400":"text-gray-400"),children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center "+("select"!==d?"bg-red-600":"bg-red-600/20"),children:"select"!==d?e.jsx(ve,{size:16}):"1"}),e.jsx("span",{className:"text-sm font-medium",children:"Select Members"})]}),e.jsx(we,{size:20,className:"text-gray-600"}),e.jsxs("div",{className:"flex items-center gap-2 "+("assign"===d?"text-red-400":"text-gray-400"),children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center "+("confirm"===d?"bg-red-600":"assign"===d?"bg-red-600/20":"bg-gray-700"),children:"confirm"===d?e.jsx(ve,{size:16}):"2"}),e.jsx("span",{className:"text-sm font-medium",children:"Choose Role"})]}),e.jsx(we,{size:20,className:"text-gray-600"}),e.jsxs("div",{className:"flex items-center gap-2 "+("confirm"===d?"text-red-400":"text-gray-400"),children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center "+("confirm"===d?"bg-red-600/20":"bg-gray-700"),children:"3"}),e.jsx("span",{className:"text-sm font-medium",children:"Confirm"})]})]}),"select"===d&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(v,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx(Q,{value:x,onChange:e=>h(e.target.value),placeholder:"Search by name or email...",className:"pl-10 bg-gray-800 border-gray-600 text-white"})]}),e.jsxs(ie,{value:u,onValueChange:p,children:[e.jsxs(ne,{className:"w-40 bg-gray-800 border-gray-600",children:[e.jsx(Ce,{size:16,className:"mr-2"}),e.jsx(le,{})]}),e.jsxs(ce,{className:"bg-gray-800 border-gray-600",children:[e.jsx(oe,{value:"all",children:"All Roles"}),c.map(s=>e.jsx(oe,{value:s,children:s},s))]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{onClick:()=>{_(I.map(e=>e.id))},variant:"outline",size:"sm",className:"flex-1",children:["Select All (",I.length,")"]}),e.jsx(K,{onClick:S,variant:"outline",size:"sm",className:"flex-1",disabled:0===C.length,children:"Clear Selection"})]}),C.length>0&&e.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3",children:e.jsxs("p",{className:"text-red-400 text-sm font-medium",children:[C.length," member",1!==C.length?"s":""," selected"]})}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:I.map(s=>e.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-colors "+(C.includes(s.id)?"bg-red-500/10 border-red-500/30":"bg-white/5 border-gray-700 hover:bg-white/10"),children:[e.jsx("input",{type:"checkbox",checked:C.includes(s.id),onChange:()=>k(s.id),className:"rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-500"}),e.jsx("img",{src:s.avatar||"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face",alt:s.name,className:"w-10 h-10 rounded-full"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:s.name}),e.jsx("p",{className:"text-sm text-gray-400 truncate",children:s.email})]}),e.jsx("span",{className:`${as(s.role,l)} px-2 py-1 rounded text-xs font-medium`,children:s.role})]},s.id))}),0===I.length&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(T,{size:48,className:"text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No members found"})]})]}),"assign"===d&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-gray-700",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Assigning role to:"}),e.jsxs("p",{className:"text-lg font-medium",children:[C.length," selected member",1!==C.length?"s":""]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(be,{className:"text-sm font-medium",children:"Role Type"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{type:"button",variant:y?"outline":"default",size:"sm",onClick:()=>{f(!1),b(z.roles[0]||"")},disabled:0===z.roles.length,className:"flex-1",children:"Predefined"}),e.jsx(K,{type:"button",variant:y?"default":"outline",size:"sm",onClick:()=>{f(!0),b("")},className:"flex-1",children:"Custom"})]})]}),!y&&z.roles.length>0?e.jsxs(ie,{value:g,onValueChange:b,children:[e.jsx(ne,{className:"bg-gray-800 border-gray-600",children:e.jsx(le,{placeholder:"Select a role"})}),e.jsxs(ce,{className:"bg-gray-800 border-gray-600",children:[z.roles.map(s=>e.jsx(oe,{value:s,className:"text-white hover:bg-gray-700",children:s},s)),c.filter(e=>!z.roles.includes(e)).map(s=>e.jsxs(oe,{value:s,className:"text-white hover:bg-gray-700",children:[s," ",e.jsx("span",{className:"text-xs text-gray-400",children:"(Custom)"})]},s))]})]}):e.jsx(Q,{value:g,onChange:e=>b(e.target.value),placeholder:"Enter custom role (e.g., Assistant Tour Manager)",className:"bg-gray-800 border-gray-600 text-white"})]}),"confirm"===d&&!N&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ke,{className:"text-yellow-400 flex-shrink-0 mt-0.5",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-yellow-400",children:"Confirm Bulk Assignment"}),e.jsxs("p",{className:"text-sm text-gray-300 mt-1",children:["You are about to assign the role ",e.jsxs("span",{className:"font-bold text-white",children:['"',g,'"']})," to ",e.jsxs("span",{className:"font-bold text-white",children:[C.length," member",1!==C.length?"s":""]}),"."]})]})]})}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[e.jsx(be,{className:"text-sm text-gray-400",children:"Members to update:"}),P.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-white/5 rounded border border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:s.avatar||"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=32&h=32&fit=crop&crop=face",alt:s.name,className:"w-8 h-8 rounded-full"}),e.jsx("span",{className:"text-sm",children:s.name})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-gray-400",children:s.role}),e.jsx("span",{className:"text-gray-600",children:"â†’"}),e.jsx("span",{className:"text-red-400 font-medium",children:g})]})]},s.id))]})]}),N&&e.jsx("div",{className:"rounded-lg p-4 "+(N.success?"bg-green-500/10 border border-green-500/20":"bg-red-500/10 border border-red-500/20"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[N.success?e.jsx(i,{className:"text-green-400",size:24}):e.jsx(ke,{className:"text-red-400",size:24}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium "+(N.success?"text-green-400":"text-red-400"),children:N.success?"Assignment Complete!":"Assignment Partially Complete"}),e.jsxs("p",{className:"text-sm text-gray-300 mt-1",children:["Successfully assigned role to ",N.assignedCount," member",1!==N.assignedCount?"s":"","."]})]})]})}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t border-gray-700",children:[!N&&"select"!==d&&e.jsx(K,{onClick:()=>{"confirm"===d?m("assign"):"assign"===d&&m("select")},variant:"outline",disabled:M,children:"Back"}),e.jsxs(K,{onClick:q,variant:"outline",className:"flex-1",disabled:M,children:[e.jsx(j,{size:16,className:"mr-1"}),N?"Done":"Cancel"]}),!N&&("confirm"===d?e.jsx(K,{onClick:async()=>{if(!g.trim())return;const e=await A(C,g.trim(),o);w(e)},disabled:M||!g.trim(),className:"flex-1 bg-red-600 hover:bg-red-700",children:M?e.jsx(e.Fragment,{children:"Assigning..."}):e.jsxs(e.Fragment,{children:[e.jsx(ve,{size:16,className:"mr-1"}),"Assign to ",C.length]})}):e.jsxs(K,{onClick:()=>{"select"===d?m("assign"):"assign"===d&&m("confirm")},disabled:"select"===d&&0===C.length||"assign"===d&&!g.trim(),className:"flex-1 bg-red-600 hover:bg-red-700",children:["Next",e.jsx(we,{size:16,className:"ml-1"})]}))]})]})})},ls=({member:s,onDirectMessage:t,showEmergencyContacts:a=!1,children:r})=>e.jsxs(Z,{children:[e.jsx(X,{asChild:!0,children:r}),e.jsxs(ee,{className:"bg-gray-800 border-gray-700 text-white w-56",children:[e.jsxs(se,{className:"text-gray-400",children:["Contact ",s.name]}),e.jsx(te,{className:"bg-gray-700"}),t&&e.jsxs(ae,{onClick:()=>{t&&t(s.id)},className:"hover:bg-gray-700 cursor-pointer",children:[e.jsx(z,{size:16,className:"mr-2 text-blue-400"}),e.jsx("span",{children:"Send Direct Message"})]}),s.phone&&e.jsxs(ae,{onClick:()=>{s.phone&&(window.location.href=`tel:${s.phone}`)},className:"hover:bg-gray-700 cursor-pointer",children:[e.jsx(M,{size:16,className:"mr-2 text-green-400"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:"Call"}),e.jsx("span",{className:"text-xs text-gray-400",children:s.phone})]})]}),e.jsxs(ae,{onClick:()=>{window.location.href=`mailto:${s.email}`},className:"hover:bg-gray-700 cursor-pointer",children:[e.jsx(Se,{size:16,className:"mr-2 text-purple-400"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:"Email"}),e.jsx("span",{className:"text-xs text-gray-400 truncate",children:s.email})]})]}),a&&s.emergencyContact&&e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"bg-gray-700"}),e.jsxs(se,{className:"text-red-400 flex items-center gap-2",children:[e.jsx(ke,{size:14}),"Emergency Contact"]}),e.jsxs(ae,{onClick:()=>{var e;(null==(e=s.emergencyContact)?void 0:e.phone)&&(window.location.href=`tel:${s.emergencyContact.phone}`)},className:"hover:bg-gray-700 cursor-pointer",children:[e.jsx(M,{size:16,className:"mr-2 text-red-400"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:s.emergencyContact.name}),e.jsx("span",{className:"text-xs text-gray-400",children:s.emergencyContact.relationship}),e.jsx("span",{className:"text-xs text-gray-400",children:s.emergencyContact.phone})]})]})]}),e.jsx(te,{className:"bg-gray-700"}),e.jsxs(ae,{className:"hover:bg-gray-700 cursor-pointer text-gray-400",children:[e.jsx(je,{size:16,className:"mr-2"}),e.jsx("span",{children:"View Full Profile"})]})]})]}),cs=({isOpen:s,onClose:a,role:r,members:i,category:n,onSendGroupMessage:l})=>{const[c,o]=t.useState(""),[d,m]=t.useState(!1),[x,h]=t.useState(!1),u=i.filter(e=>e.phone);return e.jsx(he,{open:s,onOpenChange:a,children:e.jsxs(ue,{className:"bg-gray-900 border-gray-700 text-white max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(pe,{children:e.jsxs(ge,{className:"flex items-center gap-2",children:[e.jsx(T,{size:20}),"Contact All ",r," (",i.length,")"]})}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[l&&e.jsxs(K,{variant:"outline",className:"flex-1",disabled:!i.length,children:[e.jsx(z,{size:16,className:"mr-2 text-blue-400"}),"Group Message"]}),u.length>0&&e.jsxs(K,{variant:"outline",className:"flex-1",onClick:()=>{alert(`Calling ${u.length} members with phone numbers`)},children:[e.jsx(M,{size:16,className:"mr-2 text-green-400"}),"Call All (",u.length,")"]}),e.jsxs(K,{variant:"outline",className:"flex-1",onClick:()=>{const e=i.map(e=>e.email).join(",");window.location.href=`mailto:${e}`},children:[e.jsx(Se,{size:16,className:"mr-2 text-purple-400"}),"Email All"]})]}),l&&e.jsxs("div",{className:"space-y-3 border-t border-gray-700 pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Send Message to All ",r]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d,onChange:e=>m(e.target.checked),className:"rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-500"}),e.jsx(w,{size:14,className:d?"text-red-400":"text-gray-400"}),e.jsx("span",{className:d?"text-red-400":"text-gray-400",children:"Mark as Urgent"})]})]}),e.jsx(_e,{value:c,onChange:e=>o(e.target.value),placeholder:`Message for all ${r} members...${d?"\n\nâš ï¸ This will be marked as URGENT":""}`,className:"bg-gray-800 border-gray-600 text-white min-h-[120px]",disabled:x}),d&&e.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3",children:e.jsxs("p",{className:"text-red-400 text-sm flex items-center gap-2",children:[e.jsx(w,{size:16}),"Urgent messages will send push notifications to all recipients"]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{onClick:async()=>{if(c.trim()&&l){h(!0);try{await l(i.map(e=>e.id),c.trim(),d),o(""),m(!1),a()}catch(e){}finally{h(!1)}}},disabled:!c.trim()||x,className:"flex-1 "+(d?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"),children:x?e.jsx(e.Fragment,{children:"Sending..."}):e.jsxs(e.Fragment,{children:[e.jsx(A,{size:16,className:"mr-2"}),"Send to ",i.length," Member",1!==i.length?"s":""]})}),e.jsx(K,{onClick:()=>{o(""),m(!1)},variant:"outline",disabled:x,children:"Clear"})]})]}),e.jsxs("div",{className:"space-y-3 border-t border-gray-700 pt-4",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-400",children:["All ",r," Members:"]}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:i.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:s.avatar||"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face",alt:s.name,className:"w-10 h-10 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-gray-400",children:s.email}),s.phone&&e.jsx("p",{className:"text-xs text-gray-500",children:s.phone})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.phone&&e.jsx("a",{href:`tel:${s.phone}`,className:"p-2 hover:bg-white/10 rounded transition-colors",title:"Call",children:e.jsx(M,{size:16,className:"text-green-400"})}),e.jsx("a",{href:`mailto:${s.email}`,className:"p-2 hover:bg-white/10 rounded transition-colors",title:"Email",children:e.jsx(Se,{size:16,className:"text-purple-400"})})]})]},s.id))})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-700",children:e.jsxs(K,{onClick:a,variant:"outline",children:[e.jsx(j,{size:16,className:"mr-2"}),"Close"]})})]})})},os=({roster:s,userRole:a,isReadOnly:i=!1,category:n,onUpdateMemberRole:l})=>{const[c,o]=t.useState("all"),[d,m]=t.useState(null),[x,h]=t.useState(!0),[u,p]=t.useState(!1),[g,y]=t.useState(null),[j,f]=t.useState(""),[N,v]=t.useState(!1),{terminology:{teamLabel:C},roles:k}=r(n),_=k.length>0?["all",...k]:["all"],S=(e=>{const s=e.map(e=>e.role).filter(Boolean);return[...new Set(s)].sort()})(s),A=s.some(e=>!e.role||""===e.role||"Member"===e.role||"Participant"===e.role),M="all"===c?s:s.filter(e=>e.role===c),I=()=>{const e=s.find(e=>!e.role||""===e.role||"Member"===e.role||"Participant"===e.role);e&&m(e),h(!1)},P=()=>{j.trim()&&(f(""),v(!1),alert(`Role "${j}" created! You can now assign this role to team members.`))},q="admin"===a||"tour manager"===a||"manager"===a;return e.jsxs("div",{className:"space-y-6",children:[x&&A&&!i&&e.jsx(is,{hasUnassignedRoles:A,onAssignRoles:I,onDismiss:()=>h(!1)}),i&&e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-3",children:e.jsx("p",{className:"text-yellow-400 text-sm",children:"Read-only access for your role"})}),e.jsxs("div",{className:"bg-gradient-to-br from-white/5 via-white/3 to-transparent backdrop-blur-sm border border-gray-700/50 rounded-2xl p-6 shadow-xl",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(T,{className:"text-red-400",size:24}),e.jsx("h2",{className:"text-xl font-bold text-white",children:C}),e.jsxs("span",{className:"text-gray-400",children:[s.length," members"]})]})}),e.jsx("div",{className:"flex flex-col md:flex-row items-center justify-center gap-4 mb-6",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2",children:[!i&&l&&e.jsxs(K,{onClick:()=>p(!0),variant:"outline",size:"sm",className:"border-gray-600 hover:bg-white/10 hover:border-gray-500 transition-all duration-200",title:"Assign roles to multiple members",children:[e.jsx(Ee,{size:16,className:"mr-2"}),"Bulk Edit"]}),A&&!i&&e.jsxs(K,{onClick:I,size:"sm",className:"bg-gradient-to-r from-red-600 to-orange-600 hover:from-red-700 hover:to-orange-700 text-white transition-all duration-200",title:"Assign roles to team members",children:[e.jsx(R,{size:16,className:"mr-2"}),"Assign Roles"]}),q&&!i&&e.jsxs(K,{onClick:()=>v(!N),size:"sm",variant:"outline",className:"border-purple-600 text-purple-400 hover:bg-purple-600/10 transition-all duration-200",title:"Create a new custom role",children:[e.jsx(R,{size:16,className:"mr-2"}),"Create Role"]})]})}),N&&q&&!i&&e.jsxs("div",{className:"bg-purple-500/10 border border-purple-500/20 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"text-purple-300 font-medium mb-3 text-sm",children:"Create New Role"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Q,{type:"text",placeholder:"Enter role name (e.g., 'Stage Manager', 'Chef')",value:j,onChange:e=>f(e.target.value),onKeyDown:e=>{"Enter"===e.key&&P()},className:"flex-1 bg-gray-800 border-gray-600 text-white placeholder:text-gray-500"}),e.jsx(K,{onClick:P,disabled:!j.trim(),className:"bg-purple-600 hover:bg-purple-700 text-white",children:"Create"}),e.jsx(K,{onClick:()=>{v(!1),f("")},variant:"outline",className:"border-gray-600 hover:bg-white/10",children:"Cancel"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Once created, you can assign this role to team members using the edit button on their profile."})]}),k.length>0&&e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"flex flex-wrap gap-2 justify-center items-center max-w-5xl",children:_.map(t=>{const a=s.filter(e=>e.role===t);return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("button",{onClick:()=>o(t),className:"px-4 py-2 rounded-full text-sm font-medium transition-all duration-200 "+(c===t?"bg-red-600 text-white shadow-lg shadow-red-600/30 scale-105":"bg-gray-700/50 text-gray-300 hover:bg-gray-600/50 hover:scale-102 border border-gray-600"),children:["all"===t?"All Roles":t,"all"!==t&&e.jsxs("span",{className:"ml-1.5 text-xs opacity-75",children:["(",a.length,")"]})]}),"all"!==t&&a.length>0&&e.jsx("button",{onClick:()=>y({role:t,members:a}),className:"p-1.5 hover:bg-white/10 rounded-full transition-colors",title:`Contact all ${t}`,children:e.jsx(z,{size:14,className:"text-blue-400"})})]},t)})})}),0===k.length&&e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-3",children:e.jsxs("p",{className:"text-blue-400 text-sm",children:["Team members can have custom titles entered manually. ",q&&'Use the "Create Role" button above to add new roles.']})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:M.map(s=>e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-gray-700 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("img",{src:s.avatar||"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face",alt:s.name,className:"w-12 h-12 rounded-full border-2 border-gray-600"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(ls,{member:s,children:e.jsx("h3",{className:"text-white font-medium truncate cursor-pointer hover:text-blue-400 transition-colors",children:s.name})}),e.jsx("p",{className:"text-gray-400 text-sm",children:s.email}),s.phone&&e.jsx("p",{className:"text-gray-500 text-xs",children:s.phone}),e.jsx("div",{className:"flex items-center gap-2 mt-2",children:e.jsx("span",{className:`${as(s.role,n)} px-2 py-1 rounded text-xs font-medium`,children:s.role})})]}),"admin"===a&&!i&&l&&e.jsxs("button",{onClick:()=>(e=>{!i&&l&&m(e)})(s),className:"text-gray-400 hover:text-white transition-colors p-1 rounded hover:bg-white/10 group relative",title:"Click to edit member role",children:[e.jsx(b,{size:16}),e.jsx("span",{className:"absolute -top-8 right-0 bg-gray-800 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none",children:"Edit Role"})]})]}),s.medicalNotes&&e.jsx("div",{className:"mt-3 p-2 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{size:14,className:"text-yellow-400"}),e.jsx("span",{className:"text-yellow-400 text-xs font-medium",children:"Medical Alert"})]})}),s.dietaryRestrictions&&s.dietaryRestrictions.length>0&&e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:"text-gray-400 text-xs",children:["Dietary: ",s.dietaryRestrictions.join(", ")]})})]},s.id))}),0===M.length&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(T,{size:48,className:"text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No team members found for the selected role."})]}),e.jsx(rs,{isOpen:!!d,onClose:()=>m(null),member:d,category:n,existingRoles:S,onUpdateRole:async(e,s)=>{l&&await l(e,s)}}),l&&e.jsx(ns,{isOpen:u,onClose:()=>p(!1),roster:s,category:n,existingRoles:S,onUpdateMemberRole:l}),g&&e.jsx(cs,{isOpen:!0,onClose:()=>y(null),role:g.role,members:g.members,category:n})]})},ds=({roster:s,userRole:a,isReadOnly:r=!1,category:i,tripId:n,onUpdateMemberRole:l})=>{const[c,o]=t.useState("channels");return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white/5 backdrop-blur-sm border border-gray-700/50 rounded-xl overflow-hidden",children:e.jsxs("div",{className:"flex",children:[e.jsxs("button",{onClick:()=>o("channels"),className:"flex-1 flex items-center justify-center gap-2 px-6 py-4 font-medium transition-all duration-200 "+("channels"===c?"bg-purple-600 text-white shadow-lg":"bg-transparent text-gray-400 hover:text-white hover:bg-white/5"),children:[e.jsx(P,{size:18}),e.jsx("span",{children:"Channels"})]}),e.jsxs("button",{onClick:()=>o("roles"),className:"flex-1 flex items-center justify-center gap-2 px-6 py-4 font-medium transition-all duration-200 "+("roles"===c?"bg-red-600 text-white shadow-lg":"bg-transparent text-gray-400 hover:text-white hover:bg-white/5"),children:[e.jsx(T,{size:18}),e.jsx("span",{children:"Roles"})]})]})}),"channels"===c?n?e.jsx(ts,{tripId:n,userRole:a}):e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-6 text-center",children:[e.jsx(P,{size:32,className:"mx-auto mb-2 text-yellow-400"}),e.jsx("p",{className:"text-yellow-400",children:"Trip ID is required to display channels"})]}):e.jsx(os,{roster:s,userRole:a,isReadOnly:r,category:i,onUpdateMemberRole:l})]})},ms=({activeTab:s,tripId:t,basecamp:a,tripData:r,category:i,onUpdateRoomAssignments:m,onUpdateMemberRole:x})=>{const{user:h}=p(),u=(null==h?void 0:h.proRole)||"staff",g=(null==h?void 0:h.permissions)||["read"];if(!((e,s,t)=>{const a=Fe.find(s=>s.id===e);return!!a&&(!a.restrictedRoles||!a.restrictedRoles.includes(s.toLowerCase()))&&(!(a.requiredPermissions&&a.requiredPermissions.length>0)||a.requiredPermissions.some(e=>t.includes(e)))})(s,u,g))return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-red-500/10 backdrop-blur-sm border border-red-500/20 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-red-400 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-red-300",children:"You don't have permission to access this section."}),e.jsxs("p",{className:"text-red-300/80 text-sm mt-2",children:["Current role: ",u]})]})});const b=Ve(s,u,g);return e.jsx("div",{className:"h-[calc(100vh-320px)] max-h-[1000px] min-h-[500px] overflow-y-auto flex flex-col",children:(()=>{switch(s){case"chat":return e.jsx(d,{enableGroupChat:!0,showBroadcasts:!0,tripId:t,isPro:!0,userRole:u});case"calendar":return e.jsx(o,{tripId:t});case"tasks":return e.jsx(G,{tripId:t});case"polls":return e.jsx(c,{tripId:t});case"media":return e.jsx(l,{tripId:t});case"payments":return e.jsx(H,{tripId:t});case"places":return e.jsx(V,{});case"team":return e.jsx(ds,{roster:r.roster||[],userRole:u,isReadOnly:b,category:i,tripId:t,onUpdateMemberRole:x});case"finance":return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-gray-700 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Financial Management"}),b&&e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-3 mb-4",children:e.jsx("p",{className:"text-yellow-400 text-sm",children:"Read-only access for your role"})}),e.jsxs("div",{className:"text-center py-12",children:[e.jsx(U,{size:48,className:"text-red-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-400 mb-2",children:"Per-diem & Settlement"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Per-diem automation and settlement tracking coming soon"})]})]})});case"medical":return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-gray-700 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Medical & Wellness"}),b&&e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-3 mb-4",children:e.jsx("p",{className:"text-yellow-400 text-sm",children:"Read-only access for your role"})}),e.jsxs("div",{className:"text-center py-12",children:[e.jsx(J,{size:48,className:"text-red-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-400 mb-2",children:"Health Monitoring"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Injury status tracking and compliance monitoring coming soon"})]})]})});case"compliance":return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-gray-700 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Compliance Management"}),b&&e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-3 mb-4",children:e.jsx("p",{className:"text-yellow-400 text-sm",children:"Read-only access for your role"})}),e.jsxs("div",{className:"text-center py-12",children:[e.jsx(qe,{size:48,className:"text-red-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-400 mb-2",children:"Regulatory Compliance"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Visa, union, and safety compliance tracking coming soon"})]})]})});case"sponsors":return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-gray-700 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Sponsor Management"}),b&&e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-3 mb-4",children:e.jsx("p",{className:"text-yellow-400 text-sm",children:"Read-only access for your role"})}),e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Te,{size:48,className:"text-red-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-400 mb-2",children:"Partnership Tracking"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Activation checklists and deliverable tracking coming soon"})]})]})});case"ai-chat":return e.jsx(n,{tripId:t,basecamp:a});default:return e.jsx(F,{activeTab:"chat",onTabChange:()=>{},tripId:t})}})()})},xs=({category:s})=>{const{user:a,switchRole:i}=p(),n=r(s);return t.useEffect(()=>{if(!(null==a?void 0:a.isPro)||!a.proRole)return;const e=n.roles.map(e=>e.toLowerCase());e.includes(a.proRole)||i(e[0])},[s]),(null==a?void 0:a.isPro)?e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-gray-700 rounded-xl p-6 mb-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-2",children:["Roles - ",n.name]}),e.jsxs("p",{className:"text-gray-400 text-sm mb-4",children:["Current role: ",e.jsx("span",{className:"text-white font-medium",children:a.proRole})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.roles.map(t=>{const r=((e,s)=>{const t=e.toLowerCase();switch(s){case"Sports â€“ Pro, Collegiate, Youth":return t.includes("player")?O:t.includes("coach")?T:t.includes("medical")||t.includes("trainer")?Me:J;case"Tour â€“ Music, Comedy, etc.":return t.includes("artist")?Re:t.includes("manager")?T:t.includes("security")?L:t.includes("sound")||t.includes("production")?Oe:B;case"Business Travel":return t.includes("executive")?S:t.includes("manager")?T:Ae;case"School Trip":return t.includes("teacher")||t.includes("supervisor")?Be:t.includes("student")?T:J;case"Content":return t.includes("cast")||t.includes("talent")?Re:t.includes("producer")||t.includes("director")?B:Oe;case"Other":return t.includes("founder")?De:t.includes("mentor")?Be:T;default:return T}})(t,s),n=((e,s)=>{const t=e.toLowerCase();switch(s){case"Sports â€“ Pro, Collegiate, Youth":return t.includes("player")?"bg-green-500":t.includes("coach")?"bg-blue-500":t.includes("medical")?"bg-pink-500":"bg-gray-500";case"Tour â€“ Music, Comedy, etc.":return t.includes("artist")?"bg-yellow-500":t.includes("manager")?"bg-blue-500":t.includes("security")?"bg-purple-500":"bg-gray-500";case"Business Travel":return t.includes("executive")?"bg-red-500":"bg-blue-500";case"School Trip":return t.includes("teacher")?"bg-blue-500":t.includes("student")?"bg-green-500":"bg-gray-500";case"Content":return t.includes("cast")?"bg-yellow-500":t.includes("producer")?"bg-red-500":"bg-gray-500";case"Other":return t.includes("founder")?"bg-yellow-500":t.includes("mentor")?"bg-blue-500":"bg-gray-500";default:return"bg-gray-500"}})(t,s);return e.jsxs(K,{onClick:()=>i(t.toLowerCase()),variant:a.proRole===t.toLowerCase()?"default":"outline",size:"sm",className:"flex items-center gap-2 "+(a.proRole===t.toLowerCase()?`${n} text-white`:"bg-white/10 text-gray-300 hover:bg-white/20"),children:[e.jsx(r,{size:14}),t]},t)})})]}):null},hs=({activeTab:s,onTabChange:a,onShowTripsPlusModal:i,tripId:n,basecamp:l,tripData:c,selectedCategory:o,onUpdateTripData:d})=>{const[m,x]=t.useState(!1),{user:h}=p(),u=((e,s,t)=>{let a=Fe;if(t){const e=r(t);if(!e)return Fe;a=Fe.filter(s=>!s.proOnly||e.availableTabs.includes(s.id)||["chat","places","ai-chat","media","payments"].includes(s.id))}return a.filter(t=>(!t.restrictedRoles||!t.restrictedRoles.includes(e.toLowerCase()))&&!(t.requiredPermissions&&t.requiredPermissions.length>0&&!t.requiredPermissions.some(e=>s.includes(e))))})((null==h?void 0:h.proRole)||"staff",(null==h?void 0:h.permissions)||["read"],o),g=e=>{};return e.jsxs(e.Fragment,{children:[e.jsx(xs,{category:o}),e.jsx(He,{tabs:u,activeTab:s,onTabChange:a,category:o}),e.jsx(ms,{activeTab:s,tripId:n,basecamp:l,tripData:c,category:o,onUpdateRoomAssignments:g,onUpdateMemberRole:async(e,s)=>{var t;try{const a=(null==(t=c.roster)?void 0:t.map(t=>t.id===e?{...t,role:s}:t))||[];d&&d({roster:a})}catch(a){throw a}}}),e.jsx(Le,{isOpen:m,onClose:()=>x(!1),roomAssignments:c.roomAssignments||[],roster:c.roster||[],onUpdateAssignments:g})]})},us=()=>{const{proTripId:s}=a(),{user:r}=p(),{isDemoMode:i}=ze(),[n,l]=t.useState("chat"),[c,o]=t.useState(!1),[d,u]=t.useState(!1),[g,b]=t.useState(!1),[y,j]=t.useState(!1),[f,N]=t.useState(!1),[v,w]=t.useState(!1),[_,S]=t.useState(!1);if(!i)return e.jsx(Pe,{message:"Demo Mode is disabled",details:"Turn on Demo Mode to view sample professional trips and explore all features."});if(!s)return e.jsx(Pe,{message:"No trip ID provided."});if(!(s in Ie))return e.jsx(Pe,{message:"The requested trip could not be found.",details:`Trip ID: ${s}`,availableIds:Object.keys(Ie)});const R=Ie[s];R.participants;const A={id:R.id,name:R.title,description:R.description||"",destination:R.location,start_date:R.dateRange.split(" - ")[0],end_date:R.dateRange.split(" - ")[1],created_by:"demo-user",created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),is_archived:!1,trip_type:"pro"},M={name:R.basecamp_name||"",address:R.basecamp_address||""},z={...A,basecamp:M,broadcasts:R.broadcasts||[],links:R.links||[],proTripCategory:R.proTripCategory,budget:R.budget,schedule:R.schedule,roster:R.roster,roomAssignments:R.roomAssignments,perDiem:R.perDiem,settlement:R.settlement,medical:R.medical,compliance:R.compliance,media:R.media,sponsors:R.sponsors};return e.jsx(C,{variant:"pro",children:e.jsxs("div",{className:"min-h-screen bg-black text-white",children:[e.jsx($e,{tripContext:z,showInbox:c,onToggleInbox:()=>o(!c),onShowInvite:()=>b(!0),onShowTripSettings:()=>N(!0),onShowAuth:()=>j(!0)}),c&&e.jsx(m,{}),e.jsx(x,{trip:{id:parseInt(R.id)||0,title:R.title,location:R.location,dateRange:R.dateRange,description:R.description||"",participants:R.participants},category:R.proTripCategory,tags:R.tags,onCategoryChange:()=>{},onShowExport:()=>S(!0)}),e.jsx(hs,{activeTab:n,onTabChange:l,onShowTripsPlusModal:()=>w(!0),tripId:s,basecamp:M,tripData:R,selectedCategory:R.proTripCategory}),e.jsx(h,{showSettings:d,onCloseSettings:()=>u(!1),showInvite:g,onCloseInvite:()=>b(!1),showAuth:y,onCloseAuth:()=>j(!1),showTripSettings:f,onCloseTripSettings:()=>N(!1),showTripsPlusModal:v,onCloseTripsPlusModal:()=>w(!1),tripName:R.title,tripId:s,userId:null==r?void 0:r.id}),e.jsx(Y,{isOpen:_,onClose:()=>S(!1),onExport:async(e,t,a,r)=>{try{let n;if(i)k.info("Generating demo PDF with mock data..."),n=await W({tripId:s||"",tripTitle:R.title,destination:R.location,dateRange:R.dateRange,description:R.description||"",mockData:{payments:R.settlement||[],polls:[],tasks:R.schedule||[],places:[],roster:R.roster||[],broadcasts:R.broadcasts||[],attachments:[],schedule:R.schedule||[],participants:R.participants||[]}},e,t,r);else{const i=await fetch("https://jmjiyekmxwsxkfnqwyaa.supabase.co/functions/v1/export-trip",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tripId:s,sections:e,layout:t,privacyRedaction:a,paper:r})});i.ok?n=await i.blob():(k.info("Using demo export mode..."),n=await W({tripId:s||"",tripTitle:R.title,destination:R.location,dateRange:R.dateRange,description:R.description||"",mockData:{payments:R.settlement||[],polls:[],tasks:R.schedule||[],places:[],roster:R.roster||[],broadcasts:R.broadcasts||[],attachments:[],schedule:R.schedule||[],participants:R.participants||[]}},e,t,r))}const l=window.URL.createObjectURL(n),c=document.createElement("a");c.href=l,c.download=`Trip_${R.title.replace(/[^a-z0-9]/gi,"_")}_${t}_${Date.now()}.pdf`,document.body.appendChild(c),c.click(),window.URL.revokeObjectURL(l),document.body.removeChild(c),k.success("PDF exported successfully!")}catch(n){throw k.error("Failed to export PDF"),n}},tripName:R.title,tripId:s||""})]})})};export{us as default};
