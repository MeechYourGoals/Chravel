import{e as v,j as e,h as z,A as I,u as A,n as C,r as S,R as E,S as O}from"./index-CAsyng-G.js";import{u as D}from"./useOrganization-SBfay-F2.js";import{A as R,a as T,b as _}from"./avatar-BV3tYu8d.js";import{D as P,a as B,b as F,d as j}from"./dropdown-menu-DesE2wBT.js";import{M as L,S as U}from"./select-XMWUKs4c.js";import{E as V}from"./ellipsis-vertical-CzHInxXT.js";import{U as q}from"./user-D5s9iwuG.js";import{I as G}from"./InviteMemberModal-DBcmPnoT.js";import{B as p}from"./button-_Pv0MPf0.js";import{S as i}from"./skeleton-34-YVFjV.js";import{A as N}from"./arrow-left-DsyQ2ZDs.js";import{P as H}from"./plus-CmGY8coD.js";import"./dialog-Cx8-WJ72.js";import"./chevron-right-ubVvME2N.js";import"./input-CkF3ltBX.js";import"./loader-circle-CkOmKk2l.js";const J=({member:s,onChangeRole:a,onRemove:c,isOwner:n})=>{var o,d;if(!v())return null;const u=m=>{switch(m){case"owner":return"text-purple-400 bg-purple-500/20";case"admin":return"text-blue-400 bg-blue-500/20";case"member":return"text-green-400 bg-green-500/20";default:return"text-gray-400 bg-gray-500/20"}},h=m=>{switch(m){case"owner":case"admin":return e.jsx(U,{className:"w-3 h-3"});default:return e.jsx(q,{className:"w-3 h-3"})}};return e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl bg-card border border-border",children:[e.jsxs(R,{className:"w-12 h-12",children:[e.jsx(T,{src:s.avatar_url}),e.jsx(_,{className:"bg-primary/20 text-primary",children:((o=s.full_name)==null?void 0:o.charAt(0))||((d=s.email)==null?void 0:d.charAt(0))||"?"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-foreground truncate",children:s.full_name||"Unknown User"}),s.email&&e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1 truncate",children:[e.jsx(L,{className:"w-3 h-3"}),s.email]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:z("px-2 py-1 rounded-full text-xs font-medium flex items-center gap-1",u(s.role)),children:[h(s.role),s.role]}),!n&&s.role!=="owner"&&(a||c)&&e.jsxs(P,{children:[e.jsx(B,{className:"p-1 hover:bg-accent rounded-lg transition-colors",children:e.jsx(V,{className:"w-5 h-5 text-muted-foreground"})}),e.jsxs(F,{align:"end",children:[a&&s.role!=="admin"&&e.jsx(j,{onClick:()=>a("admin"),children:"Promote to Admin"}),a&&s.role==="admin"&&e.jsx(j,{onClick:()=>a("member"),children:"Demote to Member"}),c&&e.jsx(j,{onClick:c,className:"text-destructive",children:"Remove from Organization"})]})]})]})]})},ce=()=>{const{orgId:s}=I(),a=A(),c=v(),{toast:n}=C(),[b,u]=S.useState(!1),{organizations:h,members:o,loading:d,fetchOrgMembers:m,updateMemberRole:w,removeMember:y}=D();E.useEffect(()=>{s&&m(s)},[s]);const x=h.find(r=>r.id===s);if(!c)return a("/settings"),null;const M=async(r,t)=>{try{const g=await w(r,t);if(g.error)throw g.error;n({title:"Role updated",description:"Team member role has been updated successfully"})}catch{n({title:"Error",description:"Failed to update member role",variant:"destructive"})}},k=async r=>{try{const t=await y(r);if(t.error)throw t.error;n({title:"Member removed",description:"Team member has been removed from the organization"})}catch{n({title:"Error",description:"Failed to remove member",variant:"destructive"})}};if(d&&h.length===0)return e.jsx("div",{className:"min-h-screen bg-background p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(i,{className:"h-12 w-full"}),e.jsx(i,{className:"h-32 w-full"}),e.jsx(i,{className:"h-20 w-full"}),e.jsx(i,{className:"h-20 w-full"})]})});if(!x)return e.jsxs("div",{className:"min-h-screen bg-background p-4",children:[e.jsxs(p,{variant:"ghost",onClick:()=>a(-1),className:"mb-4",children:[e.jsx(N,{className:"w-5 h-5 mr-2"}),"Back"]}),e.jsx("p",{className:"text-muted-foreground text-center mt-8",children:"Organization not found"})]});const l=o.find(r=>r.role==="owner"||r.role==="admin"),f=(l==null?void 0:l.role)==="owner"||(l==null?void 0:l.role)==="admin";return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-background/95 backdrop-blur-sm border-b border-border",children:e.jsxs("div",{className:"p-4 flex items-center justify-between",children:[e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>a(-1),children:e.jsx(N,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-lg font-semibold text-foreground",children:"Organization"}),e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>a("/settings"),children:e.jsx(O,{className:"w-5 h-5"})})]})}),e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-primary/20 to-primary/5 rounded-2xl p-6 border border-primary/20",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:x.name}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsx("span",{className:"uppercase font-medium text-primary",children:x.subscription_tier}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[x.seats_used," / ",x.seat_limit," seats"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Team Members"}),f&&e.jsxs(p,{size:"sm",onClick:()=>u(!0),className:"gap-2",children:[e.jsx(H,{className:"w-4 h-4"}),"Invite"]})]}),d?e.jsxs("div",{className:"space-y-3",children:[e.jsx(i,{className:"h-20 w-full"}),e.jsx(i,{className:"h-20 w-full"}),e.jsx(i,{className:"h-20 w-full"})]}):o.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No team members yet"}):e.jsx("div",{className:"space-y-3",children:o.map(r=>e.jsx(J,{member:r,onChangeRole:f?t=>M(r.id,t):void 0,onRemove:f?()=>k(r.id):void 0,isOwner:r.role==="owner"},r.id))})]})]}),e.jsx(G,{open:b,organizationId:s||"",onClose:()=>u(!1)})]})};export{ce as MobileOrganizationPage};
