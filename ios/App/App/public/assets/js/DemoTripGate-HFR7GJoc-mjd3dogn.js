import{j as e}from"./ui-vendor-BO3EQrMK-mjd3dogn.js";import{u as t,i as s,r}from"./react-vendor-D1R0t5S0-mjd3dogn.js";import{u as i,B as o,s as a}from"./index-Ta7FH5xW-mjd3dogn.js";import{L as l}from"./loader-circle-C0Dqayt8-mjd3dogn.js";import"./supabase-DyX-XggK-mjd3dogn.js";import"./utils-DD44zzh--mjd3dogn.js";const n=()=>{const{demoTripId:n}=t(),c=s(),{user:d}=i(),[m,p]=r.useState(!0),[h,u]=r.useState(null),[x,b]=r.useState(null),f=r.useMemo(()=>(n??"").trim(),[n]),g=r.useMemo(()=>Boolean(f)&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(f),[f]);r.useEffect(()=>{g&&c(`/trip/${encodeURIComponent(f)}/preview`,{replace:!0})},[g,c,f]),r.useEffect(()=>{(async()=>{if(f&&!g){p(!0),b(null);try{const{data:e,error:t}=await a.functions.invoke("get-trip-preview",{body:{tripId:f}});if(t||!(null==e?void 0:e.success)||!(null==e?void 0:e.trip))return u(null),void b((null==e?void 0:e.error)||(null==t?void 0:t.message)||"Unable to load demo trip.");u(e.trip)}catch(e){u(null),b(e instanceof Error?e.message:"Unable to load demo trip.")}finally{p(!1)}}})()},[g,f]);const j=r.useCallback(()=>{const e=`/demo/trip/${encodeURIComponent(f)}`;c(`/auth?mode=signup&returnTo=${encodeURIComponent(e)}`)},[c,f]),v=r.useCallback(()=>{const e=`/demo/trip/${encodeURIComponent(f)}`;c(`/auth?mode=signin&returnTo=${encodeURIComponent(e)}`)},[c,f]),w=r.useCallback(()=>{if(h)try{sessionStorage.setItem("chravel_demo_trip_prefill_v1",JSON.stringify(function(e){const t=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toISOString().slice(0,10)},s="pro"===e.trip_type||"event"===e.trip_type?e.trip_type:"consumer";return{title:e.name??"",location:e.destination??"",description:e.description??"",startDate:t(e.start_date),endDate:t(e.end_date),tripType:s}}(h)))}catch{}const e="/?createTrip=open";c(d?e:`/auth?mode=signup&returnTo=${encodeURIComponent(e)}`)},[c,h,d]);return f?m?e.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(l,{className:"h-10 w-10 animate-spin text-yellow-400 mx-auto mb-3"}),e.jsx("p",{className:"text-white/60",children:"Loading demoâ€¦"})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-black flex items-center justify-center p-4",children:e.jsx("div",{className:"max-w-lg w-full",children:e.jsxs("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-3xl overflow-hidden",children:[e.jsxs("div",{className:"relative h-48",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:`url('${(null==h?void 0:h.cover_image_url)||"https://images.unsplash.com/photo-1488646953014-85cb44e25828?w=1200&h=630&fit=crop"}')`}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-gray-900/50 to-transparent"}),e.jsx("div",{className:"absolute top-4 left-4",children:e.jsx("div",{className:"bg-black/40 backdrop-blur-sm px-4 py-2 rounded-full",children:e.jsx("span",{className:"text-yellow-400 font-bold text-lg",children:"Chravel"})})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:(null==h?void 0:h.name)||"This Demo Trip"}),e.jsxs("p",{className:"text-white/60 mb-5",children:["This is a ",e.jsx("span",{className:"text-white font-medium",children:"demo trip"})," created to show how Chravel works. Sign up or log in to create your own trip and unlock the full experience."]}),x&&e.jsx("div",{className:"mb-5 rounded-2xl border border-white/10 bg-white/5 p-4",children:e.jsx("p",{className:"text-sm text-white/70",children:x})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(o,{onClick:j,className:"w-full bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-black font-semibold py-3",children:"Sign Up"}),e.jsx(o,{onClick:v,variant:"outline",className:"w-full border-white/20 text-white hover:bg-white/10 py-3",children:"Log In"}),e.jsx("button",{type:"button",onClick:w,className:"w-full text-center text-sm text-white/70 hover:text-white transition-colors pt-1",children:"Create a Trip Like This"})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-white/10 text-center",children:e.jsx("p",{className:"text-white/40 text-xs",children:"Powered by Chravel"})})]})]})})}):e.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center p-6",children:e.jsxs("div",{className:"max-w-lg w-full text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Demo Trip"}),e.jsx("p",{className:"text-white/60 mb-6",children:"Missing demo trip id."}),e.jsx(o,{onClick:()=>c("/"),className:"bg-white text-black hover:bg-white/90",children:"Back to Home"})]})})};export{n as default};
