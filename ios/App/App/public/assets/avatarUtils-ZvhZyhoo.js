import{c as f,s as d,k as z,r as c,j as e,X as S}from"./index-CAsyng-G.js";import{d as U}from"./demoModeService-C5DiNBaU.js";import{M as B}from"./select-XMWUKs4c.js";import{E as F,u as R,I as Z,t as D,v as G}from"./SettingsMenu-BOjv86PG.js";import{P as V}from"./SeatManagementSection-BFc4Xk5u.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=f("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=f("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=f("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=f("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),J=[{id:"1",name:"Spring Break Cancun",description:"Beach vacation with the crew",destination:"Cancun, Mexico",start_date:"2026-03-15",end_date:"2026-03-22",cover_image_url:"/images/trips/cancun.jpg",created_by:"mock-user-1",created_at:"2024-01-15T10:00:00Z",updated_at:"2024-01-15T10:00:00Z",is_archived:!1,trip_type:"consumer"},{id:"2",name:"Tokyo Adventure",description:"Exploring Japan with friends",destination:"Tokyo, Japan",start_date:"2026-06-10",end_date:"2026-06-17",cover_image_url:"/images/trips/tokyo.jpg",created_by:"mock-user-1",created_at:"2024-02-01T10:00:00Z",updated_at:"2024-02-01T10:00:00Z",is_archived:!1,trip_type:"consumer"},{id:"3",name:"2026 Kappa Alpha Side Trip",description:"Alumni weekend getaway",destination:"Charleston, SC",start_date:"2026-04-05",end_date:"2026-04-08",cover_image_url:"/images/trips/charleston.jpg",created_by:"mock-user-1",created_at:"2024-01-20T10:00:00Z",updated_at:"2024-01-20T10:00:00Z",is_archived:!1,trip_type:"consumer"}],ae={async createTrip(t){try{const{data:{user:r}}=await d.auth.getUser();if(!r)throw new Error("No authenticated user");const{data:s,error:n}=await d.functions.invoke("create-trip",{body:{name:t.name,description:t.description,destination:t.destination,start_date:t.start_date,end_date:t.end_date,trip_type:t.trip_type||"consumer",cover_image_url:t.cover_image_url}});if(n)throw n;if(!(s!=null&&s.success))throw new Error((s==null?void 0:s.error)||"Failed to create trip");return s.trip}catch(r){return console.error("Error creating trip:",r),null}},async getUserTrips(){try{if(await U.isDemoModeEnabled())return J;const{data:{user:r}}=await d.auth.getUser();if(!r)return[];const{data:s,error:n}=await d.from("trips").select("*").eq("is_archived",!1).order("created_at",{ascending:!1});if(n)throw n;return s||[]}catch(t){return console.error("Error fetching trips:",t),[]}},async getTripById(t){try{const{data:r,error:s}=await d.from("trips").select("*").eq("id",t).single();if(s)throw s;return r}catch(r){return console.error("Error fetching trip:",r),null}},async updateTrip(t,r){try{const{error:s}=await d.from("trips").update(r).eq("id",t);return!s}catch(s){return console.error("Error updating trip:",s),!1}},async archiveTrip(t){try{const{error:r}=await d.from("trips").update({is_archived:!0}).eq("id",t);return!r}catch(r){return console.error("Error archiving trip:",r),!1}},async getTripMembers(t){try{const{data:r,error:s}=await d.from("trip_members").select(`
          id,
          user_id,
          role,
          created_at,
          profiles:user_id (
            display_name,
            avatar_url,
            email
          )
        `).eq("trip_id",t);if(s)throw s;return r||[]}catch(r){return console.error("Error fetching trip members:",r),[]}},async addTripMember(t,r,s="member"){try{const{error:n}=await d.from("trip_members").insert({trip_id:t,user_id:r,role:s});return!n}catch(n){return console.error("Error adding trip member:",n),!1}}},ne=({isOpen:t,onClose:r})=>{const{signIn:s,signInWithPhone:n,signInWithGoogle:u,signInWithApple:b,signUp:g,isLoading:h}=z(),[o,p]=c.useState("signin"),[m,w]=c.useState(""),[y,v]=c.useState(""),[x,j]=c.useState(""),[N,C]=c.useState(""),[_,I]=c.useState(""),[k,E]=c.useState(!1),[$,i]=c.useState("");if(!t)return null;const A=async a=>{a.preventDefault(),i("");try{let l;if(o==="signup"?l=await g(m,x,N,_):l=await s(m,x),l.error){i(l.error);return}r()}catch(l){console.error("Auth error:",l),i("An unexpected error occurred")}},M=async a=>{a.preventDefault(),i("");try{const l=await n(y);if(l.error){i(l.error);return}i("Verification code sent to your phone!")}catch(l){console.error("Phone auth error:",l),i("An unexpected error occurred")}},T=async()=>{i("");try{const a=await u();a.error&&i(a.error)}catch(a){console.error("Google auth error:",a),i("An unexpected error occurred")}},q=async()=>{i("");try{const a=await b();a.error&&i(a.error)}catch(a){console.error("Apple auth error:",a),i("An unexpected error occurred")}},L=()=>e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[o==="signup"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 text-sm mb-2",children:"First Name"}),e.jsx("input",{type:"text",value:N,onChange:a=>C(a.target.value),placeholder:"John",required:!0,className:"w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-glass-orange"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 text-sm mb-2",children:"Last Name"}),e.jsx("input",{type:"text",value:_,onChange:a=>I(a.target.value),placeholder:"Doe",required:!0,className:"w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-glass-orange"})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 text-sm mb-2",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(B,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"email",value:m,onChange:a=>w(a.target.value),placeholder:"your@email.com",required:!0,className:"w-full bg-white/10 border border-white/20 rounded-xl pl-10 pr-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-glass-orange"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 text-sm mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:k?"text":"password",value:x,onChange:a=>j(a.target.value),placeholder:"••••••••",required:!0,className:"w-full bg-white/10 border border-white/20 rounded-xl pl-4 pr-10 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-glass-orange"}),e.jsx("button",{type:"button",onClick:()=>E(!k),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white",children:k?e.jsx(W,{size:20}):e.jsx(F,{size:20})})]})]}),e.jsx("button",{type:"submit",disabled:h,className:"w-full bg-gradient-to-r from-glass-orange to-glass-yellow text-white font-medium py-3 rounded-xl hover:scale-105 transition-transform disabled:opacity-50",children:h?"Loading...":o==="signup"?"Create Account":"Sign In"}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx("button",{type:"button",onClick:T,className:"flex-1 bg-white/10 hover:bg-white/20 border border-white/20 text-white font-medium py-3 rounded-xl transition-colors",children:"Google"}),e.jsx("button",{type:"button",onClick:q,className:"flex-1 bg-white/10 hover:bg-white/20 border border-white/20 text-white font-medium py-3 rounded-xl transition-colors",children:"Apple"})]})]}),P=()=>e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 text-sm mb-2",children:"Phone Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(V,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"tel",value:y,onChange:a=>v(a.target.value),placeholder:"+1 (555) 123-4567",required:!0,className:"w-full bg-white/10 border border-white/20 rounded-xl pl-10 pr-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-glass-orange"})]})]}),e.jsx("button",{type:"submit",disabled:h,className:"w-full bg-gradient-to-r from-glass-orange to-glass-yellow text-white font-medium py-3 rounded-xl hover:scale-105 transition-transform disabled:opacity-50",children:h?"Sending...":"Send OTP"})]});return e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-8 max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:o==="phone"?"Sign in with Phone":o==="signup"?"Create Account":"Welcome Back"}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white",children:e.jsx(S,{size:24})})]}),e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsx("button",{onClick:()=>p("signin"),className:`flex-1 py-2 px-4 rounded-xl text-sm font-medium transition-colors ${o==="signin"||o==="signup"?"bg-glass-orange text-white":"bg-white/10 text-gray-300"}`,children:"Email"}),e.jsx("button",{onClick:()=>p("phone"),className:`flex-1 py-2 px-4 rounded-xl text-sm font-medium transition-colors ${o==="phone"?"bg-glass-orange text-white":"bg-white/10 text-gray-300"}`,children:"Phone"})]}),o==="phone"?P():L(),o!=="phone"&&e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:()=>p(o==="signin"?"signup":"signin"),className:"text-glass-orange hover:text-glass-yellow transition-colors",children:o==="signin"?"Don't have an account? Sign up":"Already have an account? Sign in"})})]})})},O=({tripName:t,onClose:r})=>e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:r,className:"absolute top-4 right-4 z-10 hover:bg-white/20 text-white w-10 h-10 rounded-full flex items-center justify-center transition-colors",title:"Close",children:e.jsx(S,{size:20})}),e.jsxs("div",{className:"mb-6 pr-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Invite to Trip"}),e.jsx("p",{className:"text-gray-400 text-sm",children:t})]})]}),H=({requireApproval:t,expireIn7Days:r,onRequireApprovalChange:s,onExpireIn7DaysChange:n})=>e.jsxs("div",{className:"mb-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-gray-300 text-sm",children:"Require approval to join"}),e.jsx("input",{type:"checkbox",checked:t,onChange:u=>s(u.target.checked),className:"rounded"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-gray-300 text-sm",children:"Link expires in 7 days"}),e.jsx("input",{type:"checkbox",checked:r,onChange:u=>n(u.target.checked),className:"rounded"})]})]}),oe=({isOpen:t,onClose:r,tripName:s,tripId:n})=>{const[u,b]=c.useState(!1),[g,h]=c.useState(!1),{copied:o,inviteLink:p,loading:m,regenerateInviteToken:w,handleCopyLink:y,handleShare:v,handleEmailInvite:x,handleSMSInvite:j}=R({isOpen:t,tripName:s,requireApproval:u,expireIn7Days:g});return t?e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-6 max-w-md w-full max-h-[90vh] overflow-y-auto animate-scale-in relative",children:[e.jsx(O,{tripName:s,onClose:r}),e.jsx(Z,{inviteLink:p,loading:m,copied:o,onCopyLink:y,onRegenerate:w}),e.jsx(H,{requireApproval:u,expireIn7Days:g,onRequireApprovalChange:b,onExpireIn7DaysChange:h}),e.jsx(D,{loading:m,inviteLink:p,onShare:v,onEmailInvite:x,onSMSInvite:j}),e.jsx(G,{})]})}):null},ie=t=>{if(!t||typeof t!="string")return"U";const r=t.trim().split(" ").filter(Boolean);return r.length===0?"U":r.length===1?r[0][0].toUpperCase():(r[0][0]+r[r.length-1][0]).toUpperCase()},le=t=>{if(!t)return!1;try{const r=new URL(t);return r.protocol==="http:"||r.protocol==="https:"}catch{return!1}};export{ne as A,W as E,re as I,te as M,se as S,oe as a,ie as g,le as i,ae as t};
