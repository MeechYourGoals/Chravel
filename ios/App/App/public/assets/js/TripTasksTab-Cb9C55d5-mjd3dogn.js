import{j as e}from"./ui-vendor-BO3EQrMK-mjd3dogn.js";import{r as s}from"./react-vendor-D1R0t5S0-mjd3dogn.js";import{c as t,X as a,B as l,u as i,d as r,l as n,j as d,m as o}from"./index-Ta7FH5xW-mjd3dogn.js";import{B as c}from"./badge-DyE_ZUPM-mjd3dogn.js";import{S as m,a as x,b as u,c as h,d as p}from"./sheet-L6YEzMS_-mjd3dogn.js";import{A as g,b as j,a as v}from"./avatar-HCmfb6Ad-mjd3dogn.js";import{C as f}from"./circle-check-CNnkiDfZ-mjd3dogn.js";import{C as N}from"./dropdown-menu-BXaKb4pk-mjd3dogn.js";import{f as k,a as b,r as y}from"./utils-DD44zzh--mjd3dogn.js";import{D as w,a as _,b as C,c as S}from"./dialog-BcLamxvL-mjd3dogn.js";import{a as D}from"./select-CMjqEsxb-mjd3dogn.js";import{C as z}from"./calendar-C9K0fVga-mjd3dogn.js";import{a as T}from"./user-DFuJ2ZP3-mjd3dogn.js";import{B as O,l as I,h as F,m as P,D as E}from"./TripDetailModals-BpnQZ47b-mjd3dogn.js";import{i as M,j as A,k as B,l as U,m as $,n as R,o as L,p as J}from"./SettingsMenu-DFNATHGY-mjd3dogn.js";import{C as K}from"./clock-CbBGjTQx-mjd3dogn.js";import{P as Q}from"./plus-Dhwa7sZY-mjd3dogn.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=t("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),q=({task:s,onClose:t})=>{var l,i,r,n;const d=(null==(l=s.task_status)?void 0:l.filter(e=>e.completed))||[],o=(null==(i=s.task_status)?void 0:i.filter(e=>!e.completed))||[];return e.jsx(m,{open:!0,onOpenChange:t,children:e.jsxs(x,{className:"bg-gray-900 border-gray-700 text-white",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{className:"text-white",children:s.title}),e.jsx(p,{asChild:!0,children:e.jsx("button",{className:"text-gray-400 hover:text-white",children:e.jsx(a,{size:20})})})]})}),e.jsxs("div",{className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"bg-white/5 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-gray-300",children:"Progress"}),e.jsxs(c,{className:"bg-gradient-to-r from-blue-400 to-purple-400",children:[d.length,"/",(null==(r=s.task_status)?void 0:r.length)||0]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-400 to-purple-400 h-2 rounded-full transition-all duration-300",style:{width:d.length/((null==(n=s.task_status)?void 0:n.length)||1)*100+"%"}})})]}),d.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-lg font-medium text-white flex items-center gap-2",children:[e.jsx(f,{size:20,className:"text-green-400"}),"Completed (",d.length,")"]}),e.jsx("div",{className:"space-y-2",children:d.map(s=>{var t,a,l,i;return e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-400/10 rounded-lg border border-green-400/20",children:[e.jsxs(g,{className:"w-8 h-8",children:[e.jsx(j,{src:null==(t=s.user)?void 0:t.avatar}),e.jsx(v,{className:"text-xs bg-green-400 text-white",children:(null==(l=null==(a=s.user)?void 0:a.name)?void 0:l.charAt(0))||"U"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-white font-medium",children:(null==(i=s.user)?void 0:i.name)||"Unknown User"}),s.completed_at&&e.jsxs("div",{className:"text-gray-400 text-xs",children:["Completed ",k(new Date(s.completed_at),{addSuffix:!0})]})]}),e.jsx(f,{size:20,className:"text-green-400"})]},s.user_id)})})]}),o.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-lg font-medium text-white flex items-center gap-2",children:[e.jsx(N,{size:20,className:"text-yellow-400"}),"Pending (",o.length,")"]}),e.jsx("div",{className:"space-y-2",children:o.map(s=>{var t,a,l,i;return e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-yellow-400/10 rounded-lg border border-yellow-400/20",children:[e.jsxs(g,{className:"w-8 h-8",children:[e.jsx(j,{src:null==(t=s.user)?void 0:t.avatar}),e.jsx(v,{className:"text-xs bg-yellow-400 text-white",children:(null==(l=null==(a=s.user)?void 0:a.name)?void 0:l.charAt(0))||"U"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-white font-medium",children:(null==(i=s.user)?void 0:i.name)||"Unknown User"}),e.jsx("div",{className:"text-gray-400 text-xs",children:"Not completed yet"})]}),e.jsx(N,{size:20,className:"text-yellow-400"})]},s.user_id)})})]}),s.description&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Description"}),e.jsx("p",{className:"text-gray-300 bg-white/5 rounded-lg p-3",children:s.description})]}),s.due_at&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Due Date"}),e.jsx("div",{className:"text-gray-300 bg-white/5 rounded-lg p-3",children:k(new Date(s.due_at),{addSuffix:!0})})]})]})]})})},G=({task:s,isOpen:t,onClose:a,onEdit:i,userCompleted:r})=>{var n,d;const o=(null==(n=s.task_status)?void 0:n.filter(e=>e.completed).length)||0,m=(null==(d=s.task_status)?void 0:d.length)||1;return e.jsx(w,{open:t,onOpenChange:a,children:e.jsxs(_,{className:"sm:max-w-md",children:[e.jsx(C,{children:e.jsxs(S,{className:"flex items-center gap-2",children:[r&&e.jsx("div",{className:"w-5 h-5 rounded-full bg-green-500 flex items-center justify-center flex-shrink-0",children:e.jsx(D,{size:12,className:"text-white"})}),e.jsx("span",{className:r?"text-muted-foreground":"",children:s.title})]})}),e.jsxs("div",{className:"space-y-4",children:[s.description&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Description"}),e.jsx("p",{className:"text-foreground",children:s.description})]}),s.due_at&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{size:16,className:"text-muted-foreground"}),e.jsxs("span",{className:"text-sm",children:["Due: ",b(new Date(s.due_at),"PPP")]})]}),s.creator&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{size:16,className:"text-muted-foreground"}),e.jsxs("span",{className:"text-sm",children:["Created by: ",s.creator.name||"Unknown"]})]}),s.is_poll&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Completion Progress"}),e.jsxs(c,{variant:"secondary",children:[o,"/",m," completed"]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t border-border",children:[i&&e.jsx(l,{variant:"outline",onClick:()=>{i(s),a()},children:"Edit Task"}),e.jsx(l,{variant:"ghost",onClick:a,children:"Close"})]})]})]})})},H=({task:t,tripId:a,onEdit:d})=>{var o,m,x,u,h,p,g;const[j,v]=s.useState(!1),[f,N]=s.useState(!1),[b,w]=s.useState(!1),[_,C]=s.useState(!1),{toggleTaskMutation:S,deleteTaskMutation:z}=O(a),T=t.is_poll?((null==(o=t.task_status)?void 0:o.filter(e=>e.completed).length)||0)>=((null==(m=t.task_status)?void 0:m.length)||1):(null==(u=null==(x=t.task_status)?void 0:x[0])?void 0:u.completed)||!1,P=t.due_at&&y(new Date,new Date(t.due_at))&&!T,{user:E}=i(),{isDemoMode:K}=r(),Q=K||!E?"demo-user":E.id,V=null==(h=t.task_status)?void 0:h.find(e=>e.user_id===Q),H=(null==V?void 0:V.completed)||!1,W=(null==(p=t.task_status)?void 0:p.filter(e=>e.completed).length)||0,X=(null==(g=t.task_status)?void 0:g.length)||1;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-3 transition-all hover:bg-white/10 cursor-pointer "+(H?"opacity-75":""),onClick:()=>{w(!0)},children:e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx("button",{onClick:e=>{e.stopPropagation();const s=!H;s?(F.success(),C(!0),setTimeout(()=>C(!1),1e3)):F.light(),S.mutate({taskId:t.id,completed:s})},className:`w-5 h-5 rounded-full border-2 flex items-center justify-center transition-all flex-shrink-0 ${H?"bg-green-500 border-green-500":"border-muted-foreground hover:border-foreground"} ${_?"scale-110":""}`,children:H&&e.jsx(D,{size:12,className:"text-white"})}),e.jsx("span",{className:"font-medium text-foreground "+(H?"text-muted-foreground":""),children:t.title}),t.description&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-muted-foreground hidden sm:inline",children:"•"}),e.jsx("span",{className:"text-muted-foreground text-sm truncate max-w-[350px]",children:t.description})]}),t.due_at&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-muted-foreground hidden sm:inline",children:"•"}),e.jsxs(c,{variant:P?"destructive":"secondary",className:"text-xs flex-shrink-0",children:[P?"Overdue":"Due"," ",k(new Date(t.due_at),{addSuffix:!0})]})]}),t.is_poll&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-muted-foreground hidden sm:inline",children:"•"}),e.jsxs(l,{variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),v(!0)},className:"text-xs text-muted-foreground hover:text-foreground px-2 h-7",children:[W,"/",X," done"]})]}),e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsxs(l,{variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),null==d||d(t)},className:"h-7 px-2 text-xs text-muted-foreground hover:text-foreground",children:[e.jsx(I,{size:14,className:"mr-1"}),"Edit"]}),e.jsxs(l,{variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),N(!0)},className:"h-7 px-2 text-xs text-destructive hover:text-destructive/80",children:[e.jsx(n,{size:14,className:"mr-1"}),"Remove"]})]})]})}),e.jsx(G,{task:t,isOpen:b,onClose:()=>w(!1),onEdit:d,userCompleted:H}),j&&e.jsx(q,{task:t,onClose:()=>v(!1)}),e.jsx(M,{open:f,onOpenChange:N,children:e.jsxs(A,{children:[e.jsxs(B,{children:[e.jsx(U,{children:"Delete Task"}),e.jsxs($,{children:['Are you sure you want to delete "',t.title,'"? This action cannot be undone.']})]}),e.jsxs(R,{children:[e.jsx(L,{children:"Cancel"}),e.jsx(J,{onClick:()=>{z.mutate(t.id),N(!1)},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})},W=({tasks:s,tripId:t,title:a,emptyMessage:l,showCompleted:i,onToggleCompleted:r,onEditTask:n})=>{const d=a.toLowerCase().includes("completed");return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:d?e.jsxs("button",{onClick:r,className:"flex items-center gap-2 text-gray-300 hover:text-white font-medium transition-colors",children:[e.jsx(f,{size:18}),e.jsxs("span",{children:[a," (",s.length,")"]}),e.jsx("span",{className:"text-xs",children:i?"▼":"▶"})]}):e.jsxs("div",{className:"flex items-center gap-2 text-white font-medium",children:[e.jsx(K,{size:18}),e.jsxs("span",{children:[a," (",s.length,")"]})]})}),0===s.length?e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(f,{size:48,className:"mx-auto mb-3 opacity-50"}),e.jsx("p",{children:l||"No tasks found"})]}):(!d||i)&&e.jsx("div",{className:"space-y-2",children:s.map(s=>e.jsx(H,{task:s,tripId:t,onEdit:n},s.id))})]})},X=({status:s,sortBy:t,onStatusChange:i,onSortChange:r,hasActiveFilters:n,onClearFilters:d})=>e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-sm",children:[e.jsx(V,{size:16}),e.jsx("span",{children:"Filter:"})]}),e.jsx("div",{className:"flex gap-2",children:["all","open","completed"].map(t=>e.jsx("button",{onClick:()=>i(t),className:"px-3 py-1 rounded-full text-xs font-medium transition-colors capitalize "+(s===t?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"),children:t},t))}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx("span",{className:"text-slate-400 text-sm",children:"Sort by:"}),e.jsx("select",{value:t,onChange:e=>r(e.target.value),className:"bg-slate-700 text-white text-xs rounded px-2 py-1 border border-slate-600",children:[{value:"dueDate",label:"Due Date"},{value:"created",label:"Created"},{value:"priority",label:"Priority"}].map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),n&&e.jsxs(l,{variant:"ghost",size:"sm",onClick:d,className:"text-slate-400 hover:text-white",children:[e.jsx(a,{size:14,className:"mr-1"}),"Clear"]})]}),Y=({tripId:t})=>{const[a,i]=s.useState(!1),[n,c]=s.useState(!1),{toast:m}=d(),{accentColors:x}=o(),{tasks:u,isLoading:h,applyFilters:p,status:g,setStatus:j,assignee:v,setAssignee:f,dateRange:N,setDateRange:k,sortBy:b,setSortBy:y,hasActiveFilters:w,clearFilters:_}=O(t),{isDemoMode:C}=r();P(t);const S=[{id:"task-1",trip_id:t,title:"Make sure your visa and passport documents are handled at least one month prior",description:"Verify all travel documents are valid and up to date",due_at:new Date(Date.now()+2592e6).toISOString(),is_poll:!1,task_status:[{task_id:"task-1",completed:!1,user_id:"user1"}],creator_id:"trip-organizer",created_by:"Trip Organizer",created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()},{id:"task-2",trip_id:t,title:"Jimmy to purchase alcohol for the house while Sam gets food",description:"Coordinate house supplies for the trip",due_at:new Date(Date.now()+6048e5).toISOString(),is_poll:!1,task_status:[{task_id:"task-2",completed:!0,user_id:"jimmy"}],creator_id:"marcus",created_by:"Marcus",created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()},{id:"task-3",trip_id:t,title:"Making sure all clothes are packed before next destination",description:"Pack weather-appropriate clothing for all activities",due_at:new Date(Date.now()+2592e5).toISOString(),is_poll:!1,task_status:[{task_id:"task-3",completed:!1,user_id:"user1"}],creator_id:"sarah",created_by:"Sarah",created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}],D=p(u&&u.length>0?u:C?S:[]),z=(null==D?void 0:D.filter(e=>{var s,t,a,l;if(e.is_poll){return((null==(s=e.task_status)?void 0:s.filter(e=>e.completed).length)||0)<((null==(t=e.task_status)?void 0:t.length)||1)}return!(null==(l=null==(a=e.task_status)?void 0:a[0])?void 0:l.completed)}))||[],T=(null==D?void 0:D.filter(e=>{var s,t,a,l;if(e.is_poll){return((null==(s=e.task_status)?void 0:s.filter(e=>e.completed).length)||0)>=((null==(t=e.task_status)?void 0:t.length)||1)}return null==(l=null==(a=e.task_status)?void 0:a[0])?void 0:l.completed}))||[];return h?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Tasks"}),e.jsxs(l,{onClick:()=>i(!0),className:`bg-gradient-to-r ${x.gradient} hover:opacity-90`,children:[e.jsx(Q,{size:16,className:"mr-2"}),"Add Task"]})]}),e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Keep track of everything that needs to get done"}),e.jsx(X,{status:g,sortBy:b,onStatusChange:j,onSortChange:y,hasActiveFilters:w,onClearFilters:_})]}),e.jsx(W,{tasks:z,tripId:t,title:"To Do",emptyMessage:"All caught up! No pending tasks.",onEditTask:e=>m({title:"Edit Task",description:`Editing "${e.title}" - Feature coming soon!`})}),T.length>0&&e.jsx(W,{tasks:T,tripId:t,title:"Completed",showCompleted:n,onToggleCompleted:()=>c(!n),onEditTask:e=>m({title:"Edit Task",description:`Editing "${e.title}" - Feature coming soon!`})}),a&&e.jsx(E,{tripId:t,onClose:()=>i(!1)})]})},Z=Object.freeze(Object.defineProperty({__proto__:null,TripTasksTab:Y},Symbol.toStringTag,{value:"Module"}));export{V as F,Y as T,Z as a};
