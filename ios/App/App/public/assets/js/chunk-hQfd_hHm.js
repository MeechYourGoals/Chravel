var e=Object.defineProperty,t=(t,a,s)=>((t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s)(t,"symbol"!=typeof a?a+"":a,s);import{c as a,X as s,t as i,e as r,s as n,f as o,w as l,k as d,S as c,i as m,u,m as p,q as h,j as g,x,y as f,z as b,p as y,h as v,l as w}from"../index-C69Cv9fm.js";import{j}from"./chunk-DE8J_P3a.js";import{r as N,c as _,u as k,j as S}from"./chunk-CHPtWMTz.js";import{c as C,g as D,I as M,S as T,M as I,u as P,a as z,b as E,H as A,d as O,A as L}from"./chunk-BpSVmO2m.js";import{tripService as U}from"./tripService.ts-CUb9l8sj.js";import{C as R}from"./chunk-CD10_Lnj.js";import{n as $,M as F,m as q,o as V,Z as B,S as H,p as W,l as G}from"./chunk-B6KUG25W.js";import{C as Y,S as K,a as J,b as Q,c as Z,d as X}from"./chunk-LoZVIojA.js";import{D as ee,a as te,b as ae,c as se,L as ie}from"./chunk-YjRoWQ3-.js";import{p as re,f as ne}from"./chunk-DN5ISW2H.js";import{C as oe}from"./chunk-Bbmjf7eQ.js";import{P as le,a as de,b as ce}from"./chunk-BzRjpoc5.js";import{u as me}from"./chunk-A2g_dVj8.js";import{C as ue}from"./chunk-C0eak1NN.js";import{U as pe,T as he,a as ge,C as xe}from"./chunk-BxvRdxTs.js";import{I as fe,C as be,P as ye}from"./chunk-C-NDN0ZE.js";import{M as ve}from"./chunk-ByyMTJWo.js";import{C as we}from"./chunk-D53qnCh4.js";import{L as je}from"./chunk-BIY1ublO.js";import{U as Ne}from"./chunk-D5WpN7K-.js";import{P as _e}from"./chunk-DoIo-fWL.js";import{C as ke}from"./chunk-DJZXZyJn.js";import{U as Se}from"./chunk-CkE6zG_x.js";import{d as Ce}from"./chunk-DGLf2uCM.js";import{u as De}from"./chunk-Ccyq873b.js";import{D as Me,a as Te,b as Ie,c as Pe}from"./chunk-DtLDND_v.js";import{I as ze}from"./chunk-D3Z6_DOi.js";import{B as Ee}from"./chunk-CKgI9q5n.js";import{c as Ae,F as Oe,L as Le,S as Ue,D as Re}from"./chunk-D_Hxdxtf.js";import{C as $e,a as Fe,b as qe,c as Ve}from"./chunk-30ZbY-F3.js";import{D as Be,L as He,G as We}from"./chunk-DcTAIqBw.js";import{S as Ge}from"./chunk-bP8xJp5e.js";import{E as Ye}from"./chunk-y0HRaaXz.js";import{g as Ke,a as Je}from"./chunk-wPum6LLk.js";import{u as Qe,a as Ze}from"./chunk-DV9vF-NS.js";import{B as Xe}from"./chunk-Bc1XvzR8.js";import{c as et}from"./chunk-4koW6KZp.js";import{T as tt,a as at,b as st,c as it}from"./chunk-ObNbiZMt.js";import{p as rt,e as nt}from"./chunk--XGoeuWx.js";import{S as ot}from"./chunk-88HG7dU1.js";import{C as lt}from"./chunk-D_Qk7JHd.js";import{C as dt}from"./chunk-DeuaeHUI.js";import{E as ct}from"./chunk-D393L8yP.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=a("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),ut=a("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]),pt=a("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),ht=a("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]),gt=a("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),xt=a("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),ft=a("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),bt=a("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),yt=a("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]),vt=a("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),wt=({tripId:e,description:t,onUpdate:a,className:r="text-gray-300 text-lg leading-relaxed",maxLines:n=2,collapsible:o=!0})=>{const[l,d]=N.useState(!1),[c,m]=N.useState(t),[u,p]=N.useState(!1),[h,g]=N.useState(!1),x=async()=>{if(c.trim()!==t){p(!0);try{await U.updateTrip(e,{description:c.trim()})?(a(c.trim()),d(!1),i.success("Description updated successfully")):i.error("Failed to update description")}catch(s){i.error("Failed to update description")}finally{p(!1)}}else d(!1)},f=()=>{m(t),d(!1)},b=e=>{"Enter"===e.key&&(e.ctrlKey||e.metaKey)?x():"Escape"===e.key&&f()};if(l)return j.jsxs("div",{className:"space-y-3",children:[j.jsx("textarea",{value:c,onChange:e=>m(e.target.value),onKeyDown:b,className:"w-full p-3 bg-white/10 border border-white/20 rounded-xl text-gray-300 text-lg leading-relaxed resize-none min-h-[100px] focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50",placeholder:"Add a description for this trip...",autoFocus:!0,disabled:u}),j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsxs("button",{onClick:x,disabled:u,className:"flex items-center gap-1 px-3 py-1.5 bg-green-600 hover:bg-green-700 disabled:bg-green-600/50 text-white text-sm rounded-lg transition-colors",children:[j.jsx(R,{size:14}),u?"Saving...":"Save"]}),j.jsxs("button",{onClick:f,disabled:u,className:"flex items-center gap-1 px-3 py-1.5 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-600/50 text-white text-sm rounded-lg transition-colors",children:[j.jsx(s,{size:14}),"Cancel"]}),j.jsx("span",{className:"text-xs text-gray-400",children:"Ctrl+Enter to save, Esc to cancel"})]})]});const y=o&&t.length>150,v=y&&!h?`line-clamp-${n}`:"";return j.jsxs("div",{className:"relative pb-10",children:[j.jsx("p",{className:`${r} ${v}`,children:t||"No description added yet. Click to add one."}),y&&j.jsx("button",{onClick:()=>g(!h),className:"text-xs text-gray-400 hover:text-white underline mt-1",children:h?"Read less":"Read more"}),j.jsx("button",{onClick:()=>d(!0),className:"absolute bottom-1 left-0 p-1.5 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg transition-all duration-200 text-gray-400 hover:text-white",title:"Edit description",children:j.jsx($,{size:14})})]})},jt={"Sports – Pro, Collegiate, Youth":{id:"Sports – Pro, Collegiate, Youth",name:"Sports – Pro, Collegiate, Youth",description:"Professional, collegiate, and youth sports teams, tournaments, and athletic events",roles:["Player","Coach","Crew","VIP","Security","Medical","Tech"],availableTabs:["chat","calendar","tasks","polls","places","team","finance","medical","compliance","ai-chat"],requiredTabs:["team","medical"],terminology:{teamLabel:"Team Roster",memberLabel:"Team Member",leaderLabel:"Team Captain"}},"Tour – Music, Comedy, etc.":{id:"Tour – Music, Comedy, etc.",name:"Tour – Music, Comedy, etc.",description:"Music tours, comedy shows, podcast tours, creator events, and entertainment productions",roles:["Artist Team","Tour Manager","Crew","VIP","Security"],availableTabs:["chat","calendar","tasks","polls","places","team","finance","sponsors","ai-chat"],requiredTabs:["team"],terminology:{teamLabel:"Tour Crew",memberLabel:"Crew Member",leaderLabel:"Tour Manager"}},"Business Travel":{id:"Business Travel",name:"Business Travel",description:"Corporate retreats, executive meetings, sales trips, recruiting events, and business travel",roles:[],availableTabs:["chat","calendar","tasks","polls","places","team","finance","compliance","ai-chat"],requiredTabs:["team"],terminology:{teamLabel:"Attendees",memberLabel:"Participant",leaderLabel:"Event Lead"}},"School Trip":{id:"School Trip",name:"School Trip",description:"Educational trips, academic competitions, and school-related events",roles:["Student","Chaperone","Teacher"],availableTabs:["chat","calendar","tasks","polls","places","team","compliance","medical","ai-chat"],requiredTabs:["team","compliance"],terminology:{teamLabel:"Group",memberLabel:"Participant",leaderLabel:"Lead Teacher"}},Content:{id:"Content",name:"Content",description:"Television shows, film productions, creator content, and media shoots",roles:["Talent","Crew","Security"],availableTabs:["chat","calendar","tasks","polls","places","team","sponsors","compliance","ai-chat"],requiredTabs:["team"],terminology:{teamLabel:"Cast & Crew",memberLabel:"Production Member",leaderLabel:"Producer"}},Other:{id:"Other",name:"Other",description:"All other types of professional trips and events not covered by the above categories",roles:[],availableTabs:["chat","calendar","tasks","polls","places","team","finance","ai-chat"],requiredTabs:["team"],terminology:{teamLabel:"Team",memberLabel:"Team Member",leaderLabel:"Team Lead"}}},Nt=e=>jt[e],_t=({selectedCategory:e,onCategoryChange:t,className:a=""})=>{const[s,i]=_.useState(!1),r=Object.keys(jt);return j.jsxs("div",{className:`relative ${a}`,children:[j.jsxs("button",{onClick:()=>i(!s),className:"flex items-center gap-2 bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-xl transition-colors min-w-[200px] justify-between",children:[j.jsx("span",{className:"text-sm font-medium",children:e}),j.jsx(Y,{size:16,className:"transition-transform "+(s?"rotate-180":"")})]}),s&&j.jsxs(j.Fragment,{children:[j.jsx("div",{className:"fixed inset-0 z-[59]",onClick:()=>i(!1)}),j.jsx("div",{className:"absolute top-full left-0 mt-2 w-full min-w-[280px] bg-gray-800 border border-gray-600 rounded-xl shadow-2xl z-[60] overflow-hidden max-h-72 overflow-y-auto mb-20 touch-pan-y",children:r.map(a=>{const s=Nt(a);return j.jsxs("button",{onClick:()=>{t(a),i(!1)},className:"w-full text-left px-4 py-3 text-sm transition-colors hover:bg-gray-700 border-b border-gray-700 last:border-b-0 "+(e===a?"bg-gray-700 text-yellow-400":"text-gray-300"),children:[j.jsx("div",{className:"font-medium",children:s.name}),j.jsx("div",{className:"text-xs text-gray-400 mt-1 leading-relaxed",children:s.description})]},a)})})]})]})},kt=({category:e,tags:t,className:a=""})=>{const s=[Nt(e).name,...t];return j.jsx("div",{className:`flex flex-wrap gap-2 ${a}`,children:s.map((e,t)=>j.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium "+(0===t?"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30":"bg-gray-700/50 text-gray-300 border border-gray-600/30"),children:e},t))})},St=(e,t)=>{if(!e||"string"!=typeof e)return"Unknown";const a=e.trim().split(" ").filter(Boolean);if(0===a.length)return"Unknown";if(1===a.length)return a[0];if("consumer"===t){return`${a[0]} ${a[a.length-1][0].toUpperCase()}.`}return e},Ct=e=>"consumer"===e,Dt=({participants:e,countLabel:t,maxRows:a=1,minColWidth:s=140,onShowAll:i,tripType:r="consumer"})=>{const n=Math.max(52,Math.min(160,52*a));return j.jsxs("section",{"aria-labelledby":"collab-title",className:"relative",children:[j.jsxs("div",{className:"relative",children:[j.jsx("div",{className:"grid gap-2",style:{gridTemplateColumns:`repeat(auto-fill, minmax(${s}px, 1fr))`,maxHeight:`${n}px`,overflow:"hidden"},role:"list","aria-label":"Collaborators",children:e.map(e=>j.jsxs("button",{className:"group flex items-center gap-2 rounded-lg border border-white/10 bg-white/5 px-2 py-1.5 hover:bg-white/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white/20 transition",role:"listitem",title:e.role?`${e.name} • ${e.role}`:e.name,children:[C(e.avatar)&&Ct(r)?j.jsx("img",{src:e.avatar,alt:e.name,className:"h-7 w-7 rounded-full object-cover border border-white/20",loading:"lazy"}):j.jsx("div",{className:"h-7 w-7 rounded-full bg-white/10 text-white/80 grid place-items-center text-[10px] font-semibold border border-white/20",children:D(e.name)}),j.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[j.jsx("div",{className:"truncate text-xs font-medium text-white",children:St(e.name,r)}),e.role&&j.jsx("div",{className:"truncate text-[10px] text-gray-400",children:e.role})]})]},e.id))}),j.jsx("div",{className:"pointer-events-none absolute inset-x-0 bottom-0 h-8 bg-gradient-to-t from-black/60 to-transparent rounded-b-lg"})]}),j.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[j.jsx("div",{className:"text-xs text-gray-400",children:t}),j.jsx("button",{className:"text-xs font-medium underline text-gray-200 hover:text-white",onClick:i,"aria-label":"Show all collaborators",children:"Show all"})]})]})},Mt=({open:e,onOpenChange:t,participants:a,tripType:s="consumer"})=>j.jsx(ee,{open:e,onOpenChange:t,children:j.jsxs(te,{className:"max-w-2xl",children:[j.jsx(ae,{children:j.jsxs(se,{children:["All Collaborators (",a.length,")"]})}),j.jsx("div",{role:"list","aria-label":"All collaborators",className:"mt-4 max-h-[70vh] overflow-auto pr-1",children:a.map(e=>j.jsxs("div",{role:"listitem",className:"flex items-center gap-3 rounded-lg border border-white/10 bg-white/5 px-3 py-2 mb-2",children:[C(e.avatar)?j.jsx("img",{src:e.avatar,alt:e.name,className:"h-9 w-9 rounded-full object-cover border border-white/20",loading:"lazy"}):j.jsx("div",{className:"h-9 w-9 rounded-full bg-white/10 text-white/80 grid place-items-center text-xs font-semibold border border-white/20",children:D(e.name)}),j.jsxs("div",{className:"flex-1 min-w-0",children:[j.jsx("div",{className:"truncate text-sm font-medium text-white",children:St(e.name,s)}),e.role&&j.jsx("div",{className:"truncate text-xs text-gray-400",children:e.role})]})]},e.id))})]})}),Tt=({tripId:e,currentPhoto:t,onPhotoUploaded:a,className:s=""})=>{const{user:i}=r(),[o,l]=N.useState(!1),[d,c]=N.useState(0),[m,u]=N.useState(!1),p=N.useCallback(async t=>{if(0===t.length)return;const s=t[0];l(!0),c(0);try{const t=URL.createObjectURL(s);if(setTimeout(()=>{a(t),u(!0),setTimeout(()=>u(!1),2e3),l(!1),c(0)},1500),i&&n)try{const t=new FormData;t.append("file",s),t.append("tripId",e),t.append("userId",i.id),t.append("caption",`Cover photo for trip ${e}`);const{data:r,error:o}=await n.functions.invoke("photo-upload",{body:t});if(o)throw o;(null==r?void 0:r.success)&&a(r.publicUrl)}catch(r){}}catch(r){l(!1),c(0)}},[i,e,a,n]),{getRootProps:h,getInputProps:g,isDragActive:x}=me({onDrop:p,accept:{"image/*":[".png",".jpg",".jpeg",".gif"]},maxSize:10485760,multiple:!1}),f=()=>{i||alert("Please sign in to upload photos. Demo mode: Photo will be shown temporarily.")};return t?j.jsxs("div",{className:`relative group overflow-hidden rounded-2xl ${s}`,children:[j.jsx("img",{src:t,alt:`Cover photo for trip ${e}`,className:"w-full h-full object-cover"}),j.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity rounded-2xl flex items-center justify-center",children:j.jsxs("div",{...h(),className:"cursor-pointer bg-white/20 backdrop-blur-sm border border-white/30 rounded-xl px-4 py-2 flex items-center gap-2 text-white hover:bg-white/30 transition-colors",onClick:f,children:[j.jsx("input",{...g()}),j.jsx(ue,{size:16}),j.jsx("span",{className:"text-sm font-medium",children:"Change Photo"})]})}),o&&j.jsx("div",{className:"absolute inset-0 bg-black/60 rounded-2xl flex items-center justify-center",children:j.jsxs("div",{className:"text-white text-center",children:[j.jsx("div",{className:"w-8 h-8 border-2 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-2"}),j.jsx("span",{className:"text-sm",children:"Uploading..."})]})}),m&&j.jsx("div",{className:"absolute inset-0 bg-green-500/60 rounded-2xl flex items-center justify-center",children:j.jsxs("div",{className:"text-white text-center",children:[j.jsx(R,{size:32,className:"mx-auto mb-2"}),j.jsx("span",{className:"text-sm font-medium",children:"Photo Updated!"})]})})]}):j.jsxs("div",{...h(),className:`border-2 border-dashed border-white/30 rounded-2xl p-8 text-center cursor-pointer transition-all hover:border-white/50 hover:bg-white/5 min-h-[192px] ${x?"border-blue-400 bg-blue-400/10":""} ${s}`,onClick:f,children:[j.jsx("input",{...g()}),j.jsxs("div",{className:"text-white",children:[j.jsx(pe,{size:48,className:"mx-auto mb-4 text-white/70"}),j.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Upload Trip Cover Photo"}),j.jsx("p",{className:"text-gray-300 text-sm mb-4",children:x?"Drop your photo here...":"Drag & drop a photo here, or click to browse"}),j.jsx("p",{className:"text-gray-400 text-xs",children:"Supports PNG, JPG, GIF • Max 10MB"}),!i&&j.jsx("p",{className:"text-yellow-400 text-xs mt-2",children:"Demo mode: Photos will be shown temporarily. Sign in for full functionality."})]}),o&&j.jsxs("div",{className:"mt-4",children:[j.jsx("div",{className:"w-8 h-8 border-2 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-2"}),j.jsx("span",{className:"text-sm text-white",children:"Uploading..."})]})]})},It=({isOpen:e,onClose:t,trip:a,onUpdate:i})=>{const{user:n}=r(),[d,c]=N.useState(!1),[m,u]=N.useState(a.coverPhoto),[p,h]=N.useState({name:"",destination:"",start_date:"",end_date:""});N.useEffect(()=>{if(e){const e=(e=>{try{const t=e.split(" - ");if(2!==t.length)throw new Error("Invalid date range format");const a=t[0].trim(),s=t[1].trim(),i=s.match(/, (\d{4})$/),r=i?i[1]:(new Date).getFullYear().toString(),n=s.replace(/, \d{4}$/,"").trim(),o=re(`${a}, ${r}`,"MMM d, yyyy",new Date),l=re(`${n}, ${r}`,"MMM d, yyyy",new Date);return{start:ne(o,"yyyy-MM-dd"),end:ne(l,"yyyy-MM-dd")}}catch(t){const e=ne(new Date,"yyyy-MM-dd");return{start:e,end:e}}})(a.dateRange);h({name:a.title,destination:a.location,start_date:e.start,end_date:e.end}),u(a.coverPhoto)}},[e,a]);return e?j.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in",children:j.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-6 max-w-md w-full animate-scale-in relative",children:[j.jsxs("div",{className:"flex items-center justify-between mb-6",children:[j.jsx("h2",{className:"text-2xl font-bold text-white",children:"Edit Trip Details"}),j.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white transition-colors p-2",disabled:d,children:j.jsx(s,{size:24})})]}),j.jsxs("div",{className:"space-y-6",children:[j.jsxs("div",{children:[j.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-300 mb-2",children:[j.jsx(fe,{size:16}),"Cover Photo ",a.trip_type&&"consumer"!==a.trip_type&&"(Background Overlay)"]}),j.jsx(Tt,{tripId:a.id.toString(),currentPhoto:m,onPhotoUploaded:e=>u(e),className:"h-48 w-full"}),"pro"===a.trip_type&&j.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"For Enterprise trips, your photo will appear subtly in the background of the header with a professional overlay."}),"event"===a.trip_type&&j.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"For Events, your photo will appear as a darker cinematic backdrop behind the event details for poster-style impact."})]}),j.jsxs("div",{children:[j.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-300 mb-2",children:[j.jsx(ft,{size:16}),"Trip Name"]}),j.jsx("input",{type:"text",value:p.name,onChange:e=>h({...p,name:e.target.value}),maxLength:100,className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50 transition-all",placeholder:"Enter trip name",disabled:d})]}),j.jsxs("div",{children:[j.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-300 mb-2",children:[j.jsx(ve,{size:16}),"Location"]}),j.jsx("input",{type:"text",value:p.destination,onChange:e=>h({...p,destination:e.target.value}),maxLength:200,className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50 transition-all",placeholder:"Enter destination",disabled:d})]}),j.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[j.jsxs("div",{children:[j.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-300 mb-2",children:[j.jsx(we,{size:16}),"Start Date"]}),j.jsxs(le,{children:[j.jsx(de,{asChild:!0,children:j.jsxs("button",{disabled:d,className:o("w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50 transition-all text-left flex items-center justify-between",!p.start_date&&"text-gray-500"),children:[p.start_date?ne(new Date(p.start_date),"MMM d, yyyy"):"Pick a date",j.jsx(we,{size:16,className:"opacity-50"})]})}),j.jsx(ce,{className:"w-auto p-0 bg-gray-900 border-white/10",align:"start",children:j.jsx(oe,{mode:"single",selected:p.start_date?new Date(p.start_date):void 0,onSelect:e=>e&&h({...p,start_date:ne(e,"yyyy-MM-dd")}),initialFocus:!0,className:"pointer-events-auto"})})]})]}),j.jsxs("div",{children:[j.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-300 mb-2",children:[j.jsx(we,{size:16}),"End Date"]}),j.jsxs(le,{children:[j.jsx(de,{asChild:!0,children:j.jsxs("button",{disabled:d,className:o("w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50 transition-all text-left flex items-center justify-between",!p.end_date&&"text-gray-500"),children:[p.end_date?ne(new Date(p.end_date),"MMM d, yyyy"):"Pick a date",j.jsx(we,{size:16,className:"opacity-50"})]})}),j.jsx(ce,{className:"w-auto p-0 bg-gray-900 border-white/10",align:"start",children:j.jsx(oe,{mode:"single",selected:p.end_date?new Date(p.end_date):void 0,onSelect:e=>e&&h({...p,end_date:ne(e,"yyyy-MM-dd")}),initialFocus:!0,className:"pointer-events-auto"})})]})]})]}),j.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-xl p-4",children:j.jsx("p",{className:"text-sm text-blue-300",children:n?"ℹ️ All trip members can see these changes immediately":"ℹ️ Changes save instantly in demo mode and sync when you log in"})})]}),j.jsxs("div",{className:"flex gap-3 mt-6",children:[j.jsx("button",{onClick:t,className:"flex-1 px-4 py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl text-white font-medium transition-all",disabled:d,children:"Cancel"}),j.jsx("button",{onClick:async()=>{if(p.name.trim())if(p.destination.trim())if(new Date(p.end_date)<new Date(p.start_date))l({title:"Validation Error",description:"End date must be after start date",variant:"destructive"});else{c(!0);try{const e={name:p.name,destination:p.destination,start_date:p.start_date,end_date:p.end_date};if(!n)return localStorage.setItem(`trip_${a.id}_updates`,JSON.stringify(e)),i&&i(e),l({title:"Changes saved",description:"Trip details updated successfully (demo mode)"}),void t();if(!(await U.updateTrip(a.id.toString(),e)))throw new Error("Failed to update trip");i&&i(e),l({title:"Changes saved",description:"Trip details updated successfully"}),t()}catch(e){l({title:"Update failed",description:"Could not update trip details. Please try again.",variant:"destructive"})}finally{c(!1)}}else l({title:"Validation Error",description:"Location is required",variant:"destructive"});else l({title:"Validation Error",description:"Trip name is required",variant:"destructive"})},disabled:d,className:"flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-700 rounded-xl text-white font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:d?j.jsxs(j.Fragment,{children:[j.jsx(je,{size:18,className:"animate-spin"}),"Saving..."]}):"Save Changes"})]})]})}):null},Pt=({trip:e,onManageUsers:t,onDescriptionUpdate:a,onTripUpdate:s,onShowExport:i,category:n,tags:l=[],onCategoryChange:m})=>{r();const[u,p]=N.useState(!1),[h,g]=N.useState(!1),[x,f]=N.useState(!1),{variant:b,accentColors:y}=d(),{coverPhoto:v,updateCoverPhoto:w}=(e=>{const[t,a]=N.useState(e.coverPhoto);return{coverPhoto:t,updateCoverPhoto:e=>{a(e)},removeCoverPhoto:()=>{a(void 0)}}})(e),_="pro"===b,k="pro"===e.trip_type||"event"===e.trip_type,S="event"===e.trip_type,C=Boolean(v);return j.jsxs(j.Fragment,{children:[v&&!k?j.jsx("div",{className:"relative mb-8 rounded-3xl overflow-hidden",children:j.jsxs("div",{className:"h-64 bg-cover bg-center",style:{backgroundImage:`url(${v})`},children:[j.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"}),j.jsxs("div",{className:"absolute bottom-6 left-8 right-8",children:[j.jsx("div",{className:"flex items-center gap-3 mb-2",children:j.jsx("h1",{className:"text-4xl font-bold text-white",children:e.title})}),j.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[j.jsxs("div",{className:"flex items-center gap-2 text-white/90",children:[j.jsx(ve,{size:18}),j.jsx("span",{children:e.location})]}),j.jsxs("div",{className:"flex items-center gap-2 text-white/90",children:[j.jsx(we,{size:18}),j.jsx("span",{children:e.dateRange})]})]})]}),j.jsx("div",{className:"absolute bottom-6 right-6 z-10",children:j.jsx("button",{onClick:()=>f(!0),className:"p-3 bg-black/30 hover:bg-black/50 backdrop-blur-sm border border-white/20 rounded-xl transition-all text-white/70 hover:text-white shadow-lg",title:"Edit trip details",children:j.jsx($,{size:20})})})]})}):null,j.jsxs("div",{className:o("relative rounded-3xl p-6 mb-4 overflow-hidden border border-white/20",C&&k?"shadow-2xl":"bg-white/10 backdrop-blur-md"),children:[C&&k&&j.jsxs(j.Fragment,{children:[j.jsx("div",{className:"absolute inset-0 bg-cover bg-center transition-all duration-500",style:{backgroundImage:`url(${v})`,filter:S?"brightness(0.25)":"brightness(0.35)"}}),j.jsx("div",{className:o("absolute inset-0",S?"bg-gradient-to-t from-black/90 via-black/50 to-transparent":"bg-gradient-to-t from-black/70 via-black/40 to-transparent")})]}),j.jsxs("div",{className:o("flex flex-col lg:flex-row lg:items-start lg:justify-between gap-6",C&&k&&"relative z-10"),children:[j.jsxs("div",{className:"flex-1 space-y-4",children:[!v&&j.jsx("div",{className:"flex items-center gap-3 mb-4",children:j.jsx("h1",{className:"text-4xl font-bold text-white",children:e.title})}),_&&n&&j.jsx("div",{className:"mb-4",children:j.jsx(kt,{category:n,tags:l})}),!v&&j.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4 mb-6",children:[j.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[j.jsx(ve,{size:18,className:`text-${y.primary}`}),j.jsx("span",{children:e.location})]}),j.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[j.jsx(we,{size:18,className:`text-${y.primary}`}),j.jsx("span",{children:e.dateRange})]})]}),j.jsx(wt,{tripId:e.id.toString(),description:e.description,onUpdate:a||(()=>{}),className:"text-gray-300 text-lg leading-relaxed"})]}),j.jsxs("div",{className:o("rounded-2xl p-4 min-w-[280px] lg:w-[40%] border border-white/10",C&&k?"bg-black/50 backdrop-blur-md":"bg-white/5 backdrop-blur-sm"),children:[j.jsxs("div",{className:"flex items-center justify-between mb-2",children:[j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx(Ne,{size:20,className:`text-${y.primary}`}),j.jsx("h3",{className:"text-white font-semibold text-sm",children:S?"Event Team":"Trip Collaborators"})]}),j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx("span",{className:"text-gray-400 text-sm",children:e.participants.length}),t&&j.jsx("button",{onClick:t,className:`text-gray-400 hover:text-${y.primary} transition-colors p-1 rounded-lg hover:bg-white/10`,title:"Manage users",children:j.jsx(c,{size:16})})]})]}),_&&n&&m&&j.jsxs("div",{className:"mb-4",children:[j.jsx("label",{className:"block text-gray-400 text-sm mb-2",children:"Trip Category"}),j.jsx(_t,{selectedCategory:n,onCategoryChange:m})]}),j.jsx(Dt,{participants:e.participants,countLabel:`${e.participants.length} collaborators`,onShowAll:()=>g(!0),maxRows:1,minColWidth:140,tripType:e.trip_type||"consumer"}),j.jsxs("div",{className:"mt-3 flex gap-3",children:[j.jsxs("button",{onClick:()=>p(!0),className:`flex-1 flex items-center justify-center gap-2 bg-gradient-to-r ${y.gradient} hover:from-${y.primary}/80 hover:to-${y.secondary}/80 text-white font-medium py-2 rounded-xl transition-all duration-200 hover:scale-105`,title:"Invite people to this trip",children:[j.jsx(_e,{size:16}),"Invite to Trip"]}),j.jsxs("button",{onClick:()=>null==i?void 0:i(),disabled:!1,className:o("flex-1 flex items-center justify-center gap-2 font-medium py-2 rounded-xl transition-all duration-200",`bg-gradient-to-r ${y.gradient} hover:from-${y.primary}/80 hover:to-${y.secondary}/80 text-white hover:scale-105`),title:"Export Trip to PDF","aria-label":"Export Trip to PDF",children:[j.jsx(ut,{size:16}),"Export Trip to PDF"]})]})]})]}),!(v&&!k)&&j.jsx("div",{className:"absolute bottom-4 right-4 z-20",children:j.jsx("button",{onClick:()=>f(!0),className:o("p-3 border border-white/20 rounded-xl transition-all shadow-lg backdrop-blur-sm",C&&k?"bg-black/40 hover:bg-black/60 text-white/80 hover:text-white":"bg-white/10 hover:bg-white/20 text-gray-400 hover:text-white"),title:"Edit trip details",children:j.jsx($,{size:20})})})]}),j.jsx(M,{isOpen:u,onClose:()=>p(!1),tripName:e.title,tripId:e.id.toString()}),j.jsx(Mt,{open:h,onOpenChange:g,participants:e.participants,tripType:e.trip_type||"consumer"}),j.jsx(It,{isOpen:x,onClose:()=>f(!1),trip:e,onUpdate:t=>{s&&(t.start_date&&t.end_date?(((e,t)=>{try{const a=new Date(e),s=new Date(t);return a.getMonth()===s.getMonth()&&a.getFullYear()===s.getFullYear()||a.getFullYear()===s.getFullYear()?`${ne(a,"MMM d")} - ${ne(s,"MMM d, yyyy")}`:`${ne(a,"MMM d, yyyy")} - ${ne(s,"MMM d, yyyy")}`}catch(a){return"Invalid date range"}})(t.start_date,t.end_date),s({...t,name:t.name||e.title,destination:t.destination||e.location})):s(t))}})]})},zt=()=>{const e=k(),[t,a]=N.useState("all"),[s,i]=N.useState(""),r=[].filter(e=>"unread"===t?!e.isRead:"mentions"!==t||e.mentions&&e.mentions.length>0),n=e=>{const t=new Date(e),a=new Date,s=Math.floor((a.getTime()-t.getTime())/6e4);return s<60?`${s}m ago`:s<1440?`${Math.floor(s/60)}h ago`:t.toLocaleDateString()};return j.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-6",children:[j.jsx("div",{className:"flex items-center justify-between mb-6",children:j.jsxs("div",{className:"flex items-center gap-3",children:[j.jsx(F,{size:24,className:"text-glass-orange"}),j.jsxs("div",{children:[j.jsx("h2",{className:"text-xl font-semibold text-white",children:"Message Inbox"}),j.jsxs("p",{className:"text-slate-400 text-sm",children:[0," unread messages"]})]})]})}),j.jsxs("div",{className:"relative mb-6",children:[j.jsx(m,{size:20,className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"}),j.jsx("input",{type:"text",placeholder:"Search messages, people, or trips...",value:s,onChange:e=>i(e.target.value),className:"w-full bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl pl-12 pr-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-glass-orange"})]}),j.jsx("div",{className:"flex gap-2 mb-6",children:["all","unread","mentions"].map(e=>j.jsx("button",{onClick:()=>a(e),className:"px-4 py-2 rounded-xl text-sm font-medium transition-colors "+(t===e?"bg-glass-orange text-white":"bg-white/10 text-gray-300 hover:bg-white/20"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),j.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:r.map(t=>{const a=(e=>e.tripName?e.tripName:e.tourName?e.tourName:e.tripId?"Trip":e.tourId?"Tour":null)(t),s=(e=>e.tripId&&e.tourId?"bg-purple-500/20 text-purple-400 border-purple-500/30":e.tripId?"bg-blue-500/20 text-blue-400 border-blue-500/30":e.tourId?"bg-glass-orange/20 text-glass-orange border-glass-orange/30":"bg-gray-500/20 text-gray-400 border-gray-500/30")(t);return j.jsx("div",{onClick:()=>(t=>{t.tripId?e(`/trip/${t.tripId}`):t.tourId&&e(`/tour/pro-${t.tourId}`)})(t),className:"p-4 rounded-xl cursor-pointer transition-all hover:bg-white/10 "+(t.isRead?"bg-white/2":"bg-white/5 border-l-4 border-glass-orange"),children:j.jsxs("div",{className:"flex items-start gap-3",children:[j.jsx("img",{src:t.senderAvatar||"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face",alt:t.senderName,className:"w-10 h-10 rounded-full"}),j.jsxs("div",{className:"flex-1 min-w-0",children:[j.jsxs("div",{className:"flex items-center justify-between mb-1",children:[j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx("span",{className:"text-white font-medium",children:t.senderName}),a&&j.jsx("span",{className:`text-xs px-2 py-1 rounded-full border backdrop-blur-sm truncate max-w-32 ${s}`,children:a})]}),j.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-xs",children:[j.jsx(ke,{size:12}),n(t.timestamp)]})]}),j.jsx("p",{className:"text-gray-300 text-sm truncate",children:t.content}),t.mentions&&t.mentions.includes("everyone")&&j.jsx("div",{className:"mt-2",children:j.jsxs("span",{className:"text-xs bg-red-500/20 text-red-400 px-2 py-1 rounded flex items-center gap-1 w-fit",children:[j.jsx(Se,{size:10}),"@everyone"]})})]}),!t.isRead&&j.jsx("div",{className:"w-2 h-2 bg-glass-orange rounded-full"})]})},t.id)})}),0===r.length&&j.jsxs("div",{className:"text-center py-8",children:[j.jsx(F,{size:48,className:"text-slate-600 mx-auto mb-4"}),j.jsx("h3",{className:"text-lg font-medium text-slate-400 mb-2",children:"No messages found"}),j.jsx("p",{className:"text-slate-500 text-sm",children:s?"Try a different search term":"Your messages will appear here"})]})]})},Et={Ray:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=40&h=40&fit=crop&crop=face",Maya:"https://images.unsplash.com/photo-1494790108755-2616b612b47c?w=40&h=40&fit=crop&crop=face",Sam:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face",Emma:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=40&h=40&fit=crop&crop=face",Jake:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=40&h=40&fit=crop&crop=face",Sarah:"https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=40&h=40&fit=crop&crop=face",Alex:"https://images.unsplash.com/photo-1507591064344-4c6ce005b128?w=40&h=40&fit=crop&crop=face",Lisa:"https://images.unsplash.com/photo-1489424731084-a5d8b219a5bb?w=40&h=40&fit=crop&crop=face",Mike:"https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?w=40&h=40&fit=crop&crop=face",Anna:"https://images.unsplash.com/photo-1491349174775-aaafddd81942?w=40&h=40&fit=crop&crop=face",David:"https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=40&h=40&fit=crop&crop=face",Sophie:"https://images.unsplash.com/photo-1517841905240-472988babdf9?w=40&h=40&fit=crop&crop=face",Chris:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=40&h=40&fit=crop&crop=face",Taylor:"https://images.unsplash.com/photo-1498551172505-8ee7ad69f235?w=40&h=40&fit=crop&crop=face",Jordan:"https://images.unsplash.com/photo-1507591064344-4c6ce005b128?w=40&h=40&fit=crop&crop=face",Casey:"https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=40&h=40&fit=crop&crop=face"},At=["https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face","https://images.unsplash.com/photo-1494790108755-2616b612b47c?w=40&h=40&fit=crop&crop=face","https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=40&h=40&fit=crop&crop=face","https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=40&h=40&fit=crop&crop=face","https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=40&h=40&fit=crop&crop=face","https://images.unsplash.com/photo-1507591064344-4c6ce005b128?w=40&h=40&fit=crop&crop=face"],Ot=e=>{const t=e.trim();if(Et[t])return Et[t];const a=t.split("").reduce((e,t)=>(e=(e<<5)-e+t.charCodeAt(0))&e,0);return At[Math.abs(a)%At.length]},Lt=({tripId:e,demoMode:t=!1,isEvent:a=!1}={})=>{const[s,i]=N.useState(""),[o,l]=N.useState(null),[d,c]=N.useState("all"),{user:m}=r(),{parseMessage:u}={parseMessage:N.useCallback(async(e,t,a)=>{try{const{data:s,error:i}=await n.functions.invoke("message-parser",{body:{messageId:e,content:t,tripId:a}});return!i&&((null==s?void 0:s.success)||!1)}catch(s){return!1}},[])},p=N.useCallback((e,t={})=>{const a=`msg_${Date.now()}`,{isBroadcast:s=!1,isPayment:i=!1,paymentData:r}=t;if(i&&r){const e=(r.amount/r.splitCount).toFixed(2),t="Venmo: @yourvenmo";return{id:a,text:`${r.description} - ${r.currency} ${r.amount.toFixed(2)} (split ${r.splitCount} ways) • Pay me $${e} via ${t}`,sender:{id:(null==m?void 0:m.id)||"user1",name:"You",avatar:(null==m?void 0:m.avatar)||Ot("You")},createdAt:(new Date).toISOString(),isBroadcast:!1,isPayment:!0,reactions:{},tags:["payment"],replyTo:o?{id:o.id,text:o.text,sender:o.senderName}:void 0}}return{id:a,text:e,sender:{id:(null==m?void 0:m.id)||"user1",name:"You",avatar:(null==m?void 0:m.avatar)||Ot("You")},createdAt:(new Date).toISOString(),isBroadcast:s,reactions:{},replyTo:o?{id:o.id,text:o.text,sender:o.senderName}:void 0}},[o]),h=N.useCallback(async(r={})=>{const{isPayment:n=!1,paymentData:o}=r;if(a&&n)return null;if(!n&&""===s.trim())return null;const d=p(s,r);return t||!e||n||await u(d.id,s,e),i(""),l(null),d},[s,p,t,e,u]),g=N.useCallback((e,t,a)=>{l({id:e,text:t,senderName:a})},[]),x=N.useCallback(()=>{l(null)},[]),f=N.useCallback(e=>"all"===d?e:"broadcast"===d?e.filter(e=>e.isBroadcast):"payments"===d?e.filter(e=>{var t;return e.text.includes("💳 Payment")||(null==(t=e.tags)?void 0:t.includes("payment"))}):e,[d]);return{inputMessage:s,replyingTo:o,messageFilter:d,setInputMessage:i,setMessageFilter:c,sendMessage:h,setReply:g,clearReply:x,filterMessages:f}},Ut=()=>{const[e,t]=N.useState(()=>window.innerHeight>window.innerWidth?"portrait":"landscape");return N.useEffect(()=>{const e=()=>{const e=window.innerHeight>window.innerWidth?"portrait":"landscape";t(e)};return window.addEventListener("resize",e),window.addEventListener("orientationchange",e),e(),()=>{window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e)}},[]),e},Rt=(e={})=>{const t=u(),a=N.useRef(),s=N.useRef(!1);return N.useEffect(()=>{var i;if(!t)return;a.current=(null==(i=window.visualViewport)?void 0:i.height)||window.innerHeight;const r=()=>{var t,i;if(!window.visualViewport)return;const r=window.visualViewport.height,n=(a.current||0)-r,o=n>150;o!==s.current&&(s.current=o,o?(document.body.classList.add("keyboard-visible"),null==(t=e.onShow)||t.call(e),e.adjustViewport&&document.documentElement.style.setProperty("--keyboard-height",`${n}px`)):(document.body.classList.remove("keyboard-visible"),null==(i=e.onHide)||i.call(e),e.adjustViewport&&document.documentElement.style.removeProperty("--keyboard-height")))},n=t=>{const a=t.target;if(a&&("INPUT"===a.tagName||"TEXTAREA"===a.tagName)){if(e.preventZoom&&/iPad|iPhone|iPod/.test(navigator.userAgent)){const e=a.style.fontSize;a.style.fontSize="16px";const t=()=>{a.style.fontSize=e,a.removeEventListener("blur",t)};a.addEventListener("blur",t)}setTimeout(()=>{a.scrollIntoView({behavior:"smooth",block:"center"})},300)}};return window.visualViewport&&window.visualViewport.addEventListener("resize",r),document.addEventListener("focusin",n),()=>{window.visualViewport&&window.visualViewport.removeEventListener("resize",r),document.removeEventListener("focusin",n),document.body.classList.remove("keyboard-visible"),document.documentElement.style.removeProperty("--keyboard-height")}},[t,e.preventZoom,e.adjustViewport,e.onShow,e.onHide]),{isKeyboardVisible:s.current}},$t=({onRefresh:e,threshold:t=80,maxPullDistance:a=120})=>{const[s,i]=N.useState(!1),[r,n]=N.useState(!1),[o,l]=N.useState(0),d=N.useRef(0),c=N.useRef(0);return N.useEffect(()=>{const m=e=>{0===(window.scrollY||document.documentElement.scrollTop)&&(d.current=e.touches[0].clientY,i(!0))},u=e=>{if(!s||r)return;c.current=e.touches[0].clientY;const i=c.current-d.current;if(i>0){e.preventDefault();const s=Math.min(.5*i,a);l(s),s>=t&&o<t&&p.medium()}},h=async()=>{if(s){if(o>=t){n(!0),await p.success();try{await e()}finally{n(!1)}}i(!1),l(0)}};return document.addEventListener("touchstart",m,{passive:!0}),document.addEventListener("touchmove",u,{passive:!1}),document.addEventListener("touchend",h),()=>{document.removeEventListener("touchstart",m),document.removeEventListener("touchmove",u),document.removeEventListener("touchend",h)}},[s,r,o,t,a,e]),{isPulling:s,isRefreshing:r,pullDistance:o,shouldTrigger:o>=t}};
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=["venmo","cashapp","zelle","paypal","applecash"],qt=({onSubmit:e,tripMembers:t,isVisible:a})=>{const{amount:s,currency:i,description:r,selectedParticipants:n,selectedPaymentMethods:o,perPersonAmount:l,allParticipantsSelected:d,allPaymentMethodsSelected:c,setAmount:m,setCurrency:u,setDescription:p,toggleParticipant:h,togglePaymentMethod:g,selectAllParticipants:x,selectAllPaymentMethods:f,getPaymentData:b,resetForm:y}=((e=[])=>{const[t,a]=N.useState(0),[s,i]=N.useState("USD"),[r,n]=N.useState(""),[o,l]=N.useState([]),[d,c]=N.useState([]),[m,u]=N.useState(0);N.useEffect(()=>{u(o.length)},[o]);const p=N.useCallback(e=>{l(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},[]),h=N.useCallback(e=>{c(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},[]),g=N.useCallback(()=>{const t=o.length===e.length;l(t?[]:e.map(e=>e.id))},[o.length,e]),x=N.useCallback(()=>{const e=d.length===Ft.length;c(e?[]:[...Ft])},[d.length]),f=N.useCallback(()=>0===m?0:t/m,[t,m]),b=N.useCallback(()=>t<=0?{isValid:!1,error:"Amount must be greater than 0"}:r.trim()?0===o.length?{isValid:!1,error:"At least one participant must be selected"}:0===d.length?{isValid:!1,error:"At least one payment method must be selected"}:{isValid:!0}:{isValid:!1,error:"Description is required"},[t,r,o,d]),y=N.useCallback(()=>b().isValid?{amount:t,currency:s,description:r.trim(),splitCount:m,splitParticipants:o,paymentMethods:d}:null,[t,s,r,m,o,d,b]),v=N.useCallback(()=>{a(0),i("USD"),n(""),l([]),c([]),u(0)},[]);return{amount:t,currency:s,description:r,selectedParticipants:o,selectedPaymentMethods:d,splitCount:m,perPersonAmount:f(),isValid:b().isValid,validationError:b().error,allParticipantsSelected:o.length===e.length,allPaymentMethodsSelected:d.length===Ft.length,setAmount:a,setCurrency:i,setDescription:n,toggleParticipant:p,togglePaymentMethod:h,selectAllParticipants:g,selectAllPaymentMethods:x,getPaymentData:y,validatePayment:b,resetForm:v}})(t),v=l,{isDemoMode:w}=De();return a?w||0!==t.length?j.jsx($e,{className:"bg-payment-background-light border-payment-border dark:bg-payment-background dark:border-payment-border",children:j.jsxs(Fe,{className:"p-4",children:[j.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[j.jsx(Be,{size:18,className:"text-payment-primary"}),j.jsx("span",{className:"font-medium text-payment-primary-foreground dark:text-payment-primary-foreground",children:"Payment Details"})]}),j.jsxs("form",{onSubmit:t=>{t.preventDefault();const a=b();a&&(e(a),y())},className:"space-y-4",children:[j.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[j.jsxs("div",{className:"col-span-2",children:[j.jsx(ie,{htmlFor:"amount",children:"Amount"}),j.jsx(ze,{id:"amount",type:"number",step:"0.01",value:s||"",onChange:e=>m(Number(e.target.value)),placeholder:"0.00",className:"bg-white dark:bg-white !text-black placeholder:!text-gray-500",required:!0})]}),j.jsxs("div",{children:[j.jsx(ie,{htmlFor:"currency",children:"Currency"}),j.jsxs(K,{value:i,onValueChange:u,children:[j.jsx(J,{className:"bg-white dark:bg-white !text-black",children:j.jsx(Q,{})}),j.jsxs(Z,{children:[j.jsx(X,{value:"USD",children:"USD ($)"}),j.jsx(X,{value:"EUR",children:"EUR (€)"}),j.jsx(X,{value:"GBP",children:"GBP (£)"}),j.jsx(X,{value:"CAD",children:"CAD ($)"})]})]})]})]}),j.jsxs("div",{children:[j.jsx(ie,{htmlFor:"description",children:"What's this for?"}),j.jsx(ze,{id:"description",value:r,onChange:e=>p(e.target.value),placeholder:"Dinner, taxi, tickets, etc.",className:"bg-white dark:bg-white !text-black placeholder:!text-gray-500",required:!0})]}),j.jsxs("div",{children:[j.jsxs("div",{className:"flex items-center justify-between mb-2",children:[j.jsxs(ie,{className:"flex items-center gap-2",children:[j.jsx(Ne,{size:16}),"Split between ",n.length," people",v>0&&j.jsxs("span",{className:"text-payment-primary font-medium",children:["($",v.toFixed(2)," each)"]})]}),j.jsx(Ee,{type:"button",variant:"outline",size:"sm",onClick:x,className:"text-xs h-7",children:d?"Deselect All":"Select All"})]}),j.jsx("div",{className:"mt-2 max-h-32 overflow-y-auto space-y-2 p-2 bg-white dark:bg-white rounded border",children:t.map(e=>j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx(Ae,{id:`participant-${e.id}`,checked:n.includes(e.id),onCheckedChange:()=>h(e.id)}),j.jsxs("label",{htmlFor:`participant-${e.id}`,className:"text-sm flex items-center gap-2 cursor-pointer !text-black",children:[e.avatar&&j.jsx("img",{src:e.avatar,alt:e.name,className:"w-6 h-6 rounded-full"}),e.name]})]},e.id))})]}),j.jsxs("div",{children:[j.jsxs("div",{className:"flex items-center justify-between mb-2",children:[j.jsxs(ie,{className:"flex items-center gap-2",children:[j.jsx(T,{size:16}),"Preferred payment methods"]}),j.jsx(Ee,{type:"button",variant:"outline",size:"sm",onClick:f,className:"text-xs h-7",children:c?"Deselect All":"Select All"})]}),j.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[{id:"venmo",label:"Venmo"},{id:"cashapp",label:"Cash App"},{id:"zelle",label:"Zelle"},{id:"paypal",label:"PayPal"},{id:"applecash",label:"Apple Cash"}].map(e=>j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx(Ae,{id:`payment-${e.id}`,checked:o.includes(e.id),onCheckedChange:()=>g(e.id)}),j.jsx("label",{htmlFor:`payment-${e.id}`,className:"text-sm cursor-pointer flex items-center gap-1 !text-white",children:e.label})]},e.id))})]}),j.jsx(Ee,{type:"submit",className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground",disabled:!s||!r||0===n.length,children:"Add Payment Request"})]})]})}):j.jsx($e,{className:"bg-payment-background-light border-payment-border dark:bg-payment-background dark:border-payment-border",children:j.jsx(Fe,{className:"p-6",children:j.jsxs("div",{className:"text-center py-8",children:[j.jsx(Ne,{className:"w-12 h-12 text-gray-500 mx-auto mb-3"}),j.jsx("h4",{className:"text-lg font-medium text-gray-400 mb-2",children:"No trip collaborators yet"}),j.jsx("p",{className:"text-gray-500 text-sm",children:"Add collaborators to this trip before creating payment splits"})]})})}):null};async function Vt(e,t,a){const s=`${t}/${a}/${crypto.randomUUID()}.${e.name.split(".").pop()??"bin"}`,{data:i,error:r}=await n.storage.from("advertiser-assets").upload(s,e,{contentType:e.type||e.mime||"application/octet-stream",upsert:!1});if(r)throw r;const{data:o}=n.storage.from("advertiser-assets").getPublicUrl(s);return{key:s,publicUrl:o.publicUrl}}async function Bt(e){const{data:t,error:a}=await n.from("trip_chat_messages").insert({...e,attachments:e.attachments}).select().single();if(a)throw a;return t}function Ht(e){const[t,a]=N.useState(!1),[s,o]=N.useState(null),{user:l}=r(),d=(null==l?void 0:l.id)||"";async function c(t,s){var r,c;a(!0),o(null);try{const a="image"===t?"images":"video"===t?"videos":"files",{publicUrl:o}=await Vt(s,e,a);if("image"===t||"video"===t){const a=await async function(e){const{data:t,error:a}=await n.from("trip_media_index").insert({trip_id:e.tripId,media_type:e.mediaType,media_url:e.url,filename:e.filename??null,file_size:e.fileSize??null,mime_type:e.mimeType??null,message_id:e.messageId??null,metadata:e.uploadedBy?{uploaded_by:e.uploadedBy}:null}).select().single();if(a)throw a;return t}({tripId:e,mediaType:t,url:o,filename:s.name,fileSize:s.size,mimeType:s.type,uploadedBy:d});return await Bt({trip_id:e,user_id:d,author_name:(null==(r=null==l?void 0:l.email)?void 0:r.split("@")[0])||"Unknown User",content:"",media_type:t,media_url:o,attachments:[{type:t,ref_id:a.id,url:o}]}),i.success(("image"===t?"Photo":"Video")+" uploaded successfully"),{type:t,ref:a}}{const t=await async function(e){const{data:t,error:a}=await n.from("trip_files").insert({trip_id:e.tripId,name:e.name,file_type:e.fileType,uploaded_by:e.uploadedBy}).select().single();if(a)throw a;return t}({tripId:e,name:s.name,fileType:s.type||"application/octet-stream",uploadedBy:d});return await Bt({trip_id:e,user_id:d,author_name:(null==(c=null==l?void 0:l.email)?void 0:c.split("@")[0])||"Unknown User",content:s.name,attachments:[{type:"file",ref_id:t.id,url:o}]}),i.success("File uploaded successfully"),{type:"file",ref:t}}}catch(m){const e=m.message??"Upload failed";throw o(e),i.error(e),m}finally{a(!1)}}return{shareFile:c,shareLink:async function(t){var r;a(!0),o(null);try{try{new URL(t)}catch{throw new Error("Invalid URL format")}const a=await async function(e){try{const t=new URL(e);return{domain:t.hostname,title:t.hostname,image:void 0,description:void 0}}catch(s){return{domain:"unknown"}}}(t),o=await async function(e){const{data:t,error:a}=await n.from("trip_link_index").insert({trip_id:e.tripId,url:e.url,og_title:e.ogTitle??null,og_image_url:e.ogImage??null,og_description:e.ogDescription??null,domain:e.domain??new URL(e.url).hostname,message_id:e.messageId??null}).select().single();if(a)throw a;return t}({tripId:e,url:t,ogTitle:a.title,ogImage:a.image,ogDescription:a.description,domain:a.domain,submittedBy:d});return await Bt({trip_id:e,user_id:d,author_name:(null==(r=null==l?void 0:l.email)?void 0:r.split("@")[0])||"Unknown User",content:t,link_preview:{url:t,title:a.title,image:a.image,description:a.description,domain:a.domain},attachments:[{type:"link",ref_id:o.id,url:t}]}),i.success("Link shared successfully"),{type:"link",ref:o}}catch(c){const e=c.message??"Link share failed";throw o(e),i.error(e),c}finally{a(!1)}},shareMultipleFiles:async function(e,t){const a=[];for(const i of Array.from(e))try{const e="document"===t?"file":t,s=await c(e,i);a.push(s)}catch(s){}return a},isUploading:t,error:s}}const Wt=({inputMessage:e,onInputChange:t,onSendMessage:a,onKeyPress:s,onFileUpload:i,isTyping:r,tripMembers:n=[],hidePayments:o=!1,isInChannelMode:l=!1,isPro:d=!1,tripId:c})=>{const[m,u]=N.useState(!1),[p,h]=N.useState(!1);N.useState(!1);const g=N.useRef(null),{shareFile:x,shareLink:f,shareMultipleFiles:b,isUploading:y}=Ht(c),v=()=>{p||a(m,!1)},w=async e=>{if(!g.current)return;g.current.accept={image:"image/*",video:"video/*",document:".pdf,.doc,.docx,.txt,.xlsx,.pptx"}[e],g.current.onchange=async t=>{const a=t.target.files;a&&a.length>0&&(await b(a,e),i&&i(a,e))},g.current.click()};return j.jsxs("div",{className:"space-y-4",children:[!l&&j.jsxs("div",{className:"flex justify-center gap-4",children:[j.jsxs("button",{onClick:()=>{u(!1),h(!1)},className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all "+(m||p?"border border-gray-600 text-gray-400 hover:text-white hover:border-gray-500":"bg-blue-600 text-white"),children:[j.jsx(F,{size:16}),"Group Chat"]}),j.jsxs("button",{onClick:()=>{u(!0),h(!1)},className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all "+(m?"bg-gradient-to-r from-orange-600 to-red-600 text-white":"border border-orange-600 text-orange-400 hover:text-white hover:bg-orange-600/10"),children:[j.jsx(I,{size:16}),"Broadcast"]}),!o&&j.jsxs("button",{onClick:()=>{h(!0),u(!1)},className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all "+(p?"bg-gradient-to-r from-green-600 to-emerald-600 text-white":"border border-green-600 text-green-400 hover:text-white hover:bg-green-600/10"),children:[j.jsx(q,{size:16}),"Payments"]}),j.jsxs(Me,{children:[j.jsx(Te,{asChild:!0,children:j.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium border border-gray-600 text-gray-400 hover:text-white hover:border-gray-500 transition-all","aria-label":"Share media, files, or links",children:[j.jsx(Ge,{size:16}),"Share"]})}),j.jsxs(Ie,{align:"end",className:"w-48 z-50 bg-gray-800 border-gray-700",children:[j.jsxs(Pe,{onClick:()=>w("image"),children:[j.jsx(fe,{className:"w-4 h-4 mr-2"}),"Photo/Image"]}),j.jsxs(Pe,{onClick:()=>w("video"),children:[j.jsx(yt,{className:"w-4 h-4 mr-2"}),"Video"]}),j.jsxs(Pe,{onClick:()=>w("document"),children:[j.jsx(Oe,{className:"w-4 h-4 mr-2"}),"Document"]}),j.jsxs(Pe,{onClick:async()=>{const e=prompt("Paste the link you want to share:");if(e&&e.trim())try{await f(e.trim())}catch(t){}},children:[j.jsx(Le,{className:"w-4 h-4 mr-2"}),"Link"]})]})]})]}),p&&j.jsx(qt,{onSubmit:e=>{a(!1,!0,e),h(!1)},tripMembers:n,isVisible:p}),!p&&j.jsxs("div",{className:"flex gap-3 items-end",onDrop:async e=>{e.preventDefault();const t=e.dataTransfer.files;if(t&&t.length>0){const e=t[0],a=e.type.startsWith("image/"),s=e.type.startsWith("video/"),r=a?"image":s?"video":"document";await b(t,r),i&&i(t,r)}},onDragOver:e=>{e.preventDefault()},children:[j.jsx("textarea",{value:e,onChange:e=>t(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey?s(e):(e.preventDefault(),v())},placeholder:m?"Send an announcement to all trip members...":p?"Payment mode active - use the form above to create a payment...":"Type a message or drag & drop files...",rows:2,className:"flex-1 border rounded-xl px-4 py-3 focus:outline-none resize-none transition-all "+(m?"bg-gradient-to-r from-orange-900/20 to-red-900/20 border-orange-500/50 focus:border-orange-400 text-black placeholder-black":p?"bg-gradient-to-r from-green-900/20 to-emerald-900/20 border-green-500/50 focus:border-green-400 text-white placeholder-gray-500":"bg-gray-800 border-gray-700 focus:border-blue-500 text-white placeholder-gray-500")}),j.jsx("button",{onClick:v,disabled:!e.trim()&&!y||r,className:"text-white p-3 rounded-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed "+(m?"bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700":p?"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700":"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700"),children:j.jsx(Ue,{size:16})}),j.jsx("input",{ref:g,type:"file",className:"hidden",multiple:!0})]})]})},Gt=({activeFilter:e,onFilterChange:t,hidePayments:a=!1})=>P()?j.jsxs("div",{className:"flex justify-center gap-2",children:[j.jsxs("button",{onClick:()=>t("all"),className:"flex items-center gap-1.5 px-3 py-2 rounded-full text-sm font-medium transition-all "+("all"===e?"bg-blue-600 text-white":"border border-gray-600 text-gray-400 active:text-white active:border-gray-500"),children:[j.jsx(F,{size:14}),"All Messages"]}),j.jsxs("button",{onClick:()=>t("broadcast"),className:"flex items-center gap-1.5 px-3 py-2 rounded-full text-sm font-medium transition-all "+("broadcast"===e?"bg-gradient-to-r from-orange-600 to-red-600 text-white":"border border-orange-600 text-orange-400 active:text-white active:bg-orange-600/10"),children:[j.jsx(I,{size:14}),"Broadcasts"]}),!a&&j.jsxs("button",{onClick:()=>t("payments"),className:"flex items-center gap-1.5 px-3 py-2 rounded-full text-sm font-medium transition-all "+("payments"===e?"bg-gradient-to-r from-green-600 to-emerald-600 text-white":"border border-green-600 text-green-400 active:text-white active:bg-green-600/10"),children:[j.jsx(q,{size:14}),"Payments"]})]}):j.jsxs("div",{className:"flex justify-center gap-4",children:[j.jsxs("button",{onClick:()=>t("all"),className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all "+("all"===e?"bg-blue-600 text-white":"border border-gray-600 text-gray-400 hover:text-white hover:border-gray-500"),children:[j.jsx(F,{size:16}),"All Messages"]}),j.jsxs("button",{onClick:()=>t("broadcast"),className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all "+("broadcast"===e?"bg-gradient-to-r from-orange-600 to-red-600 text-white":"border border-orange-600 text-orange-400 hover:text-white hover:bg-orange-600/10"),children:[j.jsx(I,{size:16}),"Broadcasts"]}),!a&&j.jsxs("button",{onClick:()=>t("payments"),className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all "+("payments"===e?"bg-gradient-to-r from-green-600 to-emerald-600 text-white":"border border-green-600 text-green-400 hover:text-white hover:bg-green-600/10"),children:[j.jsx(q,{size:16}),"Payments"]})]}),Yt=({replyTo:e,onRemoveReply:t,onCancel:a})=>e?j.jsx("div",{className:"bg-background/50 border-l-2 border-primary p-2 mb-2 rounded-r-lg",children:j.jsxs("div",{className:"flex items-center justify-between",children:[j.jsxs("div",{className:"flex-1",children:[j.jsxs("p",{className:"text-xs text-muted-foreground mb-1",children:["Replying to ",e.senderName]}),j.jsx("p",{className:"text-sm text-foreground/80 truncate",children:e.text})]}),(t||a)&&j.jsx("button",{onClick:t||a,className:"text-muted-foreground hover:text-foreground ml-2 transition-colors",children:"×"})]})}):null,Kt=({isLoading:e,hasMore:t,localHasMore:a=!1,messageCount:s})=>{const i=t||a;return e?j.jsxs("div",{className:"flex items-center justify-center py-4",children:[j.jsx(je,{className:"animate-spin h-5 w-5 text-primary mr-2"}),j.jsx("span",{className:"text-sm text-muted-foreground",children:"Loading messages..."})]}):i&&s>0?j.jsx("div",{className:"text-center py-3 px-4",children:j.jsx("div",{className:"text-xs text-muted-foreground",children:"↑ Scroll up to load older messages"})}):!i&&s>0?j.jsx("div",{className:"text-center py-3 px-4",children:j.jsx("div",{className:"inline-block px-4 py-2 rounded-full bg-muted/50 text-muted-foreground text-xs",children:"Beginning of conversation"})}):null},Jt=({messages:e,renderMessage:t,onLoadMore:a,hasMore:s,isLoading:i,initialVisibleCount:r=10,loadMoreThreshold:n=3,className:o="",style:l,autoScroll:d=!0,restoreScroll:c=!0,scrollKey:m="chat-scroll"})=>{const u=N.useRef(null),h=N.useRef(null),[g,x]=N.useState(!1),[f,b]=N.useState(!1),y=N.useRef(e.length),v=N.useRef(!1),w=N.useRef(0),[k,S]=N.useState(Math.max(0,e.length-r)),C=e.slice(k),D=k>0;N.useEffect(()=>{if(!d)return;if(!u.current)return;if(e.length>y.current){!g&&setTimeout(()=>{var e;null==(e=h.current)||e.scrollIntoView({behavior:"smooth"})},100)}},[e.length,d,g]),N.useEffect(()=>{if(!c)return;const e=u.current;if(!e)return;const t=localStorage.getItem(m);t?e.scrollTop=parseInt(t,10):setTimeout(()=>{var e;null==(e=h.current)||e.scrollIntoView({behavior:"auto"})},100)},[m,c]),N.useEffect(()=>{if(!c)return;const e=u.current;if(!e)return;const t=()=>{e&&localStorage.setItem(m,e.scrollTop.toString())};let a;const s=()=>{clearTimeout(a),a=setTimeout(t,500)};return e.addEventListener("scroll",s,{passive:!0}),()=>{clearTimeout(a),t(),e.removeEventListener("scroll",s)}},[m,c]),N.useEffect(()=>{const t=e.length,a=y.current;t>a?g?b(!0):(S(Math.max(0,t-r)),b(!1)):t<a&&S(Math.max(0,t-r)),y.current=t},[e.length,g,r]);const M=N.useCallback(()=>{if(!u.current)return;const{scrollTop:e,scrollHeight:t,clientHeight:i}=u.current,r=t-e-i>100;if(x(r),r||b(!1),e<200&&!v.current)if(D){v.current=!0;const t=u.current.scrollHeight;w.current=t,S(e=>Math.max(0,e-20)),setTimeout(()=>{if(u.current){const a=u.current.scrollHeight-t;u.current.scrollTop=e+a}v.current=!1},50),p.light()}else s&&(v.current=!0,p.light(),a(),setTimeout(()=>{v.current=!1},1e3))},[s,a,D,20]);return j.jsxs("div",{className:"relative flex-1 flex flex-col min-h-0",children:[j.jsxs("div",{ref:u,onScroll:M,className:`flex-1 overflow-y-auto scroll-smooth ${o}`,style:{WebkitOverflowScrolling:"touch",...l},children:[j.jsx(Kt,{isLoading:i,hasMore:s,localHasMore:D,messageCount:e.length}),j.jsxs("div",{className:"space-y-2 p-3",children:[C.map((e,a)=>j.jsx(_.Fragment,{children:t(e,a)},e.id)),j.jsx("div",{ref:h})]})]}),f&&j.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 z-10",children:j.jsx("button",{onClick:()=>{var e;null==(e=h.current)||e.scrollIntoView({behavior:"smooth"}),b(!1),x(!1)},className:"bg-primary text-primary-foreground px-4 py-2 rounded-full shadow-lg hover:bg-primary/90 transition-all animate-bounce text-sm font-medium",children:"↓ New messages"})})]})},Qt=[{id:"like",emoji:"👍",label:"Like"},{id:"love",emoji:"❤️",label:"Love"},{id:"dislike",emoji:"👎",label:"Dislike"},{id:"question",emoji:"❓",label:"Question"}],Zt=({messageId:e,reactions:t={},onReaction:a,onReactMessage:s,className:i=""})=>j.jsx("div",{className:`flex items-center gap-1 mt-1 ${i}`,children:Qt.map(i=>{const r=t[i.id],n=(null==r?void 0:r.count)||0,o=(null==r?void 0:r.userReacted)||!1;return j.jsxs(Ee,{variant:"ghost",size:"sm",onClick:()=>{a&&e?a(e,i.id):s&&s(i.id)},className:"h-6 px-2 py-1 text-xs rounded-full bg-background/20 backdrop-blur-sm border border-border/30 hover:bg-background/40 transition-all duration-200 "+(o?"bg-primary/20 border-primary/50 text-primary":"text-muted-foreground hover:text-foreground"),title:i.label,children:[j.jsx("span",{className:"text-sm mr-1",children:i.emoji}),n>0&&j.jsx("span",{className:"text-xs font-medium",children:n})]},i.id)})}),Xt=({widgetToken:e,height:t=300})=>{const a=N.useRef(null);return N.useEffect(()=>{a.current&&(a.current.innerHTML='\n          <div class="flex items-center justify-center h-full text-gray-400 text-sm">\n            <div class="text-center">\n              <p>🗺️ Google Maps configuration required</p>\n              <p class="text-xs mt-1">API key not found</p>\n            </div>\n          </div>\n        ')},[e,t]),j.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl overflow-hidden my-3",children:[j.jsxs("div",{className:"bg-white/10 px-3 py-2 flex items-center gap-2 border-b border-white/10",children:[j.jsx(ve,{size:16,className:"text-blue-400"}),j.jsx("span",{className:"text-sm font-medium text-white",children:"Google Maps"}),j.jsxs("div",{className:"ml-auto text-xs text-gray-400 flex items-center gap-1",children:[j.jsx(Ye,{size:12}),"Verified by Google"]})]}),j.jsx("div",{ref:a,style:{height:`${t}px`,minHeight:"200px"}})]})},ea=({onLongPress:e,threshold:t=500})=>{const a=N.useRef(),s=N.useRef(),i=N.useCallback(i=>{const r="touches"in i?{x:i.touches[0].clientX,y:i.touches[0].clientY}:{x:i.clientX,y:i.clientY};s.current=r,a.current=window.setTimeout(async()=>{await p.medium(),e()},t)},[e,t]),r=N.useCallback(e=>{if(a.current&&s.current){const t="touches"in e?{x:e.touches[0].clientX,y:e.touches[0].clientY}:{x:e.clientX,y:e.clientY};Math.sqrt(Math.pow(t.x-s.current.x,2)+Math.pow(t.y-s.current.y,2))>10&&clearTimeout(a.current)}},[]),n=N.useCallback(()=>{a.current&&clearTimeout(a.current)},[]);return{onTouchStart:i,onTouchMove:r,onTouchEnd:n,onMouseDown:i,onMouseMove:r,onMouseUp:n,onMouseLeave:n}},ta=({id:e,text:t,senderName:a,senderAvatar:s,timestamp:i,isBroadcast:r,isPayment:n,isOwnMessage:l=!1,reactions:d,onReaction:c,grounding:m})=>{const[u,p]=N.useState(!1),h=P(),g=ea({onLongPress:()=>{p(!0),setTimeout(()=>p(!1),5e3)},threshold:500});return j.jsxs("div",{className:o("group flex gap-2",l?"flex-row-reverse justify-end":"flex-row items-start","mb-0"),...g,children:[!l&&j.jsx("img",{src:s||Ot(a),alt:a,className:o("rounded-full object-cover border-2 border-border/50 flex-shrink-0","w-10 h-10")}),j.jsxs("div",{className:o("flex flex-col max-w-full",l?"items-end":"items-start"),children:[!l&&j.jsxs("div",{className:o("flex items-center gap-1 mb-0.5",h?"text-xs":"text-sm"),children:[j.jsx("span",{className:o("font-semibold text-foreground",h?"text-xs":"text-sm"),children:a}),j.jsx("span",{className:o("text-muted-foreground opacity-70",h?"text-[11px]":"text-xs"),children:(x=i,new Date(x).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))}),r&&j.jsx("span",{className:o("bg-orange-600/20 text-orange-400 px-1.5 py-0.5 rounded-full",h?"text-[10px]":"text-xs"),children:"📢 Broadcast"}),n&&j.jsx("span",{className:o("bg-green-600/20 text-green-400 px-1.5 py-0.5 rounded-full",h?"text-[10px]":"text-xs"),children:"💳 Payment"})]}),j.jsx("div",{className:o("inline-flex rounded-2xl backdrop-blur-sm border transition-all px-3 py-2","max-w-[85%] sm:max-w-[75%] md:max-w-[70%]",l?"bg-gradient-to-br from-[#007AFF] to-[#005FCC] text-white border-[#007AFF]/20 shadow-[0_1px_3px_rgba(0,0,0,0.25)] rounded-br-md":r?"bg-orange-600/10 border-orange-500/30 shadow-[0_2px_12px_rgba(251,146,60,0.15)]":n?"bg-green-600/10 border-green-500/30 shadow-[0_2px_12px_rgba(34,197,94,0.15)]":"bg-card/50 border-border shadow-sm"),children:j.jsx("p",{className:o("text-sm leading-snug break-words whitespace-pre-wrap",l?"text-white":r?"text-orange-400":n?"text-green-400":"text-foreground"),children:t})}),(null==m?void 0:m.googleMapsWidget)&&j.jsx("div",{className:"mt-2",children:j.jsx(Xt,{widgetToken:m.googleMapsWidget,height:h?200:250})}),(null==m?void 0:m.sources)&&m.sources.length>0&&j.jsxs("div",{className:o("space-y-2","mt-2"),children:[j.jsxs("div",{className:o("font-medium text-muted-foreground flex items-center gap-2",h?"text-[10px]":"text-xs"),children:[j.jsx("span",{children:"Sources:"}),m.sources.some(e=>"google_maps_grounding"===e.source)&&j.jsx("span",{className:o("bg-blue-500/20 text-blue-400 px-1.5 py-0.5 rounded",h?"text-[9px]":"text-[10px]"),children:"Verified by Google Maps"})]}),j.jsx("div",{className:"space-y-1",children:m.sources.map((e,t)=>j.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:o("block text-blue-400 hover:text-blue-300 flex items-center gap-1 bg-blue-500/10 rounded-lg transition-colors",h?"text-[10px] p-1.5":"text-xs p-2"),children:[j.jsx(Ye,{size:h?8:10}),j.jsx("span",{className:"truncate",children:e.title})]},e.id||t))})]}),u&&j.jsx("div",{className:o("mt-1"),children:j.jsx(Zt,{messageId:e,reactions:d,onReaction:c})})]})]});var x},aa=({message:e,reactions:t,onReaction:a})=>{var s;const{user:i}=r(),n=e,o=(null==i?void 0:i.id)===e.sender.id;return j.jsx(ta,{id:e.id,text:e.text,senderName:e.sender.name,senderAvatar:e.sender.avatar,timestamp:e.createdAt,isBroadcast:e.isBroadcast,isPayment:e.isPayment||(null==(s=e.tags)?void 0:s.includes("payment")),isOwnMessage:o,reactions:t,onReaction:a,grounding:n.sources||n.googleMapsWidget?{sources:n.sources,googleMapsWidget:n.googleMapsWidget}:void 0})},sa=e=>{const[t,a]=N.useState([]),[s,i]=N.useState(!1),{isDemoMode:r}=De(),o=e=>{const t=parseInt(e),a=Ke(t);return a&&a.participants?a.participants.map(e=>({id:e.id.toString(),name:e.name,avatar:e.avatar})):[{id:"user1",name:"You"},{id:"user2",name:"Trip Organizer"}]},l=async e=>{i(!0);try{const t=await U.getTripMembers(e);if(t&&t.length>0){const e=(e=>e.map(e=>{var t,a,s;return{id:e.user_id,name:(null==(t=e.profiles)?void 0:t.display_name)||(null==(a=e.profiles)?void 0:a.first_name)||"Unknown User",avatar:null==(s=e.profiles)?void 0:s.avatar_url}}))(t);a(e)}else if(r){const t=o(e);a(t)}else a([])}catch(t){if(r){const t=o(e);a(t)}else a([])}finally{i(!1)}};return N.useEffect(()=>{e&&l(e)},[e,r]),N.useEffect(()=>{if(!e)return;let t;return(async()=>{try{const{data:a}=await n.from("trip_members").select("id").limit(1);null!==a&&(t=n.channel(`trip-members-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"trip_members",filter:`trip_id=eq.${e}`},()=>{l(e)}).subscribe())}catch(a){}})(),()=>{t&&n.removeChannel(t)}},[e]),{tripMembers:t,loading:s,refreshMembers:()=>e&&l(e)}};const ia=new class{constructor(){t(this,"attempts",new Map)}checkLimit(e,t=10,a=6e4){const s=Date.now(),i=this.attempts.get(e);return!i||s>i.resetTime?(this.attempts.set(e,{count:1,resetTime:s+a}),!0):!(i.count>=t)&&(i.count++,!0)}getRemainingAttempts(e,t=10){const a=this.attempts.get(e);return!a||Date.now()>a.resetTime?t:Math.max(0,t-a.count)}};const ra=new class{constructor(){t(this,"isOnline",navigator.onLine),t(this,"listeners",new Set),window.addEventListener("online",()=>this.setOnline(!0)),window.addEventListener("offline",()=>this.setOnline(!1))}setOnline(e){this.isOnline=e,this.listeners.forEach(t=>t(e))}getStatus(){return this.isOnline}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}};new class{constructor(){t(this,"queue",[]),t(this,"isProcessing",!1),ra.subscribe(e=>{e&&this.queue.length>0&&this.processQueue()})}add(e,t){this.queue.push({id:e,operation:t,retryCount:0}),ra.getStatus()&&this.processQueue()}async processQueue(){if(!this.isProcessing&&0!==this.queue.length){for(this.isProcessing=!0;this.queue.length>0&&ra.getStatus();){const t=this.queue.shift();try{await t.operation()}catch(e){t.retryCount++,t.retryCount<3&&this.queue.unshift(t)}}this.isProcessing=!1}}};class na{static sanitizeText(e){return"string"!=typeof e?"":e.replace(/[<>'"]/g,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").trim().substring(0,1e3)}static isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)&&e.length<=255}static sanitizeSearchQuery(e){return"string"!=typeof e?"":e.replace(/[<>'"]/g,"").replace(/[;(){}[\]]/g,"").trim().substring(0,200)}static isValidUrl(e){try{const t=new URL(e);return["http:","https:"].includes(t.protocol)}catch{return!1}}static sanitizeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}static isValidTripId(e){return/^[a-zA-Z0-9_-]+$/.test(e)&&e.length>0&&e.length<=50}static checkRateLimit(e,t=100,a=6e4){const s=Date.now(),i=this.requestCounts.get(e);return!i||s>i.resetTime?(this.requestCounts.set(e,{count:1,resetTime:s+a}),!0):!(i.count>=t)&&(i.count++,!0)}}t(na,"requestCounts",new Map);const oa=({enableGroupChat:e=!0,showBroadcasts:t=!0,isEvent:a=!1,tripId:s,isPro:i=!1,userRole:o="member"})=>{const[l,d]=N.useState([]),[c,m]=N.useState(!0),[u,x]=N.useState({}),{isOffline:f}=function(){const[e,t]=N.useState(!navigator.onLine);return N.useEffect(()=>{const e=()=>t(!1),a=()=>t(!0);return window.addEventListener("online",e),window.addEventListener("offline",a),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",a)}},[]),{isOffline:e,isOnline:!e}}(),b=S(),y=N.useMemo(()=>s||b.tripId||b.proTripId||b.eventId||"",[s,b.tripId,b.proTripId,b.eventId]),v=De(),{tripMembers:w}=sa(y),{user:_}=r(),{messages:k,isLoading:C,sendMessageAsync:D,isCreating:M,loadMore:T,hasMore:I,isLoadingMore:P}=(e=>{const t=h(),{toast:a}=g(),[s,i]=N.useState(!0),[r,o]=N.useState(!1),{data:l=[],isLoading:d,error:c}=Qe({queryKey:["tripChat",e],queryFn:async()=>{const{data:t,error:a}=await n.from("trip_chat_messages").select("*").eq("trip_id",e).order("created_at",{ascending:!1}).limit(10);if(a)throw a;const s=(t||[]).reverse();return i(t&&10===t.length),s},enabled:!!e});N.useEffect(()=>{if(!e)return;let a=0,s=Date.now();const i=n.channel(`trip_chat_${e}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"trip_chat_messages",filter:`trip_id=eq.${e}`},i=>{const r=Date.now();r-s>6e4&&(a=0,s=r),a>=100||(a++,t.setQueryData(["tripChat",e],(e=[])=>{const t=i.new;return e.some(e=>e.id===t.id)?e:[...e,t].sort((e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime())}))}).subscribe();return()=>{n.removeChannel(i)}},[e,t]);const m=Ze({mutationFn:async t=>{const a=`chat_${e}_${t.author_name}`;if(!ia.checkLimit(a,30,6e4))throw new Error("Rate limit exceeded. Please slow down your messages.");const s=na.sanitizeText(t.content);if(!s.trim())throw new Error("Message cannot be empty.");if(s.length>1e3)throw new Error("Message is too long. Please keep it under 1000 characters.");const{data:i,error:r}=await n.from("trip_chat_messages").insert({trip_id:e,content:s,author_name:na.sanitizeText(t.author_name),media_type:t.media_type,media_url:t.media_url}).select().single();if(r)throw r;return i},onError:e=>{const t=e.message||"Failed to send message. Please try again.";a({title:"Error",description:t,variant:"destructive"})}});return{messages:l,isLoading:d,error:c,sendMessage:(e,t,a,s)=>{m.mutate({content:e,author_name:t,media_type:a,media_url:s})},sendMessageAsync:(e,t,a,s)=>m.mutateAsync({content:e,author_name:t,media_type:a,media_url:s}),isCreating:m.isPending,loadMore:async()=>{if(s&&!r&&0!==l.length){o(!0);try{const a=l[0],{data:s,error:r}=await n.from("trip_chat_messages").select("*").eq("trip_id",e).lt("created_at",a.created_at).order("created_at",{ascending:!1}).limit(20);if(r)throw r;if(s&&s.length>0){const a=s.reverse();t.setQueryData(["tripChat",e],(e=[])=>[...a,...e]),i(20===s.length)}else i(!1)}catch(a){}finally{o(!1)}}},hasMore:s,isLoadingMore:r}})(y),{inputMessage:A,setInputMessage:O,messageFilter:L,setMessageFilter:U,replyingTo:R,setReply:$,clearReply:F,sendMessage:q,filterMessages:V}=Lt({tripId:y,demoMode:v.isDemoMode,isEvent:a}),B=N.useRef(null);N.useRef(null),Ut(),Rt({preventZoom:!0,adjustViewport:!0,onShow:()=>{setTimeout(()=>{var e;null==(e=B.current)||e.scrollIntoView({behavior:"smooth"})},300)}}),$t({onRefresh:async()=>{await new Promise(e=>setTimeout(e,1e3))},threshold:80});((e,t)=>{const a=N.useRef(0),s=N.useRef(0),{onSwipeLeft:i,onSwipeRight:r,threshold:n=50}=t||{};N.useEffect(()=>{const t=e.current;if(!t)return;const o=e=>{a.current=e.touches[0].clientX,s.current=e.touches[0].clientY},l=e=>{const t=e.changedTouches[0].clientX,o=e.changedTouches[0].clientY,l=t-a.current,d=o-s.current;Math.abs(l)>Math.abs(d)&&Math.abs(l)>n&&(l>0&&r?r():l<0&&i&&i())};return t.addEventListener("touchstart",o),t.addEventListener("touchend",l),()=>{t.removeEventListener("touchstart",o),t.removeEventListener("touchend",l)}},[e,i,r,n])})(N.useRef(null),{onSwipeLeft:()=>{p.light()},onSwipeRight:()=>{p.light()},threshold:50});const H=v.isDemoMode||!y,W=N.useMemo(()=>H?[]:k.map(e=>({id:e.id,text:e.content,sender:{id:e.author_name||"unknown",name:e.author_name||"Unknown",avatar:Ot(e.author_name||"Unknown")},createdAt:e.created_at,isBroadcast:"broadcast"===e.privacy_mode,isPayment:!1,tags:[]})),[k,H]),G=async(e=!1,t=!1,a)=>{var s;let i;t&&a&&(i={amount:a.amount,currency:a.currency,description:a.description,splitCount:a.splitCount,splitParticipants:a.splitParticipants||[],paymentMethods:a.paymentMethods||[]});const r=await q({isBroadcast:e,isPayment:t,paymentData:i});if(!r)return;if(H)return void d(e=>[...e,r]);const n=(null==_?void 0:_.displayName)||(null==(s=null==_?void 0:_.email)?void 0:s.split("@")[0])||"You";try{await D(r.text,n)}catch(o){}},Y=(e,t)=>{const a={...u};a[e]||(a[e]={});const s=a[e][t]||{count:0,userReacted:!1};s.userReacted=!s.userReacted,s.count+=s.userReacted?1:-1,a[e][t]=s,x(a)};N.useEffect(()=>{(async()=>{if(H){m(!0);const e=i||b.proTripId,t=a||b.eventId;let s;s=e?await Ce.getProMockMessages("pro",(null==_?void 0:_.id)||"demo-user"):t?await Ce.getProMockMessages("event",(null==_?void 0:_.id)||"demo-user"):await Ce.getMockMessages("friends-trip",!0);const r=s.map(e=>{var t,a,s;return{id:e.id,text:e.message_content||"",sender:{id:e.sender_id||e.id,name:e.sender_name||"Unknown",avatar:Ot(e.sender_name||"Unknown")},createdAt:new Date(Date.now()-864e5*(e.timestamp_offset_days||0)).toISOString(),isBroadcast:(null==(t=e.tags)?void 0:t.includes("broadcast"))||(null==(a=e.tags)?void 0:a.includes("logistics"))||(null==(s=e.tags)?void 0:s.includes("urgent"))||!1,trip_type:e.trip_type,sender_name:e.sender_name,message_content:e.message_content,delay_seconds:e.delay_seconds,timestamp_offset_days:e.timestamp_offset_days,tags:e.tags}});d(r),m(!1)}else{d([]);const e=parseInt(y);if(e>=1&&e<=12&&0===W.length){m(!0);const e=(await Ce.getMockMessages("friends-trip",!0)).map(e=>{var t,a,s;return{id:e.id,text:e.message_content||"",sender:{id:e.sender_id||e.id,name:e.sender_name||"Unknown",avatar:Ot(e.sender_name||"Unknown")},createdAt:new Date(Date.now()-864e5*(e.timestamp_offset_days||0)).toISOString(),isBroadcast:(null==(t=e.tags)?void 0:t.includes("broadcast"))||(null==(a=e.tags)?void 0:a.includes("logistics"))||(null==(s=e.tags)?void 0:s.includes("urgent"))||!1,trip_type:e.trip_type,sender_name:e.sender_name,message_content:e.message_content,delay_seconds:e.delay_seconds,timestamp_offset_days:e.timestamp_offset_days,tags:e.tags}});d(e),m(!1)}else m(!1)}})()},[H,a,i,y,W.length,null==_?void 0:_.id]);const K=parseInt(y),J=K>=1&&K<=12&&0===W.length&&!H,Q=V(H||J?l:W),Z=H?c:C;return Z?j.jsx("div",{children:"Loading messages..."}):j.jsxs("div",{className:"flex flex-col h-full",children:[f&&j.jsxs(z,{className:"mx-4 mt-2 mb-0 border-warning/50 bg-warning/10",children:[j.jsx(vt,{className:"h-4 w-4"}),j.jsx(E,{className:"text-sm",children:"Offline Mode – viewing cached messages"})]}),Q.length>0&&j.jsx("div",{className:"p-3 border-b border-gray-700",children:j.jsx(Gt,{activeFilter:L,onFilterChange:U,hidePayments:!0})}),j.jsxs("div",{className:"mx-4 mb-2 rounded-2xl border border-white/10 bg-black/40 shadow-[inset_0_1px_0_rgba(255,255,255,0.06)] overflow-hidden flex flex-col flex-1 min-h-[400px]",children:[Z?j.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:j.jsx("div",{className:"space-y-4",children:[1,2,3].map(e=>j.jsxs("div",{className:"flex items-start gap-3 animate-pulse",children:[j.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-700"}),j.jsxs("div",{className:"flex-1",children:[j.jsx("div",{className:"h-4 bg-slate-700 rounded w-1/4 mb-2"}),j.jsx("div",{className:"h-16 bg-slate-700 rounded"})]})]},e))})}):j.jsx(Jt,{messages:Q,renderMessage:e=>j.jsx(aa,{message:e,reactions:u[e.id],onReaction:Y}),onLoadMore:H||J?()=>{}:T,hasMore:!H&&!J&&I,isLoading:P,initialVisibleCount:10,className:"chat-scroll-container native-scroll",autoScroll:!0,restoreScroll:!0,scrollKey:`chat-scroll-${y}`}),R&&j.jsx("div",{className:"border-t border-white/10 bg-black/30 px-4 py-2",children:j.jsx(Yt,{replyTo:{id:R.id,text:R.text,senderName:R.senderName},onCancel:F})}),j.jsx("div",{className:"border-t border-white/10 bg-black/30 p-3",children:j.jsx(Wt,{inputMessage:A,onInputChange:O,onSendMessage:G,onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),G())},apiKey:"",isTyping:M,tripMembers:w,hidePayments:!0,isPro:i,tripId:y})})]})]})},la=({events:e,tripName:t="Trip Itinerary"})=>{const[a,s]=N.useState(!1),i=N.useMemo(()=>{const t=(a?e:e.filter(e=>e.include_in_itinerary)).reduce((e,t)=>{const a=ne(t.date,"yyyy-MM-dd");return e[a]||(e[a]=[]),e[a].push(t),e},{});return Object.entries(t).map(([e,t])=>({date:new Date(e),events:t.sort((e,t)=>e.time.localeCompare(t.time))})).sort((e,t)=>e.date.getTime()-t.date.getTime())},[e,a]),r=e=>({dining:"bg-red-500/20 text-red-300",lodging:"bg-blue-500/20 text-blue-300",activity:"bg-green-500/20 text-green-300",transportation:"bg-yellow-500/20 text-yellow-300",entertainment:"bg-purple-500/20 text-purple-300",other:"bg-slate-500/20 text-slate-300"}[e]||"bg-slate-500/20 text-slate-300");return 0===i.length?j.jsx("div",{className:"p-6",children:j.jsxs("div",{className:"text-center py-12",children:[j.jsx(we,{size:48,className:"mx-auto text-slate-400 mb-4"}),j.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"No Itinerary Events"}),j.jsx("p",{className:"text-slate-400 mb-4",children:a?"No events have been added to the calendar yet.":"No events are marked for inclusion in the itinerary."}),j.jsx(Ee,{variant:"outline",onClick:()=>s(!a),children:a?"Show Only Itinerary Events":"Show All Events"})]})}):j.jsxs("div",{className:"p-6",children:[j.jsxs("div",{className:"flex items-center justify-between mb-6",children:[j.jsxs("div",{children:[j.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:t}),j.jsxs("p",{className:"text-slate-400 text-sm",children:[i.length," ",1===i.length?"day":"days"," • "," ",i.reduce((e,t)=>e+t.events.length,0)," events"]})]}),j.jsxs("div",{className:"flex gap-2",children:[j.jsx(Ee,{variant:"outline",size:"sm",onClick:()=>s(!a),children:a?"Itinerary Only":"All Events"}),j.jsxs(Ee,{variant:"outline",size:"sm",onClick:()=>{navigator.share&&navigator.share({title:t,text:"Check out our trip itinerary!",url:window.location.href})},children:[j.jsx(Ge,{size:16,className:"mr-1"}),"Share"]}),j.jsxs(Ee,{variant:"outline",size:"sm",onClick:()=>{},children:[j.jsx(Re,{size:16,className:"mr-1"}),"Export PDF"]})]})]}),j.jsx("div",{className:"space-y-6",children:i.map((e,t)=>j.jsxs($e,{className:"bg-slate-800/30 border-slate-700/50",children:[j.jsx(qe,{className:"pb-4",children:j.jsxs(Ve,{className:"flex items-center gap-3",children:[j.jsx("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center text-primary-foreground text-sm font-bold",children:t+1}),j.jsxs("div",{children:[j.jsx("div",{className:"text-lg font-semibold text-white",children:ne(e.date,"EEEE, MMMM d")}),j.jsxs("div",{className:"text-sm text-slate-400",children:[e.events.length," ",1===e.events.length?"event":"events"]})]})]})}),j.jsx(Fe,{className:"space-y-3",children:e.events.map((t,a)=>{var s,i;return j.jsxs("div",{className:"flex items-start gap-4 p-4 bg-slate-900/30 rounded-lg border border-slate-700/30",children:[j.jsxs("div",{className:"flex flex-col items-center",children:[j.jsx("div",{className:"w-3 h-3 bg-primary rounded-full"}),a<e.events.length-1&&j.jsx("div",{className:"w-0.5 h-8 bg-slate-600 mt-2"})]}),j.jsxs("div",{className:"flex-1 min-w-0",children:[j.jsxs("div",{className:"flex items-start justify-between mb-2",children:[j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx("span",{className:"text-lg",children:(i=t.event_category,{dining:"🍽️",lodging:"🏨",activity:"🎯",transportation:"🚗",entertainment:"🎭",other:"📅"}[i]||"📅")}),j.jsx("h4",{className:"font-semibold text-white",children:t.title}),j.jsx(Xe,{className:o("text-xs",r(t.event_category)),children:t.event_category})]}),j.jsxs("div",{className:"text-sm text-slate-400 flex items-center gap-1",children:[j.jsx(ke,{size:14}),t.time]})]}),t.location&&j.jsxs("div",{className:"flex items-center gap-1 text-sm text-slate-400 mb-2",children:[j.jsx(ve,{size:14}),t.location]}),t.description&&j.jsx("p",{className:"text-sm text-slate-300",children:t.description}),(null==(s=t.source_data)?void 0:s.confirmation_number)&&j.jsx("div",{className:"mt-2",children:j.jsxs(Xe,{variant:"outline",className:"text-xs",children:["Confirmation: ",t.source_data.confirmation_number]})})]})]},t.id)})})]},e.date.toISOString()))})]})},da=({viewMode:e,onToggleView:t,onAddEvent:a})=>j.jsxs("div",{className:"flex items-center justify-between mb-6",children:[j.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Group Calendar"}),j.jsxs("div",{className:"flex gap-2",children:[j.jsx(Ee,{variant:"outline",onClick:t,children:"calendar"===e?j.jsxs(j.Fragment,{children:[j.jsx(ht,{className:"mr-2 h-4 w-4"}),"Itinerary View"]}):j.jsxs(j.Fragment,{children:[j.jsx(we,{className:"mr-2 h-4 w-4"}),"Calendar View"]})}),j.jsxs(Ee,{onClick:a,children:[j.jsx(_e,{className:"mr-2 h-4 w-4"}),"Add Event"]})]})]}),ca=({newEvent:e,onUpdateField:t,onSubmit:a,onCancel:s,isSubmitting:i=!1,isEditing:r=!1})=>j.jsxs("div",{className:"space-y-4",children:[j.jsxs("div",{children:[j.jsx(ie,{htmlFor:"title",children:"Title"}),j.jsx(ze,{id:"title",value:e.title,onChange:e=>t("title",e.target.value),placeholder:"Event title"})]}),j.jsxs("div",{children:[j.jsx(ie,{htmlFor:"time",children:"Time"}),j.jsx(ze,{id:"time",type:"time",value:e.time,onChange:e=>t("time",e.target.value)})]}),j.jsxs("div",{children:[j.jsx(ie,{htmlFor:"location",children:"Location"}),j.jsx(ze,{id:"location",value:e.location,onChange:e=>t("location",e.target.value),placeholder:"Event location"})]}),j.jsxs("div",{children:[j.jsx(ie,{htmlFor:"category",children:"Category"}),j.jsxs(K,{value:e.category,onValueChange:e=>t("category",e),children:[j.jsx(J,{children:j.jsx(Q,{})}),j.jsxs(Z,{children:[j.jsx(X,{value:"dining",children:"Dining"}),j.jsx(X,{value:"lodging",children:"Lodging"}),j.jsx(X,{value:"activity",children:"Activity"}),j.jsx(X,{value:"transportation",children:"Transportation"}),j.jsx(X,{value:"entertainment",children:"Entertainment"}),j.jsx(X,{value:"other",children:"Other"})]})]})]}),j.jsxs("div",{children:[j.jsx(ie,{htmlFor:"description",children:"Description"}),j.jsx(he,{id:"description",value:e.description,onChange:e=>t("description",e.target.value),placeholder:"Event details (optional)"})]}),j.jsxs("div",{className:"flex gap-2",children:[j.jsx(Ee,{onClick:a,disabled:!e.title||i,children:i?"Saving...":r?"Update Event":"Add Event"}),j.jsx(Ee,{variant:"outline",onClick:s,disabled:i,children:"Cancel"})]})]}),ma=({event:e,onEdit:t,onDelete:a,isDeleting:s=!1})=>j.jsx("div",{className:"bg-card border border-border rounded-lg p-4 hover:bg-accent/50 transition-colors",children:j.jsxs("div",{className:"flex items-start justify-between gap-3",children:[j.jsxs("div",{className:"flex-1",children:[j.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[j.jsx("span",{className:"text-lg",children:{dining:"🍽️",lodging:"🏨",activity:"🎯",transportation:"🚗",entertainment:"🎭",other:"📌"}[e.event_category]||"📌"}),j.jsx("h4",{className:"font-medium text-foreground",children:e.title})]}),j.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx(ke,{className:"h-4 w-4"}),j.jsx("span",{children:e.time})]}),e.location&&j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx(ve,{className:"h-4 w-4"}),j.jsx("span",{children:e.location})]})]}),e.description&&j.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:e.description})]}),j.jsxs("div",{className:"flex gap-1",children:[t&&j.jsx(Ee,{variant:"ghost",size:"icon",onClick:()=>t(e),className:"hover:bg-primary/10 hover:text-primary",title:"Edit event",children:j.jsx(xt,{className:"h-4 w-4"})}),j.jsx(Ee,{variant:"ghost",size:"icon",onClick:()=>a(e.id),className:"text-destructive hover:text-destructive hover:bg-destructive/10",disabled:s,title:"Delete event",children:s?j.jsx("span",{className:"h-4 w-4 inline-flex items-center justify-center",children:j.jsx("span",{className:"animate-spin h-4 w-4 border-2 border-current border-t-transparent rounded-full"})}):j.jsx(ge,{className:"h-4 w-4"})})]})]})}),ua=({events:e,onEdit:t,onDelete:a,emptyMessage:s="No events for this date",isDeleting:i=!1})=>0===e.length?j.jsx("div",{className:"text-center py-8",children:j.jsx("p",{className:"text-muted-foreground text-sm",children:s})}):j.jsx("div",{className:"space-y-3",children:e.map(e=>j.jsx(ma,{event:e,onEdit:t,onDelete:a,isDeleting:i},e.id))}),pa=({tripId:e})=>{const{selectedDate:t,setSelectedDate:a,events:s,showAddEvent:i,setShowAddEvent:r,editingEvent:n,setEditingEvent:o,viewMode:l,toggleViewMode:d,newEvent:c,updateEventField:m,getEventsForDate:u,handleAddEvent:p,updateEvent:h,deleteEvent:x,resetForm:f,isLoading:b,isSaving:y}=(e=>{const[t,a]=N.useState(new Date),[s,i]=N.useState([]),[r,n]=N.useState(!1),[o,l]=N.useState(null),[d,c]=N.useState("calendar"),[m,u]=N.useState({title:"",date:new Date,time:"12:00",location:"",description:"",category:"other",include_in_itinerary:!0}),[p,h]=N.useState(!1),[x,f]=N.useState(!1),{toast:b}=g();N.useEffect(()=>{e?(async()=>{h(!0);try{const t=(await et.getTripEvents(e)).map(et.convertToCalendarEvent);i(t)}catch(t){b({title:"Unable to load events",description:"We had trouble retrieving the calendar. Please try again.",variant:"destructive"}),i([])}finally{h(!1)}})():i([])},[e,b]);const y=()=>{u({title:"",date:t||new Date,time:"12:00",location:"",description:"",category:"other",include_in_itinerary:!0}),n(!1)};return{selectedDate:t,setSelectedDate:a,events:s,setEvents:i,showAddEvent:r,setShowAddEvent:n,editingEvent:o,setEditingEvent:l,viewMode:d,setViewMode:c,toggleViewMode:()=>{c(e=>"calendar"===e?"itinerary":"calendar")},newEvent:m,updateEventField:(e,t)=>{u(a=>({...a,[e]:t}))},getEventsForDate:e=>s.filter(t=>t.date.toDateString()===e.toDateString()),handleAddEvent:async()=>{if(m.title&&t&&e)try{f(!0);const a=new Date(t),[s,r]=m.time.split(":");a.setHours(parseInt(s,10),parseInt(r,10));const n=await et.createEvent({trip_id:e,title:m.title,description:m.description,start_time:a.toISOString(),end_time:void 0,location:m.location,event_category:m.category,include_in_itinerary:m.include_in_itinerary??!0,source_type:"manual",source_data:{}});if(n){const e=et.convertToCalendarEvent(n);i(t=>[...t,e].sort((e,t)=>e.date.getTime()-t.date.getTime())),y(),b({title:"Event added",description:"Your event has been added to the shared calendar."})}}catch(a){b({title:"Unable to create event",description:"Please try again after refreshing the calendar.",variant:"destructive"})}finally{f(!1)}},updateEvent:async(t,a)=>{if(e)try{f(!0);const s=new Date(a.date),[r,n]=a.time.split(":");if(s.setHours(parseInt(r,10),parseInt(n,10)),await et.updateEvent(t,{title:a.title,description:a.description,start_time:s.toISOString(),location:a.location,event_category:a.category,include_in_itinerary:a.include_in_itinerary??!0})){const t=(await et.getTripEvents(e)).map(et.convertToCalendarEvent);i(t),l(null),b({title:"Event updated",description:"Your changes have been saved."})}}catch(s){b({title:"Unable to update event",description:"Please try again later.",variant:"destructive"})}finally{f(!1)}},deleteEvent:async t=>{if(e)try{f(!0),await et.deleteEvent(t,e)&&(i(e=>e.filter(e=>e.id!==t)),b({title:"Event removed",description:"The event has been removed from the calendar."}))}catch(a){b({title:"Unable to delete event",description:"Please try again later.",variant:"destructive"})}finally{f(!1)}},resetForm:y,isLoading:p,isSaving:x}})(e),v=t?u(t):[],w=s.map(e=>e.date);return e?"itinerary"===l?j.jsxs("div",{className:"p-6",children:[j.jsx(da,{viewMode:l,onToggleView:d,onAddEvent:()=>r(!i)}),j.jsx(la,{events:s,tripName:"Trip Itinerary"})]}):j.jsxs("div",{className:"p-6",children:[j.jsx(da,{viewMode:l,onToggleView:d,onAddEvent:()=>r(!i)}),b?j.jsx("div",{className:"flex justify-center items-center py-16",children:j.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):j.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[j.jsx("div",{className:"bg-card/50 backdrop-blur-sm border border-border rounded-lg p-4",children:j.jsx(oe,{mode:"single",selected:t,onSelect:a,className:"w-full",modifiers:{hasEvents:w},modifiersStyles:{hasEvents:{backgroundColor:"hsl(var(--primary) / 0.3)",color:"hsl(var(--primary-foreground))",fontWeight:"bold"}}})}),j.jsxs("div",{className:"bg-card/50 backdrop-blur-sm border border-border rounded-lg p-4 flex flex-col h-full",children:[i&&j.jsxs("div",{className:"mb-4 pb-4 border-b border-border",children:[j.jsx("h3",{className:"text-lg font-medium text-foreground mb-4",children:n?"Edit Event":"Add Event "+(t?`for ${ne(t,"MMM d")}`:"")}),j.jsx(ca,{newEvent:c,onUpdateField:m,onSubmit:async()=>{n?(await h(n.id,c),o(null),f()):await p()},onCancel:()=>{o(null),f()},isSubmitting:y,isEditing:!!n})]}),j.jsxs("div",{className:"flex-1",children:[j.jsx("h3",{className:"text-lg font-medium text-foreground mb-4",children:t?`Events for ${ne(t,"EEEE, MMM d")}`:"Select a date to view events"}),j.jsx(ua,{events:v,onEdit:e=>{o(e),r(!0),m("title",e.title),m("time",e.time),m("location",e.location||""),m("description",e.description||""),m("category",e.event_category||"other"),m("include_in_itinerary",e.include_in_itinerary??!0)},onDelete:x,emptyMessage:t?"No events scheduled for this day":"Select a date to view events",isDeleting:y})]})]})]})]}):j.jsx("div",{className:"p-6",children:j.jsx("div",{className:"bg-card/50 backdrop-blur-sm border border-border rounded-lg p-6 text-center text-muted-foreground",children:"Trip calendar is unavailable without a valid trip."})})},ha=({option:e,totalVotes:t,userVote:a,onVote:s,disabled:i=!1})=>{const r=t>0?e.votes/t*100:0,n=a===e.id;return j.jsxs("button",{onClick:()=>s(e.id),disabled:!!a||i,className:`w-full text-left p-4 rounded-xl border transition-all ${a?n?"border-glass-enterprise-blue bg-glass-enterprise-blue/20":"border-glass-slate-border bg-glass-slate-bg/50":"border-glass-slate-border hover:border-glass-enterprise-blue hover:bg-glass-enterprise-blue/10"} ${a||i?"cursor-default opacity-80":"cursor-pointer"}`,children:[j.jsxs("div",{className:"flex justify-between items-center mb-2",children:[j.jsx("span",{className:"font-medium text-white",children:e.text}),(a||i)&&j.jsxs("span",{className:"text-sm font-semibold text-gray-400",children:[e.votes," votes (",r.toFixed(0),"%)"]})]}),(a||i)&&j.jsx("div",{className:"w-full bg-glass-slate-bg rounded-full h-2",children:j.jsx("div",{className:"bg-gradient-to-r from-glass-enterprise-blue to-glass-accent-orange h-2 rounded-full transition-all duration-500",style:{width:`${r}%`}})})]})},ga=({poll:e,onVote:t,disabled:a=!1,isVoting:s=!1})=>{const i=i=>{a||s||t(e.id,i)};return j.jsxs("div",{className:"bg-glass-slate-card border border-glass-slate-border rounded-2xl p-6 shadow-enterprise-lg",children:[j.jsxs("div",{className:"flex items-start justify-between gap-4 mb-4",children:[j.jsx("h3",{className:"text-lg font-semibold text-white flex-1",children:e.question}),"closed"===e.status&&j.jsx("span",{className:"text-xs font-semibold px-2 py-1 rounded-full bg-red-500/10 text-red-400 border border-red-500/20",children:"Closed"})]}),j.jsx("div",{className:"space-y-3",children:e.options.map(t=>j.jsx(ha,{option:t,totalVotes:e.totalVotes,userVote:e.userVote,onVote:i,disabled:a},t.id))}),j.jsxs("p",{className:"text-sm text-gray-400 mt-4 text-center",children:[e.totalVotes," total votes"]})]})},xa=()=>`option_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,fa=({onCreatePoll:e,onCancel:t,isSubmitting:a=!1})=>{const{question:i,options:r,setQuestion:n,addOption:o,updateOption:l,removeOption:d,getPollData:c,resetForm:m}=(()=>{const[e,t]=N.useState(""),[a,s]=N.useState([{id:xa(),text:""},{id:xa(),text:""}]),i=N.useCallback(()=>{s(e=>[...e,{id:xa(),text:""}])},[]),r=N.useCallback((e,t)=>{s(a=>{const s=[...a];return s[e]={...s[e],text:t},s})},[]),n=N.useCallback(e=>{s(t=>t.filter((t,a)=>a!==e))},[]),o=N.useCallback(()=>e.trim()?a.filter(e=>e.text.trim()).length<2?{isValid:!1,error:"At least 2 options are required"}:{isValid:!0}:{isValid:!1,error:"Question is required"},[e,a]),l=N.useCallback(()=>o().isValid?{question:e.trim(),options:a.filter(e=>e.text.trim()).map(e=>e.text.trim())}:null,[e,a,o]),d=N.useCallback(()=>{t(""),s([{id:xa(),text:""},{id:xa(),text:""}])},[]);return{question:e,options:a,validOptions:a.filter(e=>e.text.trim()),canAddOption:a.length<10,canRemoveOption:a.length>2,setQuestion:t,addOption:i,updateOption:r,removeOption:n,validatePoll:o,getPollData:l,resetForm:d}})(),u=()=>{m(),t()};return j.jsxs("div",{className:"bg-glass-slate-card border border-glass-slate-border rounded-2xl p-6 shadow-enterprise-lg",children:[j.jsxs("div",{className:"flex items-center justify-between mb-4",children:[j.jsx("h3",{className:"text-lg font-semibold text-white",children:"Create New Poll"}),j.jsx("button",{onClick:u,className:"w-8 h-8 rounded-full bg-glass-slate-bg hover:bg-glass-slate-border flex items-center justify-center transition-colors",children:j.jsx(s,{size:16,className:"text-gray-400"})})]}),j.jsxs("div",{className:"space-y-4",children:[j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-semibold text-white mb-2",children:"Poll Question"}),j.jsx("input",{type:"text",value:i,onChange:e=>n(e.target.value),placeholder:"What would you like to ask the group?",className:"w-full bg-glass-slate-bg border border-glass-slate-border rounded-xl px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-glass-enterprise-blue focus:ring-2 focus:ring-glass-enterprise-blue/20"})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-semibold text-white mb-2",children:"Options"}),j.jsxs("div",{className:"space-y-2",children:[r.map((e,t)=>j.jsxs("div",{className:"flex gap-2",children:[j.jsx("input",{type:"text",value:e.text,onChange:e=>l(t,e.target.value),placeholder:`Option ${t+1}`,className:"flex-1 bg-glass-slate-bg border border-glass-slate-border rounded-lg px-3 py-2 text-white placeholder-gray-500 focus:outline-none focus:border-glass-enterprise-blue"}),r.length>2&&j.jsx("button",{onClick:()=>d(t),className:"w-8 h-8 rounded-lg bg-red-500 hover:bg-red-600 flex items-center justify-center text-white transition-colors",children:j.jsx(s,{size:14})})]},e.id)),r.length<6&&j.jsxs("button",{onClick:o,className:"w-full h-10 border-2 border-dashed border-glass-slate-border rounded-lg text-gray-400 hover:border-glass-enterprise-blue hover:text-glass-enterprise-blue transition-colors flex items-center justify-center gap-2",children:[j.jsx(_e,{size:16}),"Add Option"]})]})]}),j.jsxs("div",{className:"flex gap-3 pt-2",children:[j.jsx(Ee,{onClick:u,variant:"outline",className:"flex-1 h-10 rounded-lg border border-glass-slate-border hover:border-gray-500 font-semibold bg-glass-slate-bg text-white hover:bg-glass-slate-border",children:"Cancel"}),j.jsx(Ee,{onClick:async()=>{const t=c();t&&(await e(t.question,t.options),m())},disabled:a||!i.trim()||r.filter(e=>e.text.trim()).length<2,className:"flex-1 h-10 rounded-lg bg-gradient-to-r from-glass-enterprise-blue to-glass-enterprise-blue-light hover:from-glass-enterprise-blue-light hover:to-glass-enterprise-blue font-semibold text-white border border-glass-enterprise-blue/50",children:a?"Creating...":"Create Poll"})]})]})]})},ba=[{id:"mock-poll-1",trip_id:"1",question:"Which restaurant should we visit first?",options:[{id:"opt-1",text:"Sushi Place",voteCount:3,voters:["user-1","user-2","user-3"]},{id:"opt-2",text:"Taco Stand",voteCount:5,voters:["user-4","user-5","user-6","user-7","user-8"]},{id:"opt-3",text:"Pizza Joint",voteCount:2,voters:["user-9","user-10"]}],status:"active",total_votes:10,created_by:"mock-user-1",created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),version:1},{id:"mock-poll-2",trip_id:"1",question:"What amount is everybody going to spend on a table at the club?",options:[{id:"opt-1",text:"$500",voteCount:2,voters:["user-1","user-2"]},{id:"opt-2",text:"$1000",voteCount:4,voters:["user-3","user-4","user-5","user-6"]},{id:"opt-3",text:"$1500",voteCount:1,voters:["user-7"]}],status:"active",total_votes:7,created_by:"mock-user-1",created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),version:1}];const ya=new class{getStorageKey(e){return`polls_${e}`}async getPolls(e){try{return await x(this.getStorageKey(e),[])}catch(t){return[]}}async savePolls(e,t){try{await f(this.getStorageKey(e),t)}catch(a){}}async createPoll(e,t){const a=await this.getPolls(e),s=t.options.map((e,t)=>({id:`option_${t}`,text:e,votes:0,voters:[]})),i={id:`demo-poll-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,trip_id:e,question:t.question,options:s,total_votes:0,status:"active",created_by:"demo-user",created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()};return a.unshift(i),await this.savePolls(e,a),i}async voteOnPoll(e,t,a,s="demo-user"){const i=await this.getPolls(e),r=i.findIndex(e=>e.id===t);if(-1===r)return null;const n=i[r],o=n.options.findIndex(e=>e.id===a);return-1===o?null:(n.options.forEach(e=>{const t=e.voters.indexOf(s);-1!==t&&(e.voters.splice(t,1),e.votes=Math.max(0,e.votes-1),n.total_votes=Math.max(0,n.total_votes-1))}),n.options[o].voters.includes(s)||(n.options[o].voters.push(s),n.options[o].votes+=1,n.total_votes+=1),n.updated_at=(new Date).toISOString(),await this.savePolls(e,i),n)}async closePoll(e,t){const a=await this.getPolls(e),s=a.findIndex(e=>e.id===t);return-1===s?null:(a[s].status="closed",a[s].updated_at=(new Date).toISOString(),await this.savePolls(e,a),a[s])}async deletePoll(e,t){const a=await this.getPolls(e),s=a.filter(e=>e.id!==t);return s.length!==a.length&&(await this.savePolls(e,s),!0)}async clearPolls(e){await b(this.getStorageKey(e))}async clearAllDemoPolls(){}},va=({tripId:e})=>{const[t,a]=N.useState(!1),{user:s}=r(),{polls:i,isLoading:o,createPollAsync:l,votePollAsync:d,isCreatingPoll:c,isVoting:m}=(e=>{const t=h(),{toast:a}=g(),{isDemoMode:s}=De(),{data:i=[],isLoading:r}=Qe({queryKey:["tripPolls",e],queryFn:async()=>{if(s)return[...await ya.getPolls(e),...ba.filter(t=>t.trip_id===e).map(e=>({id:e.id,trip_id:e.trip_id,question:e.question,options:e.options.map(e=>({id:e.id,text:e.text,votes:e.voteCount,voters:e.voters})),total_votes:e.total_votes,status:e.status,created_by:e.created_by,created_at:e.created_at,updated_at:e.updated_at}))];const{data:t,error:a}=await n.from("trip_polls").select("*").eq("trip_id",e).order("created_at",{ascending:!1});if(a)throw a;return(t||[]).map(e=>({...e,options:Array.isArray(e.options)?e.options.filter(e=>e&&"object"==typeof e):[],status:e.status}))},enabled:!!e}),o=Ze({mutationFn:async t=>{if(s)return await ya.createPoll(e,t);const{data:{user:a}}=await n.auth.getUser();if(!a)throw new Error("User not authenticated");const i=t.options.map((e,t)=>({id:`option_${t}`,text:e,votes:0,voters:[]})),{data:r,error:o}=await n.from("trip_polls").insert({trip_id:e,question:t.question,options:i,total_votes:0,status:"active",created_by:a.id}).select().single();if(o)throw o;return r},onSuccess:()=>{t.invalidateQueries({queryKey:["tripPolls",e]}),a({title:"Poll created",description:"Your poll has been added to the trip."})},onError:()=>{a({title:"Error",description:"Failed to create poll. Please try again.",variant:"destructive"})}}),l=Ze({mutationFn:async({pollId:t,optionId:a})=>{if(s)return await ya.voteOnPoll(e,t,a),{pollId:t,optionId:a};const{data:{user:i}}=await n.auth.getUser();if(!i)throw new Error("User not authenticated");const{data:r,error:o}=await n.from("trip_polls").select("version").eq("id",t).single();if(o)throw o;const{error:l}=await n.rpc("vote_on_poll",{p_poll_id:t,p_option_id:a,p_user_id:i.id,p_current_version:r.version});if(l)throw l;return{pollId:t,optionId:a}},onSuccess:()=>{t.invalidateQueries({queryKey:["tripPolls",e]})},onError:()=>{a({title:"Error",description:"Failed to record vote. Please try again.",variant:"destructive"})}});return{polls:i,isLoading:r,createPoll:o.mutate,createPollAsync:o.mutateAsync,votePoll:l.mutate,votePollAsync:l.mutateAsync,isCreatingPoll:o.isPending,isVoting:l.isPending}})(e),u=null==s?void 0:s.id,p=N.useMemo(()=>i.map(e=>{const t=e.options.find(e=>{var t;return null==(t=e.voters)?void 0:t.includes(u||"")});return{id:e.id,question:e.question,options:e.options.map(e=>({id:e.id,text:e.text,votes:e.votes,voters:e.voters})),totalVotes:e.total_votes,userVote:null==t?void 0:t.id,status:e.status,createdAt:e.created_at}}),[i,u]),x=async(e,t)=>{try{await d({pollId:e,optionId:t})}catch(a){}};return j.jsxs("div",{className:"space-y-6",children:[!t&&j.jsxs(Ee,{onClick:()=>a(!0),className:"w-full h-12 rounded-xl bg-gradient-to-r from-glass-enterprise-blue to-glass-enterprise-blue-light hover:from-glass-enterprise-blue-light hover:to-glass-enterprise-blue font-semibold shadow-enterprise border border-glass-enterprise-blue/50 text-white",children:[j.jsx(be,{size:20,className:"mr-2"}),"Create Poll"]}),t&&j.jsx(fa,{onCreatePoll:async(e,t)=>{try{await l({question:e,options:t}),a(!1)}catch(s){}},onCancel:()=>a(!1),isSubmitting:c}),o?j.jsx("div",{className:"flex justify-center py-10",children:j.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):0===p.length?j.jsx("div",{className:"text-center py-10 text-muted-foreground text-sm",children:"No polls have been created yet."}):p.map(e=>j.jsx(ga,{poll:e,onVote:x,disabled:"closed"===e.status||!u,isVoting:m},e.id))]})},wa=({tripId:e})=>{const[t,a]=N.useState([{id:"1",author:"Emma",avatar:"https://images.unsplash.com/photo-1494790108755-2616b612b47c?w=40&h=40&fit=crop&crop=face",content:"This place looks amazing! Has anyone been here before?",timestamp:"2 hours ago",likes:3,linkUrl:"https://lamijean.fr",linkTitle:"L'Ami Jean - Traditional Bistro"},{id:"2",author:"Jake",avatar:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=40&h=40&fit=crop&crop=face",content:"The reviews are incredible! Definitely adding this to our must-visit list.",timestamp:"1 hour ago",likes:5,linkUrl:"https://lamijean.fr",linkTitle:"L'Ami Jean - Traditional Bistro"}]),[s,i]=N.useState(""),r=N.useMemo(()=>{const e=new Map;return t.forEach(t=>{var a;const s=t.linkUrl||"standalone";e.has(s)||e.set(s,[]),null==(a=e.get(s))||a.push(t)}),Array.from(e.entries()).map(([e,t])=>{var a;return{linkUrl:"standalone"!==e?e:void 0,linkTitle:null==(a=t[0])?void 0:a.linkTitle,comments:t}})},[t]),n=e=>{a(t.map(t=>t.id===e?{...t,likes:t.likes+1}:t))};return j.jsxs("div",{className:"p-6 space-y-6 bg-glass-slate-bg min-h-screen",children:[j.jsxs("div",{children:[j.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[j.jsx(F,{size:20,className:"text-glass-enterprise-blue"}),"Group Polls"]}),j.jsx(va,{tripId:e})]}),j.jsxs("div",{children:[j.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[j.jsx(F,{size:20,className:"text-purple-400"}),"Link Comments"]}),j.jsxs("div",{className:"bg-glass-slate-bg rounded-xl p-3 mb-4",children:[j.jsx("textarea",{value:s,onChange:e=>i(e.target.value),placeholder:"Share your thoughts about the links posted...",className:"w-full bg-glass-slate-card border border-glass-slate-border rounded-lg p-3 text-white placeholder-gray-500 focus:outline-none focus:border-glass-enterprise-blue focus:ring-1 focus:ring-glass-enterprise-blue/20 resize-none text-sm",rows:2}),j.jsx("div",{className:"flex justify-end mt-2",children:j.jsx("button",{onClick:()=>{if(!s.trim())return;const e={id:Date.now().toString(),author:"You",avatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face",content:s,timestamp:"just now",likes:0};a([e,...t]),i("")},disabled:!s.trim(),className:"bg-gradient-to-r from-glass-enterprise-blue to-glass-enterprise-blue-light hover:from-glass-enterprise-blue-light hover:to-glass-enterprise-blue disabled:opacity-50 disabled:cursor-not-allowed text-white px-4 py-1.5 rounded-lg text-sm font-semibold transition-all",children:"Post"})})]}),0===t.length?j.jsxs("div",{className:"text-center py-8",children:[j.jsx("div",{className:"text-gray-500 text-sm mb-1",children:"No comments yet"}),j.jsx("div",{className:"text-gray-400 text-xs",children:"Start the conversation about the places you're visiting!"})]}):j.jsx("div",{className:"space-y-4",children:r.map((e,t)=>j.jsxs("div",{className:"bg-glass-slate-card border border-glass-slate-border rounded-xl p-4",children:[e.linkUrl&&j.jsxs("div",{className:"bg-glass-enterprise-blue/10 border border-glass-enterprise-blue/30 rounded-lg p-3 mb-3",children:[j.jsxs("div",{className:"flex items-center gap-2 text-glass-enterprise-blue font-medium mb-1 text-sm",children:[j.jsx(Ye,{size:14}),e.linkTitle]}),j.jsx("a",{href:e.linkUrl,target:"_blank",rel:"noopener noreferrer",className:"text-glass-enterprise-blue-light text-xs hover:underline break-all",children:e.linkUrl})]}),j.jsx("div",{className:"space-y-2",children:e.comments.map((e,t)=>j.jsxs("div",{className:"flex gap-2",children:[j.jsx("img",{src:e.avatar,alt:e.author,className:"w-8 h-8 rounded-full object-cover flex-shrink-0"}),j.jsxs("div",{className:"flex-1 min-w-0",children:[j.jsxs("div",{className:"bg-white/5 rounded-lg px-3 py-2",children:[j.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[j.jsx("span",{className:"font-semibold text-white text-sm",children:e.author}),j.jsx("span",{className:"text-gray-400 text-xs",children:e.timestamp})]}),j.jsx("p",{className:"text-gray-300 text-sm leading-snug",children:e.content})]}),j.jsxs("div",{className:"flex items-center gap-3 mt-1 ml-3",children:[j.jsxs("button",{onClick:()=>n(e.id),className:"flex items-center gap-1 text-gray-400 hover:text-red-400 transition-colors text-xs",children:[j.jsx(A,{size:12}),j.jsx("span",{children:e.likes})]}),j.jsx("button",{className:"text-gray-400 hover:text-glass-enterprise-blue transition-colors text-xs",children:"Reply"})]}),e.replies&&e.replies.length>0&&j.jsx("div",{className:"mt-2 ml-4 space-y-2 border-l-2 border-glass-slate-border pl-3",children:e.replies.map(e=>j.jsxs("div",{className:"flex gap-2",children:[j.jsx("img",{src:e.avatar,alt:e.author,className:"w-7 h-7 rounded-full object-cover flex-shrink-0"}),j.jsxs("div",{className:"flex-1 min-w-0",children:[j.jsxs("div",{className:"bg-white/5 rounded-lg px-2 py-1.5",children:[j.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[j.jsx("span",{className:"font-medium text-white text-xs",children:e.author}),j.jsx("span",{className:"text-gray-400 text-xs",children:e.timestamp})]}),j.jsx("p",{className:"text-gray-300 text-xs leading-snug",children:e.content})]}),j.jsx("div",{className:"flex items-center gap-3 mt-1 ml-2",children:j.jsxs("button",{onClick:()=>n(e.id),className:"flex items-center gap-1 text-gray-400 hover:text-red-400 transition-colors text-xs",children:[j.jsx(A,{size:10}),j.jsx("span",{children:e.likes})]})})]})]},e.id))})]})]},e.id))})]},t))})]})]})},ja={1:{tripId:1,tripTitle:"Spring Break Cancun 2026 Kappa Alpha Psi Trip",location:"Cancun, Mexico",photos:[{id:"cancun-photo-1",media_url:"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=600&h=400&fit=crop",filename:"Beach Volleyball Tournament.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-864e5).toISOString(),source:"chat",file_size:425678,mime_type:"image/jpeg"},{id:"cancun-photo-2",media_url:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=600&h=400&fit=crop",filename:"Sunset Resort Pool Party.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-1728e5).toISOString(),source:"upload",file_size:523456,mime_type:"image/jpeg"},{id:"cancun-photo-3",media_url:"https://images.unsplash.com/photo-1539635278303-d4002c07eae3?w=600&h=400&fit=crop",filename:"Brotherhood Beach Group Shot.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-2592e5).toISOString(),source:"chat",file_size:378901,mime_type:"image/jpeg"}],videos:[{id:"cancun-video-1",media_url:"/mock/videos/cancun-beach-party.mp4",filename:"Epic Beach Party Highlights.mp4",media_type:"video",metadata:{duration:52,width:1280,height:720,poster:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=400&h=300&fit=crop"},created_at:new Date(Date.now()-864e5).toISOString(),source:"chat",file_size:12456e3,mime_type:"video/mp4"}],files:[{id:"cancun-file-1",media_url:"/mock/files/cancun-resort-confirmation.pdf",filename:"Moon Palace Resort Confirmation.pdf",media_type:"document",metadata:{pageCount:3,confirmationNumber:"MP-CAN-2026-789"},created_at:new Date(Date.now()-864e6).toISOString(),source:"upload",file_size:267890,mime_type:"application/pdf"},{id:"cancun-file-2",media_url:"https://images.unsplash.com/photo-1523794027912-478866de8aa4?w=400&h=300&fit=crop",filename:"Excursion Tickets - Chichen Itza.jpg",media_type:"image",metadata:{isTicket:!0,venue:"Chichen Itza",date:"2026-03-17",extractedEvents:1},created_at:new Date(Date.now()-432e6).toISOString(),source:"upload",file_size:345600,mime_type:"image/jpeg"}],links:[{id:"cancun-link-1",url:"https://www.palaceresorts.com/moon-palace-cancun",title:"Moon Palace Cancun - All Inclusive Resort",description:"Luxury all-inclusive resort with 6 restaurants, water park, and pristine beaches.",domain:"palaceresorts.com",image_url:"https://images.unsplash.com/photo-1571896349842-33c89424de2d?w=400&h=200&fit=crop",created_at:new Date(Date.now()-1296e6).toISOString(),source:"pinned",category:"Housing",tags:["resort","all-inclusive","accommodation"]},{id:"cancun-link-2",url:"https://www.joestonecrab.com/",title:"Joe's Stone Crab Cancun - Seafood Excellence",description:"World-famous stone crab and fresh seafood in the heart of Cancun.",domain:"joestonecrab.com",image_url:"https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=400&h=200&fit=crop",created_at:new Date(Date.now()-2592e5).toISOString(),source:"chat",category:"Eats",tags:["seafood","restaurant","upscale"]},{id:"cancun-link-3",url:"https://www.cocobongo.com.mx/",title:"Coco Bongo Show & Disco",description:"Spectacular acrobatic show with live performances and tribute acts.",domain:"cocobongo.com.mx",image_url:"https://images.unsplash.com/photo-1459749411175-04bf5292ceea?w=400&h=200&fit=crop",created_at:new Date(Date.now()-1728e5).toISOString(),source:"pinned",category:"Activities",tags:["nightlife","show","entertainment"]},{id:"cancun-link-4",url:"https://www.tripadvisor.com/Attraction_Review-g150807-d152896-Reviews-Chichen_Itza-Chichen_Itza_Yucatan_Peninsula.html",title:"Chichen Itza Day Trip",description:"Ancient Mayan ruins and Wonder of the World archaeological site.",domain:"tripadvisor.com",image_url:"https://images.unsplash.com/photo-1518638150340-f706e86654de?w=400&h=200&fit=crop",created_at:new Date(Date.now()-432e6).toISOString(),source:"manual",category:"Activities",tags:["cultural","historical","tour"]}]},2:{tripId:2,tripTitle:"Tokyo Adventure",location:"Tokyo, Japan",photos:[{id:"tokyo-photo-1",media_url:"https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?w=600&h=400&fit=crop",filename:"Shibuya Crossing Night Shot.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-864e5).toISOString(),source:"chat",file_size:456789,mime_type:"image/jpeg"},{id:"tokyo-photo-2",media_url:"https://images.unsplash.com/photo-1522059773416-5d424f04e00a?w=600&h=400&fit=crop",filename:"Cherry Blossoms Ueno Park.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-1728e5).toISOString(),source:"upload",file_size:398765,mime_type:"image/jpeg"},{id:"tokyo-photo-3",media_url:"https://images.unsplash.com/photo-1551963831-b3b1ca40c98e?w=600&h=400&fit=crop",filename:"Sushi Bar Group Experience.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-2592e5).toISOString(),source:"chat",file_size:423456,mime_type:"image/jpeg"}],videos:[{id:"tokyo-video-1",media_url:"/mock/videos/tokyo-karaoke.mp4",filename:"Epic Karaoke Night Shibuya.mp4",media_type:"video",metadata:{duration:78,width:1280,height:720,poster:"https://images.unsplash.com/photo-1516035069371-29a1b244cc32?w=400&h=300&fit=crop"},created_at:new Date(Date.now()-1728e5).toISOString(),source:"chat",file_size:15678e3,mime_type:"video/mp4"}],files:[{id:"tokyo-file-1",media_url:"/mock/files/jr-pass-confirmation.pdf",filename:"JR Pass - 7 Day Tokyo Regional.pdf",media_type:"document",metadata:{passType:"7-day",regions:["Tokyo","Kanto"]},created_at:new Date(Date.now()-10368e5).toISOString(),source:"upload",file_size:189456,mime_type:"application/pdf"},{id:"tokyo-file-2",media_url:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop",filename:"Tokyo Itinerary Day by Day.pdf",media_type:"document",metadata:{isSchedule:!0,days:10,extractedEvents:15},created_at:new Date(Date.now()-6912e5).toISOString(),source:"upload",file_size:567890,mime_type:"application/pdf"}],links:[{id:"tokyo-link-1",url:"https://www.booking.com/hotel/jp/the-millennials-shibuya.html",title:"The Millennials Shibuya Capsule Hotel",description:"Modern capsule hotel in the heart of Shibuya with high-tech amenities.",domain:"booking.com",image_url:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=200&fit=crop",created_at:new Date(Date.now()-1728e6).toISOString(),source:"pinned",category:"Housing",tags:["capsule","modern","shibuya"]},{id:"tokyo-link-2",url:"https://sushidai-tsukiji.com/",title:"Sushi Dai - Tsukiji Outer Market",description:"World-famous sushi restaurant known for the freshest tuna and traditional preparation.",domain:"sushidai-tsukiji.com",image_url:"https://images.unsplash.com/photo-1551963831-b3b1ca40c98e?w=400&h=200&fit=crop",created_at:new Date(Date.now()-3456e5).toISOString(),source:"chat",category:"Eats",tags:["sushi","traditional","tsukiji"]},{id:"tokyo-link-3",url:"https://www.teamlab.art/e/planets/",title:"teamLab Planets TOKYO Digital Art Museum",description:"Immersive digital art experience with interactive installations and water features.",domain:"teamlab.art",image_url:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=200&fit=crop",created_at:new Date(Date.now()-5184e5).toISOString(),source:"pinned",category:"Activities",tags:["art","digital","immersive"]},{id:"tokyo-link-4",url:"https://www.robot-restaurant.com/",title:"Robot Restaurant Shinjuku",description:"Crazy robot show with lasers, music, and mechanical mayhem in Shinjuku.",domain:"robot-restaurant.com",image_url:"https://images.unsplash.com/photo-1516035069371-29a1b244cc32?w=400&h=200&fit=crop",created_at:new Date(Date.now()-2592e5).toISOString(),source:"manual",category:"Activities",tags:["entertainment","unique","shinjuku"]}]},3:{tripId:3,tripTitle:"Jack and Jill's destination wedding",location:"Bali, Indonesia",photos:[{id:"bali-photo-1",media_url:"https://images.unsplash.com/photo-1519741497674-611481863552?w=600&h=400&fit=crop",filename:"Beachside Wedding Ceremony.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-864e5).toISOString(),source:"upload",file_size:567890,mime_type:"image/jpeg"},{id:"bali-photo-2",media_url:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=600&h=400&fit=crop",filename:"Sunset Reception Ubud.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-1728e5).toISOString(),source:"chat",file_size:456123,mime_type:"image/jpeg"}],videos:[{id:"bali-video-1",media_url:"/mock/videos/bali-ceremony.mp4",filename:"Wedding Ceremony Highlights.mp4",media_type:"video",metadata:{duration:125,width:1920,height:1080,poster:"https://images.unsplash.com/photo-1519741497674-611481863552?w=400&h=300&fit=crop"},created_at:new Date(Date.now()-864e5).toISOString(),source:"upload",file_size:25678e3,mime_type:"video/mp4"}],files:[{id:"bali-file-1",media_url:"/mock/files/villa-booking-confirmation.pdf",filename:"Villa Seminyak Wedding Package.pdf",media_type:"document",metadata:{guests:50,package:"Premium Beach Wedding"},created_at:new Date(Date.now()-2592e6).toISOString(),source:"upload",file_size:423789,mime_type:"application/pdf"}],links:[{id:"bali-link-1",url:"https://www.seminyakbeachresort.com/",title:"Seminyak Beach Resort & Spa",description:"Luxury beachfront resort perfect for destination weddings with ocean views.",domain:"seminyakbeachresort.com",image_url:"https://images.unsplash.com/photo-1571896349842-33c89424de2d?w=400&h=200&fit=crop",created_at:new Date(Date.now()-3888e6).toISOString(),source:"pinned",category:"Housing",tags:["resort","wedding-venue","luxury"]},{id:"bali-link-2",url:"https://www.lalucianbali.com/",title:"La Lucciola - Beachside Italian",description:"Romantic Italian restaurant with stunning ocean views and fresh seafood.",domain:"lalucianbali.com",image_url:"https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=400&h=200&fit=crop",created_at:new Date(Date.now()-432e6).toISOString(),source:"chat",category:"Eats",tags:["italian","romantic","ocean-view"]},{id:"bali-link-3",url:"https://www.baliswing.com/",title:"Bali Swing Adventure Experience",description:"Thrilling jungle swings with incredible valley views for adventurous couples.",domain:"baliswing.com",image_url:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=400&h=200&fit=crop",created_at:new Date(Date.now()-864e6).toISOString(),source:"manual",category:"Activities",tags:["adventure","scenic","couples"]}]},4:{tripId:4,tripTitle:"Kristen's Bachelorette Party",location:"Nashville, TN",photos:[{id:"nashville-photo-1",media_url:"https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=600&h=400&fit=crop",filename:"Honky Tonk Squad Goals.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-864e5).toISOString(),source:"chat",file_size:456789,mime_type:"image/jpeg"},{id:"nashville-photo-2",media_url:"https://images.unsplash.com/photo-1514525253161-7a46d19cd819?w=600&h=400&fit=crop",filename:"Broadway Live Music Night.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-1728e5).toISOString(),source:"upload",file_size:523456,mime_type:"image/jpeg"}],videos:[{id:"nashville-video-1",media_url:"/mock/videos/nashville-karaoke.mp4",filename:"Bride Karaoke Highlights.mp4",media_type:"video",metadata:{duration:67,width:1280,height:720,poster:"https://images.unsplash.com/photo-1514525253161-7a46d19cd819?w=400&h=300&fit=crop"},created_at:new Date(Date.now()-864e5).toISOString(),source:"chat",file_size:13456e3,mime_type:"video/mp4"}],files:[{id:"nashville-file-1",media_url:"https://images.unsplash.com/photo-1514525253161-7a46d19cd819?w=400&h=300&fit=crop",filename:"Grand Ole Opry VIP Tickets.jpg",media_type:"image",metadata:{isTicket:!0,venue:"Grand Ole Opry",date:"2025-11-09",extractedEvents:1},created_at:new Date(Date.now()-6048e5).toISOString(),source:"upload",file_size:234567,mime_type:"image/jpeg"}],links:[{id:"nashville-link-1",url:"https://www.omnihotels.com/hotels/nashville",title:"Omni Nashville Hotel - Downtown",description:"Luxury hotel in the heart of Music City with rooftop pool and spa services.",domain:"omnihotels.com",image_url:"https://images.unsplash.com/photo-1571896349842-33c89424de2d?w=400&h=200&fit=crop",created_at:new Date(Date.now()-1728e6).toISOString(),source:"pinned",category:"Housing",tags:["hotel","luxury","downtown"]},{id:"nashville-link-2",url:"https://www.hattiebs.com/",title:"Hattie B's Hot Chicken - Nashville Original",description:"Famous Nashville hot chicken with multiple heat levels and Southern sides.",domain:"hattiebs.com",image_url:"https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=400&h=200&fit=crop",created_at:new Date(Date.now()-2592e5).toISOString(),source:"chat",category:"Eats",tags:["chicken","nashville","spicy"]},{id:"nashville-link-3",url:"https://www.ryman.com/",title:"Ryman Auditorium - Mother Church of Country Music",description:"Historic venue with legendary country music performances and backstage tours.",domain:"ryman.com",image_url:"https://images.unsplash.com/photo-1514525253161-7a46d19cd819?w=400&h=200&fit=crop",created_at:new Date(Date.now()-432e6).toISOString(),source:"manual",category:"Activities",tags:["music","historic","tour"]}]},6:{tripId:6,tripTitle:"Johnson Family Summer Vacay",location:"Aspen, CO",photos:[{id:"aspen-photo-1",media_url:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=600&h=400&fit=crop",filename:"Family Mountain Hike.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-1728e5).toISOString(),source:"chat",file_size:445678,mime_type:"image/jpeg"},{id:"aspen-photo-2",media_url:"https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?w=600&h=400&fit=crop",filename:"Multi-Gen Lodge Group.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-2592e5).toISOString(),source:"upload",file_size:523789,mime_type:"image/jpeg"}],videos:[{id:"aspen-video-1",media_url:"/mock/videos/aspen-family.mp4",filename:"Family Adventure Montage.mp4",media_type:"video",metadata:{duration:89,width:1280,height:720,poster:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=400&h=300&fit=crop"},created_at:new Date(Date.now()-1728e5).toISOString(),source:"chat",file_size:16789e3,mime_type:"video/mp4"}],files:[{id:"aspen-file-1",media_url:"/mock/files/aspen-lodge-reservation.pdf",filename:"Little Nell Resort Confirmation.pdf",media_type:"document",metadata:{guests:7,nights:8},created_at:new Date(Date.now()-216e7).toISOString(),source:"upload",file_size:345600,mime_type:"application/pdf"}],links:[{id:"aspen-link-1",url:"https://www.thelittlenell.com/",title:"The Little Nell - Five-Star Aspen Resort",description:"Luxury ski-in/ski-out resort at the base of Aspen Mountain with world-class spa.",domain:"thelittlenell.com",image_url:"https://images.unsplash.com/photo-1571896349842-33c89424de2d?w=400&h=200&fit=crop",created_at:new Date(Date.now()-3888e6).toISOString(),source:"pinned",category:"Housing",tags:["resort","luxury","ski"]},{id:"aspen-link-2",url:"https://www.matsuhisaaspen.com/",title:"Matsuhisa Aspen - Renowned Japanese Cuisine",description:"World-famous Japanese restaurant by Nobu Matsuhisa with fresh sushi and mountain views.",domain:"matsuhisaaspen.com",image_url:"https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=400&h=200&fit=crop",created_at:new Date(Date.now()-3456e5).toISOString(),source:"chat",category:"Eats",tags:["japanese","sushi","upscale"]}]},7:{tripId:7,tripTitle:"Fantasy Football Chat's Annual Golf Outing",location:"Phoenix, Arizona",photos:[{id:"phoenix-photo-1",media_url:"https://images.unsplash.com/photo-1535131749006-b7f58c99034b?w=600&h=400&fit=crop",filename:"Desert Golf Championship.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-864e5).toISOString(),source:"chat",file_size:434567,mime_type:"image/jpeg"}],videos:[{id:"phoenix-video-1",media_url:"/mock/videos/phoenix-golf.mp4",filename:"Hole-in-One Celebration.mp4",media_type:"video",metadata:{duration:45,width:1280,height:720,poster:"https://images.unsplash.com/photo-1535131749006-b7f58c99034b?w=400&h=300&fit=crop"},created_at:new Date(Date.now()-864e5).toISOString(),source:"chat",file_size:9876e3,mime_type:"video/mp4"}],files:[{id:"phoenix-file-1",media_url:"/mock/files/tpc-scottsdale-booking.pdf",filename:"TPC Scottsdale Tee Times.pdf",media_type:"document",metadata:{players:6,rounds:3},created_at:new Date(Date.now()-10368e5).toISOString(),source:"upload",file_size:267890,mime_type:"application/pdf"}],links:[{id:"phoenix-link-1",url:"https://www.tpc.com/scottsdale/",title:"TPC Scottsdale - Stadium Course",description:"Home of the Waste Management Phoenix Open with the famous 16th hole stadium.",domain:"tpc.com",image_url:"https://images.unsplash.com/photo-1535131749006-b7f58c99034b?w=400&h=200&fit=crop",created_at:new Date(Date.now()-1296e6).toISOString(),source:"pinned",category:"Activities",tags:["golf","pga","tournament"]},{id:"phoenix-link-2",url:"https://www.fourseasons.com/scottsdale/",title:"Four Seasons Resort Scottsdale at Troon North",description:"Luxury desert resort with championship golf courses and spa in the Sonoran Desert.",domain:"fourseasons.com",image_url:"https://images.unsplash.com/photo-1571896349842-33c89424de2d?w=400&h=200&fit=crop",created_at:new Date(Date.now()-1728e6).toISOString(),source:"pinned",category:"Housing",tags:["resort","luxury","golf"]}]},5:{tripId:5,tripTitle:"Coachella Squad 2026",location:"Indio, CA",photos:[{id:"coachella-photo-1",media_url:"https://images.unsplash.com/photo-1459749411175-04bf5292ceea?w=600&h=400&fit=crop",filename:"Main Stage Festival Vibes.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-864e5).toISOString(),source:"chat",file_size:445678,mime_type:"image/jpeg"},{id:"coachella-photo-2",media_url:"https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=600&h=400&fit=crop",filename:"Ferris Wheel Desert Sunset.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-1728e5).toISOString(),source:"upload",file_size:523456,mime_type:"image/jpeg"},{id:"coachella-photo-3",media_url:"https://images.unsplash.com/photo-1514525253161-7a46d19cd819?w=600&h=400&fit=crop",filename:"Squad Goals at Sahara Tent.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-1728e5).toISOString(),source:"chat",file_size:378901,mime_type:"image/jpeg"},{id:"coachella-photo-4",media_url:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=600&h=400&fit=crop",filename:"Desert House Pool Party.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-2592e5).toISOString(),source:"upload",file_size:456789,mime_type:"image/jpeg"},{id:"coachella-photo-5",media_url:"https://images.unsplash.com/photo-1540039155733-5bb30b53aa14?w=600&h=400&fit=crop",filename:"Food Truck Adventures.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-3456e5).toISOString(),source:"chat",file_size:387654,mime_type:"image/jpeg"},{id:"coachella-photo-6",media_url:"https://images.unsplash.com/photo-1483032469466-b937c425697b?w=600&h=400&fit=crop",filename:"Late Night Art Installation.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-432e6).toISOString(),source:"upload",file_size:423567,mime_type:"image/jpeg"},{id:"coachella-photo-7",media_url:"https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?w=600&h=400&fit=crop",filename:"Morning Coffee Desert Views.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-5184e5).toISOString(),source:"chat",file_size:398745,mime_type:"image/jpeg"},{id:"coachella-photo-8",media_url:"https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=600&h=400&fit=crop",filename:"Full Group Festival Outfits.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-6048e5).toISOString(),source:"upload",file_size:467832,mime_type:"image/jpeg"}],videos:[{id:"coachella-video-1",media_url:"/mock/videos/coachella-highlights.mp4",filename:"Festival Highlights Reel.mp4",media_type:"video",metadata:{duration:95,width:1280,height:720},created_at:new Date(Date.now()-864e5).toISOString(),source:"chat",file_size:18456e3,mime_type:"video/mp4"},{id:"coachella-video-2",media_url:"/mock/videos/desert-house-tour.mp4",filename:"Epic Desert House Tour.mp4",media_type:"video",metadata:{duration:42,width:1280,height:720},created_at:new Date(Date.now()-2592e5).toISOString(),source:"upload",file_size:8734e3,mime_type:"video/mp4"},{id:"coachella-video-3",media_url:"/mock/videos/sunset-timelapse.mp4",filename:"Desert Sunset Timelapse.mp4",media_type:"video",metadata:{duration:28,width:1280,height:720},created_at:new Date(Date.now()-432e6).toISOString(),source:"chat",file_size:5632e3,mime_type:"video/mp4"}],files:[{id:"coachella-file-1",media_url:"https://images.unsplash.com/photo-1533174072545-7a4b6ad7a6c3?w=400&h=300&fit=crop",filename:"Weekend 1 Festival Passes.jpg",media_type:"image",metadata:{isTicket:!0,venue:"Coachella Valley Music Festival",date:"2026-04-10",extractedEvents:3},created_at:new Date(Date.now()-1296e6).toISOString(),source:"upload",file_size:234567,mime_type:"image/jpeg"},{id:"coachella-file-2",media_url:"/mock/files/coachella-lineup-schedule.pdf",filename:"Coachella 2026 Lineup & Schedule.pdf",media_type:"document",metadata:{isSchedule:!0,extractedEvents:47,pageCount:8},created_at:new Date(Date.now()-1728e6).toISOString(),source:"upload",file_size:2456789,mime_type:"application/pdf"},{id:"coachella-file-3",media_url:"https://images.unsplash.com/photo-1543892555-d79449d33e8b?w=400&h=300&fit=crop",filename:"Desert House Rental Receipt.jpg",media_type:"image",metadata:{isReceipt:!0,totalAmount:2400,splitCount:8,perPersonAmount:300,preferredMethod:"venmo"},created_at:new Date(Date.now()-216e7).toISOString(),source:"chat",file_size:345678,mime_type:"image/jpeg"},{id:"coachella-file-4",media_url:"/mock/files/festival-map.pdf",filename:"Coachella Festival Grounds Map.pdf",media_type:"document",metadata:{pageCount:2,extractedEvents:0},created_at:new Date(Date.now()-2592e6).toISOString(),source:"upload",file_size:1234567,mime_type:"application/pdf"},{id:"coachella-file-5",media_url:"https://images.unsplash.com/photo-1556742044-3c52d6e88c62?w=400&h=300&fit=crop",filename:"VIP Camping Pass Confirmation.jpg",media_type:"image",metadata:{isTicket:!0,venue:"Coachella VIP Camping",date:"2026-04-10"},created_at:new Date(Date.now()-3024e6).toISOString(),source:"upload",file_size:198765,mime_type:"image/jpeg"}],links:[{id:"coachella-link-1",url:"https://www.airbnb.com/rooms/coachella-desert-house",title:"Desert House Coachella - 8 Guests",description:"Stunning desert house with pool, perfect for festival groups.",domain:"airbnb.com",image_url:"https://images.unsplash.com/photo-1449824913935-59a10b8d2000?w=400&h=200&fit=crop",created_at:new Date(Date.now()-2592e6).toISOString(),source:"pinned",category:"Housing",tags:["airbnb","desert","festival"]},{id:"coachella-link-2",url:"https://www.yelp.com/biz/pappy-and-harriets-pioneertown",title:"Pappy & Harriet's Pioneertown Palace",description:"Legendary desert venue and restaurant, perfect for pre-festival dinner.",domain:"yelp.com",image_url:"https://images.unsplash.com/photo-1514933651103-005eec06c04b?w=400&h=200&fit=crop",created_at:new Date(Date.now()-24192e5).toISOString(),source:"manual",category:"Eats",tags:["restaurant","desert","iconic"]},{id:"coachella-link-3",url:"https://www.uber.com/us/en/ride/uber-shuttle/",title:"Uber Festival Shuttle Service",description:"Pre-book shuttle rides to avoid festival traffic and parking.",domain:"uber.com",image_url:"https://images.unsplash.com/photo-1544620347-c4fd4a3d5957?w=400&h=200&fit=crop",created_at:new Date(Date.now()-216e7).toISOString(),source:"pinned",category:"Activities",tags:["transportation","shuttle","festival"]},{id:"coachella-link-4",url:"https://www.coachella.com/lineup",title:"Coachella 2026 Official Lineup",description:"Full artist lineup and set times for both weekends.",domain:"coachella.com",image_url:"https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=400&h=200&fit=crop",created_at:new Date(Date.now()-3456e6).toISOString(),source:"pinned",category:"Activities",tags:["lineup","official","schedule"]},{id:"coachella-link-5",url:"https://www.wholefoodsmarket.com/stores/palmdesert",title:"Whole Foods Market Palm Desert",description:"Stock up on snacks and supplies before heading to the festival.",domain:"wholefoodsmarket.com",image_url:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=400&h=200&fit=crop",created_at:new Date(Date.now()-19008e5).toISOString(),source:"manual",category:"Eats",tags:["grocery","supplies","healthy"]}]},9:{tripId:9,tripTitle:"Spring Break Cancun 2026",location:"Cancun, Mexico",photos:[{id:"cancun-photo-1",media_url:"https://images.unsplash.com/photo-1544552866-d3ed42536cfd?w=600&h=400&fit=crop",filename:"Beach Day Paradise.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-864e5).toISOString(),source:"chat",file_size:445678,mime_type:"image/jpeg"},{id:"cancun-photo-2",media_url:"https://images.unsplash.com/photo-1571896349842-33c89424de2d?w=600&h=400&fit=crop",filename:"Resort Pool Vibes.jpg",media_type:"image",metadata:{width:800,height:600},created_at:new Date(Date.now()-1728e5).toISOString(),source:"upload",file_size:523456,mime_type:"image/jpeg"}],videos:[{id:"cancun-video-1",media_url:"/mock/videos/beach-volleyball.mp4",filename:"Epic Beach Volleyball Game.mp4",media_type:"video",metadata:{duration:45,width:1280,height:720},created_at:new Date(Date.now()-864e5).toISOString(),source:"chat",file_size:8456e3,mime_type:"video/mp4"}],files:[{id:"cancun-file-1",media_url:"https://images.unsplash.com/photo-1544966503-7adce1a35804?w=400&h=300&fit=crop",filename:"Flight Confirmation - Mexico City.jpg",media_type:"image",metadata:{isTicket:!0,venue:"AeroMexico Flight AM445",date:"2026-03-15"},created_at:new Date(Date.now()-864e6).toISOString(),source:"upload",file_size:234567,mime_type:"image/jpeg"},{id:"cancun-file-2",media_url:"/mock/files/hotel-confirmation.pdf",filename:"Hotel Riu Cancun Confirmation.pdf",media_type:"document",metadata:{extractedEvents:2,pageCount:3},created_at:new Date(Date.now()-1296e6).toISOString(),source:"upload",file_size:1456789,mime_type:"application/pdf"},{id:"cancun-file-3",media_url:"https://images.unsplash.com/photo-1586227740560-8cf2732c1531?w=400&h=300&fit=crop",filename:"Dinner Receipt - La Isla.jpg",media_type:"image",metadata:{isReceipt:!0,totalAmount:240,splitCount:6,perPersonAmount:40,preferredMethod:"venmo"},created_at:new Date(Date.now()-2592e5).toISOString(),source:"chat",file_size:198765,mime_type:"image/jpeg"},{id:"cancun-file-4",media_url:"/mock/files/cancun-itinerary.pdf",filename:"Cancun Week Itinerary.pdf",media_type:"document",metadata:{isSchedule:!0,extractedEvents:12,pageCount:4},created_at:new Date(Date.now()-1728e6).toISOString(),source:"upload",file_size:987654,mime_type:"application/pdf"}],links:[{id:"cancun-link-1",url:"https://www.airbnb.com/rooms/beachfront-villa-cancun",title:"Beachfront Villa with Private Pool",description:"Luxury 4BR villa steps from the beach, perfect for groups",domain:"airbnb.com",image_url:"https://images.unsplash.com/photo-1571896349842-33c89424de2d?w=400&h=200&fit=crop",created_at:new Date(Date.now()-216e7).toISOString(),source:"pinned",category:"Housing",tags:["beachfront","villa","pool"]}]}};class Na{static isUsingMockData(){return this.USE_MOCK_DATA}static getTripMockData(e){if(!this.USE_MOCK_DATA)return null;const t="string"==typeof e?parseInt(e,10):e;return ja[t]||null}static getMockMediaItems(e){const t=this.getTripMockData(e);return t?[...t.photos,...t.videos,...t.files]:[]}static getMockLinkItems(e){const t=this.getTripMockData(e);return t?t.links:[]}static getMockMediaByType(e,t){const a=this.getTripMockData(e);return a&&a[t]||[]}static getMockLinksByCategory(e,t){const a=this.getTripMockData(e);return a?t?a.links.filter(e=>e.category===t):a.links:[]}static async isEnabled(){return"true"===await x("TRIPS_DEMO_MODE")}static getTripMediaItems(e){return this.getMockMediaItems(e)}static getTripLinkItems(e){return this.getMockLinkItems(e)}}t(Na,"USE_MOCK_DATA",!1);class _a{static getUniversalMockData(e){const t=O(e),a=this.fallbackPhotos.map((t,a)=>({...t,id:`${e}-photo-${a+1}`})),s=this.fallbackVideos.map((t,a)=>({...t,id:`${e}-video-${a+1}`})),i=this.fallbackFiles.map((t,a)=>({...t,id:`${e}-file-${a+1}`})),r=this.fallbackLinks.map((t,a)=>({...t,id:`${e}-link-${a+1}`}));return"pro"===t&&i.push({id:`${e}-pro-file-1`,media_url:"/mock/files/tour_rider.pdf",filename:"Tour Rider Requirements.pdf",media_type:"document",metadata:{extractedEvents:5},created_at:new Date(Date.now()-12e5).toISOString(),source:"upload",file_size:1024e3,mime_type:"application/pdf"}),"event"===t&&i.push({id:`${e}-event-file-1`,media_url:"/mock/files/speaker_guidelines.pdf",filename:"Speaker Guidelines.pdf",media_type:"document",metadata:{extractedEvents:3},created_at:new Date(Date.now()-15e5).toISOString(),source:"upload",file_size:896e3,mime_type:"application/pdf"}),{photos:a,videos:s,files:i,links:r}}static getCombinedMediaItems(e){const t=this.getUniversalMockData(e);return[...t.photos,...t.videos,...t.files]}static getLinkItems(e){return this.getUniversalMockData(e).links}}t(_a,"fallbackPhotos",[{id:"fallback-photo-1",media_url:"/mock/images/travel-selfie.jpg",filename:"Group Travel Selfie.jpg",media_type:"image",metadata:{width:1920,height:1080},created_at:new Date(Date.now()-36e5).toISOString(),source:"chat",file_size:2457600,mime_type:"image/jpeg"},{id:"fallback-photo-2",media_url:"/mock/images/group-mountain-photo.jpg",filename:"Mountain Adventure.jpg",media_type:"image",metadata:{width:1920,height:1080},created_at:new Date(Date.now()-72e5).toISOString(),source:"upload",file_size:3145728,mime_type:"image/jpeg"},{id:"fallback-photo-3",media_url:"/mock/images/dinner-receipt-preview.jpg",filename:"Group Dinner.jpg",media_type:"image",metadata:{width:1920,height:1080},created_at:new Date(Date.now()-108e5).toISOString(),source:"chat",file_size:1843200,mime_type:"image/jpeg"},{id:"fallback-photo-4",media_url:"/mock/images/wedding-ceremony.jpg",filename:"Ceremony Moment.jpg",media_type:"image",metadata:{width:1920,height:1080},created_at:new Date(Date.now()-144e5).toISOString(),source:"upload",file_size:2621440,mime_type:"image/jpeg"}]),t(_a,"fallbackVideos",[{id:"fallback-video-1",media_url:"/mock/videos/team-celebration.mp4",filename:"Team Celebration.mp4",media_type:"video",metadata:{duration:45,width:1920,height:1080},created_at:new Date(Date.now()-54e5).toISOString(),source:"chat",file_size:15728640,mime_type:"video/mp4"},{id:"fallback-video-2",media_url:"/mock/videos/venue-tour.mp4",filename:"Venue Walkthrough.mp4",media_type:"video",metadata:{duration:120,width:1920,height:1080},created_at:new Date(Date.now()-9e6).toISOString(),source:"upload",file_size:45875200,mime_type:"video/mp4"}]),t(_a,"fallbackFiles",[{id:"fallback-file-1",media_url:"/mock/files/dinner_receipt.jpg",filename:"Group Dinner Receipt.jpg",media_type:"document",metadata:{isReceipt:!0,totalAmount:127.45,splitCount:4,perPersonAmount:31.86,preferredMethod:"venmo"},created_at:new Date(Date.now()-18e5).toISOString(),source:"upload",file_size:2048e3,mime_type:"image/jpeg"},{id:"fallback-file-2",media_url:"/mock/files/dodgers_tickets.pdf",filename:"Event Tickets.pdf",media_type:"document",metadata:{isTicket:!0,extractedEvents:1},created_at:new Date(Date.now()-54e5).toISOString(),source:"upload",file_size:512e3,mime_type:"application/pdf"},{id:"fallback-file-3",media_url:"/mock/images/conference-schedule-preview.jpg",filename:"Event Schedule.jpg",media_type:"document",metadata:{isSchedule:!0,extractedEvents:12},created_at:new Date(Date.now()-9e6).toISOString(),source:"chat",file_size:1536e3,mime_type:"image/jpeg"},{id:"fallback-file-4",media_url:"/mock/files/travel_itinerary.pdf",filename:"Travel Itinerary.pdf",media_type:"document",metadata:{extractedEvents:8},created_at:new Date(Date.now()-126e5).toISOString(),source:"upload",file_size:768e3,mime_type:"application/pdf"}]),t(_a,"fallbackLinks",[{id:"fallback-link-1",url:"https://airbnb.com/rooms/12345",title:"Beautiful Downtown Loft - Perfect for Groups",description:"Spacious 3BR/2BA loft in the heart of downtown. Sleeps 8 comfortably with modern amenities.",domain:"airbnb.com",image_url:"/mock/images/airbnb-listing.jpg",created_at:new Date(Date.now()-36e5).toISOString(),source:"chat",category:"Housing"},{id:"fallback-link-2",url:"https://opentable.com/restaurant/profile/54321",title:"Sunset Rooftop Restaurant - Reservations Available",description:"Award-winning rooftop dining with panoramic city views. Perfect for group celebrations.",domain:"opentable.com",image_url:"/mock/images/restaurant-rooftop.jpg",created_at:new Date(Date.now()-72e5).toISOString(),source:"manual",category:"Eats"},{id:"fallback-link-3",url:"https://viator.com/tours/city-walking-tour",title:"Historic City Walking Tour - Small Groups Welcome",description:"Discover hidden gems and local history on this 3-hour guided walking tour.",domain:"viator.com",image_url:"/mock/images/walking-tour.jpg",created_at:new Date(Date.now()-108e5).toISOString(),source:"pinned",category:"Activities"},{id:"fallback-link-4",url:"https://eventbrite.com/e/concert-tickets",title:"Live Music Concert - Group Discount Available",description:"Don't miss this incredible live performance. Group rates available for 6+ people.",domain:"eventbrite.com",created_at:new Date(Date.now()-144e5).toISOString(),source:"chat",category:"Activities"}]);const ka=e=>{const[t,a]=N.useState([]),[s,i]=N.useState([]),[r,o]=N.useState(!0),{isDemoMode:l}=De(),d=N.useCallback(async()=>{o(!0);try{let t=[];const s=O(e);if(l||Na.isEnabled())if("consumer"===s&&Na.getTripMediaItems(parseInt(e)).length>0)t=Na.getTripMediaItems(parseInt(e));else if("pro"===s&&rt[e]){const a=rt[e];t=[...(a.photos||[]).map(e=>({...e,media_type:"image"})),...(a.videos||[]).map(e=>({...e,media_type:"video"})),...(a.files||[]).map(e=>({...e,media_type:"document"}))]}else if("event"===s&&nt[e]){const a=nt[e];t=[...(a.photos||[]).map(e=>({...e,media_type:"image"})),...(a.videos||[]).map(e=>({...e,media_type:"video"})),...(a.files||[]).map(e=>({...e,media_type:"document"}))]}else t=_a.getCombinedMediaItems(e);else{const[a,s]=await Promise.all([n.from("trip_media_index").select("*").eq("trip_id",e).order("created_at",{ascending:!1}),n.from("trip_files").select("*").eq("trip_id",e).order("created_at",{ascending:!1})]);t=[...(a.data||[]).map(e=>({id:e.id,media_url:e.media_url,filename:e.filename||"Untitled",media_type:e.media_type,metadata:e.metadata||{},created_at:e.created_at,source:"chat"})),...(s.data||[]).map(e=>({id:e.id,media_url:`/storage/trip-files/${e.name}`,filename:e.name,media_type:e.file_type,metadata:{extracted_events:e.extracted_events},created_at:e.created_at,source:"upload"}))]}a(t)}catch(t){a(l?_a.getCombinedMediaItems(e):[])}finally{o(!1)}},[e,l]),c=N.useCallback(async()=>{try{let t=[];const a=O(e);if(l||Na.isEnabled())t="consumer"===a&&Na.getTripLinkItems(parseInt(e)).length>0?Na.getTripLinkItems(parseInt(e)):"pro"===a&&rt[e]?rt[e].links||[]:"event"===a&&nt[e]?nt[e].links||[]:_a.getLinkItems(e);else{const[a,s]=await Promise.all([n.from("trip_link_index").select("*").eq("trip_id",e).order("created_at",{ascending:!1}),n.from("trip_links").select("*").eq("trip_id",e).order("created_at",{ascending:!1})]);t=[...(a.data||[]).map(e=>({id:e.id,url:e.url,title:e.og_title||"Untitled Link",description:e.og_description||"",domain:e.domain||new URL(e.url).hostname,image_url:e.og_image_url,created_at:e.created_at,source:"chat",category:"Activities",tags:[]})),...(s.data||[]).map(e=>({id:e.id,url:e.url,title:e.title||"Untitled Link",description:e.description||"",domain:new URL(e.url).hostname,image_url:void 0,created_at:e.created_at,source:"manual",category:e.category||"Activities",tags:[]}))]}i(t)}catch(t){i(l?_a.getLinkItems(e):[])}},[e,l]);N.useEffect(()=>{d(),c()},[d,c]);const m=N.useCallback(e=>"all"===e?[...t,...s]:"photos"===e?t.filter(e=>"image"===e.media_type):"videos"===e?t.filter(e=>"video"===e.media_type):"files"===e?t.filter(e=>"document"===e.media_type):"links"===e?s:t,[t,s]),u=N.useCallback(()=>[...t,...s].sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()),[t,s]);return{mediaItems:t,linkItems:s,loading:r,totalItems:t.length+s.length,filterByType:m,getAllItemsSorted:u,refetch:()=>{d(),c()}}},Sa=({method:e,size:t=20})=>{const a={size:t,className:Ca(e)};switch(e){case"venmo":case"applecash":return j.jsx(V,{...a});case"cashapp":default:return j.jsx(Be,{...a});case"zelle":return j.jsx(B,{...a});case"paypal":return j.jsx(q,{...a})}},Ca=e=>{switch(e){case"venmo":return"text-blue-400";case"cashapp":return"text-emerald-400";case"zelle":return"text-purple-400";case"paypal":return"text-blue-500";case"applecash":return"text-gray-200";default:return"text-gray-400"}},Da=()=>{const[e,t]=N.useState(!1),[a,s]=N.useState(null);return{resolvePlaceName:async e=>{if(!e.trim())return{success:!1,error:"Place name is required"};t(!0),s(null);try{const{data:t,error:a}=await n.functions.invoke("venue-enricher",{body:{action:"resolve_place_links",query:e}});if(a)throw a;return t.success?{success:!0,place:t.place,linkOptions:t.linkOptions}:{success:!1,error:t.error||"Failed to resolve place"}}catch(a){const e=a instanceof Error?a.message:"Unknown error occurred";return s(e),{success:!1,error:e}}finally{t(!1)}},categorizePlaceType:e=>e.includes("lodging")||e.includes("hotel")?"housing":e.includes("restaurant")||e.includes("food")||e.includes("meal_takeaway")?"eats":e.includes("tourist_attraction")||e.includes("museum")||e.includes("amusement_park")?"day-activities":e.includes("night_club")||e.includes("bar")?"nightlife":e.includes("gym")||e.includes("spa")?"fitness":e.includes("travel_agency")||e.includes("airport")||e.includes("bus_station")?"transportation":"other",isLoading:e,error:a}},Ma=[{id:"housing",label:"Housing",icon:"🏠",description:"Hotels, Airbnbs, hostels"},{id:"eats",label:"Eats",icon:"🍽️",description:"Restaurants, cafes, food tours"},{id:"day-activities",label:"Day Activities",icon:"☀️",description:"Museums, tours, attractions"},{id:"nightlife",label:"Nightlife",icon:"🌙",description:"Bars, clubs, evening events"},{id:"fitness",label:"Fitness",icon:"💪",description:"Gyms, yoga, sports activities"},{id:"reservations",label:"Reservations",icon:"📅",description:"Restaurant bookings, confirmations"},{id:"transportation",label:"Transportation",icon:"✈️",description:"Flights, cars, rideshares"},{id:"essentials",label:"Essentials",icon:"🎒",description:"Packing, weather, documents"},{id:"other",label:"Other",icon:"📎",description:"Everything else"}],Ta=[{id:"1",title:"Charming 3BR Apartment in Montmartre",url:"https://airbnb.com/rooms/123",postedBy:"Emma"},{id:"2",title:"L'Ami Jean - Traditional Bistro",url:"https://example.com/restaurant",postedBy:"Jake"}],Ia=({isOpen:e,onClose:t})=>{const[a,i]=N.useState("place"),[r,n]=N.useState(""),[o,l]=N.useState(""),[d,c]=N.useState(""),[m,u]=N.useState(""),[p,h]=N.useState(""),[g,x]=N.useState(!1),[f,b]=N.useState(!1),[v,w]=N.useState([]),[_,k]=N.useState(!1),[S,C]=N.useState(null),[D,M]=N.useState([]),[T,I]=N.useState(null),[P,z]=N.useState(!1),{resolvePlaceName:E,categorizePlaceType:A,isLoading:O}=Da(),L=(e,t)=>{const a=[];return Ta.forEach(s=>{let i=0;if(s.url===e)i=1;else if(e&&s.url)try{const t=new URL(e).hostname;t===new URL(s.url).hostname&&(i=Math.max(i,.7))}catch(r){}if(t&&s.title){const e=t.toLowerCase().split(" "),a=s.title.toLowerCase().split(" "),r=e.filter(e=>e.length>3&&a.some(t=>t.includes(e)||e.includes(t))).length/Math.max(e.length,a.length);i=Math.max(i,r)}i>.6&&a.push({id:s.id,title:s.title,url:s.url,postedBy:s.postedBy,similarity:i})}),a.sort((e,t)=>t.similarity-e.similarity)},U=async(e,t,a)=>{const s=`${t} ${a} ${e}`.toLowerCase();return s.includes("airbnb")||s.includes("hotel")||s.includes("hostel")||s.includes("apartment")||s.includes("accommodation")||s.includes("booking.com")||s.includes("vrbo")||s.includes("stay")||s.includes("lodge")?"housing":s.includes("flight")||s.includes("airline")||s.includes("airport")||s.includes("uber")||s.includes("lyft")||s.includes("rental car")||s.includes("train")||s.includes("bus")||s.includes("transfer")||s.includes("expedia")||s.includes("kayak")||s.includes("car rental")?"transportation":s.includes("reservation")||s.includes("booking")||s.includes("opentable")||s.includes("resy")||s.includes("confirmed")||s.includes("table")||s.includes("tickets")||s.includes("seats")||s.includes("confirmation")?"reservations":s.includes("packing")||s.includes("checklist")||s.includes("weather")||s.includes("passport")||s.includes("visa")||s.includes("insurance")||s.includes("documents")||s.includes("emergency")||s.includes("essentials")||s.includes("what to bring")||s.includes("travel tips")?"essentials":s.includes("restaurant")||s.includes("cafe")||s.includes("food")||s.includes("menu")||s.includes("dining")||s.includes("michelin")||s.includes("cuisine")||s.includes("brunch")||s.includes("lunch")||s.includes("dinner")||s.includes("bakery")?"eats":s.includes("bar")||s.includes("club")||s.includes("nightlife")||s.includes("cocktail")||s.includes("pub")||s.includes("lounge")||s.includes("drinks")||s.includes("party")||s.includes("rooftop")?"nightlife":s.includes("gym")||s.includes("fitness")||s.includes("yoga")||s.includes("workout")||s.includes("sports")||s.includes("running")||s.includes("hiking")||s.includes("swimming")||s.includes("tennis")?"fitness":s.includes("museum")||s.includes("tour")||s.includes("attraction")||s.includes("activity")||s.includes("experience")||s.includes("sightseeing")||s.includes("gallery")||s.includes("monument")||s.includes("park")||s.includes("excursion")||s.includes("adventure")?"day-activities":"other"},R=()=>{i("place"),n(""),l(""),c(""),u(""),h(""),x(!1),w([]),k(!1),C(null),M([]),I(null),z(!1)};return e?j.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:j.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-lg w-full max-w-md max-h-[90vh] overflow-y-auto",children:[j.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-700",children:[j.jsx("h2",{className:"text-lg font-semibold text-white",children:"Add Link"}),j.jsx("button",{onClick:t,className:"text-slate-400 hover:text-white",children:j.jsx(s,{size:20})})]}),j.jsxs("form",{onSubmit:async e=>{e.preventDefault(),b(!0);try{let e=r,s=o;"place"===a&&T&&(e=T.url,s=o||(null==S?void 0:S.name)||"");let i=p;!p&&g&&(i=await U(e,s,d)),i||(i="other"),t(),R()}catch(s){}finally{b(!1)}},className:"p-6 space-y-4",children:[j.jsxs("div",{className:"flex bg-slate-900/50 rounded-lg p-1 border border-slate-600",children:[j.jsxs("button",{type:"button",onClick:()=>i("place"),className:"flex-1 px-3 py-2 rounded-md text-sm font-medium transition-all "+("place"===a?"bg-blue-600 text-white":"text-slate-400 hover:text-slate-300"),children:[j.jsx(ve,{size:16,className:"inline mr-2"}),"Add by Place Name"]}),j.jsxs("button",{type:"button",onClick:()=>i("url"),className:"flex-1 px-3 py-2 rounded-md text-sm font-medium transition-all "+("url"===a?"bg-blue-600 text-white":"text-slate-400 hover:text-slate-300"),children:[j.jsx(Le,{size:16,className:"inline mr-2"}),"Add by URL"]})]}),"place"===a&&j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Place Name *"}),j.jsxs("div",{className:"flex gap-2",children:[j.jsxs("div",{className:"relative flex-1",children:[j.jsx(ve,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400"}),j.jsx("input",{type:"text",value:m,onChange:e=>u(e.target.value),placeholder:"e.g., Gotham Hotel New York",required:"place"===a,className:"w-full bg-slate-900/50 border border-slate-600 rounded-lg pl-10 pr-4 py-3 text-white placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),j.jsx(Ee,{type:"button",onClick:async()=>{if(!m.trim())return;const e=await E(m);if(e.success&&e.place&&e.linkOptions){C(e.place),M(e.linkOptions),l(e.place.name),c(e.place.formatted_address);const t=A(e.place.types);p||g||h(t),z(!0);const a=e.linkOptions.find(e=>e.isPrimary)||e.linkOptions[0];I(a),n(a.url)}},disabled:!m.trim()||O,className:"bg-blue-600 hover:bg-blue-700",children:O?"Searching...":"Search"})]})]}),"url"===a&&j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Link URL *"}),j.jsxs("div",{className:"relative",children:[j.jsx(Le,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400"}),j.jsx("input",{type:"url",value:r,onChange:e=>(e=>{if(n(e),e||o){const t=L(e,o);w(t),k(t.length>0)}})(e.target.value),placeholder:"https://...",required:"url"===a,className:"w-full bg-slate-900/50 border border-slate-600 rounded-lg pl-10 pr-4 py-3 text-white placeholder-slate-400 focus:outline-none focus:border-blue-500"})]})]}),P&&S&&D.length>0&&j.jsxs("div",{className:"p-4 bg-slate-900/30 rounded-lg border border-slate-700",children:[j.jsx("div",{className:"flex items-start gap-3 mb-3",children:j.jsxs("div",{className:"flex-1",children:[j.jsx("h3",{className:"font-medium text-white",children:S.name}),j.jsx("p",{className:"text-sm text-slate-400",children:S.formatted_address}),S.rating&&j.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[j.jsx(ot,{size:14,className:"text-yellow-400 fill-current"}),j.jsx("span",{className:"text-sm text-slate-300",children:S.rating})]})]})}),j.jsxs("div",{className:"space-y-2",children:[j.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Choose Link Type:"}),D.map(e=>j.jsx("button",{type:"button",onClick:()=>{I(e),n(e.url)},className:"w-full p-3 rounded-lg border text-left transition-all "+((null==T?void 0:T.type)===e.type?"bg-blue-600/20 border-blue-600 text-white":"bg-slate-900/30 border-slate-700 text-slate-300 hover:border-slate-600"),children:j.jsxs("div",{className:"flex items-center justify-between",children:[j.jsxs("div",{children:[j.jsx("div",{className:"font-medium",children:e.label}),j.jsx("div",{className:"text-xs text-slate-400",children:e.description})]}),j.jsx(Ye,{size:16,className:"text-slate-400"})]})},e.type))]})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Title *"}),j.jsx("input",{type:"text",value:o,onChange:e=>(e=>{if(l(e),r||e){const t=L(r,e);w(t),k(t.length>0)}})(e.target.value),placeholder:"Give this link a title...",required:!0,className:"w-full bg-slate-900/50 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),_&&v.length>0&&j.jsxs("div",{className:"p-3 bg-amber-900/20 border border-amber-600/50 rounded-lg",children:[j.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[j.jsx(y,{size:16,className:"text-amber-400"}),j.jsx("span",{className:"text-sm font-medium text-amber-300",children:"Similar links found"})]}),v.slice(0,2).map(e=>j.jsxs("div",{className:"text-xs text-amber-200 mb-1",children:['"',e.title,'" by ',e.postedBy," ",e.similarity>.9?"(exact match)":"(similar)"]},e.id)),j.jsx("div",{className:"text-xs text-amber-300 mt-2",children:"Continue if you're sure this is different"})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Description"}),j.jsx("textarea",{value:d,onChange:e=>c(e.target.value),placeholder:"Add some context or notes...",rows:3,className:"w-full bg-slate-900/50 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 resize-none"})]}),j.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-900/30 rounded-lg border border-slate-700/50",children:[j.jsx("input",{type:"checkbox",id:"ai-sorting",checked:g,onChange:e=>x(e.target.checked),className:"w-4 h-4 text-blue-600 bg-slate-800 border-slate-600 rounded focus:ring-blue-500"}),j.jsxs("label",{htmlFor:"ai-sorting",className:"flex items-center gap-2 text-sm text-slate-300",children:[j.jsx(H,{size:16,className:"text-blue-400"}),"Let AI categorize this link automatically"]})]}),!g&&j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-3",children:"Category (optional)"}),j.jsx("div",{className:"grid grid-cols-1 gap-2 max-h-64 overflow-y-auto",children:Ma.map(e=>j.jsxs("button",{type:"button",onClick:()=>h(e.id===p?"":e.id),className:"flex items-center gap-3 p-3 rounded-lg border text-left transition-all "+(p===e.id?"bg-blue-600/20 border-blue-600 text-white":"bg-slate-900/30 border-slate-700 text-slate-300 hover:border-slate-600"),children:[j.jsx("span",{className:"text-lg",children:e.icon}),j.jsxs("div",{children:[j.jsx("div",{className:"font-medium",children:e.label}),j.jsx("div",{className:"text-xs text-slate-400",children:e.description})]})]},e.id))})]}),j.jsxs("div",{className:"flex gap-3 pt-4",children:[j.jsx(Ee,{type:"button",variant:"outline",onClick:t,className:"flex-1",children:"Cancel"}),j.jsx(Ee,{type:"submit",disabled:f||"place"===a&&!T,className:"flex-1 bg-blue-600 hover:bg-blue-700",children:f?"Adding...":"Add Link"})]})]})]})}):null},Pa=({items:e,type:t})=>{const[a,s]=_.useState(null),[i,r]=N.useState(!1),n=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),o=e=>{if(!e)return"";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(1))+" "+["Bytes","KB","MB","GB"][t]},l=e=>{var t,a;if((null==(t=e.metadata)?void 0:t.preferredMethod)&&(null==(a=e.metadata)?void 0:a.perPersonAmount)){const t=((e,t,a)=>{const s=t.toFixed(2);switch(e){case"venmo":return`venmo://paycharge?txn=pay&recipients=${encodeURIComponent(a)}&amount=${s}&note=${encodeURIComponent("Trip expense")}`;case"cashapp":return`https://cash.app/$${encodeURIComponent(a)}/${s}`;case"zelle":return"https://www.zellepay.com/send-money";case"paypal":return`https://paypal.me/${encodeURIComponent(a)}/${s}`;default:return null}})(e.metadata.preferredMethod,e.metadata.perPersonAmount,"Trip Member");t&&window.open(t,"_blank")}};if("links"===t){const t=e,o=a?t.filter(e=>e.category===a):t;return j.jsxs("div",{className:"space-y-4",children:[j.jsxs("div",{className:"flex flex-wrap gap-2 p-4 bg-muted/30 rounded-lg",children:[j.jsxs(Ee,{variant:null===a?"default":"outline",size:"sm",onClick:()=>s(null),className:"text-xs",children:["All Links (",t.length,")"]}),j.jsxs(Ee,{variant:"Housing"===a?"default":"outline",size:"sm",onClick:()=>s("Housing"),className:"text-xs",children:["Housing (",t.filter(e=>"Housing"===e.category).length,")"]}),j.jsxs(Ee,{variant:"Eats"===a?"default":"outline",size:"sm",onClick:()=>s("Eats"),className:"text-xs",children:["Eats (",t.filter(e=>"Eats"===e.category).length,")"]}),j.jsxs(Ee,{variant:"Activities"===a?"default":"outline",size:"sm",onClick:()=>s("Activities"),className:"text-xs",children:["Activities (",t.filter(e=>"Activities"===e.category).length,")"]}),j.jsxs(Ee,{variant:"ghost",size:"sm",onClick:()=>r(!0),className:"text-xs ml-auto",children:[j.jsx(Le,{className:"w-4 h-4 mr-1"}),"+ Add Link"]})]}),0===t.length?j.jsxs("div",{className:"text-center py-8",children:[j.jsx(Le,{className:"mx-auto h-8 w-8 text-muted-foreground mb-2"}),j.jsx("p",{className:"text-muted-foreground text-sm",children:"Links shared in chat will appear here automatically"})]}):null,o.length>0&&o.map(e=>j.jsx("div",{className:"bg-card border rounded-lg p-4 hover:bg-card/80 transition-colors",children:j.jsxs("div",{className:"flex gap-4",children:[e.image_url&&j.jsx("img",{src:e.image_url,alt:e.title,className:"w-20 h-20 rounded-lg object-cover flex-shrink-0"}),j.jsxs("div",{className:"flex-1 min-w-0",children:[j.jsx("h4",{className:"text-foreground font-medium text-sm mb-1 truncate",children:e.title}),j.jsx("p",{className:"text-muted-foreground text-xs mb-2 line-clamp-2",children:e.description}),j.jsxs("div",{className:"flex items-center justify-between",children:[j.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[j.jsx("span",{children:e.domain}),j.jsx("span",{children:n(e.created_at)}),j.jsx(Xe,{variant:"outline",className:"text-xs",children:"chat"===e.source?"From chat":"pinned"===e.source?"From pins":"Manual"}),e.category&&j.jsx(Xe,{variant:"secondary",className:"text-xs",children:e.category})]}),j.jsxs(Ee,{size:"sm",variant:"outline",onClick:()=>window.open(e.url,"_blank"),className:"text-xs",children:[j.jsx(Ye,{className:"w-3 h-3 mr-1"}),"Open"]})]})]})]})},e.id)),j.jsx(Ia,{isOpen:i,onClose:()=>r(!1)})]})}const d=e;if("photos"===t||"videos"===t)return j.jsxs("div",{className:"space-y-4",children:[j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsxs("h3",{className:"text-lg font-semibold text-foreground",children:["photos"===t?"Photos":"Videos"," (",d.length,")"]}),j.jsxs(Ee,{variant:"ghost",size:"sm",onClick:()=>{alert(`Add ${"photos"===t?"Photo":"Video"} functionality - would open file picker for ${t}`)},className:"text-xs",children:["photos"===t?j.jsx(ue,{className:"w-4 h-4 mr-1"}):j.jsx(yt,{className:"w-4 h-4 mr-1"}),"+ Add ","photos"===t?"Photo":"Video"]})]}),0===d.length?j.jsxs("div",{className:"text-center py-8",children:["photos"===t?j.jsx(ue,{className:"mx-auto h-8 w-8 text-muted-foreground mb-2"}):j.jsx(yt,{className:"mx-auto h-8 w-8 text-muted-foreground mb-2"}),j.jsxs("p",{className:"text-muted-foreground text-sm",children:[t.charAt(0).toUpperCase()+t.slice(1)," shared in chat will appear here"]})]}):j.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:d.map(e=>{var t;return j.jsxs("div",{className:"group relative aspect-square rounded-lg overflow-hidden bg-muted cursor-pointer",onClick:()=>{if("video"===e.media_type){const t=document.createElement("video");t.src=e.media_url,t.controls=!0,t.autoplay=!0,t.style.cssText="position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:9999;max-width:90vw;max-height:90vh;background:black;";const a=document.createElement("div");a.style.cssText="position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.8);z-index:9998;display:flex;align-items:center;justify-content:center;",a.onclick=()=>document.body.removeChild(a),a.appendChild(t),document.body.appendChild(a)}},children:["image"===e.media_type?j.jsx("img",{src:e.media_url,alt:e.filename,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}):j.jsxs("div",{className:"relative w-full h-full bg-black flex items-center justify-center",children:[j.jsx("video",{src:e.media_url,className:"w-full h-full object-cover",muted:!0,preload:"metadata"}),j.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20",children:j.jsx(ye,{className:"w-12 h-12 text-white"})}),(null==(t=e.metadata)?void 0:t.duration)&&j.jsxs("div",{className:"absolute bottom-2 right-2 bg-black/70 text-white text-xs px-2 py-1 rounded",children:[Math.floor(e.metadata.duration/60),":",(e.metadata.duration%60).toString().padStart(2,"0")]})]}),j.jsxs("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors",children:[j.jsx("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:j.jsx("div",{className:"flex items-center gap-1",children:"chat"===e.source?j.jsx(F,{className:"w-4 h-4 text-white bg-black/50 rounded p-0.5"}):j.jsx(Ye,{className:"w-4 h-4 text-white bg-black/50 rounded p-0.5"})})}),j.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-3 opacity-0 group-hover:opacity-100 transition-opacity",children:[j.jsx("p",{className:"text-white text-sm font-medium truncate",children:e.filename}),j.jsxs("p",{className:"text-white/80 text-xs",children:["chat"===e.source?"From chat":"Uploaded"," • ",n(e.created_at)]})]})]})]},e.id)})})]});if("files"===t){const e=d.filter(e=>{var t,a,s;return"document"===e.media_type||"image"===e.media_type&&((null==(t=e.metadata)?void 0:t.isSchedule)||(null==(a=e.metadata)?void 0:a.isReceipt)||(null==(s=e.metadata)?void 0:s.isTicket))});return j.jsxs("div",{className:"space-y-4",children:[j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsxs("h3",{className:"text-lg font-semibold text-foreground",children:["Files (",e.length,")"]}),j.jsxs(Ee,{variant:"ghost",size:"sm",onClick:()=>{alert("Add File functionality - would open file picker for documents, receipts, schedules")},className:"text-xs",children:[j.jsx(Oe,{className:"w-4 h-4 mr-1"}),"+ Add File"]})]}),0===e.length?j.jsxs("div",{className:"text-center py-8",children:[j.jsx(Oe,{className:"mx-auto h-8 w-8 text-muted-foreground mb-2"}),j.jsx("p",{className:"text-muted-foreground text-sm",children:"Documents, receipts, and schedules shared in chat will appear here"})]}):j.jsx("div",{className:"space-y-3",children:e.map(e=>{var t,a,s,i,r,d,c,m,u,p;return j.jsx("div",{className:"bg-card border rounded-lg p-4",children:j.jsxs("div",{className:"flex items-center justify-between",children:[j.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(null==(t=e.metadata)?void 0:t.isReceipt)||(null==(a=e.metadata)?void 0:a.isSchedule)?j.jsx("div",{className:"flex-shrink-0",children:j.jsx("img",{src:e.media_url,alt:e.filename,className:"w-12 h-12 rounded-lg object-cover"})}):j.jsx("div",{className:"flex-shrink-0",children:j.jsx(Oe,{className:"text-blue-400",size:20})}),j.jsxs("div",{className:"flex-1 min-w-0",children:[j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx("p",{className:"text-foreground font-medium truncate",children:e.filename}),(null==(s=e.metadata)?void 0:s.isReceipt)&&j.jsx(Xe,{variant:"outline",className:"text-green-400 border-green-400/50",children:"Receipt"}),(null==(i=e.metadata)?void 0:i.isTicket)&&j.jsx(Xe,{variant:"outline",className:"text-blue-400 border-blue-400/50",children:"Ticket"}),(null==(r=e.metadata)?void 0:r.isSchedule)&&j.jsx(Xe,{variant:"outline",className:"text-orange-400 border-orange-400/50",children:"Schedule"})]}),j.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground mb-1",children:[j.jsx("span",{children:o(e.file_size)}),j.jsx("span",{children:"chat"===e.source?"From chat":"Uploaded"}),j.jsx("span",{children:n(e.created_at)}),(null==(d=e.metadata)?void 0:d.extractedEvents)&&j.jsxs(Xe,{variant:"outline",className:"text-orange-400 border-orange-400/50",children:[e.metadata.extractedEvents," events"]})]}),(null==(c=e.metadata)?void 0:c.isReceipt)&&(null==(m=e.metadata)?void 0:m.totalAmount)&&j.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[j.jsxs("div",{className:"flex items-center gap-1",children:[j.jsx(Be,{size:14,className:"text-green-400"}),j.jsxs("span",{className:"text-foreground text-sm font-medium",children:["$",e.metadata.totalAmount.toFixed(2)]})]}),e.metadata.splitCount&&e.metadata.perPersonAmount&&j.jsxs("div",{className:"flex items-center gap-1",children:[j.jsx(Ne,{size:14,className:"text-blue-400"}),j.jsxs("span",{className:"text-muted-foreground text-sm",children:["$",e.metadata.perPersonAmount.toFixed(2)," each (",e.metadata.splitCount," people)"]})]}),e.metadata.preferredMethod&&j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx(Sa,{method:e.metadata.preferredMethod,size:14}),j.jsx("span",{className:"text-muted-foreground text-sm capitalize",children:e.metadata.preferredMethod})]})]})]})]}),j.jsxs("div",{className:"flex items-center gap-2",children:[(null==(u=e.metadata)?void 0:u.isReceipt)&&(null==(p=e.metadata)?void 0:p.perPersonAmount)&&j.jsxs(Ee,{onClick:()=>l(e),size:"sm",className:"bg-gradient-to-r from-green-500 to-emerald-500 text-white hover:from-green-600 hover:to-emerald-600",children:["Pay $",e.metadata.perPersonAmount.toFixed(2)]}),j.jsx(Ee,{variant:"ghost",size:"sm",onClick:()=>window.open(e.media_url,"_blank"),className:"text-muted-foreground hover:text-foreground",children:j.jsx(Re,{size:16})})]})]})},e.id)})})]})}},za=({item:e})=>"image"===e.media_type?j.jsx("div",{className:"group relative aspect-square rounded-lg overflow-hidden bg-muted",children:j.jsx("img",{src:e.media_url,alt:e.filename,className:"w-full h-full object-cover transition-transform group-hover:scale-105"})}):"video"===e.media_type?j.jsx("div",{className:"group relative aspect-square rounded-lg overflow-hidden bg-muted",children:j.jsxs("div",{className:"relative w-full h-full bg-black flex items-center justify-center",children:[j.jsx("video",{src:e.media_url,className:"w-full h-full object-cover",muted:!0,preload:"metadata"}),j.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20",children:j.jsx(yt,{className:"w-12 h-12 text-white"})})]})}):j.jsx("div",{className:"group relative aspect-square rounded-lg overflow-hidden bg-muted",children:j.jsxs("div",{className:"w-full h-full bg-white/10 flex flex-col items-center justify-center p-4",children:[j.jsx(Oe,{className:"w-8 h-8 text-blue-400"}),j.jsx("span",{className:"text-xs text-center mt-2 truncate w-full",children:e.filename})]})}),Ea=({items:e,maxItems:t})=>{const a=t?e.slice(0,t):e;return j.jsxs("div",{className:"space-y-4",children:[j.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:a.map(e=>j.jsx(za,{item:e},e.id))}),t&&e.length>t&&j.jsxs("p",{className:"text-center text-gray-400 text-sm",children:["Showing ",t," of ",e.length," items"]})]})},Aa=({items:e,maxItems:t})=>{const a=t?e.slice(0,t):e;return j.jsxs("div",{className:"space-y-4",children:[j.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:a.map(e=>j.jsxs("div",{className:"group relative aspect-square rounded-lg overflow-hidden bg-muted border border-white/10 p-3 flex flex-col",children:[e.image_url?j.jsx("img",{src:e.image_url,alt:e.title,className:"w-full flex-1 object-cover rounded mb-2"}):j.jsx("div",{className:"w-full flex-1 bg-white/5 rounded mb-2 flex items-center justify-center",children:j.jsx(Ye,{className:"w-8 h-8 text-gray-400"})}),j.jsxs("div",{className:"text-xs",children:[j.jsx("p",{className:"text-white font-medium truncate",children:e.title}),j.jsx("p",{className:"text-gray-400 text-xs",children:e.domain})]})]},e.id))}),t&&e.length>t&&j.jsxs("p",{className:"text-center text-gray-400 text-sm",children:["Showing ",t," of ",e.length," links"]})]})},Oa=({tripId:e,showDetails:t=!0})=>{const{quota:a,loading:s}=(e=>{const{isPlus:t}=v(),{isDemoMode:a}=De(),[s,i]=N.useState({usedMB:0,quotaMB:t?5e4:500,percentUsed:0,isNearLimit:!1,isOverLimit:!1}),[r,o]=N.useState(!0);N.useEffect(()=>{if(a)return i({usedMB:127,quotaMB:500,percentUsed:25.4,isNearLimit:!1,isOverLimit:!1}),void o(!1);l()},[e,t,a]);const l=async()=>{o(!0);try{let a=0;const s=n.from("trip_media_index").select("file_size");e&&s.eq("trip_id",e);const{data:r}=await s;r&&(a=r.reduce((e,t)=>e+(t.file_size||0),0));const o=a/1048576,l=t?5e4:500,d=o/l*100;i({usedMB:Math.round(10*o)/10,quotaMB:l,percentUsed:Math.round(10*d)/10,isNearLimit:d>=80,isOverLimit:d>=100})}catch(a){}finally{o(!1)}};return{quota:s,loading:r,refresh:l,canUpload:!s.isOverLimit||t||a}})(e),{isSubscribed:i,upgradeToTier:r}=v();if(s)return j.jsx("div",{className:"animate-pulse bg-white/5 h-2 rounded-full w-full"});const o=()=>a.isOverLimit?"text-red-400":a.isNearLimit?"text-yellow-400":"text-green-400";return j.jsxs("div",{className:"space-y-2",children:[t&&j.jsxs("div",{className:"flex items-center justify-between text-sm",children:[j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx(pt,{size:16,className:o()}),j.jsxs("span",{className:"text-gray-300",children:["Storage: ",a.usedMB.toFixed(1)," MB / ",a.quotaMB," MB"]})]}),j.jsxs("span",{className:`font-medium ${o()}`,children:[a.percentUsed.toFixed(1),"%"]})]}),j.jsx("div",{className:"relative w-full h-2 bg-white/10 rounded-full overflow-hidden",children:j.jsx("div",{className:`absolute left-0 top-0 h-full ${a.isOverLimit?"bg-red-500":a.isNearLimit?"bg-yellow-500":"bg-green-500"} transition-all duration-500`,style:{width:`${Math.min(a.percentUsed,100)}%`}})}),a.isOverLimit&&!i&&j.jsxs("div",{className:"bg-red-500/20 border border-red-500/30 rounded-lg p-3 flex items-start gap-3",children:[j.jsx(y,{size:20,className:"text-red-400 flex-shrink-0 mt-0.5"}),j.jsxs("div",{className:"flex-1",children:[j.jsx("p",{className:"text-red-300 text-sm font-medium mb-1",children:"Storage Limit Reached"}),j.jsx("p",{className:"text-red-200/80 text-xs mb-2",children:"You've reached your 500 MB storage limit. Upgrade for unlimited storage."}),j.jsxs("button",{onClick:()=>r("explorer","annual"),className:"bg-gradient-to-r from-yellow-400 to-orange-500 text-black px-4 py-1.5 rounded-lg text-xs font-bold hover:scale-105 transition-transform",children:[j.jsx(lt,{size:14,className:"inline mr-1"}),"View Plans"]})]})]}),a.isNearLimit&&!a.isOverLimit&&!i&&j.jsxs("div",{className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-3 flex items-start gap-3",children:[j.jsx(y,{size:20,className:"text-yellow-400 flex-shrink-0 mt-0.5"}),j.jsxs("div",{className:"flex-1",children:[j.jsx("p",{className:"text-yellow-300 text-sm font-medium mb-1",children:"Approaching Storage Limit"}),j.jsxs("p",{className:"text-yellow-200/80 text-xs mb-2",children:["You've used ",a.percentUsed.toFixed(0),"% of your storage. Upgrade for unlimited storage."]}),j.jsxs("button",{onClick:()=>r("explorer","annual"),className:"bg-gradient-to-r from-yellow-400 to-orange-500 text-black px-4 py-1.5 rounded-lg text-xs font-bold hover:scale-105 transition-transform",children:[j.jsx(lt,{size:14,className:"inline mr-1"}),"View Plans"]})]})]}),i&&t&&j.jsx("div",{className:"text-center",children:j.jsx("span",{className:"text-xs text-gray-400",children:"✨ Unlimited storage with your plan"})})]})},La=({tripId:e})=>{const[t,a]=N.useState("all"),{mediaItems:s,linkItems:i,loading:r,getAllItemsSorted:n}=ka(e);return r?j.jsx("div",{className:"flex items-center justify-center py-12",children:j.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}):j.jsxs("div",{className:"space-y-6",children:[j.jsx(Oa,{tripId:e,showDetails:!0}),j.jsxs(tt,{value:t,onValueChange:a,className:"w-full",children:[j.jsxs(at,{className:"grid w-full grid-cols-5 bg-white/5 backdrop-blur-sm",children:[j.jsx(st,{value:"all",className:"text-xs",children:"All"}),j.jsx(st,{value:"photos",className:"text-xs",children:"Photos"}),j.jsx(st,{value:"videos",className:"text-xs",children:"Videos"}),j.jsx(st,{value:"files",className:"text-xs",children:"Files"}),j.jsx(st,{value:"links",className:"text-xs",children:"Links"})]}),j.jsx(it,{value:"all",className:"mt-6",children:(()=>{if(0===s.length&&0===i.length)return j.jsxs("div",{className:"text-center py-12",children:[j.jsx(ue,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),j.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No Media Yet"}),j.jsx("p",{className:"text-muted-foreground",children:"Photos, videos, files, and links shared in chat or uploaded will appear here automatically"})]});const e=n(),t=e.slice(0,8),a=t.filter(e=>"media_type"in e),r=t.filter(e=>!("media_type"in e));return j.jsxs("div",{className:"space-y-4",children:[a.length>0&&j.jsx(Ea,{items:a}),r.length>0&&j.jsx(Aa,{items:r}),e.length>8&&j.jsxs("p",{className:"text-center text-gray-400 text-sm",children:["Showing 8 of ",e.length," items • Use tabs above to filter by type"]})]})})()}),j.jsx(it,{value:"photos",className:"mt-6",children:j.jsx(Pa,{items:s.filter(e=>"image"===e.media_type),type:"photos"})}),j.jsx(it,{value:"videos",className:"mt-6",children:j.jsx(Pa,{items:s.filter(e=>"video"===e.media_type),type:"videos"})}),j.jsx(it,{value:"files",className:"mt-6",children:j.jsx(Pa,{items:s.filter(e=>{var t,a;return"document"===e.media_type||"image"===e.media_type&&((null==(t=e.metadata)?void 0:t.isSchedule)||(null==(a=e.metadata)?void 0:a.isReceipt))}),type:"files"})}),j.jsx(it,{value:"links",className:"mt-6",children:j.jsx(Pa,{items:i,type:"links"})})]})]})};class Ua{static async getTripContext(e,t=!1){try{return t?this.getProTripContext(e):this.getConsumerTripContext(e)}catch(a){throw new Error("Failed to fetch trip context")}}static getConsumerTripContext(e){const t=Ke(parseInt(e));if(!t)throw new Error("Trip not found");const a=Je(t),s=(new Date).toISOString().split("T")[0];return{tripId:e,title:t.title,location:t.location,dateRange:t.dateRange,participants:t.participants.map(e=>({id:e.id.toString(),name:e.name,role:"participant"})),itinerary:a.itinerary.map((e,t)=>({id:t.toString(),title:`Day ${t+1}`,date:e.date,events:e.events})),accommodation:a.basecamp.name,currentDate:s,upcomingEvents:this.getUpcomingEvents(a.itinerary,s),recentUpdates:a.broadcasts.map((e,t)=>({id:t.toString(),type:"broadcast",message:e.content,timestamp:e.timestamp})),confirmationNumbers:{hotel:"HTL-"+Math.random().toString(36).substr(2,9),rental_car:"CAR-"+Math.random().toString(36).substr(2,9),flight:"FLT-"+Math.random().toString(36).substr(2,9)}}}static getProTripContext(e){const t=rt[e];if(!t)throw new Error("Pro trip not found");const a=(new Date).toISOString().split("T")[0];return{tripId:e,title:t.title,location:t.location,dateRange:t.dateRange,participants:t.participants.map(e=>({id:e.id.toString(),name:e.name,role:e.role})),itinerary:(t.itinerary||[]).map((e,t)=>({id:t.toString(),title:`Day ${t+1}`,date:e.date,events:e.events})),accommodation:`${t.location} Accommodation`,currentDate:a,upcomingEvents:this.getUpcomingEvents(t.itinerary||[],a),recentUpdates:[{id:"1",type:"description",message:t.description,timestamp:a}],confirmationNumbers:{venue:"VEN-"+Math.random().toString(36).substr(2,9),transportation:"TRN-"+Math.random().toString(36).substr(2,9)}}}static getUpcomingEvents(e,t){return e.filter(e=>e.date>=t).flatMap(e=>{var t;return(null==(t=e.events)?void 0:t.map(t=>({...t,date:e.date})))||[]}).slice(0,5)}static formatContextForAI(e){const t=e.participants.map(e=>e.name).join(", "),a=e.upcomingEvents.map(e=>`- ${e.title} at ${e.time} (${e.location})`).join("\n"),s=Object.entries(e.confirmationNumbers).map(([e,t])=>`- ${e.replace("_"," ")}: ${t}`).join("\n");return`\nTRIP INFORMATION:\n- Trip: ${e.title}\n- Location: ${e.location}\n- Dates: ${e.dateRange}\n- Participants: ${t}\n- Accommodation: ${e.accommodation||"Not specified"}\n\nTODAY'S DATE: ${e.currentDate}\n\nUPCOMING EVENTS:\n${a||"No upcoming events scheduled"}\n\nCONFIRMATION NUMBERS:\n${s}\n\nRECENT UPDATES:\n${e.recentUpdates.map(e=>`- ${e.message}`).join("\n")}\n    `.trim()}}class Ra{static async getEnhancedTripContext(e,t=!1){try{let a;a=t?await this.getProTripContext(e):await this.getConsumerTripContext(e);return await this.enhanceWithContextualData(a)}catch(a){throw new Error("Failed to fetch enhanced trip context")}}static async getConsumerTripContext(e){const t=Ke(parseInt(e));if(!t)throw new Error("Trip not found");const a=Je(t),s=(new Date).toISOString().split("T")[0];return{tripId:e,title:t.title,location:t.location,dateRange:t.dateRange,participants:t.participants.map(e=>({id:e.id.toString(),name:e.name,role:"participant"})),itinerary:a.itinerary.map((e,t)=>({id:t.toString(),title:`Day ${t+1}`,date:e.date,events:e.events})),accommodation:"object"==typeof a.basecamp?{name:a.basecamp.name,address:a.basecamp.address,checkIn:"",checkOut:""}:a.basecamp,currentDate:s,upcomingEvents:this.getUpcomingEvents(a.itinerary,s),recentUpdates:a.broadcasts.map((e,t)=>({id:t.toString(),type:"broadcast",message:e.content,timestamp:e.timestamp})),confirmationNumbers:{hotel:"HTL-"+Math.random().toString(36).substr(2,9),rental_car:"CAR-"+Math.random().toString(36).substr(2,9),flight:"FLT-"+Math.random().toString(36).substr(2,9)},basecamp:a.basecamp}}static async getProTripContext(e){const t=rt[e];if(!t)throw new Error("Pro trip not found");const a=(new Date).toISOString().split("T")[0];return{tripId:e,title:t.title,location:t.location,dateRange:t.dateRange,participants:t.participants.map(e=>({id:e.id.toString(),name:e.name,role:e.role})),itinerary:(t.itinerary||[]).map((e,t)=>({id:t.toString(),title:`Day ${t+1}`,date:e.date,events:e.events})),accommodation:`${t.location} Accommodation`,currentDate:a,upcomingEvents:this.getUpcomingEvents(t.itinerary||[],a),recentUpdates:[{id:"1",type:"description",message:t.description,timestamp:a}],confirmationNumbers:{venue:"VEN-"+Math.random().toString(36).substr(2,9),transportation:"TRN-"+Math.random().toString(36).substr(2,9)},isPro:!0,proData:{category:t.category||"professional"}}}static async enhanceWithContextualData(e){const t=await this.getTripFiles(e.tripId),a=await this.getTripPhotos(e.tripId),s=await this.getTripLinks(e.tripId),i=await this.getTripPolls(e.tripId),r=await this.getChatHistory(e.tripId),n=await this.getTripReceipts(e.tripId),o=await this.getTripPreferences(e.tripId),l=await this.getTripTasks(e.tripId);if(await this.getTripPayments(e.tripId),await this.getTripCalendar(e.tripId),e.basecamp&&"object"==typeof e.basecamp){const t=e.basecamp;if(t.address&&!t.lat&&!t.lng)try{const e=await this.geocodeAddress(t.address);e&&(t.lat=e.lat,t.lng=e.lng)}catch(p){}}const d=this.analyzeSpendingPatterns(n),c=this.analyzeGroupDynamics(r,i),m=this.extractVisitedPlaces(e.itinerary,a),u=await this.getWeatherContext(e.location);return{...e,files:t,photos:a,links:s,polls:i,chatHistory:r.slice(-20),receipts:n,preferences:o,spendingPatterns:d,groupDynamics:c,visitedPlaces:m,weatherContext:u,tasks:l}}static async geocodeAddress(e){var t;try{const{data:a,error:s}=await n.functions.invoke("google-maps-proxy",{body:{action:"geocode",address:e}});if(s||!(null==(t=null==a?void 0:a.results)?void 0:t[0]))return null;const i=a.results[0].geometry.location;return{lat:i.lat,lng:i.lng}}catch(a){return null}}static async getTripFiles(e){try{const{data:t,error:a}=await n.from("trip_files").select("\n          id,\n          name,\n          file_type,\n          content_text,\n          ai_summary,\n          extracted_events,\n          uploaded_by,\n          created_at\n        ").eq("trip_id",e).order("created_at",{ascending:!1});return a?[]:(t||[]).map(e=>({id:e.id,name:e.name,type:e.file_type,content:e.content_text,extractedEvents:e.extracted_events||0,aiSummary:e.ai_summary,uploadedBy:"Unknown",uploadedAt:e.created_at}))}catch(t){return[]}}static async getTripPhotos(e){return[{id:"photo-1",url:"/src/assets/vacation-beach-group.jpg",caption:"Beach day with the crew! 🏖️",location:"Santa Monica Beach",timestamp:new Date(Date.now()-1728e5).toISOString(),uploadedBy:"Marcus",aiTags:["beach","group","outdoor","sunny","recreational"]},{id:"photo-2",url:"/src/assets/vacation-landmark-selfie.jpg",caption:"Epic group selfie at the landmark!",location:"Hollywood Sign Viewpoint",timestamp:new Date(Date.now()-864e5).toISOString(),uploadedBy:"Sarah",aiTags:["landmark","selfie","group","tourist","scenic"]}]}static async getTripLinks(e){try{const{data:t,error:a}=await n.from("trip_links").select("\n          id,\n          url,\n          title,\n          description,\n          category,\n          votes,\n          added_by,\n          created_at\n        ").eq("trip_id",e).order("votes",{ascending:!1});return a?[]:(t||[]).map(e=>({id:e.id,url:e.url,title:e.title,description:e.description,category:e.category,votes:e.votes||0,addedBy:"Unknown",addedAt:e.created_at}))}catch(t){return[]}}static async getTripPolls(e){try{const{data:t,error:a}=await n.from("trip_polls").select("\n          id,\n          question,\n          options,\n          total_votes,\n          status,\n          created_by,\n          created_at\n        ").eq("trip_id",e).order("created_at",{ascending:!1});return a?[]:(t||[]).map(e=>({id:e.id,question:e.question,options:Array.isArray(e.options)?e.options:[],totalVotes:e.total_votes||0,createdBy:"Unknown",createdAt:e.created_at,status:e.status||"active"}))}catch(t){return[]}}static async getChatHistory(e){try{const{data:t,error:a}=await n.from("trip_chat_messages").select("\n          id,\n          content,\n          author_name,\n          sentiment,\n          created_at\n        ").eq("trip_id",e).order("created_at",{ascending:!1}).limit(50);return a?[]:(t||[]).map(e=>({id:e.id,content:e.content,author:e.author_name,timestamp:e.created_at,sentiment:e.sentiment}))}catch(t){return[]}}static async getTripReceipts(e){return[{id:"receipt-1",amount:156.8,currency:"USD",description:"Dinner at Le Comptoir",category:"food",splitBetween:4,uploadedBy:"Emma",uploadedAt:"2025-01-15T19:30:00Z"},{id:"receipt-2",amount:89.5,currency:"USD",description:"Uber to airport",category:"transport",splitBetween:3,uploadedBy:"Alex",uploadedAt:"2025-01-15T08:15:00Z"}]}static async getTripPreferences(e){try{const{data:t,error:a}=await n.from("trip_preferences").select("*").eq("trip_id",e).maybeSingle();return a||!t?{dietary:[],vibe:[],accessibility:[],business:[],entertainment:[],lifestyle:[],budgetMin:0,budgetMax:1e3,timePreference:"flexible"}:{dietary:t.dietary||[],vibe:t.vibe||[],accessibility:t.accessibility||[],business:t.business||[],entertainment:t.entertainment||[],lifestyle:t.lifestyle||[],budgetMin:t.budget_min||0,budgetMax:t.budget_max||1e3,timePreference:t.time_preference||"flexible"}}catch(t){return{dietary:[],vibe:[],accessibility:[],business:[],entertainment:[],lifestyle:[],budgetMin:0,budgetMax:1e3,timePreference:"flexible"}}}static analyzeSpendingPatterns(e){return{totalSpent:e.reduce((e,t)=>e+t.amount,0),categories:e.reduce((e,t)=>(e[t.category]=(e[t.category]||0)+t.amount,e),{}),avgPerPerson:e.reduce((e,t)=>e+t.amount/t.splitBetween,0)}}static analyzeGroupDynamics(e,t){const a=e.reduce((e,t)=>(e[t.author]=(e[t.author]||0)+1,e),{}),s=Object.entries(a).sort(([,e],[,t])=>t-e).slice(0,3).map(([e])=>e),i=t.filter(e=>"closed"===e.status).map(e=>{const t=e.options.reduce((e,t)=>t.votes>e.votes?t:e);return`${e.question}: ${t.text}`}),r=e.filter(e=>"positive"===e.sentiment).length,n=e.length?r/e.length:0;return{mostActiveParticipants:s,recentDecisions:i,consensusLevel:n>.7?"high":n>.4?"medium":"low"}}static extractVisitedPlaces(e,t){const a=new Set;return e.forEach(e=>{var t;null==(t=e.events)||t.forEach(e=>{e.location&&a.add(e.location)})}),t.forEach(e=>{e.location&&a.add(e.location)}),Array.from(a)}static async getWeatherContext(e){return{current:"Sunny, 72°F",forecast:["Sunny, 75°F","Partly cloudy, 70°F","Sunny, 78°F"]}}static getUpcomingEvents(e,t){return e.filter(e=>e.date>=t).flatMap(e=>{var t;return(null==(t=e.events)?void 0:t.map(t=>({...t,date:e.date})))||[]}).slice(0,5)}static async getTripTasks(e){try{const{data:t,error:a}=await n.from("trip_tasks").select("*").eq("trip_id",e).order("created_at",{ascending:!1});if(a)throw a;return t||[]}catch(t){return[]}}static async getTripPayments(e){try{return[]}catch(t){return[]}}static async getTripCalendar(e){try{const{data:t,error:a}=await n.from("trip_events").select("*").eq("trip_id",e).order("start_date",{ascending:!0});if(a)throw a;return t||[]}catch(t){return[]}}}const $a=({message:e,showMapWidgets:t=!1})=>{const a=e.media_type&&e.media_url,s=e.link_preview,i=e.attachments&&Array.isArray(e.attachments)&&e.attachments.length>0;return j.jsx("div",{className:o("flex","user"===e.type?"justify-end":"justify-start"),children:j.jsxs("div",{className:o("max-w-xs lg:max-w-md","user"===e.type?"":"w-full max-w-lg"),children:[j.jsxs("div",{className:o("px-4 py-3 rounded-2xl","user"===e.type?"bg-gray-800 text-white":"bg-gradient-to-r from-blue-600/20 to-purple-600/20 text-gray-300 border border-blue-500/20"),children:[e.content&&j.jsx("p",{className:"text-sm whitespace-pre-wrap",children:e.content}),(()=>{if(!a)return null;switch(e.media_type){case"image":return j.jsxs("div",{className:"mt-2 relative group",children:[j.jsx("img",{src:e.media_url,alt:"Shared image",className:"rounded-lg max-w-full h-auto cursor-pointer hover:opacity-95 transition-opacity",style:{maxHeight:"400px"},onClick:()=>window.open(e.media_url,"_blank")}),j.jsx("button",{onClick:()=>window.open(e.media_url,"_blank"),className:"absolute top-2 right-2 bg-black/50 text-white p-2 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity","aria-label":"View full size",children:j.jsx(gt,{size:16})})]});case"video":return j.jsx("div",{className:"mt-2 relative",children:j.jsx("video",{src:e.media_url,controls:!0,className:"rounded-lg max-w-full h-auto",style:{maxHeight:"400px"},children:"Your browser does not support the video tag."})});default:return null}})(),i?j.jsx("div",{className:"mt-2 space-y-2",children:e.attachments.map((t,a)=>"file"===t.type?j.jsxs("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 bg-gray-800 hover:bg-gray-700 px-3 py-2 rounded-lg transition-colors",children:[j.jsx(Oe,{size:16,className:"text-gray-400"}),j.jsx("span",{className:"text-sm truncate flex-1",children:e.content||"File attachment"}),j.jsx(Re,{size:14,className:"text-gray-400"})]},a):null)}):null,(()=>{if(!s||"object"!=typeof e.link_preview)return null;const t=e.link_preview;return j.jsxs("a",{href:t.url||e.content,target:"_blank",rel:"noopener noreferrer",className:"mt-2 block bg-gray-800 hover:bg-gray-700 rounded-lg overflow-hidden transition-colors",children:[t.image&&j.jsx("img",{src:t.image,alt:t.title||"Link preview",className:"w-full h-48 object-cover"}),j.jsx("div",{className:"p-3",children:j.jsxs("div",{className:"flex items-start gap-2",children:[j.jsx(Le,{size:14,className:"text-gray-400 mt-0.5 flex-shrink-0"}),j.jsxs("div",{className:"flex-1 min-w-0",children:[j.jsx("h4",{className:"text-sm font-medium text-white truncate",children:t.title||t.domain||"Link"}),t.description&&j.jsx("p",{className:"text-xs text-gray-400 mt-1 line-clamp-2",children:t.description}),j.jsx("p",{className:"text-xs text-gray-500 mt-1",children:t.domain})]})]})})]})})()]}),j.jsx("div",{className:"flex items-center gap-2 mt-1 px-2",children:j.jsx("span",{className:"text-xs text-gray-500",children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})})]})})},Fa=({messages:e,isTyping:t,showMapWidgets:a=!1})=>0===e.length?j.jsxs("div",{className:"text-center py-8",children:[j.jsx(F,{size:48,className:"text-gray-600 mx-auto mb-4"}),j.jsx("h4",{className:"text-lg font-medium text-gray-400 mb-2",children:"Start the conversation"}),j.jsx("p",{className:"text-gray-500 text-sm",children:"Send a message to get the chat started!"})]}):j.jsxs(j.Fragment,{children:[e.map(e=>{const t=e;return j.jsxs("div",{className:"space-y-2",children:[j.jsx($a,{message:e,showMapWidgets:a}),a&&t.googleMapsWidget&&j.jsx("div",{className:"flex "+("user"===e.type?"justify-end":"justify-start"),children:j.jsx(Xt,{widgetToken:t.googleMapsWidget})}),t.sources&&t.sources.length>0&&j.jsx("div",{className:"flex "+("user"===e.type?"justify-end":"justify-start"),children:j.jsxs("div",{className:"space-y-1 px-2 max-w-xs lg:max-w-md",children:[j.jsxs("div",{className:"text-xs font-medium text-gray-400 flex items-center gap-2",children:[j.jsx("span",{children:"Sources:"}),t.sources.some(e=>"google_maps_grounding"===e.source)&&j.jsx("span",{className:"bg-blue-500/20 text-blue-400 px-2 py-0.5 rounded text-[10px]",children:"Verified by Google Maps"})]}),t.sources.map((e,t)=>j.jsx("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"block text-xs text-blue-400 hover:text-blue-300",children:e.title},t))]})})]},e.id)}),t&&j.jsx("div",{className:"flex justify-start",children:j.jsx("div",{className:"bg-gradient-to-r from-blue-600/20 to-purple-600/20 rounded-2xl p-4 border border-blue-500/20",children:j.jsxs("div",{className:"flex space-x-1",children:[j.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce"}),j.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),j.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})})]}),qa=({inputMessage:e,onInputChange:t,onSendMessage:a,onKeyPress:s,isTyping:i,disabled:r=!1})=>j.jsxs("div",{className:"flex gap-3 items-end",children:[j.jsx("textarea",{value:e,onChange:e=>t(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey?s(e):(e.preventDefault(),a())},placeholder:"Ask about your trip...",rows:2,disabled:r,className:"flex-1 bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-blue-500 resize-none disabled:opacity-50 disabled:cursor-not-allowed"}),j.jsx("button",{onClick:a,disabled:!e.trim()||i||r,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white p-3 rounded-full transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:j.jsx(Ue,{size:16})})]});const Va=new class{constructor(){t(this,"storageKey","concierge-usage")}getDailyLimit(e){return"pro"===e?1/0:"plus"===e?50:5}async getUsage(e,t,a="free"){if(await Ce.isDemoModeEnabled())return this.getUsageFromStorage(e,t,a);const s=new Date;s.setHours(0,0,0,0);const{data:i,error:r}=await n.from("concierge_usage").select("id").eq("user_id",e).eq("context_type","event").eq("context_id",t).gte("created_at",s.toISOString());if(r)return this.getUsageFromStorage(e,t,a);const o=(null==i?void 0:i.length)||0,l=this.getNextMidnight();return{userId:e,eventId:t,queriesUsed:o,dailyLimit:this.getDailyLimit(a),resetAt:l}}getUsageFromStorage(e,t,a){const s=this.loadFromStorage(),i=`${e}-${t}`,r=s[i];if(r&&new Date(r.resetAt)>new Date)return r;const n=this.getNextMidnight(),o={userId:e,eventId:t,queriesUsed:0,dailyLimit:this.getDailyLimit(a),resetAt:n};return s[i]=o,this.saveToStorage(s),o}async incrementUsage(e,t,a="free"){const s=await this.getUsage(e,t,a);if("pro"!==a&&s.queriesUsed>=s.dailyLimit)throw new Error("Daily query limit reached");if(await Ce.isDemoModeEnabled()){s.queriesUsed++;const a=this.loadFromStorage();return a[`${e}-${t}`]=s,this.saveToStorage(a),s}const{error:i}=await n.from("concierge_usage").insert({user_id:e,context_type:"event",context_id:t,query_count:1});if(i){s.queriesUsed++;const a=this.loadFromStorage();a[`${e}-${t}`]=s,this.saveToStorage(a)}else s.queriesUsed++;return s}async canQuery(e,t,a="free"){if("pro"===a)return!0;const s=await this.getUsage(e,t,a);return s.queriesUsed<s.dailyLimit}async getRemainingQueries(e,t,a){if("pro"===a)return 1/0;const s=await this.getUsage(e,t,a);return Math.max(0,s.dailyLimit-s.queriesUsed)}async getTimeUntilReset(e,t,a){const s=await this.getUsage(e,t,a),i=new Date,r=new Date(s.resetAt),n=Math.ceil((r.getTime()-i.getTime())/36e5);return 1===n?"1 hour":n<24?`${n} hours`:"tomorrow"}getNextMidnight(){const e=new Date;return e.setDate(e.getDate()+1),e.setHours(0,0,0,0),e.toISOString()}loadFromStorage(){try{const e=localStorage.getItem(this.storageKey);return e?JSON.parse(e):{}}catch{return{}}}saveToStorage(e){try{const t=new Date,a=Object.entries(e).reduce((e,[a,s])=>(new Date(s.resetAt)>t&&(e[a]=s),e),{});localStorage.setItem(this.storageKey,JSON.stringify(a))}catch(t){}}resetUsage(e,t){const a=this.loadFromStorage();delete a[`${e}-${t}`],this.saveToStorage(a)}},Ba=({tripId:e,basecamp:t,preferences:a,isDemoMode:s=!1,isEvent:i=!1})=>{const{isPlus:o}=v(),{basecamp:l}=w(),{user:d}=r(),{usage:c,getUsageStatus:u,formatTimeUntilReset:p,isFreeUser:h,upgradeUrl:g}=(()=>{const{user:e}=r(),t=null==e?void 0:e.id,{data:a}=Qe({queryKey:["user-profile",t],queryFn:async()=>{if(!t)return null;const{data:e,error:a}=await n.from("profiles").select("app_role").eq("id",t).single();return a?null:e},enabled:!!t,staleTime:3e5}),s=(i=null==a?void 0:a.app_role)&&"consumer"!==i?"plus"===i?"plus":"pro"===i||"enterprise"===i||"advertiser"===i?"pro":"free":"free";var i;const o=(e=>{switch(e){case"pro":return-1;case"plus":return 50;default:return 10}})(s),{data:l,isLoading:d,error:c,refetch:m}=Qe({queryKey:["concierge-usage",t,s],queryFn:async()=>{if(!t)return{dailyCount:0,limit:10,remaining:10,isLimitReached:!1,resetTime:(new Date).toISOString()};if(-1===o)return{dailyCount:0,limit:-1,remaining:-1,isLimitReached:!1,resetTime:(new Date).toISOString()};const e=new Date;e.setHours(0,0,0,0);const a=await n.from("concierge_usage").select("id").eq("user_id",t).gte("created_at",e.toISOString()),{data:s,error:i}=a;if(i)return{dailyCount:0,limit:o,remaining:o,isLimitReached:!1,resetTime:(new Date).toISOString()};const r=(null==s?void 0:s.length)||0,l=Math.max(0,o-r),d=r>=o,c=new Date;return c.setDate(c.getDate()+1),c.setHours(0,0,0,0),{dailyCount:r,limit:o,remaining:l,isLimitReached:d,resetTime:c.toISOString()}},enabled:!!t,staleTime:3e4,refetchInterval:6e4});return{usage:l,isLoading:d,error:c,refetch:m,formatTimeUntilReset:e=>{const t=new Date,a=new Date(e).getTime()-t.getTime();if(a<=0)return"Reset now";const s=Math.floor(a/36e5),i=Math.floor(a%36e5/6e4);return s>0?`${s}h ${i}m`:`${i}m`},getUsageStatus:()=>l?l.isLimitReached?{status:"limit_reached",message:`Daily limit reached (${l.dailyCount}/${l.limit})`,color:"text-red-500"}:l.remaining<=2?{status:"warning",message:`${l.remaining} queries remaining today`,color:"text-yellow-500"}:{status:"ok",message:`${l.remaining} queries remaining today`,color:"text-green-500"}:{status:"ok",message:"Loading usage data...",color:"text-gray-500"},isFreeUser:"free"===s,userTier:s,upgradeUrl:(u=s,"free"===u?"/settings/billing?plan=plus":"plus"===u?"/settings/billing?plan=pro":"/settings/billing")};var u})(),[x,f]=N.useState([]),[b,y]=N.useState(""),[_,k]=N.useState(!1),[S,C]=N.useState("connected"),[D,M]=N.useState(1/0),T=N.useRef(!0),I=()=>(null==d?void 0:d.isPro)?"pro":o?"plus":"free";N.useEffect(()=>(T.current=!0,()=>{T.current=!1}),[]),N.useEffect(()=>{i&&d&&Va.getRemainingQueries(d.id,e,I()).then(e=>{T.current&&M(e)}).catch(e=>{})},[i,d,e,o]);const P=async()=>{if(!b.trim()||_)return;if(i&&d){if(!(await Va.canQuery(d.id,e,I()))){await Va.getRemainingQueries(d.id,e,I());const t=await Va.getTimeUntilReset(d.id,e,I());return void f(e=>[...e,{id:Date.now().toString(),type:"assistant",content:`⚠️ You've reached your daily limit of 5 AI Concierge queries for this event. Your limit will reset in ${t}.\n\n💎 Upgrade to Chravel+ for unlimited AI assistance!`,timestamp:(new Date).toISOString()}])}}const r={id:Date.now().toString(),type:"user",content:b,timestamp:(new Date).toISOString()};f(e=>[...e,r]);const o=b;y(""),k(!0),C("thinking");try{let r;try{r=await Ra.getEnhancedTripContext(e,!1)}catch(c){try{r=await Ua.getTripContext(e,!1)}catch(m){r={tripId:e,title:"Current Trip",location:(null==l?void 0:l.address)||(null==t?void 0:t.address)||"Unknown location",dateRange:(new Date).toISOString().split("T")[0],participants:[],itinerary:[],accommodation:(null==l?void 0:l.name)||(null==t?void 0:t.name),currentDate:(new Date).toISOString().split("T")[0],upcomingEvents:[],recentUpdates:[],confirmationNumbers:{}}}}const p=x.slice(-6).map(e=>({role:"user"===e.type?"user":"assistant",content:e.content})),h=l?{name:l.name||"Basecamp",address:l.address}:t?{name:t.name||"Basecamp",address:t.address}:void 0;let g=0;const b=2;let y,v;for(;g<=b;)try{const e=await n.functions.invoke("lovable-concierge",{body:{message:o,tripContext:r,basecampLocation:h,preferences:a,chatHistory:p,isDemoMode:s}});if(y=e.data,v=e.error,v&&g<b){g++,await new Promise(e=>setTimeout(e,1e3*g));continue}if(v)throw v;break}catch(u){if(g<b){g++,await new Promise(e=>setTimeout(e,1e3*g));continue}throw u}if(C("connected"),i&&d)try{await Va.incrementUsage(d.id,e,I());const t=await Va.getRemainingQueries(d.id,e,I());T.current&&M(t)}catch(c){}const w={id:(Date.now()+1).toString(),type:"assistant",content:y.response||"Sorry, I encountered an error processing your request.",timestamp:(new Date).toISOString(),usage:y.usage,sources:y.sources||y.citations,googleMapsWidget:y.googleMapsWidget};f(e=>[...e,w])}catch(p){C("error");const e={id:(Date.now()+1).toString(),type:"assistant",content:"I'm having trouble connecting to my AI services right now. Please try again in a moment.",timestamp:(new Date).toISOString()};f(t=>[...t,e])}finally{k(!1)}};return j.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-6",children:[j.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[j.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:j.jsx(m,{size:20,className:"text-white"})}),j.jsxs("div",{className:"flex-1",children:[j.jsx("h3",{className:"text-lg font-semibold text-white",children:"AI Concierge"}),j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsxs("div",{className:"flex items-center gap-1",children:[j.jsx(dt,{size:16,className:"text-green-400"}),j.jsx("span",{className:"text-xs text-green-400",children:"Ready with Web Search"})]}),h&&c&&j.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[j.jsx(Xe,{variant:"limit_reached"===u().status?"destructive":"warning"===u().status?"secondary":"default",className:"text-xs",children:u().message}),"limit_reached"===u().status&&j.jsxs(Ee,{size:"sm",variant:"outline",className:"text-xs h-6 px-2",onClick:()=>window.open(g,"_blank"),children:[j.jsx(lt,{size:12,className:"mr-1"}),"Upgrade"]})]}),i&&!o&&d&&D!==1/0&&j.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[j.jsx(xe,{size:16,className:D<=2?"text-orange-400":"text-blue-400"}),j.jsxs("span",{className:"text-xs "+(D<=2?"text-orange-400":"text-blue-400"),children:[D," ",1===D?"query":"queries"," left today"]})]})]})]})]}),h&&(null==c?void 0:c.isLimitReached)&&j.jsxs("div",{className:"text-center py-8 mb-6",children:[j.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-orange-500 to-red-500 rounded-full flex items-center justify-center mx-auto mb-4",children:j.jsx(lt,{size:24,className:"text-white"})}),j.jsx("h4",{className:"text-white font-medium mb-3",children:"Daily Limit Reached"}),j.jsxs("div",{className:"text-sm text-gray-300 space-y-3 max-w-md mx-auto",children:[j.jsxs("p",{children:["You've used all ",c.limit," free AI queries today."]}),j.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs text-gray-400",children:[j.jsx(ke,{size:14}),j.jsxs("span",{children:["Resets in ",p(c.resetTime)]})]}),j.jsx("div",{className:"mt-4",children:j.jsxs(Ee,{onClick:()=>window.open(g,"_blank"),className:"bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600",children:[j.jsx(lt,{size:16,className:"mr-2"}),"Upgrade to Pro for Unlimited Access"]})})]})]}),0===x.length&&!(h&&(null==c?void 0:c.isLimitReached))&&j.jsxs("div",{className:"text-center py-4 mb-4",children:[j.jsx("h4",{className:"text-white font-medium mb-3",children:"Your AI Travel Concierge"}),j.jsxs("div",{className:"text-sm text-gray-300 space-y-1 max-w-md mx-auto",children:[j.jsx("p",{children:"Ask me anything about your trip:"}),j.jsxs("div",{className:"text-xs text-gray-400 space-y-1",children:[j.jsx("p",{children:'• "What are the best restaurants for our group?"'}),j.jsx("p",{children:'• "Suggest activities based on our preferences"'}),j.jsx("p",{children:'• "Help me plan our itinerary"'}),j.jsx("p",{children:'• "What hidden gems should we check out?"'})]}),j.jsx("div",{className:"mt-3 text-xs text-green-400 bg-green-500/10 rounded px-3 py-2 inline-block",children:"✨ Powered by AI - ask me anything!"})]})]}),j.jsx("div",{className:"space-y-2 mb-4 max-h-[300px] overflow-y-auto",children:j.jsx(Fa,{messages:x,isTyping:_,showMapWidgets:!0})}),j.jsx(qa,{inputMessage:b,onInputChange:y,onSendMessage:P,onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),P())},isTyping:_,disabled:"error"===S||h&&(null==c?void 0:c.isLimitReached)})]})},Ha=({tripId:e,tripName:t,users:a,currentUserId:i,onUserRemoved:n,onLeaveTrip:o})=>{r();const[l,d]=N.useState(!1),[c,m]=N.useState(null),[u,p]=N.useState(null),h=a.find(e=>e.id===i),g="owner"===(null==h?void 0:h.role),x="admin"===(null==h?void 0:h.role)||g,f=e=>{switch(e){case"owner":return"bg-yellow-500/20 text-yellow-300 border-yellow-500/30";case"admin":return"bg-blue-500/20 text-blue-300 border-blue-500/30";default:return"bg-gray-500/20 text-gray-300 border-gray-500/30"}};return j.jsxs(j.Fragment,{children:[j.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl p-6",children:[j.jsxs("div",{className:"flex items-center justify-between mb-6",children:[j.jsxs("div",{children:[j.jsx("h3",{className:"text-lg font-semibold text-white",children:"Trip Members"}),j.jsxs("p",{className:"text-gray-400 text-sm",children:[a.length," people in this trip"]})]}),j.jsxs("button",{onClick:()=>d(!0),className:"flex items-center gap-2 bg-red-600/20 hover:bg-red-600/30 border border-red-500/30 text-red-300 px-4 py-2 rounded-xl transition-colors",children:[j.jsx(He,{size:16}),j.jsx("span",{className:"hidden sm:inline",children:"Leave Trip"})]})]}),j.jsx("div",{className:"space-y-3",children:a.map(e=>{return j.jsxs("div",{className:"flex items-center justify-between bg-white/5 border border-white/10 rounded-xl p-4",children:[j.jsxs("div",{className:"flex items-center gap-3",children:[j.jsx("img",{src:e.avatar,alt:e.name,className:"w-10 h-10 rounded-full border-2 border-white/20"}),j.jsxs("div",{children:[j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx("span",{className:"text-white font-medium",children:e.name}),e.id===i&&j.jsx("span",{className:"text-xs bg-glass-orange/20 text-glass-orange px-2 py-1 rounded",children:"You"})]}),j.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.role&&j.jsx("span",{className:`text-xs px-2 py-1 rounded border ${f(e.role)}`,children:e.role}),j.jsxs("span",{className:"text-xs text-gray-400",children:["Joined ",new Date(e.joinedAt).toLocaleDateString()]})]})]})]}),(t=e,!(t.id===i||"owner"===t.role||!g&&(!x||"admin"===t.role))&&j.jsxs("div",{className:"relative",children:[j.jsx("button",{onClick:()=>p(u===e.id?null:e.id),className:"text-gray-400 hover:text-white p-2 rounded-lg hover:bg-white/10 transition-colors",children:j.jsx(ct,{size:16})}),u===e.id&&j.jsx("div",{className:"absolute right-0 top-full mt-2 bg-gray-900/95 backdrop-blur-md border border-gray-700 rounded-xl shadow-xl z-10 min-w-[180px]",children:j.jsxs("button",{onClick:()=>m(e),className:"w-full flex items-center gap-3 px-4 py-3 text-red-300 hover:bg-red-500/10 rounded-xl transition-colors",children:[j.jsx(bt,{size:16}),"Remove from trip"]})})]}))]},e.id);var t})})]}),l&&j.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:j.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-8 max-w-md w-full",children:[j.jsxs("div",{className:"flex items-center gap-3 text-red-400 mb-4",children:[j.jsx(y,{size:24}),j.jsx("h3",{className:"text-xl font-bold text-white",children:"Leave Trip?"})]}),j.jsxs("p",{className:"text-gray-300 mb-6",children:['Are you sure you want to leave "',t,"\"? You'll lose access to all trip information and won't receive updates."]}),j.jsxs("div",{className:"flex gap-3",children:[j.jsx("button",{onClick:()=>d(!1),className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-3 rounded-xl transition-colors",children:"Cancel"}),j.jsx("button",{onClick:()=>{o(),d(!1)},className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-3 rounded-xl transition-colors",children:"Leave Trip"})]})]})}),c&&j.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:j.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-8 max-w-md w-full",children:[j.jsxs("div",{className:"flex items-center justify-between mb-4",children:[j.jsxs("div",{className:"flex items-center gap-3 text-red-400",children:[j.jsx(bt,{size:24}),j.jsx("h3",{className:"text-xl font-bold text-white",children:"Remove User?"})]}),j.jsx("button",{onClick:()=>m(null),className:"text-gray-400 hover:text-white",children:j.jsx(s,{size:20})})]}),j.jsxs("div",{className:"flex items-center gap-3 bg-white/5 border border-white/10 rounded-xl p-4 mb-6",children:[j.jsx("img",{src:c.avatar,alt:c.name,className:"w-10 h-10 rounded-full border-2 border-white/20"}),j.jsxs("div",{children:[j.jsx("span",{className:"text-white font-medium",children:c.name}),c.role&&j.jsx("div",{className:`text-xs px-2 py-1 rounded border mt-1 inline-block ${f(c.role)}`,children:c.role})]})]}),j.jsxs("p",{className:"text-gray-300 mb-6",children:["Are you sure you want to remove ",c.name,' from "',t,"\"? They'll lose access to all trip information."]}),j.jsxs("div",{className:"flex gap-3",children:[j.jsx("button",{onClick:()=>m(null),className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-3 rounded-xl transition-colors",children:"Cancel"}),j.jsx("button",{onClick:()=>(n(c.id),m(null),void p(null)),className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-3 rounded-xl transition-colors",children:"Remove User"})]})]})}),u&&j.jsx("div",{className:"fixed inset-0 z-5",onClick:()=>p(null)})]})},Wa=["Sports – Pro, Collegiate, Youth","Tour – Music, Comedy, etc.","Business Travel","School Trip","Content","Other"],Ga=({isOpen:e,onClose:t,tripId:a,tripName:i,currentUserId:r})=>{const[n,o]=N.useState("users"),[l,d]=N.useState("Business Travel"),[m,u]=N.useState(""),[p,h]=N.useState(!1),[g,x]=N.useState([{id:"1",name:"Emma Wilson",avatar:"https://images.unsplash.com/photo-1494790108755-2616b612b47c?w=40&h=40&fit=crop&crop=face",role:"owner",joinedAt:"2024-01-15"},{id:"2",name:"Jake Thompson",avatar:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=40&h=40&fit=crop&crop=face",role:"admin",joinedAt:"2024-01-16"},{id:"3",name:"Sarah Chen",avatar:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=40&h=40&fit=crop&crop=face",role:"member",joinedAt:"2024-01-18"},{id:"4",name:"You",avatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face",role:"member",joinedAt:"2024-01-20"}]);if(!e)return null;const f=[{id:"users",label:"Members",icon:Ne},{id:"general",label:"General",icon:c},{id:"danger",label:"Danger Zone",icon:ge}];return j.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50",children:j.jsxs("div",{className:"flex h-full",children:[j.jsxs("div",{className:"w-80 bg-white/5 backdrop-blur-md border-r border-white/10 p-6",children:[j.jsxs("div",{className:"flex items-center justify-between mb-8",children:[j.jsx("h2",{className:"text-xl font-bold text-white",children:"Trip Settings"}),j.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white p-2 rounded-lg hover:bg-white/10 transition-colors",children:j.jsx(s,{size:20})})]}),j.jsx("div",{className:"space-y-2",children:f.map(e=>{const t=e.icon;return j.jsxs("button",{onClick:()=>o(e.id),className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-colors "+(n===e.id?"bg-glass-orange/20 text-glass-orange border border-glass-orange/30":"text-gray-300 hover:text-white hover:bg-white/10"),children:[j.jsx(t,{size:20}),e.label]},e.id)})})]}),j.jsx("div",{className:"flex-1 overflow-y-auto",children:j.jsxs("div",{className:"p-8",children:["users"===n&&j.jsx(Ha,{tripId:a,tripName:i,users:g,currentUserId:r,onUserRemoved:e=>{x(g.filter(t=>t.id!==e))},onLeaveTrip:()=>{t()}}),"general"===n&&j.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl p-6",children:[j.jsx("h3",{className:"text-lg font-semibold text-white mb-6",children:"General Settings"}),j.jsxs("div",{className:"mb-6",children:[j.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Trip Category"}),j.jsx("select",{value:p?"Other":l,onChange:e=>{var t;"Other"===(t=e.target.value)?(h(!0),d("")):(h(!1),d(t),u(""))},className:"w-full bg-gray-800/50 border border-gray-600 text-white rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-glass-orange/50 focus:border-glass-orange/50",children:Wa.map(e=>j.jsx("option",{value:e,children:e},e))}),p&&j.jsx("div",{className:"mt-3",children:j.jsx("input",{type:"text",value:m,onChange:e=>u(e.target.value),placeholder:"Enter custom category...",className:"w-full bg-gray-800/50 border border-gray-600 text-white rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-glass-orange/50 focus:border-glass-orange/50"})}),j.jsx("button",{onClick:()=>{},className:"mt-3 bg-glass-orange hover:bg-glass-orange/80 text-white px-6 py-2 rounded-xl transition-colors font-medium",children:"Save Category"})]}),j.jsxs("div",{className:"mb-6",children:[j.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Trip Name"}),j.jsx("input",{type:"text",defaultValue:i,className:"w-full bg-gray-800/50 border border-gray-600 text-white rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-glass-orange/50 focus:border-glass-orange/50"})]}),j.jsxs("div",{className:"mb-6",children:[j.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Description"}),j.jsx("textarea",{rows:4,placeholder:"Describe your trip...",className:"w-full bg-gray-800/50 border border-gray-600 text-white rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-glass-orange/50 focus:border-glass-orange/50 resize-none"})]})]}),"danger"===n&&j.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-red-500/20 rounded-2xl p-6",children:[j.jsx("h3",{className:"text-lg font-semibold text-red-300 mb-4",children:"Danger Zone"}),j.jsx("p",{className:"text-gray-400 mb-6",children:"These actions are irreversible."}),j.jsx("button",{className:"bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-xl transition-colors",children:"Delete Trip"})]})]})})]})})},Ya=({isOpen:e,onClose:t})=>{const{upgradeToTier:a,isLoading:i}=v(),[r,n]=N.useState("explorer"),[o,l]=N.useState("annual");if(!e)return null;return j.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:j.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[j.jsxs("div",{className:"flex items-center justify-between mb-6",children:[j.jsxs("div",{className:"flex items-center gap-3",children:[j.jsxs("div",{className:"w-12 h-12 rounded-2xl flex items-center justify-center "+("explorer"===r?"bg-gradient-to-r from-glass-orange to-glass-yellow":"bg-gradient-to-r from-purple-500 to-purple-600"),children:["explorer"===r&&j.jsx(We,{size:24,className:"text-white"}),"frequent-chraveler"===r&&j.jsx(H,{size:24,className:"text-white"})]}),j.jsxs("div",{children:[j.jsxs("h2",{className:"text-3xl font-bold text-white capitalize",children:["Upgrade to ",r]}),j.jsxs("p",{className:"text-gray-400",children:["explorer"===r&&"Never lose a trip memory","frequent-chraveler"===r&&"For travel pros and adventure enthusiasts"]})]})]}),j.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white transition-colors",children:j.jsx(s,{size:24})})]}),j.jsx("div",{className:"flex justify-center gap-2 mb-6",children:["explorer","frequent-chraveler"].map(e=>j.jsx("button",{onClick:()=>n(e),className:"px-4 py-2 rounded-xl font-medium transition-all capitalize "+(r===e?"bg-gradient-to-r from-glass-orange to-glass-yellow text-white":"text-gray-300 hover:text-white bg-white/5"),children:"frequent-chraveler"===e?"Frequent Chraveler":e},e))}),j.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-8",children:[j.jsxs("div",{className:"bg-gradient-to-br from-blue-500/10 to-purple-500/10 border border-blue-500/20 rounded-2xl p-6",children:[j.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl flex items-center justify-center mb-4",children:j.jsx(H,{size:24,className:"text-white"})}),j.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Concierge"}),j.jsx("p",{className:"text-gray-300 text-sm",children:"Chat with AI for personalized recommendations based on your location and preferences."})]}),j.jsxs("div",{className:"bg-gradient-to-br from-green-500/10 to-teal-500/10 border border-green-500/20 rounded-2xl p-6",children:[j.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-green-500 to-teal-500 rounded-xl flex items-center justify-center mb-4",children:j.jsx(c,{size:24,className:"text-white"})}),j.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Smart Preferences"}),j.jsx("p",{className:"text-gray-300 text-sm",children:"Set dietary, vibe, budget, and time preferences to get tailored suggestions for your entire group."})]}),j.jsxs("div",{className:"bg-gradient-to-br from-orange-500/10 to-red-500/10 border border-orange-500/20 rounded-2xl p-6",children:[j.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-orange-500 to-red-500 rounded-xl flex items-center justify-center mb-4",children:j.jsx(B,{size:24,className:"text-white"})}),j.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Basecamp Intelligence"}),j.jsx("p",{className:"text-gray-300 text-sm",children:"Get location-aware recommendations within walking distance or perfect travel time from your basecamp."})]}),j.jsxs("div",{className:"bg-gradient-to-br from-purple-500/10 to-pink-500/10 border border-purple-500/20 rounded-2xl p-6",children:[j.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl flex items-center justify-center mb-4",children:j.jsx(F,{size:24,className:"text-white"})}),j.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Contextual Chat"}),j.jsx("p",{className:"text-gray-300 text-sm",children:"Real-time assistance for planning activities, finding restaurants, and making the most of your trip."})]}),j.jsxs("div",{className:"bg-gradient-to-br from-cyan-500/10 to-blue-500/10 border border-cyan-500/20 rounded-2xl p-6",children:[j.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-xl flex items-center justify-center mb-4",children:j.jsx(ue,{size:24,className:"text-white"})}),j.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Photo Sharing"}),j.jsx("p",{className:"text-gray-300 text-sm",children:"Share and organize trip photos with your group in beautiful albums and memories."})]})]}),j.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-6 mb-8",children:[j.jsxs("h3",{className:"text-lg font-bold text-white mb-4",children:["Free vs. ","explorer"===r?"Explorer":"Frequent Chraveler"]}),j.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[j.jsxs("div",{children:[j.jsx("h4",{className:"text-white font-medium mb-3",children:"Free Plan"}),j.jsxs("ul",{className:"space-y-2 text-sm text-gray-400",children:[j.jsx("li",{children:"• Up to 3 active trips"}),j.jsx("li",{children:"• Basic group chat"}),j.jsx("li",{children:"• Shared calendar (manual)"}),j.jsx("li",{children:"• Photo & video sharing"}),j.jsx("li",{children:"• 5 AI queries per user per trip"})]})]}),j.jsxs("div",{children:[j.jsx("h4",{className:"text-white font-medium mb-3",children:"explorer"===r?"Explorer":"Frequent Chraveler"}),"explorer"===r?j.jsxs("ul",{className:"space-y-2 text-sm text-green-300",children:[j.jsx("li",{children:"• Unlimited saved trips"}),j.jsx("li",{children:"• 10 AI queries per trip"}),j.jsx("li",{children:"• Location-aware AI"}),j.jsx("li",{children:"• Custom trip categories"}),j.jsx("li",{children:"• Smart notifications"}),j.jsx("li",{children:"• Priority support"})]}):j.jsxs("ul",{className:"space-y-2 text-sm text-purple-300",children:[j.jsx("li",{children:"• Everything in Explorer"}),j.jsx("li",{children:"• Unlimited AI queries"}),j.jsx("li",{children:"• Calendar sync & PDF export"}),j.jsx("li",{children:"• 1 Chravel Pro trip/month"}),j.jsx("li",{children:"• Role-based channels"}),j.jsx("li",{children:"• Route optimization"}),j.jsx("li",{children:"• Early feature access"})]})]})]})]}),j.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[j.jsx("span",{className:"text-sm "+("monthly"===o?"text-white font-medium":"text-gray-400"),children:"Monthly"}),j.jsx("button",{onClick:()=>l("monthly"===o?"annual":"monthly"),className:"relative w-12 h-6 bg-gray-700 rounded-full transition-colors",children:j.jsx("div",{className:"absolute top-1 w-4 h-4 bg-glass-orange rounded-full transition-transform "+("annual"===o?"translate-x-7":"translate-x-1")})}),j.jsx("span",{className:"text-sm "+("annual"===o?"text-white font-medium":"text-gray-400"),children:"Annual"}),"annual"===o&&j.jsx("div",{className:"bg-green-500/20 text-green-400 px-2 py-1 rounded-lg text-xs font-medium",children:"Save 17%"})]}),j.jsxs("div",{className:"text-center",children:[j.jsxs("div",{className:"bg-gradient-to-r from-glass-orange/20 to-glass-yellow/20 backdrop-blur-sm border border-glass-orange/30 rounded-2xl p-6 mb-6",children:[j.jsxs("div",{className:"text-4xl font-bold text-white mb-2",children:["$",(()=>{const e=W[r];return"monthly"===o?e.monthly:e.annual})(),"monthly"===o?"/month":"/year"]}),"annual"===o&&j.jsxs(j.Fragment,{children:[j.jsxs("div",{className:"text-sm text-gray-300 mb-1",children:["$",(W[r].annual/12).toFixed(2),"/month when billed annually"]}),j.jsxs("div",{className:"text-green-400 text-sm mb-2",children:["Save $",W[r].savings,"/year (17% off)"]})]}),j.jsx("p",{className:"text-gray-300 mb-4",children:"14-day free trial • Cancel anytime"}),j.jsx("div",{className:"text-sm text-glass-yellow",children:"No credit card required for trial"})]}),j.jsxs("div",{className:"flex gap-4 justify-center",children:[j.jsx("button",{onClick:t,className:"px-8 py-3 bg-white/10 backdrop-blur-md border border-white/20 hover:bg-white/20 text-white rounded-2xl transition-all duration-200 font-medium",children:"Maybe Later"}),j.jsx("button",{onClick:async()=>{await a(r,o),t()},disabled:i,className:"px-8 py-3 bg-gradient-to-r from-glass-orange to-glass-yellow hover:from-glass-orange/80 hover:to-glass-yellow/80 text-white font-medium rounded-2xl transition-all duration-200 hover:scale-105 shadow-lg disabled:opacity-50",children:i?"Processing...":"Start Free Trial"})]})]})]})})},Ka=({showSettings:e,onCloseSettings:t,showInvite:a,onCloseInvite:s,showAuth:i,onCloseAuth:r,showTripSettings:n,onCloseTripSettings:o,showTripsPlusModal:l,onCloseTripsPlusModal:d,tripName:c,tripId:m,userId:u})=>j.jsxs(j.Fragment,{children:[j.jsx(G,{isOpen:e,onClose:t}),j.jsx(M,{isOpen:a,onClose:s,tripName:c,tripId:m}),j.jsx(L,{isOpen:i,onClose:r}),j.jsx(Ga,{isOpen:n,onClose:o,tripId:m,tripName:c,currentUserId:u||"4"}),j.jsx(Ya,{isOpen:l,onClose:d})]});export{Ba as A,Wt as C,pa as G,Yt as I,aa as M,qt as P,Oa as S,oa as T,La as U,Jt as V,ea as a,ka as b,Ut as c,Lt as d,Rt as e,wa as f,Pt as g,zt as h,Ka as i,Nt as j,mt as k,sa as l,Da as m,$t as u};
