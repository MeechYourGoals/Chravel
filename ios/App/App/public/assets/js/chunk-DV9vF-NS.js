var t,e,s,i,r,n,a,h,o,l,u,c,d,p,f,v,b,y,m,g,R,O,w,C,k,M,S,E,W,U,x,Q,I,F,P=t=>{throw TypeError(t)},T=(t,e,s)=>e.has(t)||P("Cannot "+s),q=(t,e,s)=>(T(t,e,"read from private field"),s?s.call(t):e.get(t)),D=(t,e,s)=>e.has(t)?P("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),L=(t,e,s,i)=>(T(t,e,"write to private field"),i?i.call(t,s):e.set(t,s),s),_=(t,e,s)=>(T(t,e,"access private method"),s);import{D as j,E as A,F as H,G as K,I as B,J as z,K as G,L as J,N,O as V,P as Y,Q as X,U as Z,V as $,Y as tt,q as et}from"../index-C69Cv9fm.js";import{r as st}from"./chunk-CHPtWMTz.js";import"./chunk-DE8J_P3a.js";var it=(M=class extends j{constructor(b,y){super(),D(this,v),D(this,t),D(this,e),D(this,s),D(this,i),D(this,r),D(this,n),D(this,a),D(this,h),D(this,o),D(this,l),D(this,u),D(this,c),D(this,d),D(this,p),D(this,f,new Set),this.options=y,L(this,t,b),L(this,h,null),L(this,a,A()),this.options.experimental_prefetchInRender||q(this,a).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(y)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(q(this,e).addObserver(this),rt(q(this,e),this.options)?_(this,v,b).call(this):this.updateResult(),_(this,v,R).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return nt(q(this,e),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return nt(q(this,e),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,_(this,v,O).call(this),_(this,v,w).call(this),q(this,e).removeObserver(this)}setOptions(s,i){const r=this.options,n=q(this,e);if(this.options=q(this,t).defaultQueryOptions(s),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof H(this.options.enabled,q(this,e)))throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");_(this,v,C).call(this),q(this,e).setOptions(this.options),r._defaulted&&!K(this.options,r)&&q(this,t).getQueryCache().notify({type:"observerOptionsUpdated",query:q(this,e),observer:this});const a=this.hasListeners();a&&at(q(this,e),n,this.options,r)&&_(this,v,b).call(this),this.updateResult(i),!a||q(this,e)===n&&H(this.options.enabled,q(this,e))===H(r.enabled,q(this,e))&&B(this.options.staleTime,q(this,e))===B(r.staleTime,q(this,e))||_(this,v,y).call(this);const h=_(this,v,m).call(this);!a||q(this,e)===n&&H(this.options.enabled,q(this,e))===H(r.enabled,q(this,e))&&h===q(this,p)||_(this,v,g).call(this,h)}getOptimisticResult(s){const a=q(this,t).getQueryCache().build(q(this,t),s),h=this.createResult(a,s);return function(t,e){if(!K(t.getCurrentResult(),e))return!0;return!1}(this,h)&&(L(this,i,h),L(this,n,this.options),L(this,r,q(this,e).state)),h}getCurrentResult(){return q(this,i)}trackResult(t,e){const s={};return Object.keys(t).forEach(i=>{Object.defineProperty(s,i,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(i),null==e||e(i),t[i])})}),s}trackProp(t){q(this,f).add(t)}getCurrentQuery(){return q(this,e)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(e){const s=q(this,t).defaultQueryOptions(e),i=q(this,t).getQueryCache().build(q(this,t),s);return i.fetch().then(()=>this.createResult(i,s))}fetch(t){return _(this,v,b).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),q(this,i)))}createResult(t,c){var d;const p=q(this,e),f=this.options,v=q(this,i),b=q(this,r),y=q(this,n),m=t!==p?t.state:q(this,s),{state:g}=t;let R,O={...g},w=!1;if(c._optimisticResults){const e=this.hasListeners(),s=!e&&rt(t,c),i=e&&at(t,p,c,f);(s||i)&&(O={...O,...Y(g.data,t.options)}),"isRestoring"===c._optimisticResults&&(O.fetchStatus="idle")}let{error:C,errorUpdatedAt:k,status:M}=O;if(c.select&&void 0!==O.data)if(v&&O.data===(null==b?void 0:b.data)&&c.select===q(this,o))R=q(this,l);else try{L(this,o,c.select),R=c.select(O.data),R=X(null==v?void 0:v.data,R,c),L(this,l,R),L(this,h,null)}catch(I){L(this,h,I)}else R=O.data;if(void 0!==c.placeholderData&&void 0===R&&"pending"===M){let t;if((null==v?void 0:v.isPlaceholderData)&&c.placeholderData===(null==y?void 0:y.placeholderData))t=v.data;else if(t="function"==typeof c.placeholderData?c.placeholderData(null==(d=q(this,u))?void 0:d.state.data,q(this,u)):c.placeholderData,c.select&&void 0!==t)try{t=c.select(t),L(this,h,null)}catch(I){L(this,h,I)}void 0!==t&&(M="success",R=X(null==v?void 0:v.data,t,c),w=!0)}q(this,h)&&(C=q(this,h),R=q(this,l),k=Date.now(),M="error");const S="fetching"===O.fetchStatus,E="pending"===M,W="error"===M,U=E&&S,x=void 0!==R,Q={status:M,fetchStatus:O.fetchStatus,isPending:E,isSuccess:"success"===M,isError:W,isInitialLoading:U,isLoading:U,data:R,dataUpdatedAt:O.dataUpdatedAt,error:C,errorUpdatedAt:k,failureCount:O.fetchFailureCount,failureReason:O.fetchFailureReason,errorUpdateCount:O.errorUpdateCount,isFetched:O.dataUpdateCount>0||O.errorUpdateCount>0,isFetchedAfterMount:O.dataUpdateCount>m.dataUpdateCount||O.errorUpdateCount>m.errorUpdateCount,isFetching:S,isRefetching:S&&!E,isLoadingError:W&&!x,isPaused:"paused"===O.fetchStatus,isPlaceholderData:w,isRefetchError:W&&x,isStale:ht(t,c),refetch:this.refetch,promise:q(this,a)};if(this.options.experimental_prefetchInRender){const e=t=>{"error"===Q.status?t.reject(Q.error):void 0!==Q.data&&t.resolve(Q.data)},s=()=>{const t=L(this,a,Q.promise=A());e(t)},i=q(this,a);switch(i.status){case"pending":t.queryHash===p.queryHash&&e(i);break;case"fulfilled":"error"!==Q.status&&Q.data===i.value||s();break;case"rejected":"error"===Q.status&&Q.error===i.reason||s()}}return Q}updateResult(t){const s=q(this,i),a=this.createResult(q(this,e),this.options);if(L(this,r,q(this,e).state),L(this,n,this.options),void 0!==q(this,r).data&&L(this,u,q(this,e)),K(a,s))return;L(this,i,a);const h={};!1!==(null==t?void 0:t.listeners)&&(()=>{if(!s)return!0;const{notifyOnChangeProps:t}=this.options,e="function"==typeof t?t():t;if("all"===e||!e&&!q(this,f).size)return!0;const r=new Set(e??q(this,f));return this.options.throwOnError&&r.add("error"),Object.keys(q(this,i)).some(t=>{const e=t;return q(this,i)[e]!==s[e]&&r.has(e)})})()&&(h.listeners=!0),_(this,v,k).call(this,{...h,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&_(this,v,R).call(this)}},t=new WeakMap,e=new WeakMap,s=new WeakMap,i=new WeakMap,r=new WeakMap,n=new WeakMap,a=new WeakMap,h=new WeakMap,o=new WeakMap,l=new WeakMap,u=new WeakMap,c=new WeakMap,d=new WeakMap,p=new WeakMap,f=new WeakMap,v=new WeakSet,b=function(t){_(this,v,C).call(this);let s=q(this,e).fetch(this.options,t);return(null==t?void 0:t.throwOnError)||(s=s.catch(z)),s},y=function(){_(this,v,O).call(this);const t=B(this.options.staleTime,q(this,e));if(G||q(this,i).isStale||!J(t))return;const s=N(q(this,i).dataUpdatedAt,t);L(this,c,setTimeout(()=>{q(this,i).isStale||this.updateResult()},s+1))},m=function(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(q(this,e)):this.options.refetchInterval)??!1},g=function(t){_(this,v,w).call(this),L(this,p,t),!G&&!1!==H(this.options.enabled,q(this,e))&&J(q(this,p))&&0!==q(this,p)&&L(this,d,setInterval(()=>{(this.options.refetchIntervalInBackground||V.isFocused())&&_(this,v,b).call(this)},q(this,p)))},R=function(){_(this,v,y).call(this),_(this,v,g).call(this,_(this,v,m).call(this))},O=function(){q(this,c)&&(clearTimeout(q(this,c)),L(this,c,void 0))},w=function(){q(this,d)&&(clearInterval(q(this,d)),L(this,d,void 0))},C=function(){const i=q(this,t).getQueryCache().build(q(this,t),this.options);if(i===q(this,e))return;const r=q(this,e);L(this,e,i),L(this,s,i.state),this.hasListeners()&&(null==r||r.removeObserver(this),i.addObserver(this))},k=function(s){Z.batch(()=>{s.listeners&&this.listeners.forEach(t=>{t(q(this,i))}),q(this,t).getQueryCache().notify({query:q(this,e),type:"observerResultsUpdated"})})},M);function rt(t,e){return function(t,e){return!1!==H(e.enabled,t)&&void 0===t.state.data&&!("error"===t.state.status&&!1===e.retryOnMount)}(t,e)||void 0!==t.state.data&&nt(t,e,e.refetchOnMount)}function nt(t,e,s){if(!1!==H(e.enabled,t)){const i="function"==typeof s?s(t):s;return"always"===i||!1!==i&&ht(t,e)}return!1}function at(t,e,s,i){return(t!==e||!1===H(i.enabled,t))&&(!s.suspense||"error"!==t.state.status)&&ht(t,s)}function ht(t,e){return!1!==H(e.enabled,t)&&t.isStaleByTime(B(e.staleTime,t))}var ot=(F=class extends j{constructor(t,e){super(),D(this,x),D(this,S),D(this,E),D(this,W),D(this,U),L(this,S,t),this.setOptions(e),this.bindMethods(),_(this,x,Q).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var e;const s=this.options;this.options=q(this,S).defaultMutationOptions(t),K(this.options,s)||q(this,S).getMutationCache().notify({type:"observerOptionsUpdated",mutation:q(this,W),observer:this}),(null==s?void 0:s.mutationKey)&&this.options.mutationKey&&$(s.mutationKey)!==$(this.options.mutationKey)?this.reset():"pending"===(null==(e=q(this,W))?void 0:e.state.status)&&q(this,W).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||null==(t=q(this,W))||t.removeObserver(this)}onMutationUpdate(t){_(this,x,Q).call(this),_(this,x,I).call(this,t)}getCurrentResult(){return q(this,E)}reset(){var t;null==(t=q(this,W))||t.removeObserver(this),L(this,W,void 0),_(this,x,Q).call(this),_(this,x,I).call(this)}mutate(t,e){var s;return L(this,U,e),null==(s=q(this,W))||s.removeObserver(this),L(this,W,q(this,S).getMutationCache().build(q(this,S),this.options)),q(this,W).addObserver(this),q(this,W).execute(t)}},S=new WeakMap,E=new WeakMap,W=new WeakMap,U=new WeakMap,x=new WeakSet,Q=function(){var t;const e=(null==(t=q(this,W))?void 0:t.state)??tt();L(this,E,{...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset})},I=function(t){Z.batch(()=>{var e,s,i,r,n,a,h,o;if(q(this,U)&&this.hasListeners()){const l=q(this,E).variables,u=q(this,E).context;"success"===(null==t?void 0:t.type)?(null==(s=(e=q(this,U)).onSuccess)||s.call(e,t.data,l,u),null==(r=(i=q(this,U)).onSettled)||r.call(i,t.data,null,l,u)):"error"===(null==t?void 0:t.type)&&(null==(a=(n=q(this,U)).onError)||a.call(n,t.error,l,u),null==(o=(h=q(this,U)).onSettled)||o.call(h,void 0,t.error,l,u))}this.listeners.forEach(t=>{t(q(this,E))})})},F),lt=st.createContext(!1);lt.Provider;var ut=st.createContext(function(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}());function ct(t,e){return"function"==typeof t?t(...e):!!t}function dt(){}var pt=(t,e,s)=>e.fetchOptimistic(t).catch(()=>{s.clearReset()});function ft(t,e,s){var i,r,n,a,h;const o=et(),l=st.useContext(lt),u=st.useContext(ut),c=o.defaultQueryOptions(t);null==(r=null==(i=o.getDefaultOptions().queries)?void 0:i._experimental_beforeQuery)||r.call(i,c),c._optimisticResults=l?"isRestoring":"optimistic",(t=>{t.suspense&&(void 0===t.staleTime&&(t.staleTime=1e3),"number"==typeof t.gcTime&&(t.gcTime=Math.max(t.gcTime,1e3)))})(c),((t,e)=>{(t.suspense||t.throwOnError)&&(e.isReset()||(t.retryOnMount=!1))})(c,u),(t=>{st.useEffect(()=>{t.clearReset()},[t])})(u);const d=!o.getQueryCache().get(c.queryHash),[p]=st.useState(()=>new e(o,c)),f=p.getOptimisticResult(c);if(st.useSyncExternalStore(st.useCallback(t=>{const e=l?()=>{}:p.subscribe(Z.batchCalls(t));return p.updateResult(),e},[p,l]),()=>p.getCurrentResult(),()=>p.getCurrentResult()),st.useEffect(()=>{p.setOptions(c,{listeners:!1})},[c,p]),((t,e)=>(null==t?void 0:t.suspense)&&e.isPending)(c,f))throw pt(c,p,u);if((({result:t,errorResetBoundary:e,throwOnError:s,query:i})=>t.isError&&!e.isReset()&&!t.isFetching&&i&&ct(s,[t.error,i]))({result:f,errorResetBoundary:u,throwOnError:c.throwOnError,query:o.getQueryCache().get(c.queryHash)}))throw f.error;if(null==(a=null==(n=o.getDefaultOptions().queries)?void 0:n._experimental_afterQuery)||a.call(n,c,f),c.experimental_prefetchInRender&&!G&&((t,e)=>t.isLoading&&t.isFetching&&!e)(f,l)){const t=d?pt(c,p,u):null==(h=o.getQueryCache().get(c.queryHash))?void 0:h.promise;null==t||t.catch(dt).finally(()=>{p.updateResult()})}return c.notifyOnChangeProps?f:p.trackResult(f)}function vt(t,e){return ft(t,it)}function bt(t,e){const s=et(),[i]=st.useState(()=>new ot(s,t));st.useEffect(()=>{i.setOptions(t)},[i,t]);const r=st.useSyncExternalStore(st.useCallback(t=>i.subscribe(Z.batchCalls(t)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),n=st.useCallback((t,e)=>{i.mutate(t,e).catch(dt)},[i]);if(r.error&&ct(i.options.throwOnError,[r.error]))throw r.error;return{...r,mutate:n,mutateAsync:r.mutate}}export{bt as a,vt as u};
