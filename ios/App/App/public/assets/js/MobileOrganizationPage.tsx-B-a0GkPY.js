import{j as e}from"./chunk-DE8J_P3a.js";import{j as s,u as r,r as a,c as n}from"./chunk-CHPtWMTz.js";import{u as t,f as i,j as o,S as l}from"../index-C69Cv9fm.js";import{u as c}from"./chunk-5eV_qmzt.js";import{A as m,a as d,b as u}from"./chunk-I0kJWO9F.js";import{D as h,a as x,b as j,c as p}from"./chunk-DtLDND_v.js";import{M as f}from"./chunk-DgElOEdu.js";import{E as b}from"./chunk-D393L8yP.js";import{U as g}from"./chunk-CkE6zG_x.js";import{S as N}from"./chunk-DILfnUIk.js";import{I as v}from"./chunk-D6XY44pl.js";import{B as k}from"./chunk-CKgI9q5n.js";import{S as w}from"./chunk-BEvYuFwC.js";import{A as y}from"./chunk-0Vn9svHl.js";import{P as C}from"./chunk-DoIo-fWL.js";import"./chunk-DN5ISW2H.js";import"./chunk-CbEMFF6w.js";import"./chunk-DuSQr7KO.js";import"./chunk-CD10_Lnj.js";import"./chunk-YjRoWQ3-.js";import"./chunk-D3Z6_DOi.js";import"./chunk-LoZVIojA.js";import"./chunk-BIY1ublO.js";const z=({member:s,onChangeRole:r,onRemove:a,isOwner:n})=>{var o,l;if(!t())return null;return e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl bg-card border border-border",children:[e.jsxs(m,{className:"w-12 h-12",children:[e.jsx(d,{src:s.avatar_url}),e.jsx(u,{className:"bg-primary/20 text-primary",children:(null==(o=s.full_name)?void 0:o.charAt(0))||(null==(l=s.email)?void 0:l.charAt(0))||"?"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-foreground truncate",children:s.full_name||"Unknown User"}),s.email&&e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1 truncate",children:[e.jsx(f,{className:"w-3 h-3"}),s.email]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:i("px-2 py-1 rounded-full text-xs font-medium flex items-center gap-1",(e=>{switch(e){case"owner":return"text-purple-400 bg-purple-500/20";case"admin":return"text-blue-400 bg-blue-500/20";case"member":return"text-green-400 bg-green-500/20";default:return"text-gray-400 bg-gray-500/20"}})(s.role)),children:[(s=>{switch(s){case"owner":case"admin":return e.jsx(N,{className:"w-3 h-3"});default:return e.jsx(g,{className:"w-3 h-3"})}})(s.role),s.role]}),!n&&"owner"!==s.role&&(r||a)&&e.jsxs(h,{children:[e.jsx(x,{className:"p-1 hover:bg-accent rounded-lg transition-colors",children:e.jsx(b,{className:"w-5 h-5 text-muted-foreground"})}),e.jsxs(j,{align:"end",children:[r&&"admin"!==s.role&&e.jsx(p,{onClick:()=>r("admin"),children:"Promote to Admin"}),r&&"admin"===s.role&&e.jsx(p,{onClick:()=>r("member"),children:"Demote to Member"}),a&&e.jsx(p,{onClick:a,className:"text-destructive",children:"Remove from Organization"})]})]})]})]})},R=()=>{const{orgId:i}=s(),m=r(),d=t(),{toast:u}=o(),[h,x]=a.useState(!1),{organizations:j,members:p,loading:f,fetchOrgMembers:b,updateMemberRole:g,removeMember:N}=c();n.useEffect(()=>{i&&b(i)},[i]);const R=j.find(e=>e.id===i);if(!d)return m("/settings"),null;if(f&&0===j.length)return e.jsx("div",{className:"min-h-screen bg-background p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(w,{className:"h-12 w-full"}),e.jsx(w,{className:"h-32 w-full"}),e.jsx(w,{className:"h-20 w-full"}),e.jsx(w,{className:"h-20 w-full"})]})});if(!R)return e.jsxs("div",{className:"min-h-screen bg-background p-4",children:[e.jsxs(k,{variant:"ghost",onClick:()=>m(-1),className:"mb-4",children:[e.jsx(y,{className:"w-5 h-5 mr-2"}),"Back"]}),e.jsx("p",{className:"text-muted-foreground text-center mt-8",children:"Organization not found"})]});const M=p.find(e=>"owner"===e.role||"admin"===e.role),O="owner"===(null==M?void 0:M.role)||"admin"===(null==M?void 0:M.role);return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-background/95 backdrop-blur-sm border-b border-border",children:e.jsxs("div",{className:"p-4 flex items-center justify-between",children:[e.jsx(k,{variant:"ghost",size:"icon",onClick:()=>m(-1),children:e.jsx(y,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-lg font-semibold text-foreground",children:"Organization"}),e.jsx(k,{variant:"ghost",size:"icon",onClick:()=>m("/settings"),children:e.jsx(l,{className:"w-5 h-5"})})]})}),e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-primary/20 to-primary/5 rounded-2xl p-6 border border-primary/20",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:R.name}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsx("span",{className:"uppercase font-medium text-primary",children:R.subscription_tier}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[R.seats_used," / ",R.seat_limit," seats"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Team Members"}),O&&e.jsxs(k,{size:"sm",onClick:()=>x(!0),className:"gap-2",children:[e.jsx(C,{className:"w-4 h-4"}),"Invite"]})]}),f?e.jsxs("div",{className:"space-y-3",children:[e.jsx(w,{className:"h-20 w-full"}),e.jsx(w,{className:"h-20 w-full"}),e.jsx(w,{className:"h-20 w-full"})]}):0===p.length?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No team members yet"}):e.jsx("div",{className:"space-y-3",children:p.map(s=>e.jsx(z,{member:s,onChangeRole:O?e=>(async(e,s)=>{try{const r=await g(e,s);if(r.error)throw r.error;u({title:"Role updated",description:"Team member role has been updated successfully"})}catch(r){u({title:"Error",description:"Failed to update member role",variant:"destructive"})}})(s.id,e):void 0,onRemove:O?()=>(async e=>{try{const s=await N(e);if(s.error)throw s.error;u({title:"Member removed",description:"Team member has been removed from the organization"})}catch(s){u({title:"Error",description:"Failed to remove member",variant:"destructive"})}})(s.id):void 0,isOwner:"owner"===s.role},s.id))})]})]}),e.jsx(v,{open:h,organizationId:i||"",onClose:()=>x(!1)})]})};export{R as MobileOrganizationPage};
