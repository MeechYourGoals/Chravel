var e=Object.defineProperty;import{j as t,O as a,s,t as r,v as n,w as i,y as l,x as o,P as c,c as d,u,b as m,d as p,z as h,E as x,p as f,q as g,g as y,r as v,I as b,F as j,G as N,H as w,J as _,K as k,L as S,M as C,N as E,Q as P,U as A,W as D}from"./chunk-DE8J_P3a.js";import{r as M,R as I,a as T,b as R,c as F}from"./chunk-CHPtWMTz.js";import{k as O,l as z,m as L,P as $,T as B,A as U,U as q,G as V,f as Y}from"./chunk-hQfd_hHm.js";import{B as W}from"./chunk-CKgI9q5n.js";import{c as G,F as H,D as K}from"./chunk-D_Hxdxtf.js";import{A as X,a as Z,b as J}from"./chunk-I0kJWO9F.js";import{B as Q}from"./chunk-Bc1XvzR8.js";import{c as ee,f as te,X as ae,g as se,e as re,m as ne,i as ie,k as le,H as oe,l as ce,j as de,s as ue,w as me}from"../index-C69Cv9fm.js";import{a as pe,i as he,f as xe}from"./chunk-DN5ISW2H.js";import{C as fe}from"./chunk-DtLDND_v.js";import{u as ge}from"./chunk-vfQQTDq4.js";import{u as ye}from"./chunk-Ccyq873b.js";import{C as ve}from"./chunk-DeuaeHUI.js";import{C as be}from"./chunk-D53qnCh4.js";import{U as je}from"./chunk-D5WpN7K-.js";import{U as Ne}from"./chunk-CkE6zG_x.js";import{C as we}from"./chunk-DJZXZyJn.js";import{F as _e}from"./chunk-CeA63noh.js";import{D as ke,a as Se,b as Ce,c as Ee,L as Pe,d as Ae,e as De}from"./chunk-YjRoWQ3-.js";import{I as Me}from"./chunk-D3Z6_DOi.js";import{T as Ie,S as Te,a as Re}from"./chunk-BxvRdxTs.js";import{P as Fe,a as Oe,b as ze}from"./chunk-BzRjpoc5.js";import{C as Le}from"./chunk-Bbmjf7eQ.js";import{C as $e,S as Be,a as Ue,b as qe,c as Ve,d as Ye,e as We}from"./chunk-LoZVIojA.js";import{C as Ge}from"./chunk-CD10_Lnj.js";import{P as He}from"./chunk-DoIo-fWL.js";import{G as Ke,D as Xe}from"./chunk-DcTAIqBw.js";import{M as Ze}from"./chunk-ByyMTJWo.js";import{S as Je,C as Qe,n as et,M as tt}from"./chunk-B6KUG25W.js";import{G as at,H as st,u as rt,D as nt,L as it}from"./chunk-C5qHPTeJ.js";import{P as lt,T as ot}from"./chunk-vJ6XLRYv.js";import{S as ct}from"./chunk-bP8xJp5e.js";import{C as dt,b as ut,c as mt,a as pt}from"./chunk-30ZbY-F3.js";import{B as ht}from"./chunk--pMnkzaH.js";import{T as xt,a as ft,b as gt,c as yt}from"./chunk-ObNbiZMt.js";import{T as vt}from"./chunk-Bx2M---t.js";import{L as bt}from"./chunk-BIY1ublO.js";import{E as jt}from"./chunk-y0HRaaXz.js";import{d as Nt}from"./chunk-DGLf2uCM.js";import{g as wt}from"./chunk-wPum6LLk.js";import{A as _t}from"./chunk-BpSVmO2m.js";import{C as kt}from"./chunk-C0eak1NN.js";import{C as St}from"./chunk-C-NDN0ZE.js";import{E as Ct}from"./chunk-BBFu0Y12.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=ee("Bed",[["path",{d:"M2 4v16",key:"vw9hq8"}],["path",{d:"M2 8h18a2 2 0 0 1 2 2v10",key:"1dgv2r"}],["path",{d:"M2 17h20",key:"18nfp3"}],["path",{d:"M6 8v9",key:"1yriud"}]]),Pt=ee("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),At=ee("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Dt=ee("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),Mt=ee("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]),It=ee("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]),Tt=o,Rt=r,Ft=l,Ot=M.forwardRef(({className:e,...s},r)=>t.jsx(a,{className:te("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s,ref:r}));
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */Ot.displayName=a.displayName;const zt=se("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Lt=M.forwardRef(({side:e="right",className:a,children:n,...i},l)=>t.jsxs(Ft,{children:[t.jsx(Ot,{}),t.jsxs(s,{ref:l,className:te(zt({side:e}),a),...i,children:[n,t.jsxs(r,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[t.jsx(ae,{className:"h-4 w-4"}),t.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Lt.displayName=s.displayName;const $t=({className:e,...a})=>t.jsx("div",{className:te("flex flex-col space-y-2 text-center sm:text-left",e),...a});$t.displayName="SheetHeader";const Bt=M.forwardRef(({className:e,...a},s)=>t.jsx(n,{ref:s,className:te("text-lg font-semibold text-foreground",e),...a}));Bt.displayName=n.displayName;M.forwardRef(({className:e,...a},s)=>t.jsx(i,{ref:s,className:te("text-sm text-muted-foreground",e),...a})).displayName=i.displayName;const Ut=({task:e,onClose:a})=>{var s,r,n,i;const l=(null==(s=e.task_status)?void 0:s.filter(e=>e.completed))||[],o=(null==(r=e.task_status)?void 0:r.filter(e=>!e.completed))||[];return t.jsx(Tt,{open:!0,onOpenChange:a,children:t.jsxs(Lt,{className:"bg-gray-900 border-gray-700 text-white",children:[t.jsx($t,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(Bt,{className:"text-white",children:e.title}),t.jsx(Rt,{asChild:!0,children:t.jsx("button",{className:"text-gray-400 hover:text-white",children:t.jsx(ae,{size:20})})})]})}),t.jsxs("div",{className:"mt-6 space-y-6",children:[t.jsxs("div",{className:"bg-white/5 rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("span",{className:"text-gray-300",children:"Progress"}),t.jsxs(Q,{className:"bg-gradient-to-r from-blue-400 to-purple-400",children:[l.length,"/",(null==(n=e.task_status)?void 0:n.length)||0]})]}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:t.jsx("div",{className:"bg-gradient-to-r from-blue-400 to-purple-400 h-2 rounded-full transition-all duration-300",style:{width:l.length/((null==(i=e.task_status)?void 0:i.length)||1)*100+"%"}})})]}),l.length>0&&t.jsxs("div",{className:"space-y-3",children:[t.jsxs("h3",{className:"text-lg font-medium text-white flex items-center gap-2",children:[t.jsx(O,{size:20,className:"text-green-400"}),"Completed (",l.length,")"]}),t.jsx("div",{className:"space-y-2",children:l.map(e=>{var a,s,r,n;return t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-400/10 rounded-lg border border-green-400/20",children:[t.jsxs(X,{className:"w-8 h-8",children:[t.jsx(Z,{src:null==(a=e.user)?void 0:a.avatar}),t.jsx(J,{className:"text-xs bg-green-400 text-white",children:(null==(r=null==(s=e.user)?void 0:s.name)?void 0:r.charAt(0))||"U"})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"text-white font-medium",children:(null==(n=e.user)?void 0:n.name)||"Unknown User"}),e.completed_at&&t.jsxs("div",{className:"text-gray-400 text-xs",children:["Completed ",pe(new Date(e.completed_at),{addSuffix:!0})]})]}),t.jsx(O,{size:20,className:"text-green-400"})]},e.user_id)})})]}),o.length>0&&t.jsxs("div",{className:"space-y-3",children:[t.jsxs("h3",{className:"text-lg font-medium text-white flex items-center gap-2",children:[t.jsx(fe,{size:20,className:"text-yellow-400"}),"Pending (",o.length,")"]}),t.jsx("div",{className:"space-y-2",children:o.map(e=>{var a,s,r,n;return t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-yellow-400/10 rounded-lg border border-yellow-400/20",children:[t.jsxs(X,{className:"w-8 h-8",children:[t.jsx(Z,{src:null==(a=e.user)?void 0:a.avatar}),t.jsx(J,{className:"text-xs bg-yellow-400 text-white",children:(null==(r=null==(s=e.user)?void 0:s.name)?void 0:r.charAt(0))||"U"})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"text-white font-medium",children:(null==(n=e.user)?void 0:n.name)||"Unknown User"}),t.jsx("div",{className:"text-gray-400 text-xs",children:"Not completed yet"})]}),t.jsx(fe,{size:20,className:"text-yellow-400"})]},e.user_id)})})]}),e.description&&t.jsxs("div",{className:"space-y-2",children:[t.jsx("h3",{className:"text-lg font-medium text-white",children:"Description"}),t.jsx("p",{className:"text-gray-300 bg-white/5 rounded-lg p-3",children:e.description})]}),e.due_at&&t.jsxs("div",{className:"space-y-2",children:[t.jsx("h3",{className:"text-lg font-medium text-white",children:"Due Date"}),t.jsx("div",{className:"text-gray-300 bg-white/5 rounded-lg p-3",children:pe(new Date(e.due_at),{addSuffix:!0})})]})]})]})})};function qt(...e){const t=e[0];if(1===e.length)return t;const a=()=>{const a=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){const s=a.reduce((t,{useScope:a,scopeName:s})=>({...t,...a(e)[`__scope${s}`]}),{});return M.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return a.scopeName=t.scopeName,a}var Vt="Progress",[Yt,Wt]=function(e,a=[]){let s=[];const r=()=>{const t=s.map(e=>M.createContext(e));return function(a){const s=(null==a?void 0:a[e])||t;return M.useMemo(()=>({[`__scope${e}`]:{...a,[e]:s}}),[a,s])}};return r.scopeName=e,[function(a,r){const n=M.createContext(r),i=s.length;function l(a){const{scope:s,children:r,...l}=a,o=(null==s?void 0:s[e][i])||n,c=M.useMemo(()=>l,Object.values(l));return t.jsx(o.Provider,{value:c,children:r})}return s=[...s,r],l.displayName=a+"Provider",[l,function(t,s){const l=(null==s?void 0:s[e][i])||n,o=M.useContext(l);if(o)return o;if(void 0!==r)return r;throw new Error(`\`${t}\` must be used within \`${a}\``)}]},qt(r,...a)]}(Vt),[Gt,Ht]=Yt(Vt),Kt=M.forwardRef((e,a)=>{const{__scopeProgress:s,value:r=null,max:n,getValueLabel:i=Jt,...l}=e;(n||0===n)&&ta(n);const o=ta(n)?n:100;null!==r&&aa(r,o);const d=aa(r,o)?r:null,u=ea(d)?i(d,o):void 0;return t.jsx(Gt,{scope:s,value:d,max:o,children:t.jsx(c.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":ea(d)?d:void 0,"aria-valuetext":u,role:"progressbar","data-state":Qt(d,o),"data-value":d??void 0,"data-max":o,...l,ref:a})})});Kt.displayName=Vt;var Xt="ProgressIndicator",Zt=M.forwardRef((e,a)=>{const{__scopeProgress:s,...r}=e,n=Ht(Xt,s);return t.jsx(c.div,{"data-state":Qt(n.value,n.max),"data-value":n.value??void 0,"data-max":n.max,...r,ref:a})});function Jt(e,t){return`${Math.round(e/t*100)}%`}function Qt(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function ea(e){return"number"==typeof e}function ta(e){return ea(e)&&!isNaN(e)&&e>0}function aa(e,t){return ea(e)&&!isNaN(e)&&e<=t&&e>=0}Zt.displayName=Xt;var sa=Kt,ra=Zt;const na=M.forwardRef(({className:e,value:a,...s},r)=>t.jsx(sa,{ref:r,className:te("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...s,children:t.jsx(ra,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})}));na.displayName=sa.displayName;const ia=({task:e,tripId:a})=>{var s,r,n,i,l,o,c,d,u,m;const[p,h]=M.useState(!1),[x,f]=M.useState(!1),{toggleTaskMutation:g}=ge(a),y=e.is_poll?((null==(s=e.task_status)?void 0:s.filter(e=>e.completed).length)||0)>=((null==(r=e.task_status)?void 0:r.length)||1):(null==(i=null==(n=e.task_status)?void 0:n[0])?void 0:i.completed)||!1,v=e.due_at&&he(new Date,new Date(e.due_at))&&!y,{user:b}=re(),{isDemoMode:j}=ye(),N=j||!b?"demo-user":b.id,w=null==(l=e.task_status)?void 0:l.find(e=>e.user_id===N),_=(null==w?void 0:w.completed)||!1,k=(null==(o=e.task_status)?void 0:o.filter(e=>e.completed).length)||0,S=(null==(c=e.task_status)?void 0:c.length)||1,C=k/S*100;return M.useEffect(()=>{e.is_poll&&100===C&&!x&&ne.celebration()},[C,e.is_poll,x]),t.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-4 transition-all hover:bg-white/10 "+(y?"opacity-75":""),children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsxs("div",{className:"relative mt-1",children:[t.jsx(G,{checked:_,onCheckedChange:()=>{const t=!_;t?(ne.success(),f(!0),setTimeout(()=>f(!1),1e3)):ne.light(),g.mutate({taskId:e.id,completed:t})}}),x&&t.jsx("div",{className:"absolute -inset-2 pointer-events-none",children:t.jsx(ve,{className:"w-6 h-6 text-green-400 animate-scale-in",fill:"currentColor"})})]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"font-medium text-white "+(y?"line-through":""),children:e.title}),e.description&&t.jsx("p",{className:"text-gray-400 text-sm mt-1",children:e.description}),e.due_at&&t.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[t.jsx(be,{size:14}),t.jsxs(Q,{variant:v?"destructive":"secondary",className:"text-xs",children:[v?"Overdue":"Due"," ",pe(new Date(e.due_at),{addSuffix:!0})]})]})]}),t.jsx("div",{className:"flex items-center gap-2",children:e.is_poll?t.jsxs("div",{className:"flex flex-col items-end gap-1",children:[t.jsxs(W,{variant:"ghost",size:"sm",onClick:()=>h(!0),className:"flex items-center gap-2 text-gray-300 hover:text-white",children:[t.jsx(je,{size:16}),t.jsxs("span",{className:"text-sm",children:[k,"/",S]})]}),t.jsxs("div",{className:"w-20",children:[t.jsx(na,{value:C,className:"h-1 "+(100===C?"animate-pulse":"")}),t.jsxs("span",{className:"text-xs text-gray-400 mt-1",children:[Math.round(C),"%"]})]}),100===C&&t.jsx("div",{className:"text-xs text-yellow-400 font-medium animate-bounce",children:"🎉 All done!"})]}):t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Ne,{size:16,className:"text-gray-400"}),t.jsxs(X,{className:"w-6 h-6",children:[t.jsx(Z,{src:null==(d=e.creator)?void 0:d.avatar}),t.jsx(J,{className:"text-xs",children:(null==(m=null==(u=e.creator)?void 0:u.name)?void 0:m.charAt(0))||"U"})]})]})})]}),p&&t.jsx(Ut,{task:e,onClose:()=>h(!1)})]})},la=({tasks:e,tripId:a,title:s,emptyMessage:r,showCompleted:n,onToggleCompleted:i})=>{const l=s.toLowerCase().includes("completed");return t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"flex items-center gap-2",children:l?t.jsxs("button",{onClick:i,className:"flex items-center gap-2 text-gray-300 hover:text-white font-medium transition-colors",children:[t.jsx(O,{size:18}),t.jsxs("span",{children:[s," (",e.length,")"]}),t.jsx("span",{className:"text-xs",children:n?"▼":"▶"})]}):t.jsxs("div",{className:"flex items-center gap-2 text-white font-medium",children:[t.jsx(we,{size:18}),t.jsxs("span",{children:[s," (",e.length,")"]})]})}),0===e.length?t.jsxs("div",{className:"text-center py-8 text-gray-400",children:[t.jsx(O,{size:48,className:"mx-auto mb-3 opacity-50"}),t.jsx("p",{children:r||"No tasks found"})]}):(!l||n)&&t.jsx("div",{className:"space-y-2",children:e.map(e=>t.jsx(ia,{task:e,tripId:a},e.id))})]})},oa=({status:e,sortBy:a,onStatusChange:s,onSortChange:r,hasActiveFilters:n,onClearFilters:i})=>t.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-sm",children:[t.jsx(_e,{size:16}),t.jsx("span",{children:"Filter:"})]}),t.jsx("div",{className:"flex gap-2",children:["all","open","completed"].map(a=>t.jsx("button",{onClick:()=>s(a),className:"px-3 py-1 rounded-full text-xs font-medium transition-colors capitalize "+(e===a?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"),children:a},a))}),t.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[t.jsx("span",{className:"text-slate-400 text-sm",children:"Sort by:"}),t.jsx("select",{value:a,onChange:e=>r(e.target.value),className:"bg-slate-700 text-white text-xs rounded px-2 py-1 border border-slate-600",children:[{value:"dueDate",label:"Due Date"},{value:"created",label:"Created"},{value:"priority",label:"Priority"}].map(e=>t.jsx("option",{value:e.value,children:e.label},e.value))})]}),n&&t.jsxs(W,{variant:"ghost",size:"sm",onClick:i,className:"text-slate-400 hover:text-white",children:[t.jsx(ae,{size:14,className:"mr-1"}),"Clear"]})]});var ca="Radio",[da,ua]=d(ca),[ma,pa]=da(ca),ha=M.forwardRef((e,a)=>{const{__scopeRadio:s,name:r,checked:n=!1,required:i,disabled:l,value:o="on",onCheck:d,form:p,...h}=e,[x,f]=M.useState(null),g=u(a,e=>f(e)),y=M.useRef(!1),v=!x||(p||!!x.closest("form"));return t.jsxs(ma,{scope:s,checked:n,disabled:l,children:[t.jsx(c.button,{type:"button",role:"radio","aria-checked":n,"data-state":ya(n),"data-disabled":l?"":void 0,disabled:l,value:o,...h,ref:g,onClick:m(e.onClick,e=>{n||null==d||d(),v&&(y.current=e.isPropagationStopped(),y.current||e.stopPropagation())})}),v&&t.jsx(ga,{control:x,bubbles:!y.current,name:r,value:o,checked:n,required:i,disabled:l,form:p,style:{transform:"translateX(-100%)"}})]})});ha.displayName=ca;var xa="RadioIndicator",fa=M.forwardRef((e,a)=>{const{__scopeRadio:s,forceMount:r,...n}=e,i=pa(xa,s);return t.jsx(p,{present:r||i.checked,children:t.jsx(c.span,{"data-state":ya(i.checked),"data-disabled":i.disabled?"":void 0,...n,ref:a})})});fa.displayName=xa;var ga=e=>{const{control:a,checked:s,bubbles:r=!0,...n}=e,i=M.useRef(null),l=h(s),o=x(a);return M.useEffect(()=>{const e=i.current,t=window.HTMLInputElement.prototype,a=Object.getOwnPropertyDescriptor(t,"checked").set;if(l!==s&&a){const t=new Event("click",{bubbles:r});a.call(e,s),e.dispatchEvent(t)}},[l,s,r]),t.jsx("input",{type:"radio","aria-hidden":!0,defaultChecked:s,...n,tabIndex:-1,ref:i,style:{...e.style,...o,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function ya(e){return e?"checked":"unchecked"}var va=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ba="RadioGroup",[ja,Na]=d(ba,[f,ua]),wa=f(),_a=ua(),[ka,Sa]=ja(ba),Ca=M.forwardRef((e,a)=>{const{__scopeRadioGroup:s,name:r,defaultValue:n,value:i,required:l=!1,disabled:o=!1,orientation:d,dir:u,loop:m=!0,onValueChange:p,...h}=e,x=wa(s),f=g(u),[b,j]=y({prop:i,defaultProp:n,onChange:p});return t.jsx(ka,{scope:s,name:r,required:l,disabled:o,value:b,onValueChange:j,children:t.jsx(v,{asChild:!0,...x,orientation:d,dir:f,loop:m,children:t.jsx(c.div,{role:"radiogroup","aria-required":l,"aria-orientation":d,"data-disabled":o?"":void 0,dir:f,...h,ref:a})})})});Ca.displayName=ba;var Ea="RadioGroupItem",Pa=M.forwardRef((e,a)=>{const{__scopeRadioGroup:s,disabled:r,...n}=e,i=Sa(Ea,s),l=i.disabled||r,o=wa(s),c=_a(s),d=M.useRef(null),p=u(a,d),h=i.value===n.value,x=M.useRef(!1);return M.useEffect(()=>{const e=e=>{va.includes(e.key)&&(x.current=!0)},t=()=>x.current=!1;return document.addEventListener("keydown",e),document.addEventListener("keyup",t),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keyup",t)}},[]),t.jsx(b,{asChild:!0,...o,focusable:!l,active:h,children:t.jsx(ha,{disabled:l,required:i.required,checked:h,...c,...n,name:i.name,ref:p,onCheck:()=>i.onValueChange(n.value),onKeyDown:m(e=>{"Enter"===e.key&&e.preventDefault()}),onFocus:m(n.onFocus,()=>{var e;x.current&&(null==(e=d.current)||e.click())})})})});Pa.displayName=Ea;var Aa=M.forwardRef((e,a)=>{const{__scopeRadioGroup:s,...r}=e,n=_a(s);return t.jsx(fa,{...n,...r,ref:a})});Aa.displayName="RadioGroupIndicator";var Da=Ca,Ma=Pa,Ia=Aa;const Ta=M.forwardRef(({className:e,...a},s)=>t.jsx(Da,{className:te("grid gap-2",e),...a,ref:s}));Ta.displayName=Da.displayName;const Ra=M.forwardRef(({className:e,...a},s)=>t.jsx(Ma,{ref:s,className:te("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...a,children:t.jsx(Ia,{className:"flex items-center justify-center",children:t.jsx(fe,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Ra.displayName=Ma.displayName;var Fa=.999,Oa=/[\\\/_+.#"@\[\(\{&]/,za=/[\\\/_+.#"@\[\(\{&]/g,La=/[\s-]/,$a=/[\s-]/g;function Ba(e,t,a,s,r,n,i){if(n===t.length)return r===e.length?1:.99;var l=`${r},${n}`;if(void 0!==i[l])return i[l];for(var o,c,d,u,m=s.charAt(n),p=a.indexOf(m,r),h=0;p>=0;)(o=Ba(e,t,a,s,p+1,n+1,i))>h&&(p===r?o*=1:Oa.test(e.charAt(p-1))?(o*=.8,(d=e.slice(r,p-1).match(za))&&r>0&&(o*=Math.pow(Fa,d.length))):La.test(e.charAt(p-1))?(o*=.9,(u=e.slice(r,p-1).match($a))&&r>0&&(o*=Math.pow(Fa,u.length))):(o*=.17,r>0&&(o*=Math.pow(Fa,p-r))),e.charAt(p)!==t.charAt(n)&&(o*=.9999)),(o<.1&&a.charAt(p-1)===s.charAt(n+1)||s.charAt(n+1)===s.charAt(n)&&a.charAt(p-1)!==s.charAt(n))&&(.1*(c=Ba(e,t,a,s,p+1,n+2,i))>o&&(o=.1*c)),o>h&&(h=o),p=a.indexOf(m,p+1);return i[l]=h,h}function Ua(e){return e.toLowerCase().replace($a," ")}function qa(e,t,a){return Ba(e=a&&a.length>0?""+(e+" "+a.join(" ")):e,t,Ua(e),Ua(t),0,0,{})}function Va(e,t,{checkForDefaultPrevented:a=!0}={}){return function(s){if(null==e||e(s),!1===a||!s.defaultPrevented)return null==t?void 0:t(s)}}function Ya(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function Wa(...e){return t=>{let a=!1;const s=e.map(e=>{const s=Ya(e,t);return a||"function"!=typeof s||(a=!0),s});if(a)return()=>{for(let t=0;t<s.length;t++){const a=s[t];"function"==typeof a?a():Ya(e[t],null)}}}}function Ga(...e){return M.useCallback(Wa(...e),e)}function Ha(...e){const t=e[0];if(1===e.length)return t;const a=()=>{const a=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){const s=a.reduce((t,{useScope:a,scopeName:s})=>({...t,...a(e)[`__scope${s}`]}),{});return M.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return a.scopeName=t.scopeName,a}var Ka=(null==globalThis?void 0:globalThis.document)?M.useLayoutEffect:()=>{},Xa=I[" useId ".trim().toString()]||(()=>{}),Za=0;function Ja(e){const[t,a]=M.useState(Xa());return Ka(()=>{a(e=>e??String(Za++))},[e]),t?`radix-${t}`:""}var Qa=I[" useInsertionEffect ".trim().toString()]||Ka;function es({prop:e,defaultProp:t,onChange:a=()=>{},caller:s}){const[r,n,i]=function({defaultProp:e,onChange:t}){const[a,s]=M.useState(e),r=M.useRef(a),n=M.useRef(t);return Qa(()=>{n.current=t},[t]),M.useEffect(()=>{var e;r.current!==a&&(null==(e=n.current)||e.call(n,a),r.current=a)},[a,r]),[a,s,n]}({defaultProp:t,onChange:a}),l=void 0!==e,o=l?e:r;{const t=M.useRef(void 0!==e);M.useEffect(()=>{const e=t.current;if(e!==l){}t.current=l},[l,s])}const c=M.useCallback(t=>{var a;if(l){const s=function(e){return"function"==typeof e}(t)?t(e):t;s!==e&&(null==(a=i.current)||a.call(i,s))}else n(t)},[l,e,n,i]);return[o,c]}function ts(e){const a=as(e),s=M.forwardRef((e,s)=>{const{children:r,...n}=e,i=M.Children.toArray(r),l=i.find(rs);if(l){const e=l.props.children,r=i.map(t=>t===l?M.Children.count(e)>1?M.Children.only(null):M.isValidElement(e)?e.props.children:null:t);return t.jsx(a,{...n,ref:s,children:M.isValidElement(e)?M.cloneElement(e,void 0,r):null})}return t.jsx(a,{...n,ref:s,children:r})});return s.displayName=`${e}.Slot`,s}function as(e){const t=M.forwardRef((e,t)=>{const{children:a,...s}=e;if(M.isValidElement(a)){const e=function(e){var t,a;let s=null==(t=Object.getOwnPropertyDescriptor(e.props,"ref"))?void 0:t.get,r=s&&"isReactWarning"in s&&s.isReactWarning;if(r)return e.ref;if(s=null==(a=Object.getOwnPropertyDescriptor(e,"ref"))?void 0:a.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r)return e.props.ref;return e.props.ref||e.ref}(a),r=function(e,t){const a={...t};for(const s in t){const r=e[s],n=t[s];/^on[A-Z]/.test(s)?r&&n?a[s]=(...e)=>{const t=n(...e);return r(...e),t}:r&&(a[s]=r):"style"===s?a[s]={...r,...n}:"className"===s&&(a[s]=[r,n].filter(Boolean).join(" "))}return{...e,...a}}(s,a.props);return a.type!==M.Fragment&&(r.ref=t?Wa(t,e):e),M.cloneElement(a,r)}return M.Children.count(a)>1?M.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var ss=Symbol("radix.slottable");function rs(e){return M.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===ss}var ns=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,a)=>{const s=ts(`Primitive.${a}`),r=M.forwardRef((e,r)=>{const{asChild:n,...i}=e,l=n?s:a;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),t.jsx(l,{...i,ref:r})});return r.displayName=`Primitive.${a}`,{...e,[a]:r}},{});function is(e){const t=M.useRef(e);return M.useEffect(()=>{t.current=e}),M.useMemo(()=>(...e)=>{var a;return null==(a=t.current)?void 0:a.call(t,...e)},[])}var ls,os="dismissableLayer.update",cs="dismissableLayer.pointerDownOutside",ds="dismissableLayer.focusOutside",us=M.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),ms=M.forwardRef((e,a)=>{const{disableOutsidePointerEvents:s=!1,onEscapeKeyDown:r,onPointerDownOutside:n,onFocusOutside:i,onInteractOutside:l,onDismiss:o,...c}=e,d=M.useContext(us),[u,m]=M.useState(null),p=(null==u?void 0:u.ownerDocument)??(null==globalThis?void 0:globalThis.document),[,h]=M.useState({}),x=Ga(a,e=>m(e)),f=Array.from(d.layers),[g]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),y=f.indexOf(g),v=u?f.indexOf(u):-1,b=d.layersWithOutsidePointerEventsDisabled.size>0,j=v>=y,N=function(e,t=(null==globalThis?void 0:globalThis.document)){const a=is(e),s=M.useRef(!1),r=M.useRef(()=>{});return M.useEffect(()=>{const e=e=>{if(e.target&&!s.current){let s=function(){hs(cs,a,n,{discrete:!0})};const n={originalEvent:e};"touch"===e.pointerType?(t.removeEventListener("click",r.current),r.current=s,t.addEventListener("click",r.current,{once:!0})):s()}else t.removeEventListener("click",r.current);s.current=!1},n=window.setTimeout(()=>{t.addEventListener("pointerdown",e)},0);return()=>{window.clearTimeout(n),t.removeEventListener("pointerdown",e),t.removeEventListener("click",r.current)}},[t,a]),{onPointerDownCapture:()=>s.current=!0}}(e=>{const t=e.target,a=[...d.branches].some(e=>e.contains(t));j&&!a&&(null==n||n(e),null==l||l(e),e.defaultPrevented||null==o||o())},p),w=function(e,t=(null==globalThis?void 0:globalThis.document)){const a=is(e),s=M.useRef(!1);return M.useEffect(()=>{const e=e=>{if(e.target&&!s.current){hs(ds,a,{originalEvent:e},{discrete:!1})}};return t.addEventListener("focusin",e),()=>t.removeEventListener("focusin",e)},[t,a]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}(e=>{const t=e.target;[...d.branches].some(e=>e.contains(t))||(null==i||i(e),null==l||l(e),e.defaultPrevented||null==o||o())},p);return function(e,t=(null==globalThis?void 0:globalThis.document)){const a=is(e);M.useEffect(()=>{const e=e=>{"Escape"===e.key&&a(e)};return t.addEventListener("keydown",e,{capture:!0}),()=>t.removeEventListener("keydown",e,{capture:!0})},[a,t])}(e=>{v===d.layers.size-1&&(null==r||r(e),!e.defaultPrevented&&o&&(e.preventDefault(),o()))},p),M.useEffect(()=>{if(u)return s&&(0===d.layersWithOutsidePointerEventsDisabled.size&&(ls=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(u)),d.layers.add(u),ps(),()=>{s&&1===d.layersWithOutsidePointerEventsDisabled.size&&(p.body.style.pointerEvents=ls)}},[u,p,s,d]),M.useEffect(()=>()=>{u&&(d.layers.delete(u),d.layersWithOutsidePointerEventsDisabled.delete(u),ps())},[u,d]),M.useEffect(()=>{const e=()=>h({});return document.addEventListener(os,e),()=>document.removeEventListener(os,e)},[]),t.jsx(ns.div,{...c,ref:x,style:{pointerEvents:b?j?"auto":"none":void 0,...e.style},onFocusCapture:Va(e.onFocusCapture,w.onFocusCapture),onBlurCapture:Va(e.onBlurCapture,w.onBlurCapture),onPointerDownCapture:Va(e.onPointerDownCapture,N.onPointerDownCapture)})});ms.displayName="DismissableLayer";function ps(){const e=new CustomEvent(os);document.dispatchEvent(e)}function hs(e,t,a,{discrete:s}){const r=a.originalEvent.target,n=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:a});t&&r.addEventListener(e,t,{once:!0}),s?function(e,t){e&&T.flushSync(()=>e.dispatchEvent(t))}(r,n):r.dispatchEvent(n)}M.forwardRef((e,a)=>{const s=M.useContext(us),r=M.useRef(null),n=Ga(a,r);return M.useEffect(()=>{const e=r.current;if(e)return s.branches.add(e),()=>{s.branches.delete(e)}},[s.branches]),t.jsx(ns.div,{...e,ref:n})}).displayName="DismissableLayerBranch";var xs="focusScope.autoFocusOnMount",fs="focusScope.autoFocusOnUnmount",gs={bubbles:!1,cancelable:!0},ys=M.forwardRef((e,a)=>{const{loop:s=!1,trapped:r=!1,onMountAutoFocus:n,onUnmountAutoFocus:i,...l}=e,[o,c]=M.useState(null),d=is(n),u=is(i),m=M.useRef(null),p=Ga(a,e=>c(e)),h=M.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;M.useEffect(()=>{if(r){let e=function(e){if(h.paused||!o)return;const t=e.target;o.contains(t)?m.current=t:Ns(m.current,{select:!0})},t=function(e){if(h.paused||!o)return;const t=e.relatedTarget;null!==t&&(o.contains(t)||Ns(m.current,{select:!0}))},a=function(e){if(document.activeElement===document.body)for(const t of e)t.removedNodes.length>0&&Ns(o)};document.addEventListener("focusin",e),document.addEventListener("focusout",t);const s=new MutationObserver(a);return o&&s.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),s.disconnect()}}},[r,o,h.paused]),M.useEffect(()=>{if(o){ws.add(h);const t=document.activeElement;if(!o.contains(t)){const a=new CustomEvent(xs,gs);o.addEventListener(xs,d),o.dispatchEvent(a),a.defaultPrevented||(!function(e,{select:t=!1}={}){const a=document.activeElement;for(const s of e)if(Ns(s,{select:t}),document.activeElement!==a)return}((e=vs(o),e.filter(e=>"A"!==e.tagName)),{select:!0}),document.activeElement===t&&Ns(o))}return()=>{o.removeEventListener(xs,d),setTimeout(()=>{const e=new CustomEvent(fs,gs);o.addEventListener(fs,u),o.dispatchEvent(e),e.defaultPrevented||Ns(t??document.body,{select:!0}),o.removeEventListener(fs,u),ws.remove(h)},0)}}var e},[o,d,u,h]);const x=M.useCallback(e=>{if(!s&&!r)return;if(h.paused)return;const t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,a=document.activeElement;if(t&&a){const t=e.currentTarget,[r,n]=function(e){const t=vs(e),a=bs(t,e),s=bs(t.reverse(),e);return[a,s]}(t);r&&n?e.shiftKey||a!==n?e.shiftKey&&a===r&&(e.preventDefault(),s&&Ns(n,{select:!0})):(e.preventDefault(),s&&Ns(r,{select:!0})):a===t&&e.preventDefault()}},[s,r,h.paused]);return t.jsx(ns.div,{tabIndex:-1,...l,ref:p,onKeyDown:x})});function vs(e){const t=[],a=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{const t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;a.nextNode();)t.push(a.currentNode);return t}function bs(e,t){for(const a of e)if(!js(a,{upTo:t}))return a}function js(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e;){if(void 0!==t&&e===t)return!1;if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}function Ns(e,{select:t=!1}={}){if(e&&e.focus){const a=document.activeElement;e.focus({preventScroll:!0}),e!==a&&function(e){return e instanceof HTMLInputElement&&"select"in e}(e)&&t&&e.select()}}ys.displayName="FocusScope";var ws=function(){let e=[];return{add(t){const a=e[0];t!==a&&(null==a||a.pause()),e=_s(e,t),e.unshift(t)},remove(t){var a;e=_s(e,t),null==(a=e[0])||a.resume()}}}();function _s(e,t){const a=[...e],s=a.indexOf(t);return-1!==s&&a.splice(s,1),a}var ks=M.forwardRef((e,a)=>{var s;const{container:r,...n}=e,[i,l]=M.useState(!1);Ka(()=>l(!0),[]);const o=r||i&&(null==(s=null==globalThis?void 0:globalThis.document)?void 0:s.body);return o?R.createPortal(t.jsx(ns.div,{...n,ref:a}),o):null});ks.displayName="Portal";var Ss=e=>{const{present:t,children:a}=e,s=function(e){const[t,a]=M.useState(),s=M.useRef(null),r=M.useRef(e),n=M.useRef("none"),i=e?"mounted":"unmounted",[l,o]=function(e,t){return M.useReducer((e,a)=>t[e][a]??e,e)}(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return M.useEffect(()=>{const e=Cs(s.current);n.current="mounted"===l?e:"none"},[l]),Ka(()=>{const t=s.current,a=r.current;if(a!==e){const s=n.current,i=Cs(t);if(e)o("MOUNT");else if("none"===i||"none"===(null==t?void 0:t.display))o("UNMOUNT");else{o(a&&s!==i?"ANIMATION_OUT":"UNMOUNT")}r.current=e}},[e,o]),Ka(()=>{if(t){let e;const a=t.ownerDocument.defaultView??window,i=n=>{const i=Cs(s.current).includes(CSS.escape(n.animationName));if(n.target===t&&i&&(o("ANIMATION_END"),!r.current)){const s=t.style.animationFillMode;t.style.animationFillMode="forwards",e=a.setTimeout(()=>{"forwards"===t.style.animationFillMode&&(t.style.animationFillMode=s)})}},l=e=>{e.target===t&&(n.current=Cs(s.current))};return t.addEventListener("animationstart",l),t.addEventListener("animationcancel",i),t.addEventListener("animationend",i),()=>{a.clearTimeout(e),t.removeEventListener("animationstart",l),t.removeEventListener("animationcancel",i),t.removeEventListener("animationend",i)}}o("ANIMATION_END")},[t,o]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:M.useCallback(e=>{s.current=e?getComputedStyle(e):null,a(e)},[])}}(t),r="function"==typeof a?a({present:s.isPresent}):M.Children.only(a),n=Ga(s.ref,function(e){var t,a;let s=null==(t=Object.getOwnPropertyDescriptor(e.props,"ref"))?void 0:t.get,r=s&&"isReactWarning"in s&&s.isReactWarning;if(r)return e.ref;if(s=null==(a=Object.getOwnPropertyDescriptor(e,"ref"))?void 0:a.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r)return e.props.ref;return e.props.ref||e.ref}(r));return"function"==typeof a||s.isPresent?M.cloneElement(r,{ref:n}):null};function Cs(e){return(null==e?void 0:e.animationName)||"none"}Ss.displayName="Presence";var Es=0;function Ps(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var As=j(),Ds=function(){},Ms=M.forwardRef(function(e,t){var a=M.useRef(null),s=M.useState({onScrollCapture:Ds,onWheelCapture:Ds,onTouchMoveCapture:Ds}),r=s[0],n=s[1],i=e.forwardProps,l=e.children,o=e.className,c=e.removeScrollBar,d=e.enabled,u=e.shards,m=e.sideCar,p=e.noRelative,h=e.noIsolation,x=e.inert,f=e.allowPinchZoom,g=e.as,y=void 0===g?"div":g,v=e.gapMode,b=N(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),j=m,k=w([a,t]),S=_(_({},b),r);return M.createElement(M.Fragment,null,d&&M.createElement(j,{sideCar:As,removeScrollBar:c,shards:u,noRelative:p,noIsolation:h,inert:x,setCallbacks:n,allowPinchZoom:!!f,lockRef:a,gapMode:v}),i?M.cloneElement(M.Children.only(l),_(_({},S),{ref:k})):M.createElement(y,_({},S,{className:o,ref:k}),l))});Ms.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},Ms.classNames={fullWidth:k,zeroRight:S};var Is=!1;if("undefined"!=typeof window)try{var Ts=Object.defineProperty({},"passive",{get:function(){return Is=!0,!0}});window.addEventListener("test",Ts,Ts),window.removeEventListener("test",Ts,Ts)}catch(Wn){Is=!1}var Rs=!!Is&&{passive:!1},Fs=function(e,t){if(!(e instanceof Element))return!1;var a=window.getComputedStyle(e);return"hidden"!==a[t]&&!(a.overflowY===a.overflowX&&!function(e){return"TEXTAREA"===e.tagName}(e)&&"visible"===a[t])},Os=function(e,t){var a=t.ownerDocument,s=t;do{if("undefined"!=typeof ShadowRoot&&s instanceof ShadowRoot&&(s=s.host),zs(e,s)){var r=Ls(e,s);if(r[1]>r[2])return!0}s=s.parentNode}while(s&&s!==a.body);return!1},zs=function(e,t){return"v"===e?function(e){return Fs(e,"overflowY")}(t):function(e){return Fs(e,"overflowX")}(t)},Ls=function(e,t){return"v"===e?[(a=t).scrollTop,a.scrollHeight,a.clientHeight]:function(e){return[e.scrollLeft,e.scrollWidth,e.clientWidth]}(t);var a},$s=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Bs=function(e){return[e.deltaX,e.deltaY]},Us=function(e){return e&&"current"in e?e.current:e},qs=function(e){return"\n  .block-interactivity-".concat(e," {pointer-events: none;}\n  .allow-interactivity-").concat(e," {pointer-events: all;}\n")},Vs=0,Ys=[];function Ws(e){for(var t=null;null!==e;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Gs=A(As,function(e){var t=M.useRef([]),a=M.useRef([0,0]),s=M.useRef(),r=M.useState(Vs++)[0],n=M.useState(C)[0],i=M.useRef(e);M.useEffect(function(){i.current=e},[e]),M.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(r));var t=E([e.lockRef.current],(e.shards||[]).map(Us),!0).filter(Boolean);return t.forEach(function(e){return e.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),t.forEach(function(e){return e.classList.remove("allow-interactivity-".concat(r))})}}},[e.inert,e.lockRef.current,e.shards]);var l=M.useCallback(function(e,t){if("touches"in e&&2===e.touches.length||"wheel"===e.type&&e.ctrlKey)return!i.current.allowPinchZoom;var r,n=$s(e),l=a.current,o="deltaX"in e?e.deltaX:l[0]-n[0],c="deltaY"in e?e.deltaY:l[1]-n[1],d=e.target,u=Math.abs(o)>Math.abs(c)?"h":"v";if("touches"in e&&"h"===u&&"range"===d.type)return!1;var m=Os(u,d);if(!m)return!0;if(m?r=u:(r="v"===u?"h":"v",m=Os(u,d)),!m)return!1;if(!s.current&&"changedTouches"in e&&(o||c)&&(s.current=r),!r)return!0;var p=s.current||r;return function(e,t,a,s,r){var n=function(e,t){return"h"===e&&"rtl"===t?-1:1}(e,window.getComputedStyle(t).direction),i=n*s,l=a.target,o=t.contains(l),c=!1,d=i>0,u=0,m=0;do{if(!l)break;var p=Ls(e,l),h=p[0],x=p[1]-p[2]-n*h;(h||x)&&zs(e,l)&&(u+=x,m+=h);var f=l.parentNode;l=f&&f.nodeType===Node.DOCUMENT_FRAGMENT_NODE?f.host:f}while(!o&&l!==document.body||o&&(t.contains(l)||t===l));return d&&(Math.abs(u)<1||!r)?c=!0:d||!(Math.abs(m)<1)&&r||(c=!0),c}(p,t,e,"h"===p?o:c,!0)},[]),o=M.useCallback(function(e){var a=e;if(Ys.length&&Ys[Ys.length-1]===n){var s="deltaY"in a?Bs(a):$s(a),r=t.current.filter(function(e){return e.name===a.type&&(e.target===a.target||a.target===e.shadowParent)&&(t=e.delta,r=s,t[0]===r[0]&&t[1]===r[1]);var t,r})[0];if(r&&r.should)a.cancelable&&a.preventDefault();else if(!r){var o=(i.current.shards||[]).map(Us).filter(Boolean).filter(function(e){return e.contains(a.target)});(o.length>0?l(a,o[0]):!i.current.noIsolation)&&a.cancelable&&a.preventDefault()}}},[]),c=M.useCallback(function(e,a,s,r){var n={name:e,delta:a,target:s,should:r,shadowParent:Ws(s)};t.current.push(n),setTimeout(function(){t.current=t.current.filter(function(e){return e!==n})},1)},[]),d=M.useCallback(function(e){a.current=$s(e),s.current=void 0},[]),u=M.useCallback(function(t){c(t.type,Bs(t),t.target,l(t,e.lockRef.current))},[]),m=M.useCallback(function(t){c(t.type,$s(t),t.target,l(t,e.lockRef.current))},[]);M.useEffect(function(){return Ys.push(n),e.setCallbacks({onScrollCapture:u,onWheelCapture:u,onTouchMoveCapture:m}),document.addEventListener("wheel",o,Rs),document.addEventListener("touchmove",o,Rs),document.addEventListener("touchstart",d,Rs),function(){Ys=Ys.filter(function(e){return e!==n}),document.removeEventListener("wheel",o,Rs),document.removeEventListener("touchmove",o,Rs),document.removeEventListener("touchstart",d,Rs)}},[]);var p=e.removeScrollBar,h=e.inert;return M.createElement(M.Fragment,null,h?M.createElement(n,{styles:qs(r)}):null,p?M.createElement(P,{noRelative:e.noRelative,gapMode:e.gapMode}):null)});var Hs=M.forwardRef(function(e,t){return M.createElement(Ms,_({},e,{ref:t,sideCar:Gs}))});Hs.classNames=Ms.classNames;var Ks="Dialog",[Xs,Zs]=function(e,a=[]){let s=[];const r=()=>{const t=s.map(e=>M.createContext(e));return function(a){const s=(null==a?void 0:a[e])||t;return M.useMemo(()=>({[`__scope${e}`]:{...a,[e]:s}}),[a,s])}};return r.scopeName=e,[function(a,r){const n=M.createContext(r),i=s.length;s=[...s,r];const l=a=>{var s;const{scope:r,children:l,...o}=a,c=(null==(s=null==r?void 0:r[e])?void 0:s[i])||n,d=M.useMemo(()=>o,Object.values(o));return t.jsx(c.Provider,{value:d,children:l})};return l.displayName=a+"Provider",[l,function(t,s){var l;const o=(null==(l=null==s?void 0:s[e])?void 0:l[i])||n,c=M.useContext(o);if(c)return c;if(void 0!==r)return r;throw new Error(`\`${t}\` must be used within \`${a}\``)}]},Ha(r,...a)]}(Ks),[Js,Qs]=Xs(Ks),er=e=>{const{__scopeDialog:a,children:s,open:r,defaultOpen:n,onOpenChange:i,modal:l=!0}=e,o=M.useRef(null),c=M.useRef(null),[d,u]=es({prop:r,defaultProp:n??!1,onChange:i,caller:Ks});return t.jsx(Js,{scope:a,triggerRef:o,contentRef:c,contentId:Ja(),titleId:Ja(),descriptionId:Ja(),open:d,onOpenChange:u,onOpenToggle:M.useCallback(()=>u(e=>!e),[u]),modal:l,children:s})};er.displayName=Ks;var tr="DialogTrigger";M.forwardRef((e,a)=>{const{__scopeDialog:s,...r}=e,n=Qs(tr,s),i=Ga(a,n.triggerRef);return t.jsx(ns.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":yr(n.open),...r,ref:i,onClick:Va(e.onClick,n.onOpenToggle)})}).displayName=tr;var ar="DialogPortal",[sr,rr]=Xs(ar,{forceMount:void 0}),nr=e=>{const{__scopeDialog:a,forceMount:s,children:r,container:n}=e,i=Qs(ar,a);return t.jsx(sr,{scope:a,forceMount:s,children:M.Children.map(r,e=>t.jsx(Ss,{present:s||i.open,children:t.jsx(ks,{asChild:!0,container:n,children:e})}))})};nr.displayName=ar;var ir="DialogOverlay",lr=M.forwardRef((e,a)=>{const s=rr(ir,e.__scopeDialog),{forceMount:r=s.forceMount,...n}=e,i=Qs(ir,e.__scopeDialog);return i.modal?t.jsx(Ss,{present:r||i.open,children:t.jsx(cr,{...n,ref:a})}):null});lr.displayName=ir;var or=ts("DialogOverlay.RemoveScroll"),cr=M.forwardRef((e,a)=>{const{__scopeDialog:s,...r}=e,n=Qs(ir,s);return t.jsx(Hs,{as:or,allowPinchZoom:!0,shards:[n.contentRef],children:t.jsx(ns.div,{"data-state":yr(n.open),...r,ref:a,style:{pointerEvents:"auto",...r.style}})})}),dr="DialogContent",ur=M.forwardRef((e,a)=>{const s=rr(dr,e.__scopeDialog),{forceMount:r=s.forceMount,...n}=e,i=Qs(dr,e.__scopeDialog);return t.jsx(Ss,{present:r||i.open,children:i.modal?t.jsx(mr,{...n,ref:a}):t.jsx(pr,{...n,ref:a})})});ur.displayName=dr;var mr=M.forwardRef((e,a)=>{const s=Qs(dr,e.__scopeDialog),r=M.useRef(null),n=Ga(a,s.contentRef,r);return M.useEffect(()=>{const e=r.current;if(e)return D(e)},[]),t.jsx(hr,{...e,ref:n,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Va(e.onCloseAutoFocus,e=>{var t;e.preventDefault(),null==(t=s.triggerRef.current)||t.focus()}),onPointerDownOutside:Va(e.onPointerDownOutside,e=>{const t=e.detail.originalEvent,a=0===t.button&&!0===t.ctrlKey;(2===t.button||a)&&e.preventDefault()}),onFocusOutside:Va(e.onFocusOutside,e=>e.preventDefault())})}),pr=M.forwardRef((e,a)=>{const s=Qs(dr,e.__scopeDialog),r=M.useRef(!1),n=M.useRef(!1);return t.jsx(hr,{...e,ref:a,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{var a,i;null==(a=e.onCloseAutoFocus)||a.call(e,t),t.defaultPrevented||(r.current||null==(i=s.triggerRef.current)||i.focus(),t.preventDefault()),r.current=!1,n.current=!1},onInteractOutside:t=>{var a,i;null==(a=e.onInteractOutside)||a.call(e,t),t.defaultPrevented||(r.current=!0,"pointerdown"===t.detail.originalEvent.type&&(n.current=!0));const l=t.target;(null==(i=s.triggerRef.current)?void 0:i.contains(l))&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&n.current&&t.preventDefault()}})}),hr=M.forwardRef((e,a)=>{const{__scopeDialog:s,trapFocus:r,onOpenAutoFocus:n,onCloseAutoFocus:i,...l}=e,o=Qs(dr,s),c=M.useRef(null),d=Ga(a,c);return M.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??Ps()),document.body.insertAdjacentElement("beforeend",e[1]??Ps()),Es++,()=>{1===Es&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Es--}},[]),t.jsxs(t.Fragment,{children:[t.jsx(ys,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:n,onUnmountAutoFocus:i,children:t.jsx(ms,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":yr(o.open),...l,ref:d,onDismiss:()=>o.onOpenChange(!1)})}),t.jsxs(t.Fragment,{children:[t.jsx(Nr,{titleId:o.titleId}),t.jsx(wr,{contentRef:c,descriptionId:o.descriptionId})]})]})}),xr="DialogTitle";M.forwardRef((e,a)=>{const{__scopeDialog:s,...r}=e,n=Qs(xr,s);return t.jsx(ns.h2,{id:n.titleId,...r,ref:a})}).displayName=xr;var fr="DialogDescription";M.forwardRef((e,a)=>{const{__scopeDialog:s,...r}=e,n=Qs(fr,s);return t.jsx(ns.p,{id:n.descriptionId,...r,ref:a})}).displayName=fr;var gr="DialogClose";function yr(e){return e?"open":"closed"}M.forwardRef((e,a)=>{const{__scopeDialog:s,...r}=e,n=Qs(gr,s);return t.jsx(ns.button,{type:"button",...r,ref:a,onClick:Va(e.onClick,()=>n.onOpenChange(!1))})}).displayName=gr;var vr="DialogTitleWarning",[br,jr]=function(e,a){const s=M.createContext(a),r=e=>{const{children:a,...r}=e,n=M.useMemo(()=>r,Object.values(r));return t.jsx(s.Provider,{value:n,children:a})};return r.displayName=e+"Provider",[r,function(t){const r=M.useContext(s);if(r)return r;if(void 0!==a)return a;throw new Error(`\`${t}\` must be used within \`${e}\``)}]}(vr,{contentName:dr,titleName:xr,docsSlug:"dialog"}),Nr=({titleId:e})=>{const t=jr(vr),a=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.\n\nIf you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return M.useEffect(()=>{if(e){document.getElementById(e)}},[a,e]),null},wr=({contentRef:e,descriptionId:t})=>{const a=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${jr("DialogDescriptionWarning").contentName}}.`;return M.useEffect(()=>{var a;const s=null==(a=e.current)?void 0:a.getAttribute("aria-describedby");if(t&&s){document.getElementById(t)}},[a,e,t]),null},_r=er,kr=nr,Sr=lr,Cr=ur,Er='[cmdk-group=""]',Pr='[cmdk-group-items=""]',Ar='[cmdk-item=""]',Dr=`${Ar}:not([aria-disabled="true"])`,Mr="cmdk-item-select",Ir="data-value",Tr=(e,t,a)=>qa(e,t,a),Rr=M.createContext(void 0),Fr=()=>M.useContext(Rr),Or=M.createContext(void 0),zr=()=>M.useContext(Or),Lr=M.createContext(void 0),$r=M.forwardRef((e,t)=>{let a=en(()=>{var t,a;return{search:"",value:null!=(a=null!=(t=e.value)?t:e.defaultValue)?a:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),s=en(()=>new Set),r=en(()=>new Map),n=en(()=>new Map),i=en(()=>new Set),l=Jr(e),{label:o,children:c,value:d,onValueChange:u,filter:m,shouldFilter:p,loop:h,disablePointerSelection:x=!1,vimBindings:f=!0,...g}=e,y=Ja(),v=Ja(),b=Ja(),j=M.useRef(null),N=sn();Qr(()=>{if(void 0!==d){let e=d.trim();a.current.value=e,w.emit()}},[d]),Qr(()=>{N(6,P)},[]);let w=M.useMemo(()=>({subscribe:e=>(i.current.add(e),()=>i.current.delete(e)),snapshot:()=>a.current,setState:(e,t,s)=>{var r,n,i,o;if(!Object.is(a.current[e],t)){if(a.current[e]=t,"search"===e)E(),S(),N(1,C);else if("value"===e){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let e=document.getElementById(b);e?e.focus():null==(r=document.getElementById(y))||r.focus()}if(N(7,()=>{var e;a.current.selectedItemId=null==(e=A())?void 0:e.id,w.emit()}),s||N(5,P),void 0!==(null==(n=l.current)?void 0:n.value)){let e=null!=t?t:"";return void(null==(o=(i=l.current).onValueChange)||o.call(i,e))}}w.emit()}},emit:()=>{i.current.forEach(e=>e())}}),[]),_=M.useMemo(()=>({value:(e,t,s)=>{var r;t!==(null==(r=n.current.get(e))?void 0:r.value)&&(n.current.set(e,{value:t,keywords:s}),a.current.filtered.items.set(e,k(t,s)),N(2,()=>{S(),w.emit()}))},item:(e,t)=>(s.current.add(e),t&&(r.current.has(t)?r.current.get(t).add(e):r.current.set(t,new Set([e]))),N(3,()=>{E(),S(),a.current.value||C(),w.emit()}),()=>{n.current.delete(e),s.current.delete(e),a.current.filtered.items.delete(e);let t=A();N(4,()=>{E(),(null==t?void 0:t.getAttribute("id"))===e&&C(),w.emit()})}),group:e=>(r.current.has(e)||r.current.set(e,new Set),()=>{n.current.delete(e),r.current.delete(e)}),filter:()=>l.current.shouldFilter,label:o||e["aria-label"],getDisablePointerSelection:()=>l.current.disablePointerSelection,listId:y,inputId:b,labelId:v,listInnerRef:j}),[]);function k(e,t){var s,r;let n=null!=(r=null==(s=l.current)?void 0:s.filter)?r:Tr;return e?n(e,a.current.search,t):0}function S(){if(!a.current.search||!1===l.current.shouldFilter)return;let e=a.current.filtered.items,t=[];a.current.filtered.groups.forEach(a=>{let s=r.current.get(a),n=0;s.forEach(t=>{let a=e.get(t);n=Math.max(a,n)}),t.push([a,n])});let s=j.current;D().sort((t,a)=>{var s,r;let n=t.getAttribute("id"),i=a.getAttribute("id");return(null!=(s=e.get(i))?s:0)-(null!=(r=e.get(n))?r:0)}).forEach(e=>{let t=e.closest(Pr);t?t.appendChild(e.parentElement===t?e:e.closest(`${Pr} > *`)):s.appendChild(e.parentElement===s?e:e.closest(`${Pr} > *`))}),t.sort((e,t)=>t[1]-e[1]).forEach(e=>{var t;let a=null==(t=j.current)?void 0:t.querySelector(`${Er}[${Ir}="${encodeURIComponent(e[0])}"]`);null==a||a.parentElement.appendChild(a)})}function C(){let e=D().find(e=>"true"!==e.getAttribute("aria-disabled")),t=null==e?void 0:e.getAttribute(Ir);w.setState("value",t||void 0)}function E(){var e,t,i,o;if(!a.current.search||!1===l.current.shouldFilter)return void(a.current.filtered.count=s.current.size);a.current.filtered.groups=new Set;let c=0;for(let r of s.current){let s=k(null!=(t=null==(e=n.current.get(r))?void 0:e.value)?t:"",null!=(o=null==(i=n.current.get(r))?void 0:i.keywords)?o:[]);a.current.filtered.items.set(r,s),s>0&&c++}for(let[s,n]of r.current)for(let e of n)if(a.current.filtered.items.get(e)>0){a.current.filtered.groups.add(s);break}a.current.filtered.count=c}function P(){var e,t,a;let s=A();s&&((null==(e=s.parentElement)?void 0:e.firstChild)===s&&(null==(a=null==(t=s.closest(Er))?void 0:t.querySelector('[cmdk-group-heading=""]'))||a.scrollIntoView({block:"nearest"})),s.scrollIntoView({block:"nearest"}))}function A(){var e;return null==(e=j.current)?void 0:e.querySelector(`${Ar}[aria-selected="true"]`)}function D(){var e;return Array.from((null==(e=j.current)?void 0:e.querySelectorAll(Dr))||[])}function I(e){let t=D()[e];t&&w.setState("value",t.getAttribute(Ir))}function T(e){var t;let a=A(),s=D(),r=s.findIndex(e=>e===a),n=s[r+e];null!=(t=l.current)&&t.loop&&(n=r+e<0?s[s.length-1]:r+e===s.length?s[0]:s[r+e]),n&&w.setState("value",n.getAttribute(Ir))}function R(e){let t,a=A(),s=null==a?void 0:a.closest(Er);for(;s&&!t;)s=e>0?Xr(s,Er):Zr(s,Er),t=null==s?void 0:s.querySelector(Dr);t?w.setState("value",t.getAttribute(Ir)):T(e)}let F=()=>I(D().length-1),O=e=>{e.preventDefault(),e.metaKey?F():e.altKey?R(1):T(1)},z=e=>{e.preventDefault(),e.metaKey?I(0):e.altKey?R(-1):T(-1)};return M.createElement(ns.div,{ref:t,tabIndex:-1,...g,"cmdk-root":"",onKeyDown:e=>{var t;null==(t=g.onKeyDown)||t.call(g,e);let a=e.nativeEvent.isComposing||229===e.keyCode;if(!e.defaultPrevented&&!a)switch(e.key){case"n":case"j":f&&e.ctrlKey&&O(e);break;case"ArrowDown":O(e);break;case"p":case"k":f&&e.ctrlKey&&z(e);break;case"ArrowUp":z(e);break;case"Home":e.preventDefault(),I(0);break;case"End":e.preventDefault(),F();break;case"Enter":{e.preventDefault();let t=A();if(t){let e=new Event(Mr);t.dispatchEvent(e)}}}}},M.createElement("label",{"cmdk-label":"",htmlFor:_.inputId,id:_.labelId,style:nn},o),rn(e,e=>M.createElement(Or.Provider,{value:w},M.createElement(Rr.Provider,{value:_},e))))}),Br=M.forwardRef((e,t)=>{var a,s;let r=Ja(),n=M.useRef(null),i=M.useContext(Lr),l=Fr(),o=Jr(e),c=null!=(s=null==(a=o.current)?void 0:a.forceMount)?s:null==i?void 0:i.forceMount;Qr(()=>{if(!c)return l.item(r,null==i?void 0:i.id)},[c]);let d=an(r,n,[e.value,e.children,n],e.keywords),u=zr(),m=tn(e=>e.value&&e.value===d.current),p=tn(e=>!(!c&&!1!==l.filter())||(!e.search||e.filtered.items.get(r)>0));function h(){var e,t;x(),null==(t=(e=o.current).onSelect)||t.call(e,d.current)}function x(){u.setState("value",d.current,!0)}if(M.useEffect(()=>{let t=n.current;if(t&&!e.disabled)return t.addEventListener(Mr,h),()=>t.removeEventListener(Mr,h)},[p,e.onSelect,e.disabled]),!p)return null;let{disabled:f,value:g,onSelect:y,forceMount:v,keywords:b,...j}=e;return M.createElement(ns.div,{ref:Wa(n,t),...j,id:r,"cmdk-item":"",role:"option","aria-disabled":!!f,"aria-selected":!!m,"data-disabled":!!f,"data-selected":!!m,onPointerMove:f||l.getDisablePointerSelection()?void 0:x,onClick:f?void 0:h},e.children)}),Ur=M.forwardRef((e,t)=>{let{heading:a,children:s,forceMount:r,...n}=e,i=Ja(),l=M.useRef(null),o=M.useRef(null),c=Ja(),d=Fr(),u=tn(e=>!(!r&&!1!==d.filter())||(!e.search||e.filtered.groups.has(i)));Qr(()=>d.group(i),[]),an(i,l,[e.value,e.heading,o]);let m=M.useMemo(()=>({id:i,forceMount:r}),[r]);return M.createElement(ns.div,{ref:Wa(l,t),...n,"cmdk-group":"",role:"presentation",hidden:!u||void 0},a&&M.createElement("div",{ref:o,"cmdk-group-heading":"","aria-hidden":!0,id:c},a),rn(e,e=>M.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":a?c:void 0},M.createElement(Lr.Provider,{value:m},e))))}),qr=M.forwardRef((e,t)=>{let{alwaysRender:a,...s}=e,r=M.useRef(null),n=tn(e=>!e.search);return a||n?M.createElement(ns.div,{ref:Wa(r,t),...s,"cmdk-separator":"",role:"separator"}):null}),Vr=M.forwardRef((e,t)=>{let{onValueChange:a,...s}=e,r=null!=e.value,n=zr(),i=tn(e=>e.search),l=tn(e=>e.selectedItemId),o=Fr();return M.useEffect(()=>{null!=e.value&&n.setState("search",e.value)},[e.value]),M.createElement(ns.input,{ref:t,...s,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":o.listId,"aria-labelledby":o.labelId,"aria-activedescendant":l,id:o.inputId,type:"text",value:r?e.value:i,onChange:e=>{r||n.setState("search",e.target.value),null==a||a(e.target.value)}})}),Yr=M.forwardRef((e,t)=>{let{children:a,label:s="Suggestions",...r}=e,n=M.useRef(null),i=M.useRef(null),l=tn(e=>e.selectedItemId),o=Fr();return M.useEffect(()=>{if(i.current&&n.current){let e,t=i.current,a=n.current,s=new ResizeObserver(()=>{e=requestAnimationFrame(()=>{let e=t.offsetHeight;a.style.setProperty("--cmdk-list-height",e.toFixed(1)+"px")})});return s.observe(t),()=>{cancelAnimationFrame(e),s.unobserve(t)}}},[]),M.createElement(ns.div,{ref:Wa(n,t),...r,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":l,"aria-label":s,id:o.listId},rn(e,e=>M.createElement("div",{ref:Wa(i,o.listInnerRef),"cmdk-list-sizer":""},e)))}),Wr=M.forwardRef((e,t)=>{let{open:a,onOpenChange:s,overlayClassName:r,contentClassName:n,container:i,...l}=e;return M.createElement(_r,{open:a,onOpenChange:s},M.createElement(kr,{container:i},M.createElement(Sr,{"cmdk-overlay":"",className:r}),M.createElement(Cr,{"aria-label":e.label,"cmdk-dialog":"",className:n},M.createElement($r,{ref:t,...l}))))}),Gr=M.forwardRef((e,t)=>tn(e=>0===e.filtered.count)?M.createElement(ns.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),Hr=M.forwardRef((e,t)=>{let{progress:a,children:s,label:r="Loading...",...n}=e;return M.createElement(ns.div,{ref:t,...n,"cmdk-loading":"",role:"progressbar","aria-valuenow":a,"aria-valuemin":0,"aria-valuemax":100,"aria-label":r},rn(e,e=>M.createElement("div",{"aria-hidden":!0},e)))}),Kr=Object.assign($r,{List:Yr,Item:Br,Input:Vr,Group:Ur,Separator:qr,Dialog:Wr,Empty:Gr,Loading:Hr});function Xr(e,t){let a=e.nextElementSibling;for(;a;){if(a.matches(t))return a;a=a.nextElementSibling}}function Zr(e,t){let a=e.previousElementSibling;for(;a;){if(a.matches(t))return a;a=a.previousElementSibling}}function Jr(e){let t=M.useRef(e);return Qr(()=>{t.current=e}),t}var Qr="undefined"==typeof window?M.useEffect:M.useLayoutEffect;function en(e){let t=M.useRef();return void 0===t.current&&(t.current=e()),t}function tn(e){let t=zr(),a=()=>e(t.snapshot());return M.useSyncExternalStore(t.subscribe,a,a)}function an(e,t,a,s=[]){let r=M.useRef(),n=Fr();return Qr(()=>{var i;let l=(()=>{var e;for(let t of a){if("string"==typeof t)return t.trim();if("object"==typeof t&&"current"in t)return t.current?null==(e=t.current.textContent)?void 0:e.trim():r.current}})(),o=s.map(e=>e.trim());n.value(e,l,o),null==(i=t.current)||i.setAttribute(Ir,l),r.current=l}),r}var sn=()=>{let[e,t]=M.useState(),a=en(()=>new Map);return Qr(()=>{a.current.forEach(e=>e()),a.current=new Map},[e]),(e,s)=>{a.current.set(e,s),t({})}};function rn({asChild:e,children:t},a){return e&&M.isValidElement(t)?M.cloneElement(function(e){let t=e.type;return"function"==typeof t?t(e.props):"render"in t?t.render(e.props):e}(t),{ref:t.ref},a(t.props.children)):a(t)}var nn={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const ln=M.forwardRef(({className:e,...a},s)=>t.jsx(Kr,{ref:s,className:te("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...a}));ln.displayName=Kr.displayName;const on=M.forwardRef(({className:e,...a},s)=>t.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[t.jsx(ie,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),t.jsx(Kr.Input,{ref:s,className:te("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...a})]}));on.displayName=Kr.Input.displayName;const cn=M.forwardRef(({className:e,...a},s)=>t.jsx(Kr.List,{ref:s,className:te("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...a}));cn.displayName=Kr.List.displayName;const dn=M.forwardRef(({className:e,...a},s)=>t.jsx(Kr.Empty,{ref:s,className:te("py-6 text-center text-sm",e),...a}));dn.displayName=Kr.Empty.displayName;const un=M.forwardRef(({className:e,...a},s)=>t.jsx(Kr.Group,{ref:s,className:te("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...a}));un.displayName=Kr.Group.displayName;M.forwardRef(({className:e,...a},s)=>t.jsx(Kr.Separator,{ref:s,className:te("-mx-1 h-px bg-border",e),...a})).displayName=Kr.Separator.displayName;const mn=M.forwardRef(({className:e,...a},s)=>t.jsx(Kr.Item,{ref:s,className:te("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50",e),...a}));mn.displayName=Kr.Item.displayName;const pn=({tripId:e,selectedMembers:a,onMembersChange:s,isSingleTask:r})=>{const{tripMembers:n,loading:i}=z(e),l=Array.isArray(n)?n:[],[o,c]=F.useState(!1);F.useEffect(()=>{!r&&l.length>0&&0===a.length&&s(l.map(e=>e.id))},[r,l,a.length,s]);const d=l.filter(e=>a.includes(e.id)).map(e=>e.name).join(", "),u=0===a.length?r?"Assign to someone":"Assign to group":a.length!==l.length||r?d:"Everyone";return i?t.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[t.jsx(je,{size:16}),t.jsx("span",{children:"Loading members..."})]}):t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-gray-300",children:r?"Assign to:":"Group members:"}),!r&&t.jsx(W,{type:"button",variant:"ghost",size:"sm",onClick:()=>{const e=a.length===l.length;s(e?[]:l.map(e=>e.id))},className:"text-xs text-gray-400 hover:text-white",children:a.length===l.length?"Deselect All":"Select All"})]}),t.jsxs(Fe,{open:o,onOpenChange:c,children:[t.jsx(Oe,{asChild:!0,children:t.jsxs(W,{variant:"outline",role:"combobox","aria-expanded":o,className:"w-full justify-between bg-gray-800 border-gray-600 text-white hover:bg-gray-700",children:[t.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[r?t.jsx(Ne,{size:16,className:"text-gray-400 shrink-0"}):t.jsx(je,{size:16,className:"text-gray-400 shrink-0"}),t.jsx("span",{className:"truncate",children:u})]}),t.jsx($e,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),t.jsx(ze,{className:"w-full p-0 bg-gray-800 border-gray-600 z-50",children:t.jsxs(ln,{className:"bg-gray-800",children:[t.jsx(on,{placeholder:"Search members...",className:"bg-gray-800 border-gray-600 text-white"}),t.jsxs(cn,{children:[t.jsx(dn,{children:"No members found."}),t.jsx(un,{children:l.map(e=>t.jsxs(mn,{onSelect:()=>{return t=e.id,void(a.includes(t)?s(a.filter(e=>e!==t)):s([...a,t]));var t},className:"flex items-center gap-3 cursor-pointer hover:bg-gray-700",children:[t.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[t.jsxs(X,{className:"w-6 h-6",children:[t.jsx(Z,{src:e.avatar}),t.jsx(J,{className:"text-xs",children:e.name.charAt(0).toUpperCase()})]}),t.jsx("span",{className:"text-white",children:e.name})]}),t.jsx(Ge,{className:"h-4 w-4 "+(a.includes(e.id)?"opacity-100":"opacity-0")})]},e.id))})]})]})})]}),a.length>0&&t.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:l.filter(e=>a.includes(e.id)).map(e=>t.jsx(Q,{variant:"secondary",className:"text-xs bg-gray-700 text-gray-200",children:e.name},e.id))})]})},hn=({tripId:e,onClose:a})=>{const[s,r]=M.useState(""),[n,i]=M.useState(""),[l,o]=M.useState(),[c,d]=M.useState("solo"),[u,m]=M.useState(!1),[p,h]=M.useState([]),{createTaskMutation:x}=ge(e),{accentColors:f}=le();return t.jsx(ke,{open:!0,onOpenChange:a,children:t.jsxs(Se,{className:"sm:max-w-md bg-gray-900 border-gray-700",children:[t.jsx(Ce,{children:t.jsx(Ee,{className:"text-white",children:"Create New Task"})}),t.jsxs("form",{onSubmit:e=>{e.preventDefault(),s.trim()&&x.mutate({title:s.trim(),description:n.trim()||void 0,due_at:null==l?void 0:l.toISOString(),is_poll:"poll"===c,assignedTo:p},{onSuccess:()=>{r(""),i(""),o(void 0),d("solo"),h([]),a()},onError:e=>{}})},className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Pe,{htmlFor:"title",className:"text-gray-300",children:"Task Title"}),t.jsx(Me,{id:"title",value:s,onChange:e=>r(e.target.value),placeholder:"What needs to be done?",maxLength:140,className:"bg-gray-800 border-gray-600 text-white",autoFocus:!0}),t.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[s.length,"/140"]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Pe,{htmlFor:"description",className:"text-gray-300",children:"Description (Optional)"}),t.jsx(Ie,{id:"description",value:n,onChange:e=>i(e.target.value),placeholder:"Add more details...",className:"bg-gray-800 border-gray-600 text-white min-h-[80px]"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Pe,{className:"text-gray-300",children:"Due Date (Optional)"}),t.jsxs(Fe,{open:u,onOpenChange:m,children:[t.jsx(Oe,{asChild:!0,children:t.jsxs(W,{variant:"outline",className:"w-full justify-start text-left bg-gray-800 border-gray-600 text-white hover:bg-gray-700",children:[t.jsx(be,{size:16,className:"mr-2"}),l?xe(l,"PPP"):"Set due date"]})}),t.jsx(ze,{className:"w-auto p-0 bg-gray-800 border-gray-600",children:t.jsx(Le,{mode:"single",selected:l,onSelect:e=>{o(e),m(!1)},disabled:e=>e<new Date,className:"text-white"})})]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx(Pe,{className:"text-gray-300",children:"Task Type"}),t.jsxs(Ta,{value:c,onValueChange:e=>d(e),children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(Ra,{value:"solo",id:"solo"}),t.jsxs(Pe,{htmlFor:"solo",className:"flex items-center gap-2 text-gray-300",children:[t.jsx(Ne,{size:16}),"Single Task - Assign to specific people"]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(Ra,{value:"poll",id:"poll"}),t.jsxs(Pe,{htmlFor:"poll",className:"flex items-center gap-2 text-gray-300",children:[t.jsx(je,{size:16}),"Group Task - Everyone needs to complete this"]})]})]})]}),t.jsx(pn,{tripId:e,selectedMembers:p,onMembersChange:h,isSingleTask:"solo"===c}),t.jsxs("div",{className:"flex gap-3 pt-4",children:[t.jsx(W,{type:"button",variant:"outline",onClick:a,className:"flex-1 border-gray-600 text-gray-300 hover:bg-gray-700",children:"Cancel"}),t.jsx(W,{type:"submit",disabled:!s.trim()||x.isPending,className:`flex-1 bg-gradient-to-r ${f.gradient} hover:opacity-90`,children:x.isPending?"Creating...":"Create Task"})]})]})]})})},xn=({tripId:e})=>{const[a,s]=M.useState(!1),[r,n]=M.useState(!1),{accentColors:i}=le(),{tasks:l,isLoading:o,applyFilters:c,status:d,setStatus:u,assignee:m,setAssignee:p,dateRange:h,setDateRange:x,sortBy:f,setSortBy:g,hasActiveFilters:y,clearFilters:v}=ge(e),{isDemoMode:b}=ye(),j=[{id:"task-1",trip_id:e,title:"Make sure your visa and passport documents are handled at least one month prior",description:"Verify all travel documents are valid and up to date",due_at:new Date(Date.now()+2592e6).toISOString(),is_poll:!1,task_status:[{task_id:"task-1",completed:!1,user_id:"user1"}],creator_id:"trip-organizer",created_by:"Trip Organizer",created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()},{id:"task-2",trip_id:e,title:"Jimmy to purchase alcohol for the house while Sam gets food",description:"Coordinate house supplies for the trip",due_at:new Date(Date.now()+6048e5).toISOString(),is_poll:!1,task_status:[{task_id:"task-2",completed:!0,user_id:"jimmy"}],creator_id:"marcus",created_by:"Marcus",created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()},{id:"task-3",trip_id:e,title:"Making sure all clothes are packed before next destination",description:"Pack weather-appropriate clothing for all activities",due_at:new Date(Date.now()+2592e5).toISOString(),is_poll:!1,task_status:[{task_id:"task-3",completed:!1,user_id:"user1"}],creator_id:"sarah",created_by:"Sarah",created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}],N=c(l&&l.length>0?l:b?j:[]),w=(null==N?void 0:N.filter(e=>{var t,a,s,r;if(e.is_poll){return((null==(t=e.task_status)?void 0:t.filter(e=>e.completed).length)||0)<((null==(a=e.task_status)?void 0:a.length)||1)}return!(null==(r=null==(s=e.task_status)?void 0:s[0])?void 0:r.completed)}))||[],_=(null==N?void 0:N.filter(e=>{var t,a,s,r;if(e.is_poll){return((null==(t=e.task_status)?void 0:t.filter(e=>e.completed).length)||0)>=((null==(a=e.task_status)?void 0:a.length)||1)}return null==(r=null==(s=e.task_status)?void 0:s[0])?void 0:r.completed}))||[];return o?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold text-white",children:"Tasks"}),t.jsx("p",{className:"text-gray-400 text-sm",children:"Keep track of everything that needs to get done"})]}),t.jsxs(W,{onClick:()=>s(!0),className:`bg-gradient-to-r ${i.gradient} hover:opacity-90`,children:[t.jsx(He,{size:16,className:"mr-2"}),"Add Task"]})]}),t.jsx(oa,{status:d,sortBy:f,onStatusChange:u,onSortChange:g,hasActiveFilters:y,onClearFilters:v}),t.jsx(la,{tasks:w,tripId:e,title:"To Do",emptyMessage:"All caught up! No pending tasks."}),_.length>0&&t.jsx(la,{tasks:_,tripId:e,title:"Completed",showCompleted:r,onToggleCompleted:()=>n(!r)}),a&&t.jsx(hn,{tripId:e,onClose:()=>s(!1)})]})},fn=[/^https?:\/\/.+/i,/^www\..+\..+/i,/\.(com|org|net|edu|gov|co|io|ai|app|ly|me|tv|fm|xyz|biz|info)[\s\/]?/i],gn=[/(.+)\s+(in|at|near|@)\s+([a-zA-Z\s,]+)/i,/(.+),\s*([a-zA-Z\s,]+)/i,/(.+)\s+([A-Z]{2,})\s*(\d{5})?/i],yn=e=>{var t,a,s,r,n;const i=e.trim();for(const l of gn){const e=i.match(l);if(e)return{businessName:null==(t=e[1])?void 0:t.trim(),location:(null==(a=e[2])?void 0:a.trim())||(null==(s=e[3])?void 0:s.trim()),fullLocation:`${(null==(r=e[2])?void 0:r.trim())||""} ${(null==(n=e[3])?void 0:n.trim())||""}`.trim()}}return{businessName:i,location:"",fullLocation:""}},vn=[{id:"restaurant",label:"Eats",icon:"🍽️",description:"Restaurants, cafes, food tours"},{id:"attraction",label:"Attraction / Sightseeing",icon:"🎯",description:"Museums, tours, attractions"},{id:"activity",label:"Day Activities",icon:"☀️",description:"Activities and experiences"},{id:"fitness",label:"Fitness",icon:"💪",description:"Gyms, yoga, sports activities"},{id:"nightlife",label:"Nightlife",icon:"🌙",description:"Bars, clubs, evening events"},{id:"transportation",label:"Transportation",icon:"✈️",description:"Flights, cars, rideshares"},{id:"hotel",label:"Housing",icon:"🏠",description:"Hotels, Airbnbs, hostels"}],bn=({isOpen:e,onClose:a,onPlaceAdded:s,basecamp:r})=>{const[n,i]=M.useState(""),[l,o]=M.useState(""),[c,d]=M.useState(!!r),[u,m]=M.useState(""),[p,h]=M.useState(!0),[x,f]=M.useState(!1),[g,y]=M.useState(!1),[v,b]=M.useState([]),[j,N]=M.useState(null),[w,_]=M.useState(null),{resolvePlaceName:k,categorizePlaceType:S,isLoading:C}=L();M.useEffect(()=>{if(!n.trim())return _(null),b([]),void N(null);const e=(e=>{const t=e.trim();if(!t)return{type:"place_name",isValid:!1};if(fn.some(e=>e.test(t)))try{const e=t.startsWith("http")?t:`https://${t}`;return new URL(e),{type:"url",isValid:!0}}catch{return{type:"url",isValid:!1}}const a=yn(t),s=a.businessName.length>0,r=[];return s&&(a.location?r.push(`${a.businessName} in ${a.location}`):(r.push(`${a.businessName} near me`),r.push(`${a.businessName} locations`))),{type:"place_name",isValid:s,suggestions:r.length>0?r:void 0}})(n);if(_(e.type),"place_name"===e.type&&e.isValid){const e=setTimeout(async()=>{const e=(e=>{const t=yn(e);return t.location?`${t.businessName} ${t.location}`:t.businessName})(n),t=await k(e);if(t.success&&t.place&&(b([t.place]),N(t.place),l||t.place.name===l||o(t.place.name),p&&t.place.types)){const e=S(t.place.types);e!==u&&m(e)}},500);return()=>clearTimeout(e)}},[n,k,S,p,u,l]);return e?g?t.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-lg w-full max-w-md p-8 text-center",children:[t.jsx("div",{className:"flex justify-center mb-4",children:t.jsx(ve,{size:48,className:"text-green-400"})}),t.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"Pin saved!"}),t.jsx("p",{className:"text-slate-300",children:"Added to your trip links and visible in Media tab."})]})}):t.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-lg w-full max-w-md max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-700",children:[t.jsx("h2",{className:"text-lg font-semibold text-white",children:"Save Trip Pin"}),t.jsx("button",{onClick:a,className:"text-slate-400 hover:text-white",children:t.jsx(ae,{size:20})})]}),t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),n.trim()&&l.trim()){f(!0);try{let e="",t=u;e="url"===w?(e=>{const t=e.trim();return t.startsWith("http")?t:`https://${t}`})(n):j?j.website||`https://www.google.com/maps/place/?q=place_id:${j.place_id}`:`https://www.google.com/search?q=${encodeURIComponent(n)}`,t||(t=j&&j.types?S(j.types):"attraction");const c={id:Date.now().toString(),name:l.trim(),url:e,category:t,calculatedAt:(new Date).toISOString(),...j&&{address:j.formatted_address,rating:j.rating,placeId:j.place_id}};s&&s(c),y(!0),setTimeout(()=>{i(""),o(""),d(!!r),m(""),h(!0),b([]),N(null),_(null),y(!1),a()},1500)}catch(t){}finally{f(!1)}}},className:"p-6 space-y-4",children:[t.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-3 text-sm text-blue-300",children:'Enter a place name (e.g., "Starbucks Chicago IL") or URL to save it to your trip links.'}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Place or URL *"}),t.jsxs("div",{className:"relative",children:["url"===w?t.jsx(Ke,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400"}):t.jsx(ie,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400"}),t.jsx("input",{type:"text",value:n,onChange:e=>i(e.target.value),placeholder:"Target Chicago IL, https://target.com, or business name...",required:!0,className:"w-full bg-slate-900/50 border border-slate-600 rounded-lg pl-10 pr-4 py-3 text-white placeholder-slate-400 focus:outline-none focus:border-blue-500"}),C&&t.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-400"})})]}),w&&t.jsx("div",{className:"mt-2 text-xs text-slate-400 flex items-center gap-1",children:"url"===w?t.jsxs(t.Fragment,{children:[t.jsx(Ke,{size:12}),"Detected as URL"]}):t.jsxs(t.Fragment,{children:[t.jsx(Ze,{size:12}),"Searching for places..."]})})]}),j&&"place_name"===w&&t.jsx("div",{className:"bg-slate-900/30 border border-slate-700 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(Ze,{size:16,className:"text-green-400 mt-1 flex-shrink-0"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h4",{className:"font-medium text-white text-sm",children:j.name}),j.formatted_address&&t.jsx("p",{className:"text-xs text-slate-400 mt-1",children:j.formatted_address}),j.rating&&t.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[t.jsx("span",{className:"text-xs text-yellow-400",children:"★"}),t.jsx("span",{className:"text-xs text-slate-300",children:j.rating})]})]})]})}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Place Name *"}),t.jsx("input",{type:"text",value:l,onChange:e=>o(e.target.value),placeholder:"Give this place a name...",required:!0,className:"w-full bg-slate-900/50 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-900/30 rounded-lg border border-slate-700/50",children:[t.jsx("input",{type:"checkbox",id:"ai-sorting",checked:p,onChange:e=>h(e.target.checked),className:"w-4 h-4 text-blue-600 bg-slate-800 border-slate-600 rounded focus:ring-blue-500"}),t.jsxs("label",{htmlFor:"ai-sorting",className:"flex items-center gap-2 text-sm text-slate-300",children:[t.jsx(Je,{size:16,className:"text-blue-400"}),"Auto-categorize based on place type"]})]}),!p&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-3",children:"Category (optional)"}),t.jsx("div",{className:"grid grid-cols-1 gap-2 max-h-64 overflow-y-auto",children:vn.map(e=>t.jsxs("button",{type:"button",onClick:()=>m(e.id===u?"":e.id),className:"flex items-center gap-3 p-3 rounded-lg border text-left transition-all "+(u===e.id?"bg-blue-600/20 border-blue-600 text-white":"bg-slate-900/30 border-slate-700 text-slate-300 hover:border-slate-600"),children:[t.jsx("span",{className:"text-lg",children:e.icon}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:e.label}),t.jsx("div",{className:"text-xs text-slate-400",children:e.description})]})]},e.id))})]}),r&&t.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm font-semibold text-white",children:"Calculate distance from Basecamp"}),t.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:c,onChange:e=>d(e.target.checked),className:"sr-only peer"}),t.jsx("div",{className:"w-11 h-6 bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-500/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-500"})]})]}),t.jsx("p",{className:"text-xs text-green-300",children:"See how far your options are from your base"})]}),t.jsxs("div",{className:"flex gap-3 pt-4",children:[t.jsx(W,{type:"button",variant:"outline",onClick:a,className:"flex-1",children:"Cancel"}),t.jsx(W,{type:"submit",disabled:x||!n.trim()||!l.trim(),className:"flex-1 bg-blue-600 hover:bg-blue-700",children:x?"Saving...":"Save Pin"})]})]})]})}):null},jn=({isOpen:e,onClose:a,onBasecampSet:s,currentBasecamp:r})=>{const[n,i]=M.useState((null==r?void 0:r.address)||""),[l,o]=M.useState((null==r?void 0:r.name)||""),[c,d]=M.useState((null==r?void 0:r.type)||"hotel"),[u,m]=M.useState(!1),[p,h]=M.useState([]),[x,f]=M.useState(!1),[g,y]=M.useState(-1),[v,b]=M.useState(!1),[j,N]=M.useState(null),[w,_]=M.useState(null),k=M.useRef(null),S=M.useRef(null),C=M.useRef(null),E=async e=>{var t,a,s;if(i(e.description),f(!1),h([]),"text-search"===e.source&&(null==(t=e.geometry)?void 0:t.location))return _({lat:e.geometry.location.lat,lng:e.geometry.location.lng}),N(e.place_id),void(e.name&&!l&&o(e.name));if("osm"===e.source)return _({lat:e.osm_lat,lng:e.osm_lng}),void N(null);N(e.place_id),_(null);try{const t=await at.getPlaceDetails(e.place_id);if((null==(a=null==t?void 0:t.result)?void 0:a.name)&&!l&&o(t.result.name),(null==(s=null==t?void 0:t.result)?void 0:s.types)&&!c){const e=t.result.types;e.includes("lodging")||e.includes("hotel")?d("hotel"):(e.includes("airport")||e.includes("point_of_interest"))&&d("other")}}catch(r){}};return M.useEffect(()=>{const e=e=>{var t;!S.current||S.current.contains(e.target)||(null==(t=k.current)?void 0:t.contains(e.target))||f(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),e?t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gray-900 rounded-3xl w-full max-w-md shadow-2xl border border-gray-800",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-800",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-green-600 to-green-700 rounded-xl flex items-center justify-center",children:t.jsx(oe,{size:20,className:"text-white"})}),t.jsx("h2",{className:"text-xl font-bold text-white",children:r?"Update Basecamp":"Set Basecamp"})]}),t.jsx("button",{onClick:a,className:"w-8 h-8 rounded-full bg-gray-800 hover:bg-gray-700 flex items-center justify-center transition-colors border border-gray-700",children:t.jsx(ae,{size:16,className:"text-gray-400"})})]}),t.jsxs("form",{onSubmit:async e=>{var t,r,i,o,d;if(e.preventDefault(),n.trim()){m(!0),f(!1);try{let e=null,m=l.trim();if(j&&!j.startsWith("osm:"))try{const a=await at.getPlaceDetailsById(j);(null==(r=null==(t=null==a?void 0:a.result)?void 0:t.geometry)?void 0:r.location)&&(e={lat:a.result.geometry.location.lat,lng:a.result.geometry.location.lng},!m&&a.result.name&&(m=a.result.name))}catch(u){}if(!e&&w&&(e=w),!e)try{const t=await at.searchPlacesByText(n);if(null==(d=null==(o=null==(i=null==t?void 0:t.results)?void 0:i[0])?void 0:o.geometry)?void 0:d.location){const a=t.results[0];e={lat:a.geometry.location.lat,lng:a.geometry.location.lng},!m&&a.name&&(m=a.name)}}catch(u){}if(!e)try{e=await at.geocodeAddress(n)}catch(u){}if(!e)try{const t=await at.fallbackGeocodeNominatim(n);t&&(e={lat:t.lat,lng:t.lng},m||(m=t.displayName.split(",")[0]))}catch(u){}if(e){const t={address:n.trim(),coordinates:e,name:m||void 0,type:c};await Promise.resolve(s(t)),a()}else alert(`We couldn't find "${n}". Please try:\n\n• Adding city/country (e.g., "${n}, [City], [Country]")\n• Checking spelling\n• Selecting from dropdown suggestions above`)}catch(u){alert("There was an error setting your basecamp. Please check your internet connection and try again.")}finally{m(!1)}}else alert("Please enter an address.")},className:"p-6 space-y-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx("label",{className:"block text-sm font-semibold text-white mb-2",children:"Basecamp Address *"}),t.jsxs("div",{className:"relative",children:[t.jsx(Ze,{size:18,className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 z-10"}),t.jsx("input",{ref:k,type:"text",value:n,onChange:e=>(async e=>{i(e),y(-1),N(null),_(null),C.current&&clearTimeout(C.current),e.length>2?(b(!0),f(!0),C.current=setTimeout(async()=>{var t,a;try{const s=at.detectQueryType(e);let r=!1;if("venue"!==s){const a=await at.getPlaceAutocomplete(e);(null==(t=null==a?void 0:a.predictions)?void 0:t.length)>0&&(h(a.predictions),r=!0)}if(!r){const t=await at.searchPlacesByText(e);if((null==(a=null==t?void 0:t.results)?void 0:a.length)>0){const e=t.results.slice(0,8).map(e=>({place_id:e.place_id,description:`${e.name} - ${e.formatted_address||e.vicinity}`,name:e.name,geometry:e.geometry,source:"text-search",types:e.types||["establishment"],structured_formatting:{main_text:e.name,secondary_text:e.formatted_address||e.vicinity}}));h(e),r=!0}}if(!r){const t=await at.fallbackSuggestNominatim(e);h(t),t.length}}catch(s){h([])}finally{b(!1)}},300)):(f(!1),h([]),b(!1))})(e.target.value),onKeyDown:e=>{if(x&&0!==p.length)switch(e.key){case"ArrowDown":e.preventDefault(),y(e=>e<p.length-1?e+1:0);break;case"ArrowUp":e.preventDefault(),y(e=>e>0?e-1:p.length-1);break;case"Enter":e.preventDefault(),g>=0&&E(p[g]);break;case"Escape":f(!1),h([]),y(-1)}},onFocus:()=>p.length>0&&f(!0),placeholder:"Enter hotel, Airbnb, or main lodging address...",required:!0,className:"w-full bg-gray-800 border border-gray-700 rounded-xl pl-12 pr-4 py-4 text-white placeholder-gray-500 focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-500/20 transition-all",autoComplete:"off"}),(x||v)&&t.jsx("div",{ref:S,className:"absolute top-full left-0 right-0 bg-gray-800 border border-gray-700 rounded-xl mt-1 shadow-lg z-20 max-h-60 overflow-y-auto",children:v?t.jsx("div",{className:"px-4 py-3 text-gray-400 text-sm",children:"Loading suggestions..."}):p.length>0?p.map((e,a)=>{var s,r;const n=e.types||[],i=n.includes("lodging")?{icon:"🏨",label:"Hotel",color:"bg-blue-100 text-blue-800"}:n.includes("tourist_attraction")?{icon:"🎯",label:"Attraction",color:"bg-green-100 text-green-800"}:n.includes("stadium")?{icon:"🏟️",label:"Stadium",color:"bg-purple-100 text-purple-800"}:n.includes("establishment")?{icon:"📍",label:"Place",color:"bg-gray-100 text-gray-800"}:null;return t.jsxs("button",{type:"button",onClick:()=>E(e),className:"w-full text-left px-4 py-3 hover:bg-gray-700 transition-colors text-white text-sm flex items-center gap-3 "+(a===g?"bg-gray-700":""),children:[t.jsx(Ze,{size:14,className:"text-gray-400 flex-shrink-0"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("span",{className:"font-medium truncate",children:(null==(s=e.structured_formatting)?void 0:s.main_text)||e.description}),i&&t.jsxs("span",{className:`text-xs px-2 py-0.5 rounded-full ${i.color} flex-shrink-0`,children:[i.icon," ",i.label]})]}),(null==(r=e.structured_formatting)?void 0:r.secondary_text)&&t.jsx("div",{className:"text-xs text-gray-500 truncate",children:e.structured_formatting.secondary_text})]})]},e.place_id||a)}):null})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-white mb-2",children:"Basecamp Name (optional)"}),t.jsx("input",{type:"text",value:l,onChange:e=>o(e.target.value),placeholder:"e.g., 'Grand Hotel Paris' or 'Downtown Airbnb'",className:"w-full bg-gray-800 border border-gray-700 rounded-xl px-4 py-4 text-white placeholder-gray-500 focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-500/20 transition-all"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-white mb-2",children:"Type"}),t.jsxs("select",{value:c,onChange:e=>d(e.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-xl px-4 py-4 text-white focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-500/20 transition-all",children:[t.jsx("option",{value:"hotel",children:"Hotel"}),t.jsx("option",{value:"airbnb",children:"Airbnb / Vacation Rental"}),t.jsx("option",{value:"other",children:"Other"})]})]}),t.jsx("div",{className:"bg-green-500/10 border border-green-500/30 rounded-xl p-4",children:t.jsxs("p",{className:"text-sm text-green-300",children:["💡 ",t.jsx("strong",{children:"Tip:"})," Selecting from the dropdown improves accuracy, but you can also type any location (city, region, or address) and press Set."]})}),t.jsxs("div",{className:"flex gap-3 pt-4",children:[t.jsx(W,{type:"button",variant:"outline",onClick:a,className:"flex-1 h-12 rounded-xl border-2 border-gray-700 hover:border-gray-600 font-semibold bg-gray-800 text-white hover:bg-gray-700",children:"Cancel"}),t.jsx(W,{type:"submit",disabled:u||!n.trim(),className:"flex-1 h-12 rounded-xl bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 font-semibold shadow-lg shadow-green-500/25 border border-green-500/50 disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Setting...":r?"Update":"Set Basecamp"})]})]})]})}):null},Nn=({className:e=""})=>{const{basecamp:a,isBasecampSet:s,setBasecamp:r}=ce(),[n,i]=M.useState(""),[l,o]=M.useState(!1),[c,d]=M.useState(!0);M.useEffect(()=>{d(!0);const e=e=>{i(e)};if(s&&(null==a?void 0:a.address))return e(at.buildEmbeddableUrl(a.address,a.coordinates)),void d(!1);const t=setTimeout(()=>{e(at.buildEmbeddableUrl()),d(!1)},4e3);navigator.geolocation?navigator.geolocation.getCurrentPosition(a=>{clearTimeout(t);const{latitude:s,longitude:r}=a.coords;e(at.buildEmbeddableUrl(void 0,{lat:s,lng:r})),d(!1)},()=>{clearTimeout(t),e(at.buildEmbeddableUrl()),d(!1)},{maximumAge:3e5,timeout:3500,enableHighAccuracy:!1}):(clearTimeout(t),e(at.buildEmbeddableUrl()),d(!1))},[a,s]);return t.jsxs("div",{className:`relative w-full h-full bg-background ${e}`,children:[t.jsx("button",{onClick:()=>{o(!0)},className:"absolute top-4 left-1/2 -translate-x-1/2 z-20 flex items-center gap-2 px-4 py-2 bg-background/95 backdrop-blur-sm border border-border rounded-xl shadow-lg hover:bg-accent transition-colors text-sm font-medium",children:s?t.jsxs(t.Fragment,{children:[t.jsx(Ze,{size:16,className:"text-primary"}),t.jsx("span",{className:"text-foreground",children:(null==a?void 0:a.name)||"Base Camp"}),t.jsx(lt,{size:14,className:"text-muted-foreground"})]}):t.jsxs(t.Fragment,{children:[t.jsx(Ze,{size:16,className:"text-muted-foreground"}),t.jsx("span",{className:"text-muted-foreground",children:"Set Base Camp"})]})}),c&&t.jsx("div",{className:"absolute inset-0 bg-background/50 backdrop-blur-sm flex items-center justify-center z-10",children:t.jsx("div",{className:"bg-background/95 backdrop-blur-sm border border-border rounded-xl p-6 shadow-2xl",children:t.jsxs("div",{className:"flex flex-col items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 border-3 border-primary border-t-transparent rounded-full animate-spin"}),t.jsx("p",{className:"text-sm text-foreground font-medium",children:"Loading map..."})]})})}),t.jsx("iframe",{src:n,className:"w-full h-full border-0",loading:"lazy",referrerPolicy:"strict-origin-when-cross-origin",onLoad:()=>{d(!1)},onError:()=>{if(n.includes("maps.google.com")){const e=n.replace("maps.google.com","www.google.com");i(e)}else{const e="https://www.google.com/maps?output=embed&q="+encodeURIComponent("near me");i(e)}},title:"Google Maps",allow:"geolocation"}),t.jsx(jn,{isOpen:l,onClose:()=>o(!1),onBasecampSet:async e=>{await r(e)},currentBasecamp:a})]})},wn=({basecamp:e,onBasecampSet:a})=>{const{basecamp:s,setBasecamp:r,isBasecampSet:n}=ce(),{toast:i}=de(),l=s||e,[o,c]=M.useState(!1),[d,u]=M.useState(!1),[m,p]=M.useState(!1),h=async()=>{if(l)try{await navigator.clipboard.writeText(l.address),u(!0),i({title:"Address copied to clipboard!"}),setTimeout(()=>u(!1),2e3)}catch(e){i({title:"Failed to copy address",variant:"destructive"})}};return t.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded-3xl p-6 shadow-2xl shadow-black/50 min-h-[500px] flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center "+(l?"bg-gradient-to-r from-green-600 to-green-700":"bg-gradient-to-r from-gray-600 to-gray-700"),children:t.jsx(oe,{size:20,className:"text-white"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold text-white",children:"Set Basecamp"}),t.jsx("p",{className:"text-gray-400 text-sm",children:l?"Basecamp configured":"Choose your home base"})]})]}),t.jsx("button",{onClick:()=>c(!0),className:"text-gray-400 hover:text-white transition-colors",children:t.jsx(It,{size:20})})]}),l?t.jsxs("div",{className:"flex-1 space-y-6",children:[t.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[t.jsx("div",{className:"w-8 h-8 bg-green-500/20 rounded-lg flex items-center justify-center flex-shrink-0 mt-1",children:t.jsx(oe,{size:16,className:"text-green-400"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("h4",{className:"text-white font-semibold",children:l.name||"Your Home Base"}),t.jsx("span",{className:"text-xs bg-green-500/20 text-green-300 px-2 py-0.5 rounded-full",children:"Current"})]}),t.jsx("p",{className:"text-green-300 text-sm leading-relaxed mb-2",children:(e=>{var t,a;const s=e.split(",");return s.length>2?`${s[0]}, ${null==(t=s[s.length-2])?void 0:t.trim()}, ${null==(a=s[s.length-1])?void 0:a.trim()}`:e})(l.address)}),m&&t.jsxs("p",{className:"text-green-400/60 text-xs font-mono",children:[l.coordinates.lat.toFixed(6),", ",l.coordinates.lng.toFixed(6)]})]})]}),t.jsx("button",{onClick:h,className:"text-green-400 hover:text-green-300 transition-colors flex-shrink-0",title:"Copy address",children:d?t.jsx(Ge,{size:18}):t.jsx(Qe,{size:18})})]}),t.jsxs("button",{onClick:()=>p(!m),className:"text-xs text-green-400/60 hover:text-green-400 mt-2",children:[m?"Hide":"Show"," coordinates"]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Ze,{size:16,className:"text-blue-400"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-white font-medium text-sm",children:"Distance Calculations"}),t.jsx("p",{className:"text-gray-400 text-xs",children:"All places show distance from basecamp"})]})]})}),t.jsx("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Mt,{size:16,className:"text-purple-400"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-white font-medium text-sm",children:"Route Planning"}),t.jsx("p",{className:"text-gray-400 text-xs",children:"Optimized routes from your base"})]})]})}),t.jsx("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(we,{size:16,className:"text-orange-400"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-white font-medium text-sm",children:"Travel Time Estimates"}),t.jsx("p",{className:"text-gray-400 text-xs",children:"Plan your daily itinerary efficiently"})]})]})})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("button",{onClick:()=>c(!0),className:"w-full bg-gray-800 hover:bg-gray-700 text-white py-3 px-4 rounded-xl transition-all duration-200 border border-gray-700 hover:border-green-500/50 font-medium text-sm",children:"Update Basecamp Location"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("button",{onClick:h,className:"bg-gray-800/50 hover:bg-gray-800 text-gray-300 py-2 px-3 rounded-lg transition-colors border border-gray-700 text-xs flex items-center justify-center gap-2",children:[t.jsx(Qe,{size:14}),"Copy Address"]}),t.jsxs("button",{onClick:async()=>{if(!l)return;const e=`📍 ${l.name||"Our Basecamp"}\n${l.address}`;if(navigator.share)try{await navigator.share({title:"Trip Basecamp",text:e})}catch(t){}else h()},className:"bg-gray-800/50 hover:bg-gray-800 text-gray-300 py-2 px-3 rounded-lg transition-colors border border-gray-700 text-xs flex items-center justify-center gap-2",children:[t.jsx(ct,{size:14}),"Share"]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("button",{onClick:()=>{var e;null==(e=document.querySelector(".hero-map-section"))||e.scrollIntoView({behavior:"smooth"})},className:"bg-gray-800/50 hover:bg-gray-800 text-gray-300 py-2 px-3 rounded-lg transition-colors border border-gray-700 text-xs flex items-center justify-center gap-2",children:[t.jsx(Ze,{size:14}),"View on Map"]}),t.jsxs("button",{onClick:()=>{const e=`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(l.address)}`;window.open(e,"_blank")},className:"bg-gray-800/50 hover:bg-gray-800 text-gray-300 py-2 px-3 rounded-lg transition-colors border border-gray-700 text-xs flex items-center justify-center gap-2",children:[t.jsx(Mt,{size:14}),"Get Directions"]})]})]})]}):t.jsxs("div",{className:"flex-1 flex flex-col justify-center items-center text-center",children:[t.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-gray-800 to-gray-900 rounded-full flex items-center justify-center border border-gray-700 mb-6",children:t.jsx(oe,{size:32,className:"text-gray-400"})}),t.jsx("h4",{className:"text-xl font-bold text-white mb-3",children:"Set Your Basecamp"}),t.jsx("p",{className:"text-gray-400 mb-6 max-w-sm mx-auto leading-relaxed",children:"Choose a central location for your trip. We'll calculate distances and travel times from this point to all your destinations."}),t.jsx("button",{onClick:()=>c(!0),className:"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white px-8 py-4 rounded-xl transition-all duration-300 hover:scale-105 shadow-xl shadow-green-500/25 font-semibold border border-green-500/50",children:"Choose Basecamp"}),t.jsxs("div",{className:"mt-8 space-y-2 text-sm text-gray-500",children:[t.jsx("p",{children:"• Hotels, vacation rentals, or meeting spots work great"}),t.jsx("p",{children:"• Used for distance calculations and route planning"}),t.jsx("p",{children:"• Can be updated anytime during your trip"})]})]}),t.jsx(jn,{isOpen:o,onClose:()=>c(!1),onBasecampSet:async e=>{await r(e),a&&await Promise.resolve(a(e))},currentBasecamp:l})]})},_n=({isOpen:e,onClose:a,onEventAdded:s,prefilledData:r,editEvent:n})=>{const[i,l]=M.useState({title:(null==r?void 0:r.title)||(null==n?void 0:n.title)||"",date:(null==r?void 0:r.date)||(null==n?void 0:n.date)||new Date,time:(null==r?void 0:r.time)||(null==n?void 0:n.time)||"",location:(null==r?void 0:r.location)||(null==n?void 0:n.location)||"",description:(null==r?void 0:r.description)||(null==n?void 0:n.description)||"",category:(null==r?void 0:r.category)||(null==n?void 0:n.event_category)||"activity",include_in_itinerary:(null==r?void 0:r.include_in_itinerary)??(null==n?void 0:n.include_in_itinerary)??!0});M.useEffect(()=>{n?l({title:n.title,date:n.date,time:n.time,location:n.location||"",description:n.description||"",category:n.event_category||"activity",include_in_itinerary:n.include_in_itinerary??!0}):r&&l({title:r.title||"",date:r.date||new Date,time:r.time||"",location:r.location||"",description:r.description||"",category:r.category||"activity",include_in_itinerary:r.include_in_itinerary??!0})},[n,r]);const o=()=>{l({title:"",date:new Date,time:"",location:"",description:"",category:"activity",include_in_itinerary:!0}),a()};return t.jsx(ke,{open:e,onOpenChange:o,children:t.jsxs(Se,{className:"max-w-md",children:[t.jsx(Ce,{children:t.jsx(Ee,{children:n?"Edit Event":"Add to Calendar"})}),t.jsxs("form",{onSubmit:e=>{e.preventDefault(),i.title&&i.time&&(s(i,null==n?void 0:n.id),o())},className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Pe,{htmlFor:"title",children:"Event Title *"}),t.jsx(Me,{id:"title",value:i.title,onChange:e=>l({...i,title:e.target.value}),placeholder:"Event name",required:!0})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Pe,{children:"Date *"}),t.jsxs(Fe,{children:[t.jsx(Oe,{asChild:!0,children:t.jsxs(W,{variant:"outline",className:te("w-full justify-start text-left font-normal",!i.date&&"text-muted-foreground"),children:[t.jsx(be,{className:"mr-2 h-4 w-4"}),i.date?xe(i.date,"PPP"):"Pick a date"]})}),t.jsx(ze,{className:"w-auto p-0",align:"start",children:t.jsx(Le,{mode:"single",selected:i.date,onSelect:e=>e&&l({...i,date:e}),initialFocus:!0,className:"p-3 pointer-events-auto"})})]})]}),t.jsxs("div",{children:[t.jsx(Pe,{htmlFor:"time",children:"Time *"}),t.jsx(Me,{id:"time",type:"time",value:i.time,onChange:e=>l({...i,time:e.target.value}),required:!0})]})]}),t.jsxs("div",{children:[t.jsx(Pe,{htmlFor:"location",children:"Location"}),t.jsx(Me,{id:"location",value:i.location,onChange:e=>l({...i,location:e.target.value}),placeholder:"Event location"})]}),t.jsxs("div",{children:[t.jsx(Pe,{children:"Category"}),t.jsxs(Be,{value:i.category,onValueChange:e=>l({...i,category:e}),children:[t.jsx(Ue,{children:t.jsx(qe,{})}),t.jsx(Ve,{children:[{value:"dining",label:"Dining",icon:"🍽️"},{value:"lodging",label:"Lodging",icon:"🏨"},{value:"activity",label:"Activity",icon:"🎯"},{value:"transportation",label:"Transportation",icon:"🚗"},{value:"entertainment",label:"Entertainment",icon:"🎭"},{value:"other",label:"Other",icon:"📅"}].map(e=>t.jsx(Ye,{value:e.value,children:t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx("span",{children:e.icon}),e.label]})},e.value))})]})]}),t.jsxs("div",{children:[t.jsx(Pe,{htmlFor:"description",children:"Description"}),t.jsx(Ie,{id:"description",value:i.description,onChange:e=>l({...i,description:e.target.value}),placeholder:"Additional details...",rows:2})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(Te,{id:"include-itinerary",checked:i.include_in_itinerary,onCheckedChange:e=>l({...i,include_in_itinerary:e})}),t.jsx(Pe,{htmlFor:"include-itinerary",children:"Include in trip itinerary"})]}),t.jsxs("div",{className:"flex gap-2 pt-4",children:[t.jsx(W,{type:"submit",className:"flex-1",children:n?"Update Event":"Add Event"}),t.jsx(W,{type:"button",variant:"outline",onClick:o,children:"Cancel"})]})]})]})})},kn=({placeName:e,placeAddress:a,category:s="activity",onEventAdded:r,variant:n="default"})=>{const[i,l]=M.useState(!1),o=e=>{null==r||r(e),l(!1)},c={title:e,location:a||e,category:s,include_in_itinerary:!0};return"icon"===n?t.jsxs(t.Fragment,{children:[t.jsx(W,{variant:"outline",size:"sm",onClick:()=>l(!0),className:"p-2",children:t.jsx(be,{size:16})}),t.jsx(_n,{isOpen:i,onClose:()=>l(!1),onEventAdded:o,prefilledData:c})]}):"pill"===n?t.jsxs(t.Fragment,{children:[t.jsxs(W,{variant:"outline",size:"sm",onClick:()=>l(!0),className:"text-xs",children:[t.jsx(be,{size:14,className:"mr-1"}),"Add to Calendar"]}),t.jsx(_n,{isOpen:i,onClose:()=>l(!1),onEventAdded:o,prefilledData:c})]}):t.jsxs(t.Fragment,{children:[t.jsxs(W,{variant:"outline",onClick:()=>l(!0),className:"w-full",children:[t.jsx(He,{size:16,className:"mr-2"}),"Add to Calendar"]}),t.jsx(_n,{isOpen:i,onClose:()=>l(!1),onEventAdded:o,prefilledData:c})]})},Sn=({places:e,basecamp:a,onPlaceAdded:s,onPlaceRemoved:r,onEventAdded:n,distanceUnit:i,preferredMode:l})=>{const[o,c]=M.useState(!1);return t.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded-3xl p-6 shadow-2xl shadow-black/50 min-h-[500px] flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center "+(e.length>0?"bg-gradient-to-r from-red-600 to-red-700":"bg-gradient-to-r from-gray-600 to-gray-700"),children:t.jsx(Ze,{size:20,className:"text-white"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold text-white",children:"Trip Pins"}),t.jsx("p",{className:"text-gray-400 text-sm",children:e.length>0?`${e.length} saved locations`:"Save your trip locations"})]})]}),t.jsx("button",{onClick:()=>c(!0),className:"text-gray-400 hover:text-white transition-colors",children:t.jsx(It,{size:20})})]}),0===e.length?t.jsxs("div",{className:"flex-1 flex flex-col justify-center items-center text-center",children:[t.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-gray-800 to-gray-900 rounded-full flex items-center justify-center border border-gray-700 mb-6",children:t.jsx(Ze,{size:32,className:"text-gray-400"})}),t.jsx("h4",{className:"text-xl font-bold text-white mb-3",children:"Save Trip Pins"}),t.jsx("p",{className:"text-gray-400 mb-6 max-w-sm mx-auto leading-relaxed",children:"Start saving locations you want to visit or remember for your trip. Explore the map above and add places that catch your eye."}),t.jsx("button",{onClick:()=>c(!0),className:"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white px-8 py-4 rounded-xl transition-all duration-300 hover:scale-105 shadow-xl shadow-green-500/25 font-semibold border border-green-500/50",children:"Save Pin"}),t.jsxs("div",{className:"mt-8 space-y-2 text-sm text-gray-500",children:[t.jsx("p",{children:"• Places you add will be saved to Links for easy access"}),t.jsx("p",{children:"• View distances from your basecamp when set"}),t.jsx("p",{children:"• Add events directly to your calendar"})]})]}):t.jsxs("div",{className:"flex-1 space-y-6",children:[t.jsx("div",{className:"space-y-3",children:t.jsxs("button",{onClick:()=>c(!0),className:"w-full bg-gray-800 hover:bg-gray-700 text-white py-3 px-4 rounded-xl transition-all duration-200 border border-gray-700 hover:border-red-500/50 font-medium text-sm",children:[t.jsx(He,{size:16,className:"inline mr-2"}),"Add Another Pin"]})}),t.jsx("div",{className:"space-y-3 flex-1 overflow-y-auto",children:e.map(e=>{var a;return t.jsx("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700",children:t.jsx("div",{className:"flex items-start justify-between",children:t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("h4",{className:"text-white font-semibold text-sm",children:e.name}),t.jsx(Q,{variant:"secondary",className:"text-xs bg-blue-500/20 text-blue-300 border-blue-500/30",children:"Linked"})]}),t.jsx("p",{className:"text-gray-400 text-xs capitalize mb-2",children:e.category}),e.distanceFromBasecamp&&t.jsx("div",{className:"mb-3",children:t.jsxs("span",{className:"inline-flex items-center gap-1 bg-green-500/20 text-green-300 px-2 py-1 rounded-lg text-xs",children:[t.jsx(Ze,{size:12}),null==(a=e.distanceFromBasecamp[l])?void 0:a.toFixed(1)," ",e.distanceFromBasecamp.unit," from basecamp"]})}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(kn,{placeName:e.name,placeAddress:e.address,category:"activity",onEventAdded:n,variant:"pill"}),t.jsxs("button",{onClick:()=>r(e.id),className:"text-red-400 hover:text-red-300 text-xs px-2 py-1 rounded bg-red-500/10 hover:bg-red-500/20 transition-colors",children:[t.jsx(Re,{size:12,className:"inline mr-1"}),"Remove"]})]})]})})},e.id)})})]}),t.jsx(bn,{isOpen:o,onClose:()=>c(!1),onPlaceAdded:s,basecamp:a})]})};const Cn=new class{async getUserAccommodation(e,t){var a;const{data:s,error:r}=await ue.from("user_accommodations").select("*").eq("trip_id",e).eq("user_id",t||(null==(a=(await ue.auth.getUser()).data.user)?void 0:a.id)||"").maybeSingle();if(r)throw r;return s}async getTripAccommodations(e){try{const{data:t,error:a}=await ue.from("user_accommodations").select("*").eq("trip_id",e).order("created_at",{ascending:!0});if(a)throw a;return t||[]}catch(t){return[]}}async setUserAccommodation(e){const{data:{user:t}}=await ue.auth.getUser();if(!t)throw new Error("User not authenticated");const{data:a,error:s}=await ue.from("user_accommodations").upsert({trip_id:e.trip_id,user_id:t.id,accommodation_name:e.accommodation_name,address:e.address,latitude:e.latitude,longitude:e.longitude,check_in:e.check_in,check_out:e.check_out,accommodation_type:e.accommodation_type||"hotel"},{onConflict:"trip_id,user_id"}).select().single();if(s)throw s;return a}async updateUserAccommodation(e,t){try{const{data:a,error:s}=await ue.from("user_accommodations").update(t).eq("id",e).select().single();if(s)throw s;return a}catch(a){return null}}async deleteUserAccommodation(e){try{const{error:t}=await ue.from("user_accommodations").delete().eq("id",e);if(t)throw t;return!0}catch(t){return!1}}async getAccommodationsNearLocation(e,t,a=10){try{const{data:s,error:r}=await ue.rpc("get_accommodations_within_radius",{lat:e,lng:t,radius:1e3*a});if(r)throw r;return s||[]}catch(s){return[]}}async getTripAccommodationStats(e){try{const t=await this.getTripAccommodations(e);return{totalAccommodations:t.length,accommodationTypes:t.reduce((e,t)=>(e[t.accommodation_type]=(e[t.accommodation_type]||0)+1,e),{})}}catch(t){return{totalAccommodations:0,accommodationTypes:{}}}}},En={hotel:st,airbnb:oe,hostel:ht,apartment:ht,resort:st,other:Et},Pn=({tripId:e,onLocationSet:a})=>{const{user:s}=re(),{basecamp:r}=ce(),[n,i]=M.useState(null),[l,o]=M.useState(!1),[c,d]=M.useState(!0),[u,m]=M.useState(null),p=F.useCallback(async()=>{d(!0),m(null);try{if(!s)return i(null),void d(!1);const t=await Cn.getUserAccommodation(e,s.id);i(t)}catch(Wn){m((null==Wn?void 0:Wn.message)||"Failed to load accommodations. Please try again.")}finally{d(!1)}},[e,s,r]);M.useEffect(()=>{p()},[p]);return c?t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"animate-pulse bg-gray-200 h-32 rounded-xl"}),t.jsx("div",{className:"animate-pulse bg-gray-200 h-32 rounded-xl"})]}):u?t.jsxs(dt,{className:"border-red-200 bg-red-50",children:[t.jsx(ut,{children:t.jsxs(mt,{className:"text-red-900 flex items-center gap-2",children:[t.jsx(Ze,{size:20}),"Unable to Load Accommodations"]})}),t.jsxs(pt,{children:[t.jsx("p",{className:"text-sm text-red-700 mb-4",children:u}),t.jsx(W,{onClick:p,variant:"outline",className:"border-red-300 text-red-700 hover:bg-red-100",children:"Retry"})]})]}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs(dt,{className:"bg-glass-slate-card border border-glass-slate-border shadow-enterprise-lg rounded-2xl",children:[t.jsxs(ut,{className:"pb-3",children:[t.jsxs(mt,{className:"text-white flex items-center gap-2",children:[t.jsx(Ze,{size:20,className:"text-blue-400"}),"Trip Base Camp"]}),t.jsx("p",{className:"text-sm text-gray-300",children:"Main meeting point for group activities and shared recommendations"})]}),r?t.jsx(pt,{className:"pt-0",children:t.jsxs("div",{className:"flex items-start gap-2 text-white",children:[t.jsx(Ze,{size:16,className:"text-blue-400 mt-1 flex-shrink-0"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("span",{className:"font-medium block",children:r.name}),r.address&&t.jsx("p",{className:"text-sm text-gray-300 mt-1 break-words",children:r.address})]})]})}):t.jsx(pt,{className:"pt-0",children:t.jsx("p",{className:"text-sm text-gray-400 italic",children:'No basecamp set. Set it in the "Places & Activities" tab.'})})]}),t.jsxs(dt,{className:"bg-glass-slate-card border border-glass-slate-border shadow-enterprise-lg rounded-2xl",children:[t.jsxs(ut,{className:"pb-3",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[t.jsxs(mt,{className:"text-white flex items-center gap-2 flex-wrap",children:[t.jsx(Et,{size:20,className:"text-green-400 flex-shrink-0"}),t.jsx("span",{children:"Your Accommodation"}),!s&&t.jsx(Q,{variant:"outline",className:"text-xs border-green-400/30 text-green-400",children:"Private"})]}),n&&s?t.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[t.jsx(W,{variant:"outline",size:"sm",onClick:async()=>{if(n)try{await Cn.deleteUserAccommodation(n.id)&&i(null)}catch(e){}},className:"border-glass-slate-border text-red-400 hover:bg-red-500/10",children:t.jsx(Re,{size:16})}),t.jsxs(W,{variant:"outline",size:"sm",onClick:()=>o(!0),className:"border-glass-slate-border text-white hover:bg-white/10",children:[t.jsx(et,{size:16}),t.jsx("span",{className:"hidden sm:inline",children:"Edit"})]})]}):t.jsxs(W,{variant:"outline",size:"sm",onClick:()=>o(!0),disabled:!s,className:"border-glass-slate-border text-white hover:bg-white/10 disabled:opacity-50 w-full sm:w-auto flex-shrink-0",children:[t.jsx(He,{size:16}),t.jsx("span",{children:"Set Your Location"})]})]}),t.jsx("p",{className:"text-sm text-gray-300 mt-2",children:s?"Where you're staying for personalized recommendations and local insights":"Sign in to save your private accommodation for personalized directions"})]}),n&&t.jsx(pt,{className:"pt-0",children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[F.createElement(En[n.accommodation_type],{size:16,className:"text-green-400"}),t.jsx("span",{className:"font-medium text-white",children:n.accommodation_name})]}),t.jsx(Q,{variant:"outline",className:"border-green-400/30 text-green-400 text-xs",children:n.accommodation_type})]}),n.address&&t.jsx("p",{className:"text-sm text-gray-300",children:n.address}),(n.check_in||n.check_out)&&t.jsxs("div",{className:"flex gap-4 text-sm text-gray-400",children:[n.check_in&&t.jsxs("span",{children:["Check-in: ",new Date(n.check_in).toLocaleDateString()]}),n.check_out&&t.jsxs("span",{children:["Check-out: ",new Date(n.check_out).toLocaleDateString()]})]})]})})]}),l&&t.jsx(jn,{isOpen:l,onClose:()=>o(!1),onBasecampSet:async t=>{var r,n;if(s)try{const s=await Cn.setUserAccommodation({trip_id:e,accommodation_name:t.name||"My Accommodation",address:t.formatted_address||t.address,latitude:(null==(r=t.coordinates)?void 0:r.lat)||t.latitude,longitude:(null==(n=t.coordinates)?void 0:n.lng)||t.longitude,accommodation_type:"hotel"});s&&(i(s),a&&await Promise.resolve(a(t,"personal")))}catch(l){}}})]})};class An{static async calculateDistance(e,t,a){var s;if(!t.coordinates&&!t.address)return null;const r=`${e.coordinates.lat},${e.coordinates.lng}-${(null==(s=t.coordinates)?void 0:s.lat)||t.address}-${a.preferredMode}`;if(this.cache.has(r))return this.cache.get(r);try{let s=null;return s="straightLine"===a.preferredMode?this.calculateStraightLineDistance(e.coordinates,t.coordinates):await this.calculateRouteDistance(e,t,a.preferredMode),null!==s&&("km"===a.unit&&s&&(s*=1.60934),this.cache.set(r,s)),s}catch(n){return null}}static calculateStraightLineDistance(e,t){if(!t)return null;const a=this.deg2rad(t.lat-e.lat),s=this.deg2rad(t.lng-e.lng),r=Math.sin(a/2)*Math.sin(a/2)+Math.cos(this.deg2rad(e.lat))*Math.cos(this.deg2rad(t.lat))*Math.sin(s/2)*Math.sin(s/2),n=3959*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)));return Math.round(10*n)/10}static async calculateRouteDistance(e,t,a){var s,r;const n=`${e.coordinates.lat},${e.coordinates.lng}`,i=t.coordinates?`${t.coordinates.lat},${t.coordinates.lng}`:encodeURIComponent(t.address||""),l="driving"===a?"DRIVING":"WALKING";try{const e=await at.getDistanceMatrix(n,i,l);if("OK"===e.status&&"OK"===(null==(r=null==(s=e.rows[0])?void 0:s.elements[0])?void 0:r.status)){const t=e.rows[0].elements[0].distance.text;return parseFloat(t.replace(/[^\d.]/g,""))}return null}catch(o){return null}}static deg2rad(e){return e*(Math.PI/180)}static async geocodeAddress(e){try{return await at.geocodeAddress(e)}catch(t){return null}}}var Dn;((t,a,s)=>{a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s})(An,"symbol"!=typeof(Dn="cache")?Dn+"":Dn,new Map);const Mn=({tripId:e="1",tripName:a="Your Trip"})=>{const{variant:s}=le(),{user:r}=re();rt({trip_type:"consumer"===s?"consumer":"pro",enabled_features:[...nt]});const{basecamp:n,setBasecamp:i,isBasecampSet:l}=ce(),[o,c]=M.useState(!1),[d,u]=M.useState([]),[m]=M.useState({preferredMode:"driving",unit:"miles",showDistances:!0}),{createLinkFromPlace:p,removeLinkByPlaceId:h,updateLinkByPlaceId:x}=(()=>{const e=e=>e.url?e.url:e.address?`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(e.address)}`:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(e.name)}`;return{createLinkFromPlace:M.useCallback(async(t,a="You",s,r)=>{try{if(!r){const a=JSON.parse(localStorage.getItem(`demo_trip_links_${s}`)||"[]");return a.push({place_id:t.id,name:t.name,url:e(t),timestamp:Date.now()}),void localStorage.setItem(`demo_trip_links_${s}`,JSON.stringify(a))}const a=e(t),n={trip_id:s,url:a,og_title:t.name,og_description:`Saved from Places${t.address?`: ${t.address}`:""} | place_id:${t.id}`,domain:new URL(a).hostname,og_image_url:null,favicon_url:null},{data:i,error:l}=await ue.from("trip_link_index").insert(n).select().single();if(l)throw l;return i}catch(n){throw n}},[]),removeLinkByPlaceId:M.useCallback(async(e,t,a)=>{try{if(!a){const a=JSON.parse(localStorage.getItem(`demo_trip_links_${t}`)||"[]").filter(t=>t.place_id!==e);return void localStorage.setItem(`demo_trip_links_${t}`,JSON.stringify(a))}const{data:s}=await ue.from("trip_link_index").select("id, og_description").eq("trip_id",t),r=null==s?void 0:s.find(t=>{var a;return null==(a=t.og_description)?void 0:a.includes(`place_id:${e}`)});r&&await ue.from("trip_link_index").delete().eq("id",r.id)}catch(s){}},[]),updateLinkByPlaceId:M.useCallback(async(t,a,s,r)=>{try{if(!r){const r=JSON.parse(localStorage.getItem(`demo_trip_links_${s}`)||"[]").map(s=>s.place_id===t?{...s,name:a.name,url:e(a)}:s);return void localStorage.setItem(`demo_trip_links_${s}`,JSON.stringify(r))}const{data:n}=await ue.from("trip_link_index").select("id, og_description").eq("trip_id",s),i=null==n?void 0:n.find(e=>{var a;return null==(a=e.og_description)?void 0:a.includes(`place_id:${t}`)});i&&await ue.from("trip_link_index").update({og_title:a.name,url:e(a),og_description:`Saved from Places${a.address?`: ${a.address}`:""} | place_id:${t}`}).eq("id",i.id)}catch(n){}},[])}})();M.useEffect(()=>{if(l&&n&&d.length>0){(async()=>{const t=await Promise.all(d.map(async t=>{try{const a=await An.calculateDistance(n,t,m),s={...t,distanceFromBasecamp:a?{[m.preferredMode]:a,unit:m.unit,calculatedAt:(new Date).toISOString()}:void 0};return await x(t.id,s,e,null==r?void 0:r.id),s}catch(a){return t}}));u(t)})()}},[n,l,m.preferredMode,m.unit]);const f=async t=>{if(i(t),d.length>0){const a=await Promise.all(d.map(async a=>{const s=await An.calculateDistance(t,a,m),n={...a,distanceFromBasecamp:s?{...a.distanceFromBasecamp,[m.preferredMode]:s,unit:m.unit}:void 0};return await x(a.id,n,e,null==r?void 0:r.id),n}));u(a)}},g=async t=>{if(n&&m.showDistances){const e=await An.calculateDistance(n,t,m);e&&(t.distanceFromBasecamp={[m.preferredMode]:e,unit:m.unit})}u([...d,t]),await p(t,"You",e,null==r?void 0:r.id)};return t.jsxs("div",{className:"mb-12",children:[t.jsx("div",{className:"mb-8",children:t.jsx("h2",{className:"text-3xl font-bold text-white",children:"Places"})}),t.jsx("div",{className:"mb-4 hero-map-section",children:t.jsx("div",{className:"bg-gray-900 border border-gray-800 rounded-3xl overflow-hidden shadow-2xl shadow-black/50 h-96",children:t.jsx(Nn,{className:"w-full h-full"})})}),l&&n&&t.jsx("div",{className:"mb-8 bg-green-500/10 border border-green-500/30 rounded-xl p-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(oe,{size:16,className:"text-green-400 flex-shrink-0"}),t.jsxs("span",{className:"text-sm text-green-300",children:["All searches use ",t.jsx("strong",{children:n.name||n.address})," as your starting point"]})]})}),t.jsxs(xt,{defaultValue:"accommodations",className:"w-full",children:[t.jsxs(ft,{className:"grid w-full grid-cols-2 mb-6",children:[t.jsxs(gt,{value:"accommodations",className:"flex items-center gap-2",children:[t.jsx(Et,{size:16}),"Accommodations"]}),t.jsxs(gt,{value:"places",className:"flex items-center gap-2",children:[t.jsx(Ze,{size:16}),"Places & Activities"]})]}),t.jsx(yt,{value:"accommodations",className:"space-y-6",children:t.jsx(Pn,{tripId:e,onLocationSet:(e,t)=>{"trip"===t&&f(e)}})}),t.jsx(yt,{value:"places",className:"space-y-6",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[t.jsx(wn,{basecamp:n,onBasecampSet:f}),t.jsx(Sn,{places:d,basecamp:n,onPlaceAdded:g,onPlaceRemoved:async t=>{u(e=>e.filter(e=>e.id!==t)),await h(t,e,null==r?void 0:r.id)},onEventAdded:e=>{},distanceUnit:m.unit,preferredMode:m.preferredMode})]})})]}),t.jsx(bn,{isOpen:o,onClose:()=>c(!1),onPlaceAdded:g,basecamp:n})]})},In=({summary:e})=>{const a=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e);return t.jsx(dt,{className:"bg-gradient-to-br from-primary/10 to-primary/5 border-primary/20",children:t.jsx(pt,{className:"pt-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"text-center space-y-1",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"You Owe"}),t.jsx("p",{className:"text-2xl font-bold text-orange-600",children:a(e.totalOwed)})]}),t.jsxs("div",{className:"text-center space-y-1",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"You Are Owed"}),t.jsx("p",{className:"text-2xl font-bold text-green-600",children:a(e.totalOwedToYou)})]}),t.jsxs("div",{className:"text-center space-y-1",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Net Balance"}),t.jsxs("div",{className:"flex items-center justify-center gap-2 text-2xl font-bold "+(e.netBalance>0?"text-green-600":e.netBalance<0?"text-orange-600":"text-muted-foreground"),children:[e.netBalance>0?t.jsx(vt,{className:"w-5 h-5"}):e.netBalance<0?t.jsx(ot,{className:"w-5 h-5"}):t.jsx(Dt,{className:"w-5 h-5"}),a(Math.abs(e.netBalance))]})]})]})})})},Tn=({open:e,onOpenChange:a,balance:s,tripId:r})=>{const{toast:n}=de(),[i,l]=M.useState(!1),o=s.amountOwed<0;return t.jsx(ke,{open:e,onOpenChange:a,children:t.jsxs(Se,{children:[t.jsxs(Ce,{children:[t.jsx(Ee,{children:"Settle Payment"}),t.jsx(Ae,{children:"Confirm that this payment has been completed"})]}),t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-muted-foreground",children:"Amount:"}),t.jsx("span",{className:"text-lg font-semibold",children:(c=Math.abs(s.amountOwed),new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.abs(c)))})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-muted-foreground",children:o?"Paying to:":"Receiving from:"}),t.jsx("span",{className:"font-medium",children:s.userName})]}),s.preferredPaymentMethod&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-muted-foreground",children:"Method:"}),t.jsx("span",{className:"font-medium",children:s.preferredPaymentMethod.type.charAt(0).toUpperCase()+s.preferredPaymentMethod.type.slice(1)})]}),t.jsx("p",{className:"text-sm text-muted-foreground mt-4",children:"This will mark all associated payments as settled. This action cannot be undone."})]}),t.jsxs(De,{children:[t.jsx(W,{variant:"outline",onClick:()=>a(!1),disabled:i,children:"Cancel"}),t.jsxs(W,{onClick:async()=>{var e,t;l(!0);try{const{data:{user:r}}=await ue.auth.getUser();if(!r)throw new Error("Not authenticated");const i=s.amountOwed<0,l=s.unsettledPayments.map(e=>e.paymentId);if(i){const{error:t}=await ue.from("payment_splits").update({confirmation_status:"pending",settlement_method:(null==(e=s.preferredPaymentMethod)?void 0:e.type)||"other"}).in("payment_message_id",l).eq("debtor_user_id",r.id).eq("is_settled",!1);if(t)throw t;n({title:"Payment Marked as Paid",description:`${s.userName} will be notified to confirm receipt`})}else{const{error:e}=await ue.from("payment_splits").update({is_settled:!0,settled_at:(new Date).toISOString(),confirmation_status:"confirmed",confirmed_by:r.id,confirmed_at:(new Date).toISOString(),settlement_method:(null==(t=s.preferredPaymentMethod)?void 0:t.type)||"other"}).in("payment_message_id",l).eq("debtor_user_id",s.userId).eq("is_settled",!1);if(e)throw e;n({title:"Payment Settled",description:`Marked payment from ${s.userName} as settled`})}a(!1),window.location.reload()}catch(r){n({title:"Error",description:"Failed to settle payment. Please try again.",variant:"destructive"})}finally{l(!1)}},disabled:i,children:[i&&t.jsx(bt,{className:"w-4 h-4 mr-2 animate-spin"}),"Confirm Settlement"]})]})]})});var c},Rn=({open:e,onOpenChange:a,balance:s,tripId:r})=>{const[n,i]=M.useState(!1),l=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.abs(e));return t.jsx(ke,{open:e,onOpenChange:a,children:t.jsxs(Se,{className:"sm:max-w-md",children:[t.jsxs(Ce,{children:[t.jsxs(Ee,{className:"flex items-center gap-2",children:[t.jsx(O,{className:"w-5 h-5 text-green-500"}),"Confirm Payment Received"]}),t.jsxs(Ae,{children:[s.userName," marked their payment as complete. Please confirm you've received the money."]})]}),t.jsxs("div",{className:"py-4",children:[t.jsxs("div",{className:"bg-muted rounded-lg p-4 space-y-2",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Amount:"}),t.jsx("span",{className:"font-semibold",children:l(Math.abs(s.amountOwed))})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"From:"}),t.jsx("span",{className:"font-medium",children:s.userName})]}),s.preferredPaymentMethod&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Via:"}),t.jsx("span",{className:"font-medium capitalize",children:s.preferredPaymentMethod.type})]})]}),t.jsx("div",{className:"mt-4 text-sm text-muted-foreground",children:"By confirming, you're acknowledging that you've received this payment and the transaction will be marked as complete."})]}),t.jsxs(De,{className:"flex gap-2",children:[t.jsx(W,{type:"button",variant:"outline",onClick:()=>{a(!1),me({title:"Payment Still Pending",description:"The payment confirmation request will remain open."})},disabled:n,children:"Leave Pending"}),t.jsx(W,{type:"button",onClick:async()=>{i(!0);try{const{data:{user:e}}=await ue.auth.getUser();if(!e)throw new Error("Not authenticated");const{error:t}=await ue.from("payment_splits").update({confirmation_status:"confirmed",confirmed_by:e.id,confirmed_at:(new Date).toISOString(),is_settled:!0,settled_at:(new Date).toISOString()}).eq("debtor_user_id",s.userId).eq("confirmation_status","pending");if(t)throw t;me({title:"Payment Confirmed",description:`You've confirmed receiving ${l(Math.abs(s.amountOwed))} from ${s.userName}`}),a(!1),window.location.reload()}catch(e){me({title:"Confirmation Failed",description:e instanceof Error?e.message:"Failed to confirm payment",variant:"destructive"})}finally{i(!1)}},disabled:n,className:"bg-green-600 hover:bg-green-700",children:n?t.jsxs(t.Fragment,{children:[t.jsx(bt,{className:"w-4 h-4 mr-2 animate-spin"}),"Confirming..."]}):t.jsxs(t.Fragment,{children:[t.jsx(O,{className:"w-4 h-4 mr-2"}),"Confirm Received"]})})]})]})})},Fn=({balance:e,tripId:a})=>{const[s,r]=M.useState(!1),[n,i]=M.useState(!1),[l,o]=M.useState(!1),c="pending"===e.confirmationStatus,d=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.abs(e)),u=e.amountOwed<0,m=Math.abs(e.amountOwed),p=(()=>{if(!e.preferredPaymentMethod)return null;const t=e.preferredPaymentMethod,a=t.identifier;switch(t.type){case"venmo":return`venmo://paycharge?txn=pay&recipients=${encodeURIComponent(a)}&amount=${m.toFixed(2)}`;case"cashapp":return`https://cash.app/${encodeURIComponent(a)}/${m.toFixed(2)}`;case"paypal":return`https://paypal.me/${encodeURIComponent(a)}/${m.toFixed(2)}`;default:return null}})();return t.jsxs(t.Fragment,{children:[t.jsx(dt,{className:u?"border-orange-600/30":"border-green-600/30",children:t.jsxs(pt,{className:"pt-6",children:[t.jsxs("div",{className:"flex items-center justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[t.jsxs(X,{className:"w-10 h-10 flex-shrink-0",children:[t.jsx(Z,{src:e.avatar,alt:e.userName}),t.jsx(J,{children:e.userName.charAt(0)})]}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("h4",{className:"font-semibold text-foreground truncate",children:e.userName}),t.jsx("p",{className:"text-xs text-muted-foreground truncate",children:(()=>{if(!e.preferredPaymentMethod)return"No payment method set";const t=e.preferredPaymentMethod;return`${{venmo:"Venmo",cashapp:"Cash App",zelle:"Zelle",paypal:"PayPal",applecash:"Apple Cash"}[t.type]||t.type}: ${t.identifier}`})()})]})]}),c&&!u?t.jsxs(W,{size:"sm",className:"text-xs px-3 py-1.5 h-auto flex-shrink-0 bg-orange-600 hover:bg-orange-700",onClick:()=>o(!0),children:[t.jsx(we,{className:"w-3 h-3 mr-1"}),"Confirm Payment"]}):u?t.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[p&&t.jsxs(W,{size:"sm",className:"text-xs px-3 py-1.5 h-auto",onClick:()=>window.open(p,"_blank"),children:[t.jsx(jt,{className:"w-3 h-3 mr-1"}),"Pay Now"]}),t.jsx(W,{size:"sm",variant:"outline",className:"text-xs px-3 py-1.5 h-auto",onClick:()=>i(!0),children:"Mark as Paid"})]}):t.jsx(W,{size:"sm",variant:"outline",className:"text-xs px-3 py-1.5 h-auto flex-shrink-0",onClick:()=>i(!0),children:"Mark as Paid"}),t.jsxs("div",{className:"text-right flex-shrink-0",children:[t.jsx("p",{className:"text-sm font-semibold "+(u?"text-orange-600":"text-green-600"),children:u?"You owe":"Owes you"}),t.jsx("p",{className:"text-lg font-bold",children:d(m)})]}),t.jsx(W,{size:"sm",variant:"ghost",className:"flex-shrink-0 h-auto p-1",onClick:()=>r(!s),children:s?t.jsx(We,{className:"w-4 h-4"}):t.jsx($e,{className:"w-4 h-4"})})]}),s&&t.jsxs("div",{className:"mt-4 pt-4 border-t border-border space-y-2",children:[t.jsx("h5",{className:"font-medium text-sm text-muted-foreground mb-2",children:"Individual Payments"}),e.unsettledPayments.length>0?e.unsettledPayments.map((e,a)=>t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-muted-foreground",children:e.description}),t.jsx("span",{className:e.amount<0?"text-orange-600":"text-green-600",children:d(Math.abs(e.amount))})]},a)):t.jsx("p",{className:"text-sm text-muted-foreground italic",children:"No itemized breakdown available"})]})]})}),t.jsx(Tn,{open:n,onOpenChange:i,balance:e,tripId:a}),t.jsx(Rn,{open:l,onOpenChange:o,balance:e,tripId:a})]})},On=[{id:"mock-payment-1",trip_id:"1",amount:150,currency:"USD",description:"Dinner split",split_count:4,split_participants:["user-1","user-2","user-3","user-4"],payment_methods:["venmo:@sarahchen"],created_by:"mock-user-1",is_settled:!1,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),version:1}],zn={async getUserPaymentMethods(e){try{const{data:t,error:a}=await ue.from("user_payment_methods").select("*").eq("user_id",e).order("created_at",{ascending:!1});if(a)throw a;return t.map(e=>({id:e.id,type:e.method_type,identifier:e.identifier,displayName:e.display_name,isPreferred:e.is_preferred,isVisible:e.is_visible}))}catch(t){return[]}},async savePaymentMethod(e,t){try{const{error:a}=await ue.from("user_payment_methods").insert({user_id:e,method_type:t.type,identifier:t.identifier,display_name:t.displayName,is_preferred:t.isPreferred,is_visible:t.isVisible});return!a}catch(a){return!1}},async updatePaymentMethod(e,t){try{const{error:a}=await ue.from("user_payment_methods").update({method_type:t.type,identifier:t.identifier,display_name:t.displayName,is_preferred:t.isPreferred,is_visible:t.isVisible}).eq("id",e);return!a}catch(a){return!1}},async deletePaymentMethod(e){try{const{error:t}=await ue.from("user_payment_methods").delete().eq("id",e);return!t}catch(t){return!1}},async createPaymentMessage(e,t,a){try{const{data:s,error:r}=await ue.rpc("create_payment_with_splits_v2",{p_trip_id:e,p_amount:a.amount,p_currency:a.currency,p_description:a.description,p_split_count:a.splitCount,p_split_participants:a.splitParticipants,p_payment_methods:a.paymentMethods,p_created_by:t});if(r)throw r;return s}catch(s){return null}},async getTripPaymentMessages(e){try{if(await Nt.isDemoModeEnabled())return On.filter(t=>t.trip_id===e).map(e=>({id:e.id,tripId:e.trip_id,messageId:null,amount:e.amount,currency:e.currency,description:e.description,splitCount:e.split_count,splitParticipants:e.split_participants,paymentMethods:e.payment_methods,createdBy:e.created_by,createdAt:e.created_at,isSettled:e.is_settled}));const{data:t,error:a}=await ue.from("trip_payment_messages").select("*").eq("trip_id",e).order("created_at",{ascending:!1});if(a)throw a;return t.map(e=>({id:e.id,tripId:e.trip_id,messageId:e.message_id,amount:parseFloat(e.amount.toString()),currency:e.currency,description:e.description,splitCount:e.split_count,splitParticipants:Array.isArray(e.split_participants)?e.split_participants:[],paymentMethods:Array.isArray(e.payment_methods)?e.payment_methods:[],createdBy:e.created_by,createdAt:e.created_at,isSettled:e.is_settled}))}catch(t){return[]}},async settlePayment(e,t){try{const{data:a,error:s}=await ue.from("payment_splits").select("is_settled").eq("id",e).single();if(s)throw s;if(a.is_settled)throw new Error("Payment has already been settled by another user.");const{error:r}=await ue.from("payment_splits").update({is_settled:!0,settled_at:(new Date).toISOString(),settlement_method:t}).eq("id",e).eq("is_settled",!1);return!r}catch(a){return!1}},async getTripPaymentSummary(e){try{const t=await this.getTripPaymentMessages(e),{data:a,error:s}=await ue.from("payment_splits").select("\n          *,\n          payment_message:trip_payment_messages!inner(trip_id, created_by, amount)\n        ").eq("payment_message.trip_id",e);if(s)throw s;const r={};let n=0;t.forEach(e=>{n+=e.amount,r[e.createdBy]||(r[e.createdBy]=0),r[e.createdBy]+=e.amount}),a.forEach(e=>{r[e.debtor_user_id]||(r[e.debtor_user_id]=0),r[e.debtor_user_id]-=parseFloat(e.amount_owed.toString())});const i=[],l=Object.entries(r).filter(([e,t])=>t<0),o=Object.entries(r).filter(([e,t])=>t>0);return l.forEach(([e,t])=>{o.forEach(([a,s])=>{if(Math.abs(t)>0&&s>0){const r=Math.min(Math.abs(t),s);i.push({from:e,to:a,amount:r})}})}),{totalExpenses:n,userBalances:r,settlementSuggestions:i}}catch(t){return{totalExpenses:0,userBalances:{},settlementSuggestions:[]}}}},Ln=({tripId:e})=>{const[a,s]=M.useState([]),[r,n]=M.useState(!0);M.useEffect(()=>{(async()=>{n(!0);try{let t=await zn.getTripPaymentMessages(e);const a=parseInt(e);if(0===t.length&&a>=1&&a<=12){t=(await Nt.getMockPayments(e,!1)).map(e=>({id:e.id,tripId:e.trip_id,messageId:null,amount:e.amount,currency:e.currency,description:e.description,splitCount:e.split_count,splitParticipants:e.split_participants,paymentMethods:e.payment_methods,createdBy:e.created_by,createdAt:e.created_at,isSettled:e.is_settled}))}const r=Nt.getSessionPayments(e);if(r.length>0){const e=r.map(e=>({id:e.id,tripId:e.trip_id,messageId:null,amount:e.amount,currency:e.currency,description:e.description,splitCount:e.split_count,splitParticipants:e.split_participants,paymentMethods:e.payment_methods,createdBy:e.created_by,createdAt:e.created_at,isSettled:e.is_settled}));t=[...t,...e]}t.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime());const n=[...new Set(t.filter(e=>"demo-user"!==e.createdBy).map(e=>e.createdBy))],i=new Map;if(n.length>0){const{data:e}=await ue.from("profiles").select("user_id, display_name").in("user_id",n);(e||[]).forEach(e=>{i.set(e.user_id,e.display_name||"Trip member")})}const l=t.map(e=>({id:e.id,description:e.description,amount:e.amount,currency:e.currency,splitCount:e.splitCount,createdBy:e.createdBy,createdAt:e.createdAt,createdByName:"demo-user"===e.createdBy?"Demo User":i.get(e.createdBy)||"Trip member"}));s(l)}catch(t){const a=parseInt(e);if(a>=1&&a<=12){const t=(await Nt.getMockPayments(e,!1)).map(e=>({id:e.id,description:e.description,amount:e.amount,currency:e.currency,splitCount:e.split_count,createdBy:e.created_by,createdAt:e.created_at,createdByName:"Demo User"}));s(t)}else s([])}finally{n(!1)}})()},[e]);const i=(e,t)=>new Intl.NumberFormat("en-US",{style:"currency",currency:t}).format(e);return r?t.jsx(dt,{children:t.jsx(pt,{className:"flex items-center justify-center py-8",children:t.jsx(bt,{className:"w-6 h-6 animate-spin text-primary"})})}):t.jsxs(dt,{children:[t.jsxs(ut,{children:[t.jsx(mt,{children:"Payment History"}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"All payment requests created for this trip"})]}),t.jsx(pt,{children:a.length>0?t.jsx("div",{className:"space-y-2",children:a.map(e=>t.jsxs("div",{className:"flex items-center justify-between py-1.5 border-b border-border last:border-0",children:[t.jsxs("div",{className:"flex items-baseline gap-2 flex-1 min-w-0",children:[t.jsx("span",{className:"font-medium text-foreground",children:e.description}),t.jsxs("span",{className:"text-xs text-muted-foreground truncate",children:[e.createdByName||"Trip member"," requested • Split among ",e.splitCount," people • ",xe(new Date(e.createdAt),"MMM d, yyyy")]})]}),t.jsx("div",{className:"text-right flex-shrink-0",children:t.jsxs("span",{className:"font-semibold text-foreground",children:[i(e.amount,e.currency)," ",t.jsxs("span",{className:"text-sm text-muted-foreground font-normal",children:["(",i(e.amount/e.splitCount,e.currency),"/person)"]})]})})]},e.id))}):t.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No payments yet"})})]})},$n={async getBalanceSummary(e,t){try{const{data:a,error:s}=await ue.from("trip_payment_messages").select("*").eq("trip_id",e);if(s)throw s;if(!a||0===a.length)return{totalOwed:0,totalOwedToYou:0,netBalance:0,balances:[]};const{data:r,error:n}=await ue.from("payment_splits").select("*, confirmation_status, confirmed_by, confirmed_at").in("payment_message_id",(null==a?void 0:a.map(e=>e.id))||[]);if(n)throw n;const i=new Set;null==a||a.forEach(e=>i.add(e.created_by)),null==r||r.forEach(e=>i.add(e.debtor_user_id));const{data:l,error:o}=await ue.from("profiles").select("user_id, display_name, avatar_url").in("user_id",Array.from(i));if(o)throw o;const{data:c,error:d}=await ue.from("user_payment_methods").select("*").in("user_id",Array.from(i));if(d)throw d;const u=e=>{if(!e||0===e.length)return null;const t=e.find(e=>e.is_preferred);if(t)return t;const a=["venmo","cashapp","zelle","paypal","applecash","cash","other"];return[...e].sort((e,t)=>{const s=a.indexOf(e.method_type),r=a.indexOf(t.method_type);return(-1===s?999:s)-(-1===r?999:r)})[0]},m=new Map;m.set(t,{netAmount:0,payments:[],confirmationStatus:"none"}),null==a||a.forEach(e=>{if(e.created_by===t){((null==r?void 0:r.filter(a=>a.payment_message_id===e.id&&a.debtor_user_id!==t))||[]).forEach(t=>{if(!t.is_settled){const a=t.debtor_user_id,s=t.confirmation_status||"none";m.has(a)||m.set(a,{netAmount:0,payments:[],confirmationStatus:s});const r=m.get(a);r.netAmount+=t.amount_owed,r.confirmationStatus=s,r.payments.push({paymentId:e.id,description:e.description,amount:t.amount_owed,date:e.created_at})}})}}),null==r||r.forEach(e=>{if(e.debtor_user_id===t&&!e.is_settled){const t=null==a?void 0:a.find(t=>t.id===e.payment_message_id);if(t){const a=t.created_by,s=e.confirmation_status||"none";m.has(a)||m.set(a,{netAmount:0,payments:[],confirmationStatus:s});const r=m.get(a);r.netAmount-=e.amount_owed,r.confirmationStatus=s,r.payments.push({paymentId:t.id,description:t.description,amount:-e.amount_owed,date:t.created_at})}}});const p=[];let h=0,x=0;return m.forEach((e,a)=>{if(a===t)return;const s=null==l?void 0:l.find(e=>e.user_id===a),r=(null==c?void 0:c.filter(e=>e.user_id===a))||[],n=u(r.map(e=>({...e,type:e.method_type})));p.push({userId:a,userName:(null==s?void 0:s.display_name)||"Unknown User",avatar:null==s?void 0:s.avatar_url,amountOwed:e.netAmount,preferredPaymentMethod:n?{id:n.id,type:n.method_type,identifier:n.identifier,displayName:n.display_name||void 0,isPreferred:n.is_preferred||!1}:null,unsettledPayments:e.payments,confirmationStatus:e.confirmationStatus}),e.netAmount<0?h+=Math.abs(e.netAmount):e.netAmount>0&&(x+=e.netAmount)}),p.sort((e,t)=>e.amountOwed-t.amountOwed),{totalOwed:h,totalOwedToYou:x,netBalance:x-h,balances:p.filter(e=>0!==e.amountOwed)}}catch(a){return{totalOwed:0,totalOwedToYou:0,netBalance:0,balances:[]}}}},Bn=({tripId:e})=>{const{user:a}=re(),{createPaymentMessage:s}=(e=>{const[t,a]=M.useState([]),[s,r]=M.useState([]),[n,i]=M.useState(!1),{user:l}=re(),o=null==l?void 0:l.id;return M.useEffect(()=>{o&&(async()=>{i(!0);try{const e=await zn.getUserPaymentMethods(o);a(e)}catch(e){}finally{i(!1)}})()},[o]),M.useEffect(()=>{e&&(async()=>{i(!0);try{const t=await zn.getTripPaymentMessages(e);r(t)}catch(t){}finally{i(!1)}})()},[e]),{paymentMethods:t,tripPayments:s,loading:n,addPaymentMethod:async e=>{if(!o)return!1;const t=await zn.savePaymentMethod(o,e);if(t){const e=await zn.getUserPaymentMethods(o);a(e)}return t},updatePaymentMethod:async(e,t)=>{const s=await zn.updatePaymentMethod(e,t);if(s&&o){const e=await zn.getUserPaymentMethods(o);a(e)}return s},deletePaymentMethod:async e=>{const t=await zn.deletePaymentMethod(e);if(t&&o){const e=await zn.getUserPaymentMethods(o);a(e)}return t},createPaymentMessage:async t=>{if(!e||!o)return null;const a=await zn.createPaymentMessage(e,o,t);if(a){const t=await zn.getTripPaymentMessages(e);r(t)}return a},settlePayment:async(t,a)=>{const s=await zn.settlePayment(t,a);if(s&&e){const t=await zn.getTripPaymentMessages(e);r(t)}return s},getTripPaymentSummary:async()=>e?await zn.getTripPaymentSummary(e):null}})(e),{toast:r}=de(),{isDemoMode:n,isLoading:i}=ye(),[l,o]=M.useState(null),[c,d]=M.useState(!0),[u,m]=M.useState([]),[p,h]=M.useState(!1),x=parseInt(e),f=n||x>=1&&x<=12;M.useEffect(()=>{if(i)return;(async()=>{const t=parseInt(e);if(t>=1&&t<=12){const e=wt(t);if(null==e?void 0:e.participants){const t=e.participants.map(e=>({id:e.id.toString(),name:e.name,avatar:e.avatar}));return void m(t)}}try{const{data:t,error:a}=await ue.from("trip_members").select("user_id").eq("trip_id",e);if(a||!t||0===t.length)return void m([]);const s=t.map(e=>e.user_id),{data:r,error:n}=await ue.from("profiles").select("user_id, display_name, avatar_url").in("user_id",s);if(n)return void m([]);const i=(r||[]).map(e=>({id:e.user_id,name:e.display_name||"Unknown User",avatar:e.avatar_url||void 0}));m(i)}catch(a){m([])}})()},[e,i]),M.useEffect(()=>{if(i)return;(async()=>{if(f){const t=await Nt.getMockPayments(e,!1),a=await Nt.getMockMembers(e),s=t.reduce((e,t)=>e+t.amount,0)/Math.max(a.length,1);return o({totalOwed:.6*s,totalOwedToYou:.4*s,netBalance:.2*s,balances:a.slice(0,3).map((e,t)=>({userId:e.user_id,userName:e.display_name,avatar:e.avatar_url,amountOwed:(0===t?.5*s:.3*s)*(t%2==0?1:-1),preferredPaymentMethod:null,unsettledPayments:[]}))}),void d(!1)}if(!(null==a?void 0:a.id))return o({totalOwed:0,totalOwedToYou:0,netBalance:0,balances:[]}),void d(!1);d(!0);const t=await $n.getBalanceSummary(e,a.id);o(t),d(!1)})()},[e,null==a?void 0:a.id,f,i]);return c?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx(bt,{className:"w-8 h-8 animate-spin text-primary"})}):l?t.jsxs("div",{className:"space-y-6",children:[i?t.jsx("div",{className:"flex items-center justify-center py-8 opacity-80",children:t.jsx(bt,{className:"w-5 h-5 animate-spin text-muted-foreground"})}):a||f?t.jsx($,{onSubmit:async t=>{if(f){if(Nt.addSessionPayment(e,t)){r({title:"Payment request created (Demo)",description:`${t.description} - $${t.amount}`});const a=[...await Nt.getMockPayments(e,!1),...Nt.getSessionPayments(e)],s=await Nt.getMockMembers(e),n=a.reduce((e,t)=>e+t.amount,0)/Math.max(s.length,1);o({totalOwed:.6*n,totalOwedToYou:.4*n,netBalance:.2*n,balances:s.slice(0,3).map((e,t)=>({userId:e.user_id,userName:e.display_name,avatar:e.avatar_url,amountOwed:(0===t?.5*n:.3*n)*(t%2==0?1:-1),preferredPaymentMethod:null,unsettledPayments:[]}))})}return}if(await s(t)){if(r({title:"Payment request created",description:`${t.description} - $${t.amount}`}),null==a?void 0:a.id){const t=await $n.getBalanceSummary(e,a.id);o(t)}}else r({title:"Error",description:"Failed to create payment request",variant:"destructive"})},tripMembers:u,isVisible:!0}):t.jsxs("div",{className:"bg-card rounded-lg border border-border p-6 text-center",children:[t.jsx(it,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),t.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Sign in to create payment requests"}),t.jsx("p",{className:"text-muted-foreground mb-4",children:"You need to be signed in to create and manage payments for this trip."}),t.jsx(W,{variant:"default",onClick:()=>h(!0),children:"Sign In"})]}),t.jsx(In,{summary:l}),l.balances.length>0?t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Balance Breakdown"}),l.balances.map(a=>t.jsx(Fn,{balance:a,tripId:e},a.userId))]}):t.jsx("div",{className:"text-center py-8 bg-muted/50 rounded-lg border border-border",children:t.jsx("p",{className:"text-muted-foreground",children:"All settled up! No outstanding payments."})}),t.jsx(Ln,{tripId:e}),t.jsx(_t,{isOpen:p,onClose:()=>h(!1)})]}):t.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Unable to load payment information"})},Un=({activeTab:e,onTabChange:a,tripId:s="1",tripName:r,basecamp:n,tripPreferences:i,showPlaces:l=!1,showConcierge:o=!1,isDemoMode:c=!1,tripData:d})=>{const[u,m]=M.useState("chat"),{accentColors:p}=le(),h=rt(d||{}),x=[{id:"chat",label:"Chat",icon:tt,enabled:h.showChat},{id:"calendar",label:"Calendar",icon:be,enabled:h.showCalendar},{id:"concierge",label:"Concierge",icon:Je,enabled:o},{id:"media",label:"Media",icon:kt,enabled:h.showMedia},{id:"payments",label:"Payments",icon:Xe,enabled:!0},{id:"places",label:"Places",icon:Ze,enabled:l},{id:"polls",label:"Polls",icon:St,enabled:h.showPolls},{id:"tasks",label:"Tasks",icon:Pt,enabled:h.showTasks}];return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex overflow-x-auto whitespace-nowrap scroll-smooth gap-2 mb-8 pb-2 -mx-2 px-2 justify-center",children:x.map(e=>{const a=e.icon,s=u===e.id,r=e.enabled;return t.jsxs("button",{onClick:()=>((e,t)=>{t&&m(e)})(e.id,r),disabled:!r,className:`\n                flex items-center justify-center gap-2 \n                px-4 py-3 min-h-[44px] min-w-max\n                rounded-lg font-medium text-sm\n                transition-all duration-200\n                flex-shrink-0\n                ${s&&r?`bg-gradient-to-r ${p.gradient} text-white shadow-md`:r?"bg-white/10 text-gray-300 hover:bg-white/20 hover:text-white hover:shadow-sm":"bg-white/5 text-gray-500 cursor-not-allowed opacity-50"}\n                ${r?"focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white/30 focus-visible:ring-offset-2 focus-visible:ring-offset-transparent":""}\n              `,children:[t.jsx(a,{size:16,className:"flex-shrink-0"}),t.jsx("span",{className:"whitespace-nowrap",children:e.label}),!r&&t.jsx(At,{size:12,className:"ml-1 flex-shrink-0"})]},e.id)})}),t.jsx("div",{className:"h-[calc(100vh-320px)] max-h-[1000px] min-h-[500px]",children:(()=>{switch(u){case"chat":default:return t.jsx(B,{tripId:s});case"polls":return t.jsx(Y,{tripId:s});case"tasks":return t.jsx(xn,{tripId:s});case"calendar":return t.jsx(V,{tripId:s});case"media":return t.jsx(q,{tripId:s});case"payments":return t.jsx(Bn,{tripId:s});case"places":return t.jsx(Mn,{tripId:s,tripName:r});case"concierge":return t.jsx(U,{tripId:s,basecamp:n,preferences:i,isDemoMode:c})}})()})]})},qn=({isOpen:e,onClose:a,onExport:s,tripName:r})=>{const[n,i]=M.useState(["calendar","payments","polls","places","tasks"]),[l,o]=M.useState(!1),[c,d]=M.useState(null),[u,m]=M.useState("onepager"),[p,h]=M.useState(!1),[x,f]=M.useState("letter"),g=e=>{m(e),i("pro"===e?e=>{const t=[...e];return["roster","broadcasts","attachments"].forEach(e=>{t.includes(e)||t.push(e)}),t}:e=>e.filter(e=>!["roster","broadcasts","attachments"].includes(e)))};return e?t.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-gray-900 rounded-2xl shadow-2xl max-w-2xl w-full border border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-700",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"bg-blue-600 p-2 rounded-lg",children:t.jsx(H,{size:24})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-white",children:"Export Trip Summary"}),t.jsx("p",{className:"text-sm text-gray-400",children:"Create a PDF summary of your trip"})]})]}),t.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white transition-colors",disabled:l,children:t.jsx(ae,{size:24})})]}),t.jsx("div",{className:"p-6",children:t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("h3",{className:"text-white font-semibold mb-2",children:["Trip: ",r]}),t.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Select the sections you'd like to include in your PDF export"}),t.jsxs("div",{className:"flex gap-3 mb-4",children:[t.jsxs("button",{onClick:()=>g("onepager"),className:"flex-1 py-2 px-4 rounded-lg border-2 transition-all "+("onepager"===u?"bg-blue-900/30 border-blue-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-600"),children:[t.jsx("div",{className:"font-medium",children:"One-Pager"}),t.jsx("div",{className:"text-xs mt-1",children:"Quick summary (1-2 pages)"})]}),t.jsxs("button",{onClick:()=>g("pro"),className:"flex-1 py-2 px-4 rounded-lg border-2 transition-all "+("pro"===u?"bg-blue-900/30 border-blue-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-600"),children:[t.jsx("div",{className:"font-medium",children:"Chravel Pro Summary"}),t.jsx("div",{className:"text-xs mt-1",children:"Full details for teams"})]})]}),t.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg bg-gray-800 border border-gray-700 mb-4 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:p,onChange:e=>h(e.target.checked),className:"w-5 h-5 rounded border-gray-600 text-blue-600 focus:ring-blue-500 focus:ring-offset-gray-900"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"text-white font-medium",children:"Privacy Redaction"}),t.jsx("div",{className:"text-sm text-gray-400",children:"Hide emails and phone numbers"})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"text-white text-sm font-medium mb-2 block",children:"Paper Size"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsxs("button",{onClick:()=>f("letter"),className:"flex-1 py-2 px-4 rounded-lg border transition-all "+("letter"===x?"bg-blue-900/30 border-blue-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-600"),children:[t.jsx("div",{className:"font-medium",children:"Letter"}),t.jsx("div",{className:"text-xs mt-1",children:'8.5" × 11" (US)'})]}),t.jsxs("button",{onClick:()=>f("a4"),className:"flex-1 py-2 px-4 rounded-lg border transition-all "+("a4"===x?"bg-blue-900/30 border-blue-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-600"),children:[t.jsx("div",{className:"font-medium",children:"A4"}),t.jsx("div",{className:"text-xs mt-1",children:"210mm × 297mm (Intl)"})]})]})]})]}),t.jsx("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[{id:"calendar",label:"Calendar",icon:"",description:"Events and itinerary"},{id:"payments",label:"Payments",icon:"",description:"Expenses and splits"},{id:"polls",label:"Polls",icon:"",description:"Voting results"},{id:"places",label:"Places",icon:"",description:"Saved locations"},{id:"tasks",label:"Tasks",icon:"",description:"To-do items"},{id:"roster",label:"Roster & Contacts",icon:"",description:"Team members (Chravel Pro Only)"},{id:"broadcasts",label:"Broadcast Log",icon:"",description:"Important updates (Chravel Pro Only)"},{id:"attachments",label:"Attachments",icon:"",description:"Files and documents (Chravel Pro Only)"}].map(e=>{const a=["roster","broadcasts","attachments"].includes(e.id)&&"onepager"===u;return t.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg border transition-all cursor-pointer "+(a?"bg-gray-800/50 border-gray-700/50 opacity-50 cursor-not-allowed":n.includes(e.id)?"bg-blue-900/30 border-blue-500":"bg-gray-800 border-gray-700 hover:border-gray-600"),children:[t.jsx("input",{type:"checkbox",checked:n.includes(e.id)&&!a,onChange:()=>{return!a&&(t=e.id,void i(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]));var t},disabled:a,className:"w-4 h-4 rounded border-gray-600 text-blue-600 focus:ring-blue-500 focus:ring-offset-gray-900 disabled:cursor-not-allowed"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"text-white text-sm font-medium truncate",children:e.label}),a&&t.jsx("div",{className:"text-xs text-gray-500",children:"Pro only"})]})]},e.id)})}),c&&t.jsx("div",{className:"bg-red-900/30 border border-red-500/50 rounded-lg p-4 mb-4",children:t.jsx("p",{className:"text-red-200 text-sm",children:c})}),t.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4 mb-6",children:t.jsxs("p",{className:"text-gray-300 text-sm",children:[t.jsx("strong",{children:"Note:"})," Chat messages and AI Concierge history are never included in exports for privacy."]})})]})}),t.jsxs("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-gray-700",children:[t.jsx("button",{onClick:a,disabled:l,className:"px-6 py-2 rounded-lg text-gray-300 hover:text-white transition-colors disabled:opacity-50",children:"Cancel"}),t.jsx("button",{onClick:async()=>{if(0!==n.length){o(!0),d(null);try{await s(n,u,p,x),a()}catch(Wn){d(Wn instanceof Error?Wn.message:"Failed to export trip summary")}finally{o(!1)}}else d("Please select at least one section to export")},disabled:l||0===n.length,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:l?t.jsxs(t.Fragment,{children:[t.jsx(bt,{size:18,className:"animate-spin"}),"Generating PDF..."]}):t.jsxs(t.Fragment,{children:[t.jsx(K,{size:18}),"Download PDF"]})})]})]})}):null};async function Vn(e,t,a,s="letter"){var r,n,i,l,o,c,d,u;const m=new Ct({orientation:"portrait",unit:"pt",format:"a4"===s?"a4":"letter"}),p=m.internal.pageSize.getWidth(),h=40,x=p-80;let f=h;if(m.setFontSize(24),m.setFont("helvetica","bold"),m.text(e.tripTitle,h,f),f+=30,e.destination&&(m.setFontSize(12),m.setFont("helvetica","normal"),m.text(e.destination,h,f),f+=20),e.dateRange&&(m.setFontSize(11),m.setTextColor(100),m.text(e.dateRange,h,f),f+=20),e.description){m.setFontSize(10),m.setTextColor(80);const t=m.splitTextToSize(e.description,x);m.text(t,h,f),f+=14*t.length+10}if(m.setDrawColor(200),m.line(h,f,p-h,f),f+=30,m.setFontSize(14),m.setFont("helvetica","bold"),m.setTextColor(0),t.includes("calendar")&&(Yn(m,f,40),m.text("Calendar",h,f),f+=20,m.setFontSize(10),m.setFont("helvetica","normal"),m.text("No calendar events available in demo mode",h,f),f+=30),t.includes("payments")){f=Yn(m,f,60),m.setFontSize(14),m.setFont("helvetica","bold"),m.setTextColor(0),m.text("Payments",h,f),f+=20;const t=(null==(r=e.mockData)?void 0:r.payments)||[];if(t.length>0){const e=t.map(e=>{var t;return[e.description||"N/A",`${e.currency||"USD"} ${(null==(t=e.amount)?void 0:t.toFixed(2))||"0.00"}`,`${e.split_count||0} people`,e.is_settled?"Settled":"Pending"]});m.autoTable({startY:f,head:[["Description","Amount","Split","Status"]],body:e,theme:"striped",headStyles:{fillColor:[66,139,202],fontSize:10},margin:{left:h,right:h},styles:{fontSize:9}}),f=m.lastAutoTable.finalY+20;const a=t.reduce((e,t)=>e+(t.amount||0),0);m.setFontSize(10),m.setFont("helvetica","bold"),m.text(`Total: ${(null==(n=t[0])?void 0:n.currency)||"USD"} ${a.toFixed(2)}`,h,f),f+=30}else m.setFontSize(10),m.setFont("helvetica","normal"),m.setTextColor(120),m.text("No payment records available in demo mode",h,f),f+=30}if(t.includes("polls")){f=Yn(m,f,60),m.setFontSize(14),m.setFont("helvetica","bold"),m.setTextColor(0),m.text("Polls",h,f),f+=20;const t=(null==(i=e.mockData)?void 0:i.polls)||[];t.length>0?t.forEach((e,t)=>{if(f=Yn(m,f,80),m.setFontSize(11),m.setFont("helvetica","bold"),m.setTextColor(0),m.text(`${t+1}. ${e.question}`,h,f),f+=15,e.options&&e.options.length>0){const t=e.options.map(t=>[t.text||"N/A",`${t.votes||0} votes`,`${(t.votes/e.total_votes*100).toFixed(1)}%`]);m.autoTable({startY:f,body:t,theme:"plain",margin:{left:60,right:h},styles:{fontSize:9,cellPadding:3}}),f=m.lastAutoTable.finalY+10}m.setFontSize(9),m.setFont("helvetica","italic"),m.setTextColor(100),m.text(`Total votes: ${e.total_votes||0}`,60,f),f+=20}):(m.setFontSize(10),m.setFont("helvetica","normal"),m.setTextColor(120),m.text("No polls available in demo mode",h,f),f+=30)}if(t.includes("places")&&(Yn(m,f,40),m.setFontSize(14),m.setFont("helvetica","bold"),m.text("Places & Links",h,f),f+=20,m.setFontSize(10),m.setFont("helvetica","normal"),m.text("No places saved in demo mode",h,f),f+=30),t.includes("tasks")){f=Yn(m,f,60),m.setFontSize(14),m.setFont("helvetica","bold"),m.setTextColor(0),m.text("Tasks",h,f),f+=20;const t=(null==(l=e.mockData)?void 0:l.tasks)||[];if(t.length>0){const e=t.map(e=>[e.title||e.description||"N/A",e.assigned_to||"Unassigned",e.due_date?new Date(e.due_date).toLocaleDateString():"No due date",e.completed?"Done":"Pending"]);m.autoTable({startY:f,head:[["Task","Assigned To","Due Date","Status"]],body:e,theme:"striped",headStyles:{fillColor:[66,139,202],fontSize:10},margin:{left:h,right:h},styles:{fontSize:9}}),f=m.lastAutoTable.finalY+30}else m.setFontSize(10),m.setFont("helvetica","normal"),m.setTextColor(120),m.text("No tasks available in demo mode",h,f),f+=30}if("pro"===a){if(t.includes("roster")){f=Yn(m,f,60),m.setFontSize(14),m.setFont("helvetica","bold"),m.setTextColor(0),m.text("Roster & Contacts",h,f),f+=20;const t=(null==(o=e.mockData)?void 0:o.roster)||(null==(c=e.mockData)?void 0:c.participants)||[];if(t.length>0){const e=t.map(e=>[e.name||"N/A",e.email||"N/A",e.role||"N/A",e.credentialLevel||"N/A"]);m.autoTable({startY:f,head:[["Name","Email","Role","Credential Level"]],body:e,theme:"striped",headStyles:{fillColor:[66,139,202],fontSize:10},margin:{left:h,right:h},styles:{fontSize:9}}),f=m.lastAutoTable.finalY+30}else m.setFontSize(10),m.setFont("helvetica","normal"),m.setTextColor(120),m.text("No roster data available in demo mode",h,f),f+=30}if(t.includes("broadcasts")){f=Yn(m,f,60),m.setFontSize(14),m.setFont("helvetica","bold"),m.setTextColor(0),m.text("Broadcast Log",h,f),f+=20;const t=(null==(d=e.mockData)?void 0:d.broadcasts)||[];if(t.length>0){const e=t.map(e=>[e.timestamp?new Date(e.timestamp).toLocaleString():"N/A",e.message||"N/A",e.channel||"N/A",e.sender||"N/A"]);m.autoTable({startY:f,head:[["Timestamp","Message","Channel","Sender"]],body:e,theme:"striped",headStyles:{fillColor:[66,139,202],fontSize:10},margin:{left:h,right:h},styles:{fontSize:9}}),f=m.lastAutoTable.finalY+30}else m.setFontSize(10),m.setFont("helvetica","normal"),m.setTextColor(120),m.text("No broadcasts available in demo mode",h,f),f+=30}if(t.includes("attachments")){f=Yn(m,f,60),m.setFontSize(14),m.setFont("helvetica","bold"),m.setTextColor(0),m.text("Attachments",h,f),f+=20;const t=(null==(u=e.mockData)?void 0:u.attachments)||[];if(t.length>0){const e=t.map(e=>[e.name||"N/A",e.type||"N/A",e.size||"N/A",e.uploaded_at?new Date(e.uploaded_at).toLocaleDateString():"N/A"]);m.autoTable({startY:f,head:[["File Name","Type","Size","Uploaded"]],body:e,theme:"striped",headStyles:{fillColor:[66,139,202],fontSize:10},margin:{left:h,right:h},styles:{fontSize:9}}),f=m.lastAutoTable.finalY+30}else m.setFontSize(10),m.setFont("helvetica","normal"),m.setTextColor(120),m.text("No attachments available in demo mode",h,f),f+=30}}const g=m.internal.pageSize.getHeight();return m.setFontSize(8),m.setTextColor(120),m.text(`Generated by Chravel • ${(new Date).toLocaleString()} • Trip ID: ${e.tripId}`,h,g-20),m.output("blob")}function Yn(e,t,a){return t+a>e.internal.pageSize.getHeight()-60?(e.addPage(),40):t}export{Pt as C,At as L,Mn as P,Un as T,qn as a,Bn as b,xn as c,Vn as g};
