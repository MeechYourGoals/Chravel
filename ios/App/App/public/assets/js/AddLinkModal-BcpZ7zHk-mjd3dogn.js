import{j as e}from"./ui-vendor-BO3EQrMK-mjd3dogn.js";import{r as t,R as s}from"./react-vendor-D1R0t5S0-mjd3dogn.js";import{X as l,B as r,I as a}from"./index-Ta7FH5xW-mjd3dogn.js";import{E as i,L as o}from"./TripDetailModals-BpnQZ47b-mjd3dogn.js";import{M as d}from"./map-pin-BtCU-LeS-mjd3dogn.js";import{S as n}from"./useSavedRecommendations-DTox9Xl2-mjd3dogn.js";import{E as m}from"./external-link-CqAT5ABV-mjd3dogn.js";import"./supabase-DyX-XggK-mjd3dogn.js";import"./utils-DD44zzh--mjd3dogn.js";import"./tripConverter-C1IUbOIF-mjd3dogn.js";import"./tripsData-DKwZ96V_-mjd3dogn.js";import"./select-CMjqEsxb-mjd3dogn.js";import"./SettingsMenu-DFNATHGY-mjd3dogn.js";import"./SavedRecommendations-D-6cIfyL-mjd3dogn.js";import"./card-jeNxgMYk-mjd3dogn.js";import"./badge-DyE_ZUPM-mjd3dogn.js";import"./plus-Dhwa7sZY-mjd3dogn.js";import"./pro-CZgaTEEg-mjd3dogn.js";import"./BillingSection-CjHrdMm3-mjd3dogn.js";import"./building-QMpp1aWF-mjd3dogn.js";import"./camera-AJLsIMdA-mjd3dogn.js";import"./user-DFuJ2ZP3-mjd3dogn.js";import"./shield-DGBvlKQi-mjd3dogn.js";import"./zap-LZcBFzwj-mjd3dogn.js";import"./trending-up-B0a-0y1l-mjd3dogn.js";import"./input-DsI2n-oJ-mjd3dogn.js";import"./label-D_iG0y88-mjd3dogn.js";import"./switch-GKuTbu---mjd3dogn.js";import"./loader-circle-C0Dqayt8-mjd3dogn.js";import"./mail-BdBVrsyz-mjd3dogn.js";import"./userPreferencesService-DregIO64-mjd3dogn.js";import"./calendar-C9K0fVga-mjd3dogn.js";import"./archive-zX2FvEif-mjd3dogn.js";import"./AuthModal-BKw70HSh-mjd3dogn.js";import"./arrow-left-Biq1qnK6-mjd3dogn.js";import"./eye-BNDPAvT6-mjd3dogn.js";import"./users-B07yK8Y7-mjd3dogn.js";import"./dropdown-menu-BXaKb4pk-mjd3dogn.js";import"./chevron-right-DKRZr0Ps-mjd3dogn.js";import"./dialog-BcLamxvL-mjd3dogn.js";import"./eventsMockData-BWXZ-nj7-mjd3dogn.js";import"./calendar-ylgcJK3b-mjd3dogn.js";import"./chevron-left-C1xtDQ_l-mjd3dogn.js";import"./progress-D31nnzej-mjd3dogn.js";import"./textarea-BudkfAn8-mjd3dogn.js";import"./googlePlacesNew-Dl7cAwDK-mjd3dogn.js";import"./circle-check-big-Bvor9_sf-mjd3dogn.js";import"./avatar-HCmfb6Ad-mjd3dogn.js";import"./circle-alert-CX60mGhN-mjd3dogn.js";import"./clock-CbBGjTQx-mjd3dogn.js";import"./chart-column-DOJCLy2J-mjd3dogn.js";import"./circle-check-CNnkiDfZ-mjd3dogn.js";import"./charts-CLK9EMgA-mjd3dogn.js";import"./share-2-DwO-SOoB-mjd3dogn.js";const c=[{id:"1",title:"Charming 3BR Apartment in Montmartre",url:"https://airbnb.com/rooms/123",postedBy:"Emma"},{id:"2",title:"L'Ami Jean - Traditional Bistro",url:"https://example.com/restaurant",postedBy:"Jake"}],p=({isOpen:p,onClose:u,prefill:j})=>{const[x,g]=t.useState("place"),[b,h]=t.useState(""),[f,v]=t.useState(""),[N,y]=t.useState(""),[k,w]=t.useState(""),[S,C]=t.useState(!1),[L,z]=t.useState([]),[A,M]=t.useState(!1),[R,B]=t.useState(null),[P,T]=t.useState([]),[O,U]=t.useState(null),[D,E]=t.useState(!1),{resolvePlaceName:q,isLoading:J}=i();s.useEffect(()=>{p&&j&&(j.url&&(g("url"),h(j.url)),j.title&&v(j.title),j.note&&y(j.note))},[p,j]);const _=(e,t)=>{const s=[];return c.forEach(l=>{let r=0;if(l.url===e)r=1;else if(e&&l.url)try{const t=new URL(e).hostname;t===new URL(l.url).hostname&&(r=Math.max(r,.7))}catch{}if(t&&l.title){const e=t.toLowerCase().split(" "),s=l.title.toLowerCase().split(" "),a=e.filter(e=>e.length>3&&s.some(t=>t.includes(e)||e.includes(t))).length/Math.max(e.length,s.length);r=Math.max(r,a)}r>.6&&s.push({id:l.id,title:l.title,url:l.url,postedBy:l.postedBy,similarity:r})}),s.sort((e,t)=>t.similarity-e.similarity)},G=()=>{g("place"),h(""),v(""),y(""),w(""),z([]),M(!1),B(null),T([]),U(null),E(!1)};return p?e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-lg w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-700",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:j?"Save to Trip Links":"Add Link"}),e.jsx("button",{onClick:u,className:"text-slate-400 hover:text-white",children:e.jsx(l,{size:20})})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),C(!0);try{"place"===x&&O&&O.url,"place"===x&&O&&(f||(null==R||R.name));u(),G()}catch(t){}finally{C(!1)}},className:"p-6 space-y-4",children:[!(null==j?void 0:j.url)&&e.jsxs("div",{className:"flex bg-slate-900/50 rounded-lg p-1 border border-slate-600",children:[e.jsxs("button",{type:"button",onClick:()=>g("place"),className:"flex-1 px-3 py-2 rounded-md text-sm font-medium transition-all "+("place"===x?"bg-blue-600 text-white":"text-slate-400 hover:text-slate-300"),children:[e.jsx(d,{size:16,className:"inline mr-2"}),"Add by Place Name"]}),e.jsxs("button",{type:"button",onClick:()=>g("url"),className:"flex-1 px-3 py-2 rounded-md text-sm font-medium transition-all "+("url"===x?"bg-blue-600 text-white":"text-slate-400 hover:text-slate-300"),children:[e.jsx(o,{size:16,className:"inline mr-2"}),"Add by URL"]})]}),(null==j?void 0:j.url)&&e.jsx("div",{className:"p-3 bg-purple-500/10 border border-purple-500/30 rounded-lg",children:e.jsx("p",{className:"text-sm text-purple-200",children:"ðŸ“Œ Promoting URL from Media to Trip Links"})}),"place"===x&&!(null==j?void 0:j.url)&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Place Name *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(d,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",value:k,onChange:e=>w(e.target.value),placeholder:"e.g., Gotham Hotel New York",required:"place"===x,className:"w-full bg-slate-900/50 border border-slate-600 rounded-lg pl-10 pr-4 py-3 text-white placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),e.jsx(r,{type:"button",onClick:async()=>{if(!k.trim())return;const e=await q(k);if(e.success&&e.place&&e.linkOptions){B(e.place),T(e.linkOptions),v(e.place.name),y(e.place.formatted_address),E(!0);const t=e.linkOptions.find(e=>e.isPrimary)||e.linkOptions[0];U(t),h(t.url)}},disabled:!k.trim()||J,className:"bg-blue-600 hover:bg-blue-700",children:J?"Searching...":"Search"})]})]}),("url"===x||(null==j?void 0:j.url))&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Link URL *"}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"url",value:b,onChange:e=>(e=>{if(h(e),e||f){const t=_(e,f);z(t),M(t.length>0)}})(e.target.value),placeholder:"https://...",required:"url"===x||!!(null==j?void 0:j.url),disabled:!!(null==j?void 0:j.url),className:"w-full bg-slate-900/50 border border-slate-600 rounded-lg pl-10 pr-4 py-3 text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 disabled:opacity-60 disabled:cursor-not-allowed"})]})]}),D&&R&&P.length>0&&!(null==j?void 0:j.url)&&e.jsxs("div",{className:"p-4 bg-slate-900/30 rounded-lg border border-slate-700",children:[e.jsx("div",{className:"flex items-start gap-3 mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-white",children:R.name}),e.jsx("p",{className:"text-sm text-slate-400",children:R.formatted_address}),R.rating&&e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(n,{size:14,className:"text-yellow-400 fill-current"}),e.jsx("span",{className:"text-sm text-slate-300",children:R.rating})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Choose Link Type:"}),P.map(t=>e.jsx("button",{type:"button",onClick:()=>{U(t),h(t.url)},className:"w-full p-3 rounded-lg border text-left transition-all "+((null==O?void 0:O.type)===t.type?"bg-blue-600/20 border-blue-600 text-white":"bg-slate-900/30 border-slate-700 text-slate-300 hover:border-slate-600"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.label}),e.jsx("div",{className:"text-xs text-slate-400",children:t.description})]}),e.jsx(m,{size:16,className:"text-slate-400"})]})},t.type))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Title *"}),e.jsx("input",{type:"text",value:f,onChange:e=>(e=>{if(v(e),b||e){const t=_(b,e);z(t),M(t.length>0)}})(e.target.value),placeholder:"Give this link a title...",required:!0,className:"w-full bg-slate-900/50 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),A&&L.length>0&&e.jsxs("div",{className:"p-3 bg-amber-900/20 border border-amber-600/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(a,{size:16,className:"text-amber-400"}),e.jsx("span",{className:"text-sm font-medium text-amber-300",children:"Similar links found"})]}),L.slice(0,2).map(t=>e.jsxs("div",{className:"text-xs text-amber-200 mb-1",children:['"',t.title,'" by ',t.postedBy," ",t.similarity>.9?"(exact match)":"(similar)"]},t.id)),e.jsx("div",{className:"text-xs text-amber-300 mt-2",children:"Continue if you're sure this is different"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Description"}),e.jsx("textarea",{value:N,onChange:e=>y(e.target.value),placeholder:"Add some context or notes...",rows:3,className:"w-full bg-slate-900/50 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 resize-none"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(r,{type:"button",variant:"outline",onClick:u,className:"flex-1",children:"Cancel"}),e.jsx(r,{type:"submit",disabled:S||"place"===x&&!O&&!(null==j?void 0:j.url),className:"flex-1 bg-blue-600 hover:bg-blue-700",children:S?"Saving...":j?"Save to Trip Links":"Add Link"})]})]})]})}):null};export{p as AddLinkModal};
