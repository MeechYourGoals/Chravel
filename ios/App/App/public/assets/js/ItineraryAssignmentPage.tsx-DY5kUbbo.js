import{j as e}from"./chunk-DE8J_P3a.js";import{r as t,j as s,u as r}from"./chunk-CHPtWMTz.js";import{u as a}from"./chunk-vfQQTDq4.js";import{u as i,a as n}from"./chunk-DV9vF-NS.js";import{c as o,e as l,q as d,s as c,X as g,t as m}from"../index-C69Cv9fm.js";import{u}from"./chunk-Ccyq873b.js";import{C as x}from"./chunk-CD10_Lnj.js";import{C as p}from"./chunk-D_Qk7JHd.js";import{P as h}from"./chunk-DoIo-fWL.js";import{U as y}from"./chunk-CkE6zG_x.js";import{C as f}from"./chunk-Bbmjf7eQ.js";import{c as b}from"./chunk-4koW6KZp.js";import{F as v}from"./chunk-CeA63noh.js";import{C as j}from"./chunk-DJZXZyJn.js";import{M as w}from"./chunk-ByyMTJWo.js";import{f as N}from"./chunk-DN5ISW2H.js";import{A as k}from"./chunk-0Vn9svHl.js";import{U as C}from"./chunk-D5WpN7K-.js";import{C as _}from"./chunk-D53qnCh4.js";import"./chunk-CbEMFF6w.js";import"./chunk-DGLf2uCM.js";import"./chunk-CKgI9q5n.js";import"./chunk-DV21tWlK.js";import"./chunk-DuSQr7KO.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=o("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]),E=[{id:"accommodations",name:"Accommodations",icon:"🏨",description:"Hotels, rentals, and lodging",color:"bg-blue-500"},{id:"food",name:"Food & Dining",icon:"🍽️",description:"Restaurants, cafes, and meals",color:"bg-red-500"},{id:"transportation",name:"Transportation",icon:"🚗",description:"Flights, cars, and local transport",color:"bg-green-500"},{id:"fitness",name:"Fitness & Activities",icon:"💪",description:"Sports, hiking, and wellness",color:"bg-purple-500"},{id:"nightlife",name:"Nightlife & Entertainment",icon:"🌙",description:"Bars, clubs, and evening fun",color:"bg-indigo-500"},{id:"attractions",name:"Attractions & Sightseeing",icon:"🎯",description:"Museums, landmarks, and tours",color:"bg-yellow-500"},{id:"budget",name:"Budget & Expenses",icon:"💰",description:"Costs, payments, and financial planning",color:"bg-emerald-500"}],S="chravel_category_assignments",A=e=>{try{const t=localStorage.getItem(`${S}_${e}`);return t?JSON.parse(t):[]}catch{return[]}},$=(e,t)=>{localStorage.setItem(`${S}_${e}`,JSON.stringify(t))},F=e=>{const{user:t}=l(),{isDemoMode:s}=u(),r=d(),a=i({queryKey:["categoryAssignments",e,s],queryFn:async()=>{if(s||!t)return A(e);const{data:r,error:a}=await c.from("category_assignments").select("*").eq("trip_id",e);if(a)throw a;return(r||[]).map(e=>({...e,assigned_user_ids:Array.isArray(e.assigned_user_ids)?e.assigned_user_ids:[]}))},enabled:!!e}),o=n({mutationFn:async r=>{if(s||!t){const t=A(e),s=t.findIndex(e=>e.category_id===r.category_id);let a;return s>=0?(a=[...t],a[s]={...r,updated_at:(new Date).toISOString()}):a=[...t,{...r,id:`demo-${Date.now()}`,created_at:(new Date).toISOString()}],$(e,a),a[s>=0?s:a.length-1]}const{data:a,error:i}=await c.from("category_assignments").upsert({trip_id:r.trip_id,category_id:r.category_id,assigned_user_ids:r.assigned_user_ids,lead_user_id:r.lead_user_id,task_id:r.task_id},{onConflict:"trip_id,category_id"}).select().single();if(i)throw i;return a},onSuccess:()=>{r.invalidateQueries({queryKey:["categoryAssignments",e]})}}),g=n({mutationFn:async r=>{if(s||!t){const t=A(e).filter(e=>e.category_id!==r);return void $(e,t)}const{error:a}=await c.from("category_assignments").delete().eq("trip_id",e).eq("category_id",r);if(a)throw a},onSuccess:()=>{r.invalidateQueries({queryKey:["categoryAssignments",e]})}});return{assignments:a.data||[],isLoading:a.isLoading,upsertAssignment:o.mutateAsync,deleteAssignment:g.mutateAsync}},D=({tripMembers:s,tripId:r})=>{var i;const[n,o]=t.useState(null),[l,d]=t.useState(!1),[c,g]=t.useState({}),{createOrUpdateCategoryTask:m}=(e=>{const{createTaskMutation:t}=a(e),{upsertAssignment:s,deleteAssignment:r,assignments:i}=F(e);return{createOrUpdateCategoryTask:async(a,n,o)=>{const l=E.find(e=>e.id===a);if(!l)return;const d=i.find(e=>e.category_id===a);if(0!==n.length)if(d&&d.task_id)await s({...d,assigned_user_ids:n,lead_user_id:o});else try{const r=await t.mutateAsync({title:`Plan ${l.name}`,description:`You've been assigned to coordinate ${l.description.toLowerCase()} for this trip.`,is_poll:!1,assignedTo:n});await s({trip_id:e,category_id:a,assigned_user_ids:n,lead_user_id:o,task_id:r.id})}catch(c){await s({trip_id:e,category_id:a,assigned_user_ids:n,lead_user_id:o})}else d&&await r(a)}}})(r),{assignments:u}=F(r);t.useEffect(()=>{const e={};u.forEach(t=>{e[t.category_id]={userIds:t.assigned_user_ids,leadId:t.lead_user_id}}),g(e)},[u]);const f=e=>{const t=c[e];return t?s.filter(e=>t.userIds.includes(e.id)):[]},b=e=>{var t;return null==(t=c[e])?void 0:t.leadId},v=async(e,t,s=!1)=>{const r=c[e]||{userIds:[],leadId:void 0},a=r.userIds.includes(t);let i=r.userIds,n=r.leadId;a||(i=[...r.userIds,t]),s&&(n=t),g(t=>({...t,[e]:{userIds:i,leadId:n}})),await m(e,i,n)},j=async(e,t)=>{const s=c[e];if(!s)return;const r=s.userIds.filter(e=>e!==t);let a=s.leadId;if(a===t&&(a=r[0]),0===r.length){const{[e]:t,...s}=c;g(s)}else g(t=>({...t,[e]:{userIds:r,leadId:a}}));await m(e,r,a)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white/5 backdrop-blur-md border border-white/10 rounded-2xl p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-3",children:"Assign Category Responsibilities"}),e.jsx("p",{className:"text-gray-300",children:"Assign team members to be responsible for different aspects of your trip. The person with the crown icon is the category lead and has primary responsibility."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:E.map(t=>{const s=f(t.id),r=b(t.id),a=s.length;return e.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl p-6 hover:border-yellow-500/30 transition-all",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"text-3xl",children:t.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:t.name}),e.jsx("p",{className:"text-sm text-gray-400",children:t.description})]})]}),e.jsx("div",{className:"mb-4",children:a>0?e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-400 text-sm",children:[e.jsx(x,{size:16}),e.jsxs("span",{children:[a," ",1===a?"person":"people"," assigned"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-blue-400 text-xs",children:[e.jsx(I,{size:14}),e.jsx("span",{children:"Task created in Tasks tab"})]})]}):e.jsx("div",{className:"text-gray-400 text-sm",children:"No one assigned yet"})}),s.length>0&&e.jsx("div",{className:"space-y-2 mb-4",children:s.map(s=>e.jsxs("div",{className:"flex items-center justify-between bg-white/5 rounded-lg p-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:s.avatar,alt:s.name,className:"w-6 h-6 rounded-full"}),e.jsx("span",{className:"text-white text-sm",children:s.name}),r===s.id&&e.jsx(p,{size:14,className:"text-yellow-500"})]}),e.jsx("button",{onClick:()=>j(t.id,s.id),className:"text-gray-400 hover:text-red-400 text-xs",children:"Remove"})]},s.id))}),e.jsxs("button",{onClick:()=>{o(t.id),d(!0)},className:"w-full flex items-center justify-center gap-2 bg-yellow-500/20 hover:bg-yellow-500/30 text-yellow-400 py-2 rounded-lg transition-colors border border-yellow-500/30",children:[e.jsx(h,{size:16}),e.jsx("span",{children:"Assign People"})]})]},t.id)})}),l&&n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-2xl p-6 w-full max-w-md",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-4",children:["Assign to ",null==(i=E.find(e=>e.id===n))?void 0:i.name]}),e.jsx("div",{className:"space-y-3 mb-6",children:s.map(t=>{const s=f(n),r=b(n),a=s.some(e=>e.id===t.id),i=r===t.id;return e.jsxs("div",{className:"flex items-center justify-between bg-gray-800 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:t.avatar,alt:t.name,className:"w-8 h-8 rounded-full"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:t.name}),e.jsx("div",{className:"text-gray-400 text-sm",children:t.email})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a&&e.jsx("button",{onClick:()=>v(n,t.id,!0),className:"p-1 rounded "+(i?"text-yellow-500":"text-gray-400 hover:text-yellow-500"),title:"Make lead",children:e.jsx(p,{size:16})}),e.jsx("button",{onClick:()=>a?j(n,t.id):v(n,t.id),className:"p-1 rounded "+(a?"text-red-400 hover:text-red-300":"text-green-400 hover:text-green-300"),children:a?e.jsx(y,{size:16}):e.jsx(h,{size:16})})]})]},t.id)})}),e.jsx("div",{className:"flex gap-3",children:e.jsx("button",{onClick:()=>d(!1),className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-2 rounded-lg transition-colors",children:"Done"})})]})})]})},T=({category:s,isOpen:r,onClose:a,onSubmit:i,selectedDate:n})=>{const[o,l]=t.useState({title:"",time:"",location:"",description:"",checkInTime:"",checkOutTime:"",bookingReference:"",cuisine:"",dietaryRestrictions:"",priceRange:"",duration:"",difficulty:"",dressCode:"",coverCharge:"",ageRequirement:""});return r?e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-2xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:s.icon}),e.jsxs("h3",{className:"text-xl font-semibold text-white",children:["Add ",s.name," Event"]})]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white p-1 rounded-lg hover:bg-gray-800",children:e.jsx(g,{size:20})})]}),n&&e.jsxs("div",{className:"mb-4 text-sm text-gray-400",children:["Date: ",n.toLocaleDateString()]}),e.jsxs("form",{onSubmit:e=>{e.preventDefault(),i(o),l({title:"",time:"",location:"",description:"",checkInTime:"",checkOutTime:"",bookingReference:"",cuisine:"",dietaryRestrictions:"",priceRange:"",duration:"",difficulty:"",dressCode:"",coverCharge:"",ageRequirement:""})},className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Event title",value:o.title,onChange:e=>l({...o,title:e.target.value}),required:!0,className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500"}),e.jsx("input",{type:"time",value:o.time,onChange:e=>l({...o,time:e.target.value}),required:!0,className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-yellow-500"}),e.jsx("input",{type:"text",placeholder:"Location",value:o.location,onChange:e=>l({...o,location:e.target.value}),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500"}),(()=>{switch(s.id){case"accommodations":return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"time",placeholder:"Check-in time",value:o.checkInTime,onChange:e=>l({...o,checkInTime:e.target.value}),className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-yellow-500"}),e.jsx("input",{type:"time",placeholder:"Check-out time",value:o.checkOutTime,onChange:e=>l({...o,checkOutTime:e.target.value}),className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-yellow-500"})]}),e.jsx("input",{type:"text",placeholder:"Booking reference",value:o.bookingReference,onChange:e=>l({...o,bookingReference:e.target.value}),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500"})]});case"food":return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",placeholder:"Cuisine type",value:o.cuisine,onChange:e=>l({...o,cuisine:e.target.value}),className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500"}),e.jsxs("select",{value:o.priceRange,onChange:e=>l({...o,priceRange:e.target.value}),className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-yellow-500",children:[e.jsx("option",{value:"",children:"Price range"}),e.jsx("option",{value:"$",children:"$ (Budget)"}),e.jsx("option",{value:"$$",children:"$$ (Moderate)"}),e.jsx("option",{value:"$$$",children:"$$$ (Expensive)"}),e.jsx("option",{value:"$$$$",children:"$$$$ (Very Expensive)"})]})]}),e.jsx("input",{type:"text",placeholder:"Dietary restrictions",value:o.dietaryRestrictions,onChange:e=>l({...o,dietaryRestrictions:e.target.value}),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500"})]});case"transportation":return e.jsx("input",{type:"text",placeholder:"Booking reference / Flight number",value:o.bookingReference,onChange:e=>l({...o,bookingReference:e.target.value}),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500"});case"fitness":return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",placeholder:"Duration (e.g., 2 hours)",value:o.duration,onChange:e=>l({...o,duration:e.target.value}),className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500"}),e.jsxs("select",{value:o.difficulty,onChange:e=>l({...o,difficulty:e.target.value}),className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-yellow-500",children:[e.jsx("option",{value:"",children:"Difficulty"}),e.jsx("option",{value:"easy",children:"Easy"}),e.jsx("option",{value:"moderate",children:"Moderate"}),e.jsx("option",{value:"hard",children:"Hard"}),e.jsx("option",{value:"expert",children:"Expert"})]})]})});case"nightlife":return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",placeholder:"Dress code",value:o.dressCode,onChange:e=>l({...o,dressCode:e.target.value}),className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500"}),e.jsx("input",{type:"text",placeholder:"Cover charge",value:o.coverCharge,onChange:e=>l({...o,coverCharge:e.target.value}),className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500"})]}),e.jsx("input",{type:"text",placeholder:"Age requirement",value:o.ageRequirement,onChange:e=>l({...o,ageRequirement:e.target.value}),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500"})]});default:return null}})(),e.jsx("textarea",{placeholder:"Description (optional)",value:o.description,onChange:e=>l({...o,description:e.target.value}),rows:3,className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500 resize-none"}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-yellow-500 hover:bg-yellow-600 text-black font-medium py-2 rounded-lg transition-colors",children:"Add Event"}),e.jsx("button",{type:"button",onClick:a,className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-2 rounded-lg transition-colors",children:"Cancel"})]})]})]})}):null},R=[{id:"accommodations",name:"Accommodations",icon:"🏨",color:"bg-blue-500"},{id:"food",name:"Food & Dining",icon:"🍽️",color:"bg-red-500"},{id:"transportation",name:"Transportation",icon:"🚗",color:"bg-green-500"},{id:"fitness",name:"Fitness & Activities",icon:"💪",color:"bg-purple-500"},{id:"nightlife",name:"Nightlife & Entertainment",icon:"🌙",color:"bg-indigo-500"},{id:"attractions",name:"Attractions & Sightseeing",icon:"🎯",color:"bg-yellow-500"},{id:"budget",name:"Budget & Expenses",icon:"💰",color:"bg-emerald-500"}],M=({categories:t,selectedFilter:s,onFilterChange:r})=>e.jsxs("div",{className:"bg-card/50 backdrop-blur-sm border border-border rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(v,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Filter by Category"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>r(null),className:"px-3 py-2 rounded-lg text-sm transition-colors "+(null===s?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground hover:bg-secondary/80"),children:"All Categories"}),t.map(t=>e.jsxs("button",{onClick:()=>r(t.id),className:"flex items-center gap-2 px-3 py-2 rounded-lg text-sm transition-colors "+(s===t.id?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground hover:bg-secondary/80"),children:[e.jsx("span",{children:t.icon}),t.name]},t.id))]})]}),q=({categories:t,onSelectCategory:s})=>e.jsxs("div",{className:"bg-card/50 backdrop-blur-sm border border-border rounded-2xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-4",children:"Quick Add Event"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:t.slice(0,6).map(t=>e.jsxs("button",{onClick:()=>s(t.id),className:"flex items-center gap-2 bg-secondary/50 hover:bg-secondary text-foreground px-3 py-2 rounded-lg transition-colors text-sm",children:[e.jsx("span",{children:t.icon}),t.name]},t.id))})]}),z=({event:t,categoryInfo:s,assignment:r})=>e.jsx("div",{className:"bg-card border border-border rounded-lg p-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-lg",children:null==s?void 0:s.icon}),e.jsx("h4",{className:"font-medium text-foreground",children:t.title}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${null==s?void 0:s.color} text-white`,children:null==s?void 0:s.name})]}),e.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-3.5 w-3.5"}),t.time]}),t.location&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-3.5 w-3.5"}),t.location]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-3.5 w-3.5"}),"Added by ",t.creatorName||"Unknown"]})]}),t.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:t.description})]})})}),O=({events:t,selectedDate:s,assignments:r,getCategoryInfo:a})=>e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-4",children:s?`Events for ${N(s,"EEEE, MMM d")}`:"Select a date to view events"}),t.length>0?e.jsx("div",{className:"space-y-3",children:t.map(t=>e.jsx(z,{event:t,categoryInfo:a(t.event_category),assignment:r.find(e=>e.categoryId===t.event_category)},t.id))}):e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"text-muted-foreground text-sm",children:s?"No events scheduled for this day":"Select a date to view events"})})]}),U=({tripMembers:s,assignments:r,tripId:a})=>{const[i,n]=t.useState(new Date),[o,l]=t.useState(!1),{createEventFromCalendar:d,getCalendarEvents:c}=(e=>{const[s,r]=t.useState([]),[a,i]=t.useState(!1);t.useEffect(()=>{e&&n()},[e]);const n=async()=>{if(e){i(!0);try{const t=await b.getTripEvents(e);r(t)}catch(t){}finally{i(!1)}}},o=async e=>{const t=await b.createEvent(e);return t&&r(e=>[...e,t]),t};return{events:s,loading:a,createEvent:o,createEventFromCalendar:async t=>{if(!e)return null;const s=b.convertFromCalendarEvent(t,e);return o(s)},updateEvent:async(e,t)=>{const s=await b.updateEvent(e,t);return s&&r(s=>s.map(s=>s.id===e?{...s,...t}:s)),s},deleteEvent:async t=>{const s=await b.deleteEvent(t,e);return s&&r(e=>e.filter(e=>e.id!==t)),s},refreshEvents:n,getCalendarEvents:()=>s.map(e=>b.convertToCalendarEvent(e))}})(a),{categories:g,filterCategory:u,setFilterCategory:x,selectedCategory:p,setSelectedCategory:h,selectCategory:y,getCategoryInfo:v,filterEventsByCategory:j}=(e=>{const[s,r]=t.useState(null),[a,i]=t.useState(null);return{categories:R,filterCategory:s,setFilterCategory:r,selectedCategory:a,setSelectedCategory:i,selectCategory:e=>i(e),getCategoryInfo:e=>R.find(t=>t.id===e),getUserAssignedCategories:t=>e.filter(e=>e.assignedUsers.some(e=>e.id===t)).map(e=>e.categoryId),isUserLeadForCategory:(t,s)=>{const r=e.find(e=>e.categoryId===s);return(null==r?void 0:r.leadUserId)===t},filterEventsByCategory:e=>s?e.filter(e=>e.event_category===s):e,clearFilter:()=>r(null)}})(r),w=c(),N=i?(e=>{const t=w.filter(t=>t.date.toDateString()===e.toDateString());return j(t)})(i):[],k=w.map(e=>e.date);return e.jsxs("div",{className:"space-y-6",children:[e.jsx(M,{categories:g,selectedFilter:u,onFilterChange:x}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl p-6",children:e.jsx(f,{mode:"single",selected:i,onSelect:n,className:"w-full",modifiers:{hasEvents:k},modifiersStyles:{hasEvents:{backgroundColor:"rgb(59 130 246 / 0.3)",color:"white",fontWeight:"bold"}}})}),e.jsxs("div",{className:"bg-card/50 backdrop-blur-sm border border-border rounded-2xl p-6 flex flex-col h-full",children:[e.jsx(q,{categories:g,onSelectCategory:e=>{y(e),l(!0)}}),e.jsx("div",{className:"flex-1 mt-4",children:e.jsx(O,{events:N,selectedDate:i,assignments:r,getCategoryInfo:v})})]})]}),o&&p&&e.jsx(T,{category:g.find(e=>e.id===p),isOpen:o,onClose:()=>{l(!1),h(null)},onSubmit:async e=>{if(!i||!p)return;const t={id:"",title:e.title,date:i,time:e.time,location:e.location,description:e.description,createdBy:"",include_in_itinerary:!0,event_category:(s=p||"other",{accommodations:"lodging",food:"dining",transportation:"transportation",fitness:"activity",nightlife:"entertainment",attractions:"activity",budget:"other"}[s]||"other"),source_type:"manual",source_data:{}};var s;try{await d(t)?(m.success("Event added successfully!"),l(!1),y(null)):m.error("Failed to add event. Please try again.")}catch(r){m.error("Failed to add event. Please try again.")}},selectedDate:i})]})},B=()=>{const{tripId:a}=s(),i=r(),[n,o]=t.useState("assignments"),{assignments:l}=F(a||""),d=[{id:"1",name:"Joe",avatar:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=40&h=40&fit=crop&crop=face",email:"joe@example.com"},{id:"2",name:"Phil",avatar:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=40&h=40&fit=crop&crop=face",email:"phil@example.com"},{id:"3",name:"Stephanie",avatar:"https://images.unsplash.com/photo-1494790108755-2616b612b47c?w=40&h=40&fit=crop&crop=face",email:"stephanie@example.com"},{id:"4",name:"Elissa",avatar:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=40&h=40&fit=crop&crop=face",email:"elissa@example.com"},{id:"5",name:"Tara",avatar:"https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=40&h=40&fit=crop&crop=face",email:"tara@example.com"}],c=l.map(e=>({categoryId:e.category_id,assignedUsers:d.filter(t=>e.assigned_user_ids.includes(t.id)),leadUserId:e.lead_user_id}));return e.jsx("div",{className:"min-h-screen bg-black",children:e.jsxs("div",{className:"container mx-auto px-6 py-8 max-w-7xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("button",{onClick:()=>i(`/trip/${a}`),className:"flex items-center gap-3 text-gray-300 hover:text-white transition-colors group",children:[e.jsx("div",{className:"bg-gray-800 p-2 rounded-lg shadow-lg group-hover:shadow-yellow-500/20 transition-all border border-gray-700 hover:border-yellow-500/50",children:e.jsx(k,{size:20})}),e.jsx("span",{className:"font-medium",children:"Back to Trip"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>o("assignments"),className:"flex items-center gap-2 px-4 py-2 rounded-xl transition-colors "+("assignments"===n?"bg-yellow-500 text-black":"bg-gray-800 text-white hover:bg-gray-700"),children:[e.jsx(C,{size:16}),"Assignments"]}),e.jsxs("button",{onClick:()=>o("calendar"),className:"flex items-center gap-2 px-4 py-2 rounded-xl transition-colors "+("calendar"===n?"bg-yellow-500 text-black":"bg-gray-800 text-white hover:bg-gray-700"),children:[e.jsx(_,{size:16}),"Calendar"]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Itinerary Management"}),e.jsx("p",{className:"text-gray-400",children:"Assign responsibilities and collaborate on your trip planning"})]}),"assignments"===n?e.jsx(D,{tripMembers:d,tripId:a||""}):e.jsx(U,{tripMembers:d,assignments:c,tripId:a||""})]})})};export{B as default};
